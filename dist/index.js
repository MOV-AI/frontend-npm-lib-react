!function(e,t){"object"==typeof exports&&"object"==typeof module?module.exports=t():"function"==typeof define&&define.amd?define([],t):"object"==typeof exports?exports.Movai=t():e.Movai=t()}(global,(function(){return function(e){var t={};function n(o){if(t[o])return t[o].exports;var r=t[o]={i:o,l:!1,exports:{}};return e[o].call(r.exports,r,r.exports,n),r.l=!0,r.exports}return n.m=e,n.c=t,n.d=function(e,t,o){n.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:o})},n.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},n.t=function(e,t){if(1&t&&(e=n(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var o=Object.create(null);if(n.r(o),Object.defineProperty(o,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var r in e)n.d(o,r,function(t){return e[t]}.bind(null,r));return o},n.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return n.d(t,"a",t),t},n.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},n.p="",n(n.s=94)}([function(e,t){e.exports=require("@babel/runtime-corejs3/helpers/esm/defineProperty")},function(e,t){e.exports=require("babylonjs")},function(e,t){e.exports=require("react")},function(e,t){e.exports=require("@babel/runtime-corejs3/core-js-stable/instance/for-each")},function(e,t){e.exports=require("@babel/runtime-corejs3/helpers/esm/assertThisInitialized")},function(e,t){e.exports=require("prop-types")},function(e,t){e.exports=require("@babel/runtime-corejs3/core-js-stable/instance/map")},function(e,t){e.exports=require("monet")},function(e,t){e.exports=require("@babel/runtime-corejs3/helpers/esm/classCallCheck")},function(e,t){e.exports=require("@babel/runtime-corejs3/helpers/esm/createClass")},function(e,t){e.exports=require("@babel/runtime-corejs3/helpers/esm/getPrototypeOf")},function(e,t){e.exports=require("@babel/runtime-corejs3/helpers/esm/possibleConstructorReturn")},function(e,t){e.exports=require("@babel/runtime-corejs3/helpers/esm/extends")},function(e,t){e.exports=require("@babel/runtime-corejs3/helpers/esm/inherits")},function(e,t){e.exports=require("@babel/runtime-corejs3/core-js-stable/instance/flat-map")},function(e,t){e.exports=require("@babel/runtime-corejs3/helpers/esm/get")},function(e,t){e.exports=require("@babel/runtime-corejs3/core-js-stable/instance/concat")},function(e,t){e.exports=require("@babel/runtime-corejs3/core-js-stable/object/keys")},function(e,t){e.exports=require("@babel/runtime-corejs3/core-js-stable/instance/filter")},function(e,t){e.exports=require("mov.ai-core")},function(e,t){e.exports=require("@babel/runtime-corejs3/core-js-stable/object/get-own-property-descriptors")},function(e,t){e.exports=require("@babel/runtime-corejs3/core-js-stable/object/get-own-property-descriptor")},function(e,t){e.exports=require("@babel/runtime-corejs3/core-js-stable/object/get-own-property-symbols")},function(e,t){e.exports=require("@material-ui/core/styles")},function(e,t){e.exports=require("@babel/runtime-corejs3/core-js-stable/object/define-property")},function(e,t){e.exports=require("@babel/runtime-corejs3/core-js-stable/object/define-properties")},function(e,t){e.exports=require("@babel/runtime-corejs3/helpers/esm/toConsumableArray")},function(e,t){e.exports=require("@material-ui/core")},function(e,t){e.exports=require("@babel/runtime-corejs3/core-js-stable/object/values")},function(e,t){e.exports=require("@babel/runtime-corejs3/core-js-stable/instance/reduce")},function(e,t){e.exports=require("@babel/runtime-corejs3/core-js-stable/instance/some")},function(e,t){e.exports=require("@babel/runtime-corejs3/helpers/esm/slicedToArray")},function(e,t){e.exports=require("@babel/runtime-corejs3/core-js-stable/set-timeout")},function(e,t){e.exports=require("@babel/runtime-corejs3/core-js-stable/instance/splice")},function(e,t){e.exports=require("@material-ui/icons/ChevronRight")},function(e,t){e.exports=require("@material-ui/core/MenuItem")},function(e,t){e.exports=require("@material-ui/core/Typography")},function(e,t){e.exports=require("@material-ui/icons/Search")},function(e,t){e.exports=require("@babel/runtime-corejs3/helpers/esm/objectWithoutProperties")},function(e,t){e.exports=require("@babel/runtime-corejs3/core-js-stable/instance/fill")},function(e,t){e.exports=require("react-dom")},function(e,t){e.exports=require("@material-ui/icons/Clear")},function(e,t){e.exports=require("@babylonjs/gui/2D")},function(e,t){e.exports=require("@babel/runtime-corejs3/core-js-stable/promise")},function(e,t){e.exports=require("@babel/runtime-corejs3/regenerator")},function(e,t){e.exports=require("@material-ui/core/Button")},function(e,t){e.exports=require("@material-ui/core/Drawer")},function(e,t){e.exports=require("@material-ui/icons/ExpandMore")},function(e,t){e.exports=require("@material-ui/core/Collapse")},function(e,t){e.exports=require("@material-ui/core/Menu")},function(e,t){e.exports=require("material-table")},function(e,t){e.exports=require("@material-ui/icons/AddBox")},function(e,t){e.exports=require("@material-ui/icons/ArrowDownward")},function(e,t){e.exports=require("@material-ui/icons/Check")},function(e,t){e.exports=require("@material-ui/icons/ChevronLeft")},function(e,t){e.exports=require("@material-ui/icons/DeleteOutline")},function(e,t){e.exports=require("@material-ui/icons/Edit")},function(e,t){e.exports=require("@material-ui/icons/FilterList")},function(e,t){e.exports=require("@material-ui/icons/FirstPage")},function(e,t){e.exports=require("@material-ui/icons/LastPage")},function(e,t){e.exports=require("@material-ui/icons/Remove")},function(e,t){e.exports=require("@material-ui/icons/SaveAlt")},function(e,t){e.exports=require("@material-ui/icons/ViewColumn")},function(e,t){e.exports=require("@material-ui/core/Tabs")},function(e,t){e.exports=require("@material-ui/core/Tab")},function(e,t){e.exports=require("@material-ui/core/TextField")},function(e,t){e.exports=require("@material-ui/core/FormControlLabel")},function(e,t){e.exports=require("@material-ui/core/Switch")},function(e,t){e.exports=require("@material-ui/core/InputBase")},function(e,t){e.exports=require("@material-ui/core/Breadcrumbs")},function(e,t){e.exports=require("@material-ui/icons/NavigateNext")},function(e,t){e.exports=require("react-resize-detector")},function(e,t){e.exports=require("@babel/runtime-corejs3/core-js-stable/math/sign")},function(e,t){e.exports=require("earcut")},function(e,t){e.exports=require("@babel/runtime-corejs3/core-js-stable/instance/sort")},function(e,t){e.exports=require("@babel/runtime-corejs3/core-js-stable/instance/find-index")},function(e,t){e.exports=require("@babel/runtime-corejs3/core-js-stable/instance/slice")},function(e,t){e.exports=require("@babel/runtime-corejs3/core-js-stable/instance/every")},function(e,t){e.exports=require("@babel/runtime-corejs3/core-js-stable/instance/includes")},function(e,t){e.exports=require("@babel/runtime-corejs3/core-js-stable/number/parse-float")},function(e,t){e.exports=require("@babel/runtime-corejs3/helpers/esm/asyncToGenerator")},function(e,t){e.exports=require("@material-ui/core/InputLabel")},function(e,t){e.exports=require("@material-ui/core/FormControl")},function(e,t){e.exports=require("@material-ui/core/Select")},function(e,t){e.exports=require("clsx")},function(e,t){e.exports=require("@material-ui/core/IconButton")},function(e,t){e.exports=require("@material-ui/core/utils")},function(e,t){e.exports=require("@material-ui/core/colors")},function(e,t){e.exports=require("babylonjs-loaders")},function(e,t){e.exports=require("@material-ui/core/FormHelperText")},function(e,t,n){var o=n(91),r=n(92);"string"==typeof(r=r.__esModule?r.default:r)&&(r=[[e.i,r,""]]);var a={insert:"head",singleton:!1},i=(o(r,a),r.locals?r.locals:{});e.exports=i},function(e,t,n){"use strict";var o,r=function(){return void 0===o&&(o=Boolean(window&&document&&document.all&&!window.atob)),o},a=function(){var e={};return function(t){if(void 0===e[t]){var n=document.querySelector(t);if(window.HTMLIFrameElement&&n instanceof window.HTMLIFrameElement)try{n=n.contentDocument.head}catch(e){n=null}e[t]=n}return e[t]}}(),i=[];function l(e){for(var t=-1,n=0;n<i.length;n++)if(i[n].identifier===e){t=n;break}return t}function c(e,t){for(var n={},o=[],r=0;r<e.length;r++){var a=e[r],c=t.base?a[0]+t.base:a[0],u=n[c]||0,s="".concat(c," ").concat(u);n[c]=u+1;var f=l(s),m={css:a[1],media:a[2],sourceMap:a[3]};-1!==f?(i[f].references++,i[f].updater(m)):i.push({identifier:s,updater:v(m,t),references:1}),o.push(s)}return o}function u(e){var t=document.createElement("style"),o=e.attributes||{};if(void 0===o.nonce){var r=n.nc;r&&(o.nonce=r)}if(Object.keys(o).forEach((function(e){t.setAttribute(e,o[e])})),"function"==typeof e.insert)e.insert(t);else{var i=a(e.insert||"head");if(!i)throw new Error("Couldn't find a style target. This probably means that the value for the 'insert' parameter is invalid.");i.appendChild(t)}return t}var s,f=(s=[],function(e,t){return s[e]=t,s.filter(Boolean).join("\n")});function m(e,t,n,o){var r=n?"":o.media?"@media ".concat(o.media," {").concat(o.css,"}"):o.css;if(e.styleSheet)e.styleSheet.cssText=f(t,r);else{var a=document.createTextNode(r),i=e.childNodes;i[t]&&e.removeChild(i[t]),i.length?e.insertBefore(a,i[t]):e.appendChild(a)}}function h(e,t,n){var o=n.css,r=n.media,a=n.sourceMap;if(r?e.setAttribute("media",r):e.removeAttribute("media"),a&&btoa&&(o+="\n/*# sourceMappingURL=data:application/json;base64,".concat(btoa(unescape(encodeURIComponent(JSON.stringify(a))))," */")),e.styleSheet)e.styleSheet.cssText=o;else{for(;e.firstChild;)e.removeChild(e.firstChild);e.appendChild(document.createTextNode(o))}}var d=null,p=0;function v(e,t){var n,o,r;if(t.singleton){var a=p++;n=d||(d=u(t)),o=m.bind(null,n,a,!1),r=m.bind(null,n,a,!0)}else n=u(t),o=h.bind(null,n,t),r=function(){!function(e){if(null===e.parentNode)return!1;e.parentNode.removeChild(e)}(n)};return o(e),function(t){if(t){if(t.css===e.css&&t.media===e.media&&t.sourceMap===e.sourceMap)return;o(e=t)}else r()}}e.exports=function(e,t){(t=t||{}).singleton||"boolean"==typeof t.singleton||(t.singleton=r());var n=c(e=e||[],t);return function(e){if(e=e||[],"[object Array]"===Object.prototype.toString.call(e)){for(var o=0;o<n.length;o++){var r=l(n[o]);i[r].references--}for(var a=c(e,t),u=0;u<n.length;u++){var s=l(n[u]);0===i[s].references&&(i[s].updater(),i.splice(s,1))}n=a}}}},function(e,t,n){(t=n(93)(!1)).push([e.i,"body.react-confirm-alert-body-element {\n  overflow: hidden;\n}\n\n.react-confirm-alert-blur {\n  filter: url(#gaussian-blur);\n  filter: blur(2px);\n  -webkit-filter: blur(2px);\n}\n\n.react-confirm-alert-overlay {\n  position: fixed;\n  top: calc(100vh - 300px);\n  left: 0;\n  right: 0;\n  bottom: 0;\n  z-index: 99;\n  display: -webkit-flex;\n  display: -moz-flex;\n  display: -ms-flex;\n  display: -o-flex;\n  display: flex;\n  justify-content: flex-start;\n  -ms-align-items: center;\n  align-items: flex-end;\n  opacity: 1;\n}\n\n.react-confirm-alert-body {\n  width: 400px;\n  padding: 30px;\n}\n\n.react-confirm-alert-svg {\n  position: absolute;\n  top: 0;\n  left: 0;\n}\n\n.react-confirm-alert-body > h1 {\n  margin-top: 0;\n}\n\n.react-confirm-alert-body > h3 {\n  margin: 0;\n  font-size: 16px;\n}\n\n.react-confirm-alert-button-group {\n  display: -webkit-flex;\n  display: -moz-flex;\n  display: -ms-flex;\n  display: -o-flex;\n  display: flex;\n  justify-content: flex-start;\n  margin-top: 20px;\n}\n\n.react-confirm-alert-button-group > button {\n  outline: none;\n  background: #333;\n  border: none;\n  display: inline-block;\n  padding: 6px 18px;\n  color: #eee;\n  margin-right: 10px;\n  border-radius: 5px;\n  font-size: 12px;\n  cursor: pointer;\n}\n\n.icon-container {\n  display: flex;\n  justify-content: center;\n  align-items: center;\n}\n\n.icon-container:hover {\n  cursor: pointer;\n}\n",""]),e.exports=t},function(e,t,n){"use strict";e.exports=function(e){var t=[];return t.toString=function(){return this.map((function(t){var n=function(e,t){var n=e[1]||"",o=e[3];if(!o)return n;if(t&&"function"==typeof btoa){var r=(i=o,l=btoa(unescape(encodeURIComponent(JSON.stringify(i)))),c="sourceMappingURL=data:application/json;charset=utf-8;base64,".concat(l),"/*# ".concat(c," */")),a=o.sources.map((function(e){return"/*# sourceURL=".concat(o.sourceRoot||"").concat(e," */")}));return[n].concat(a).concat([r]).join("\n")}var i,l,c;return[n].join("\n")}(t,e);return t[2]?"@media ".concat(t[2]," {").concat(n,"}"):n})).join("")},t.i=function(e,n,o){"string"==typeof e&&(e=[[null,e,""]]);var r={};if(o)for(var a=0;a<this.length;a++){var i=this[a][0];null!=i&&(r[i]=!0)}for(var l=0;l<e.length;l++){var c=[].concat(e[l]);o&&r[c[0]]||(n&&(c[2]?c[2]="".concat(n," and ").concat(c[2]):c[2]=n),t.push(c))}},t}},function(e,n,o){"use strict";o.r(n),o.d(n,"Button",(function(){return f})),o.d(n,"AbstractModal",(function(){return O})),o.d(n,"Drawer",(function(){return F})),o.d(n,"Collapse",(function(){return X})),o.d(n,"VerticalBar",(function(){return oe})),o.d(n,"ContextMenu",(function(){return ue})),o.d(n,"Table",(function(){return Ge})),o.d(n,"Tabs",(function(){return tt})),o.d(n,"Text",(function(){return at})),o.d(n,"Themes",(function(){return Wa})),o.d(n,"Toggle",(function(){return dt})),o.d(n,"SearchInput",(function(){return It})),o.d(n,"Breadcrumb",(function(){return qt})),o.d(n,"SceneViewer",(function(){return ya})),o.d(n,"Select",(function(){return Sa})),o.d(n,"snackbar",(function(){return La}));var r=o(2),a=o.n(r),i=o(45),l=o.n(i),c=o(5),u=o.n(c),s=function(e){return a.a.createElement(l.a,{className:e.className,style:e.style,onClick:e.onClick,color:e.color,variant:e.variant,size:e.size,startIcon:e.startIcon,disabled:e.disabled},e.children)};s.propTypes={style:u.a.object,onClick:u.a.func,color:u.a.string,variant:u.a.string,size:u.a.string,startIcon:u.a.element,children:u.a.node.isRequired,disabled:u.a.bool},s.defaultProps={style:{},onClick:function(){return console.log("Click MOV.AI button")},color:"default",variant:"contained",size:"medium",startIcon:void 0,children:a.a.createElement("div",null),disabled:!1};var f=s,m=o(24),h=o.n(m),d=o(25),p=o.n(d),v=o(20),b=o.n(v),y=o(3),g=o.n(y),M=o(21),x=o.n(M),w=o(18),C=o.n(w),k=o(22),P=o.n(k),N=o(17),S=o.n(N),T=o(0),E=o.n(T),A=o(27);function _(e,t){var n=S()(e);if(P.a){var o=P()(e);t&&(o=C()(o).call(o,(function(t){return x()(e,t).enumerable}))),n.push.apply(n,o)}return n}function j(e){for(var t=1;t<arguments.length;t++){var n,o=null!=arguments[t]?arguments[t]:{};if(t%2)g()(n=_(Object(o),!0)).call(n,(function(t){E()(e,t,o[t])}));else if(b.a)p()(e,b()(o));else{var r;g()(r=_(Object(o))).call(r,(function(t){h()(e,t,x()(o,t))}))}}return e}var R={margin:"auto",position:"absolute",overflow:"auto",display:"flex",flexDirection:"column"},I=function(e){var t=function(){e.onSubmit()},n=function(){e.onCancel()};return a.a.createElement(A.Modal,{onKeyPress:function(e){"Enter"===e.key&&t()},open:e.open,onClose:n,style:{display:"flex",alignItems:"center",justifyContent:"center"}},a.a.createElement(A.Card,{style:j({},R,{width:e.width,height:e.height,minWidth:"260px",minHeight:"280px"})},a.a.createElement(A.CardContent,{style:{flexGrow:1,display:"flex",flexDirection:"column",minHeight:0}},a.a.createElement(A.Typography,{variant:"h5",style:{padding:"12px 0px 12px 6px",fontWeight:600}},e.title),a.a.createElement("div",{style:{paddingLeft:"6px",flexGrow:1,overflow:"auto",minHeight:0}},e.children)),a.a.createElement(A.Divider,null),a.a.createElement(A.CardActions,{style:{alignSelf:"flex-end"}},a.a.createElement(f,{onClick:n,variant:"outlined"},e.cancelText),a.a.createElement(f,{color:"primary",onClick:t},e.submitText))))};I.propTypes={onSubmit:u.a.func,onCancel:u.a.func,open:u.a.bool,title:u.a.string,submitText:u.a.string,cancelText:u.a.string,width:u.a.string,height:u.a.string},I.defaultProps={onSubmit:function(){},onCancel:function(){},open:!1,title:"New",submitText:"Confirm",cancelText:"Cancel",width:"25%",height:"25%"};var O=I,B=o(46),z=o.n(B),D=function(e){return a.a.createElement(z.a,{style:e.style,anchor:e.anchor,open:e.open,onClose:e.onClose},e.children)};D.propTypes={style:u.a.object,anchor:u.a.string,open:u.a.bool,children:u.a.object},D.defaultProps={style:{},anchor:"left",open:!1,children:a.a.createElement("div",null)},D.ANCHOR={left:"left",right:"right",top:"top",bottom:"bottom"};var F=D,V=o(31),q=o.n(V),L=o(34),U=o.n(L),G=o(47),W=o.n(G),Y=o(48),Q=o.n(Y);function H(e,t){var n=S()(e);if(P.a){var o=P()(e);t&&(o=C()(o).call(o,(function(t){return x()(e,t).enumerable}))),n.push.apply(n,o)}return n}function Z(e){for(var t=1;t<arguments.length;t++){var n,o=null!=arguments[t]?arguments[t]:{};if(t%2)g()(n=H(Object(o),!0)).call(n,(function(t){E()(e,t,o[t])}));else if(b.a)p()(e,b()(o));else{var r;g()(r=H(Object(o))).call(r,(function(t){h()(e,t,x()(o,t))}))}}return e}var K=function(e){var t=a.a.useState(e.open),n=q()(t,2),o=n[0],r=n[1];a.a.useEffect((function(){e.open!==o&&r(e.open)}),[e.open]);var i;return a.a.createElement(A.List,null,a.a.createElement(A.ListItem,{button:!0,onClick:(i=e.onClick,function(){r(!o),i()})},o?a.a.createElement(W.a,{style:Z({},e.iconStyle)}):a.a.createElement(U.a,{style:Z({},e.iconStyle)}),a.a.createElement("div",{style:{width:"100%"}},e.item)),e.divided?a.a.createElement(A.Divider,null):[],a.a.createElement(Q.a,{className:e.className,style:e.style,in:o},e.children))};K.propTypes={item:u.a.object,onClick:u.a.func,open:u.a.bool,divided:u.a.bool,iconStyle:u.a.object},K.defaultProps={item:a.a.createElement("div",null),onClick:function(){},open:!1,divided:!1,style:{},iconStyle:{}};var X=K,J=o(6),$=o.n(J),ee=o(23),te=Object(ee.makeStyles)((function(e){return{container:{height:"100%",backgroundColor:function(e){return e.backgroundColor},width:function(e){return e.width},display:"flex",flexDirection:"column"},logoArea:{padding:"17px",textAlign:"center",alignItems:"center",justifyContent:"center"},navigationArea:{flexGrow:1,display:"flex",flexDirection:"column",alignItems:"center"},accountArea:{padding:"17px",textAlign:"center",alignItems:"center",justifyContent:"center"}}})),ne=function(e){var t,n=te(e);return a.a.createElement("div",{className:n.container},a.a.createElement("div",{className:n.logoArea},e.upperElement),a.a.createElement("div",{className:n.navigationArea},$()(t=e.navigationList).call(t,(function(e,t){return a.a.createElement("div",{key:t,style:{padding:"15px 0px"}},e)}))),a.a.createElement("div",{className:n.accountArea},e.lowerElement))};ne.propTypes={upperElement:u.a.node.isRequired,navigationList:u.a.array,lowerElement:u.a.node.isRequired,width:u.a.string,backgroundColor:u.a.string},ne.defaultProps={upperElement:a.a.createElement("div",null),navigationList:[a.a.createElement("div",null)],lowerElement:a.a.createElement("div",null),width:"68px",backgroundColor:"#424242"};var oe=ne,re=o(49),ae=o.n(re),ie=o(35),le=o.n(ie),ce=function(e){var t,n=a.a.useState(null),o=q()(n,2),r=o[0],i=o[1],l=function(){i(null)};return a.a.createElement("div",null,a.a.cloneElement(e.element,{onClick:function(t){void 0!==e.element.props.onClick&&e.element.props.onClick(),i(t.currentTarget)}}),a.a.createElement(ae.a,{id:"simple-menu",anchorEl:r,keepMounted:!0,open:Boolean(r),onClose:l},$()(t=e.menuList).call(t,(function(e,t){return a.a.createElement(le.a,{onClick:function(){e.onClick(),(e.onClose||void 0===e.onClose)&&l()},key:t},e.element)}))))};ce.propTypes={element:u.a.node.isRequired,navigationList:u.a.array,lowerElement:u.a.node.isRequired,width:u.a.string,backgroundColor:u.a.string},ce.defaultProps={element:a.a.createElement("div",null,"Ahaha"),menuList:[{onClick:function(){return console.log("clicked 1")},element:"Profile",onClose:!0}],lowerElement:a.a.createElement("div",null),width:"68px",backgroundColor:"#424242"};var ue=ce,se=o(12),fe=o.n(se),me=o(50),he=o.n(me),de=o(51),pe=o.n(de),ve=o(52),be=o.n(ve),ye=o(53),ge=o.n(ye),Me=o(54),xe=o.n(Me),we=o(41),Ce=o.n(we),ke=o(55),Pe=o.n(ke),Ne=o(56),Se=o.n(Ne),Te=o(57),Ee=o.n(Te),Ae=o(58),_e=o.n(Ae),je=o(59),Re=o.n(je),Ie=o(60),Oe=o.n(Ie),Be=o(61),ze=o.n(Be),De=o(37),Fe=o.n(De),Ve=o(62),qe=o.n(Ve),Le={Add:Object(r.forwardRef)((function(e,t){return a.a.createElement(pe.a,fe()({},e,{ref:t}))})),Check:Object(r.forwardRef)((function(e,t){return a.a.createElement(ge.a,fe()({},e,{ref:t}))})),Clear:Object(r.forwardRef)((function(e,t){return a.a.createElement(Ce.a,fe()({},e,{ref:t}))})),Delete:Object(r.forwardRef)((function(e,t){return a.a.createElement(Pe.a,fe()({},e,{ref:t}))})),DetailPanel:Object(r.forwardRef)((function(e,t){return a.a.createElement(U.a,fe()({},e,{ref:t}))})),Edit:Object(r.forwardRef)((function(e,t){return a.a.createElement(Se.a,fe()({},e,{ref:t}))})),Export:Object(r.forwardRef)((function(e,t){return a.a.createElement(ze.a,fe()({},e,{ref:t}))})),Filter:Object(r.forwardRef)((function(e,t){return a.a.createElement(Ee.a,fe()({},e,{ref:t}))})),FirstPage:Object(r.forwardRef)((function(e,t){return a.a.createElement(_e.a,fe()({},e,{ref:t}))})),LastPage:Object(r.forwardRef)((function(e,t){return a.a.createElement(Re.a,fe()({},e,{ref:t}))})),NextPage:Object(r.forwardRef)((function(e,t){return a.a.createElement(U.a,fe()({},e,{ref:t}))})),PreviousPage:Object(r.forwardRef)((function(e,t){return a.a.createElement(xe.a,fe()({},e,{ref:t}))})),ResetSearch:Object(r.forwardRef)((function(e,t){return a.a.createElement(Ce.a,fe()({},e,{ref:t}))})),Search:Object(r.forwardRef)((function(e,t){return a.a.createElement(Fe.a,fe()({},e,{ref:t}))})),SortArrow:Object(r.forwardRef)((function(e,t){return a.a.createElement(be.a,fe()({},e,{ref:t}))})),ThirdStateCheck:Object(r.forwardRef)((function(e,t){return a.a.createElement(Oe.a,fe()({},e,{ref:t}))})),ViewColumn:Object(r.forwardRef)((function(e,t){return a.a.createElement(qe.a,fe()({},e,{ref:t}))}))},Ue=function(e){return a.a.createElement(he.a,{style:e.style,title:e.title,columns:e.columns,data:e.data,icons:Le,actions:e.actions,options:e.options,components:e.components,localization:e.localization})};Ue.propTypes={style:u.a.object,title:u.a.string,columns:u.a.array,data:u.a.array,actions:u.a.array,options:u.a.object,components:u.a.object,localization:u.a.object},Ue.defaultProps={style:{},title:"",columns:[],data:[],actions:[],options:{actionsColumnIndex:-1,draggable:!1,grouping:!1,search:!1,toolbar:!1,searchFieldAlignment:"left",paging:!1},components:{},localization:{header:{actions:"auaauau"},toolbar:{searchTooltip:t("Search"),searchPlaceholder:"".concat(t("Search"),"...")}}};var Ge=Ue,We=o(38),Ye=o.n(We),Qe=o(63),He=o.n(Qe),Ze=o(64),Ke=o.n(Ze),Xe=o(36),Je=o.n(Xe);function $e(e){var t=e.children,n=e.selectedTab,o=e.index,r=Ye()(e,["children","selectedTab","index"]);return a.a.createElement(Je.a,fe()({component:"div",role:"tabpanel",hidden:n!==o,id:"tabpanel-".concat(o),"aria-labelledby":"tab-".concat(o)},r),n===o&&t)}$e.propTypes={children:u.a.node,index:u.a.any.isRequired,selectedTab:u.a.any.isRequired};var et=Object(ee.makeStyles)((function(e){return{root:{flexGrow:1,height:"100%"},tabPanel:{flexGrow:1,minHeight:0,height:"calc(100% - 48px)",overflowY:"auto"}}}));function tt(e){var t,n,o=et(),r=a.a.useState(e.selectedTab),i=q()(r,2),l=i[0],c=i[1];a.a.useEffect((function(){e.selectedTab!==l&&c(e.selectedTab)}),[e.selectedTab]);return a.a.createElement("div",{className:o.root},a.a.createElement(He.a,{value:l,onChange:function(e,t){c(t)},indicatorColor:"primary",textColor:"primary"},$()(t=e.tabList).call(t,(function(e,t){return a.a.createElement(Ke.a,fe()({key:t,label:e.label},function(e){return{id:"tab-".concat(e),"aria-controls":"tabpanel-".concat(e)}}(t)))}))),$()(n=e.tabList).call(n,(function(t,n){return a.a.createElement($e,{key:n,selectedTab:l,index:n,className:e.scrollable?o.tabPanel:void 0},t.component)})))}tt.propTypes={tabList:u.a.array,selectedTab:u.a.number,scrollable:u.a.bool},tt.defaultProps={tabList:[{label:"Tab 1",component:a.a.createElement("div",null,"Component 1")},{label:"Tab 2",component:a.a.createElement("div",null,"Lorem Ipsum is simply dummy text of the printing and typesetting industry. Lorem Ipsum has been the industry standard dummy text ever since the 1500s, when an unknown printer took a galley of type and scrambled it to make a type specimen book. It has survived not only five centuries, but also the leap into electronic typesetting, remaining essentially unchanged. It was popularised in the 1960s with the release of Letraset sheets containing Lorem Ipsum passages, and more recently with desktop publishing software like Aldus PageMaker including versions of Lorem Ipsum.")},{label:"Tab 3",component:a.a.createElement("div",null,"Component 3")}],selectedTab:0,scrollable:!0};var nt=o(65),ot=o.n(nt),rt=function(e){return a.a.createElement(ot.a,e)};rt.propTypes={},rt.defaultProps={};var at=rt,it=o(66),lt=o.n(it),ct=o(67),ut=o.n(ct);o(87);function st(e,t){var n=S()(e);if(P.a){var o=P()(e);t&&(o=C()(o).call(o,(function(t){return x()(e,t).enumerable}))),n.push.apply(n,o)}return n}function ft(e){for(var t=1;t<arguments.length;t++){var n,o=null!=arguments[t]?arguments[t]:{};if(t%2)g()(n=st(Object(o),!0)).call(n,(function(t){E()(e,t,o[t])}));else if(b.a)p()(e,b()(o));else{var r;g()(r=st(Object(o))).call(r,(function(t){h()(e,t,x()(o,t))}))}}return e}var mt=Object(ee.makeStyles)((function(e){return{label:{fontFamily:"Roboto",fontStyle:"normal",fontWeight:"normal",fontSize:"16px",marginLeft:0,marginRight:0}}})),ht=function(e){var t=mt();return a.a.createElement(lt.a,{control:a.a.createElement(ut.a,{checked:e.toggle,onChange:e.onToggle,color:e.color}),labelPlacement:e.labelPlacement,label:e.label,classes:{label:t.label},style:ft({},e.style,{marginLeft:0,marginRight:0})})};ht.propTypes={toggle:u.a.bool,onToggle:u.a.func,label:u.a.string,color:u.a.string,labelPlacement:u.a.string,style:u.a.object},ht.defaultProps={color:"primary"};var dt=ht,pt=o(32),vt=o.n(pt),bt=o(16),yt=o.n(bt),gt=o(8),Mt=o.n(gt),xt=o(9),wt=o.n(xt),Ct=o(11),kt=o.n(Ct),Pt=o(10),Nt=o.n(Pt),St=o(4),Tt=o.n(St),Et=o(13),At=o.n(Et),_t=o(68),jt=o.n(_t),Rt=function(e){function t(){var e,n,o;Mt()(this,t);for(var r=arguments.length,a=new Array(r),i=0;i<r;i++)a[i]=arguments[i];return o=kt()(this,(e=Nt()(t)).call.apply(e,yt()(n=[this]).call(n,a))),E()(Tt()(o),"searchInput",void 0),E()(Tt()(o),"timer",void 0),E()(Tt()(o),"handleChange",(function(e){o.searchInput=e.target.value,o.props.enableTimeout?(o.timer&&clearTimeout(o.timer),o.timer=vt()(o.handleSearch,o.props.time)):o.handleSearch()})),E()(Tt()(o),"handleSearch",(function(){void 0!==o.searchInput&&o.props.onChange(o.searchInput)})),o}return At()(t,e),wt()(t,[{key:"render",value:function(){var e=this.props,t=e.classes,n=e.style,o=e.placeholder;return a.a.createElement("div",{className:t.search,style:n},a.a.createElement("div",{className:t.searchIcon},a.a.createElement(Fe.a,null)),a.a.createElement(jt.a,{ref:this.setSearchInput,placeholder:o,classes:{root:t.inputRoot,input:t.inputInput},inputProps:{"aria-label":"search"},onChange:this.handleChange}))}}]),t}(r.Component);Rt.propTypes={placeholder:u.a.string,onChange:u.a.func,time:u.a.number,enableTimeout:u.a.bool,style:u.a.object},Rt.defaultProps={placeholder:"Search...",onChange:function(e){console.log(e)},time:250,enableTimeout:!0,style:{}};var It=Object(ee.withStyles)((function(e){return{search:E()({position:"relative",borderRadius:e.shape.borderRadius,backgroundColor:Object(ee.fade)(e.palette.common.white,.15),"&:hover":{backgroundColor:Object(ee.fade)(e.palette.common.white,.25)},marginRight:e.spacing(2),marginLeft:0,width:"100%"},e.breakpoints.up("sm"),{marginLeft:e.spacing(3),width:"auto"}),searchIcon:{width:e.spacing(7),height:"100%",position:"absolute",pointerEvents:"none",display:"flex",alignItems:"center",justifyContent:"center"},inputRoot:{color:"inherit"},inputInput:E()({padding:e.spacing(1,1,1,7),transition:e.transitions.create("width"),width:"100%"},e.breakpoints.up("md"),{width:200})}}),{withTheme:!0})(Rt),Ot=o(69),Bt=o.n(Ot),zt=o(70),Dt=o.n(zt),Ft=Object(ee.makeStyles)((function(e){return{root:{"& > * + *":{marginTop:e.spacing(2)}},link:{fontSize:"24px",fontWeight:800,fontFamily:"Avenir","&:hover":{cursor:"pointer",textDecoration:"underline"}},lastLabel:{fontSize:"24px",fontWeight:800,fontFamily:"Avenir"}}})),Vt=function(e){var t,n=Ft();return a.a.createElement("div",{className:n.root},a.a.createElement(Bt.a,{separator:a.a.createElement(Dt.a,{fontSize:"small"}),"aria-label":"breadcrumb",style:e.style},$()(t=e.pathList).call(t,(function(t,o){if(e.pathList.length-1!==o)return a.a.createElement(Je.a,{key:o,color:"primary",variant:"inherit",className:n.link,onClick:t.function},t.label)})),a.a.createElement(Je.a,{color:"textPrimary",className:n.lastLabel},e.pathList[e.pathList.length-1].label)))};Vt.propTypes={pathList:u.a.array},Vt.defaultProps={pathList:[{label:"Mov.ai",function:function(){return console.log("pth1/")}},{label:"User",function:function(){return console.log("path1/path2")}},{label:"John Doe"}]};var qt=Vt,Lt=o(30),Ut=o.n(Lt),Gt=o(28),Wt=o.n(Gt),Yt=o(26),Qt=o.n(Yt),Ht=o(71),Zt=o.n(Ht),Kt=o(1),Xt=function(e){function t(){var e,n,o;Mt()(this,t);for(var r=arguments.length,a=new Array(r),i=0;i<r;i++)a[i]=arguments[i];return o=kt()(this,(e=Nt()(t)).call.apply(e,yt()(n=[this]).call(n,a))),E()(Tt()(o),"state",{size:{width:"100px",height:"100px"}}),E()(Tt()(o),"addEventListeners",(function(){return o.props.addEventListeners2Canvas(o.canvas)})),E()(Tt()(o),"getCanvas",(function(){return o.canvas})),E()(Tt()(o),"onResize",(function(e,t){console.log("Canvas on resize",e,t),o.setState({size:{width:e,height:t}})})),E()(Tt()(o),"getSize",(function(){return o.state.size})),o}return At()(t,e),wt()(t,[{key:"componentDidMount",value:function(){this.addEventListeners(),this.engine=new Kt.Engine(this.canvas,!0,{stencil:!0});var e=this.props.createScene(this.engine,this.canvas);this.props.is2render&&this.engine.runRenderLoop((function(){e.render()}))}},{key:"render",value:function(){var e=this;return a.a.createElement(A.Typography,{component:"div",style:{width:"100%",height:"100%",display:"flex",flexDirection:"column",flexGrow:1}},a.a.createElement("canvas",{ref:function(t){return e.canvas=t},style:{flexGrow:1},width:this.state.size.width,height:this.state.size.height}),a.a.createElement(Zt.a,{handleWidth:!0,handleHeight:!0,onResize:this.onResize}))}}]),t}(r.Component);Xt.propTypes={createScene:u.a.func,is2render:u.a.bool,addEventListeners2Canvas:u.a.func},Xt.defaultProps={createScene:function(e,t){},is2render:!0,addEventListeners2Canvas:function(e){}};var Jt=Xt,$t=o(7),en=o(15),tn=o.n(en),nn=o(29),on=o.n(nn),rn=function(){function e(t,n,o){Mt()(this,e);for(var r=[t,n,o],a=0;a<r.length;a++)if(r[a].constructor!==Array||r[a].length<3)throw"One of the inputs is not a array";this.mat3=$()(r).call(r,(function(e){return new ln(e)}))}return wt()(e,[{key:"prodVec",value:function(e){for(var t=new ln([0,0,0]),n=0;n<this.mat3.length;n++)t=t.add(this.mat3[n].scale(e.vec3[n]));return t}},{key:"dotVec",value:function(e){for(var t=[0,0,0],n=0;n<this.mat3.length;n++)t[n]=this.mat3[n].dot(e);return new ln(t)}},{key:"prod",value:function(t){var n=this.prodVec(t.mat3[0]),o=this.prodVec(t.mat3[1]),r=this.prodVec(t.mat3[2]);return new e(n.vec3,o.vec3,r.vec3)}},{key:"dot",value:function(t){var n=this.dotVec(t.mat3[0]),o=this.dotVec(t.mat3[1]),r=this.dotVec(t.mat3[2]);return new e(n.vec3,o.vec3,r.vec3)}},{key:"map",value:function(t){var n,o,r,a=$()(n=this.mat3[0]).call(n,t),i=$()(o=this.mat3[1]).call(o,t),l=$()(r=this.mat3[2]).call(r,t);return new e(a.vec3,i.vec3,l.vec3)}},{key:"equals",value:function(e){var t,n;return e.constructor===this.constructor&&on()(t=$()(n=this.mat3).call(n,(function(t,n){return t.equals(e.mat3[n])}))).call(t,(function(e,t){return e&&t}),!0)}}],[{key:"ofBabylonMatrix",value:function(t){var n=Kt.Matrix.GetAsMatrix3x3(t);return new e([n[0],n[1],n[2]],[n[3],n[4],n[5]],[n[6],n[7],n[8]])}},{key:"of",value:function(t,n,o){return new e(t,n,o)}},{key:"eye",value:function(){return new e([1,0,0],[0,1,0],[0,0,1])}}]),e}(),an=function(){function e(t){var n=this;if(Mt()(this,e),E()(this,"normalize",(function(){var e=n.length();if(0===e)throw"You can't normalize a zero norm vector";return n.scale(1/e)})),t.constructor!==Array||t.length<3)throw"".concat(t," is not a valid 3-vector");this.vec3=Qt()(t)}return wt()(e,[{key:"getX",value:function(){return this.vec3[0]}},{key:"getY",value:function(){return this.vec3[1]}},{key:"getZ",value:function(){return this.vec3[2]}},{key:"add",value:function(e){return this.binaryOp(e,(function(e,t){return e+t}))}},{key:"sub",value:function(e){return this.binaryOp(e,(function(e,t){return e-t}))}},{key:"mul",value:function(e){return this.binaryOp(e,(function(e,t){return e*t}))}},{key:"binaryOp",value:function(t,n){var o=[];return o[0]=n(this.vec3[0],t.vec3[0]),o[1]=n(this.vec3[1],t.vec3[1]),o[2]=n(this.vec3[2],t.vec3[2]),new e(o)}},{key:"scale",value:function(e){var t;return $()(t=this).call(t,(function(t){return t*e}))}},{key:"dot",value:function(e){return this.vec3[0]*e.vec3[0]+this.vec3[1]*e.vec3[1]+this.vec3[2]*e.vec3[2]}},{key:"map",value:function(t){var n;return new e($()(n=this.vec3).call(n,t))}},{key:"length",value:function(){return Math.sqrt(this.dot(this))}},{key:"toBabylon",value:function(){return new Kt.Vector3(this.vec3[0],this.vec3[1],this.vec3[2])}},{key:"toArray",value:function(){return this.vec3}},{key:"equals",value:function(e){var t,n;return e.constructor===this.constructor&&on()(t=$()(n=e.vec3).call(n,(function(t,n){return e.vec3[n]===t}))).call(t,(function(e,t){return e&&t}),!0)}},{key:"reduce",value:function(e,t){var n;return on()(n=this.vec3).call(n,e,t)}},{key:"getMax",value:function(){var e;return on()(e=this).call(e,(function(e,t){return Math.max(e,t)}),-Number.MAX_VALUE)}},{key:"getMin",value:function(){var e;return on()(e=this).call(e,(function(e,t){return Math.min(e,t)}),Number.MAX_VALUE)}}],[{key:"ofBabylon",value:function(t){return new e([t.x,t.y,t.z])}},{key:"of",value:function(t){return new e(t||[0,0,0])}},{key:"orthogonalBasisFromVector",value:function(e){for(var t=rn.eye(),n=0,o=0;o<3;o++)if(0!=e.vec3[o]){n=o;break}var r=t.mat3[(n+1)%3].add(t.mat3[n].scale(-e.vec3[(n+1)%3]/e.vec3[n]));r=r.normalize();var a=t.mat3[(n+2)%3].add(t.mat3[n].scale(-e.vec3[(n+2)%3]/e.vec3[n]));return a=(a=a.normalize()).sub(r.scale(r.dot(a))),{u:e.normalize(),v:r,w:a.normalize()}}}]),e}();E()(an,"ONES",an.of([1,1,1])),E()(an,"ZERO",an.of([0,0,0]));var ln=an,cn=o(72),un=o.n(cn),sn=o(14),fn=o.n(sn),mn=function(){function e(t){Mt()(this,e),this._scene=t,this._isPosition=!1,this._isRotation=!1,this._isBoundingBox=!1,this._isScale=!1,this._usePointerToAttachGizmos=!1}return wt()(e,[{key:"isPosition",value:function(e){return this._isPosition=e,this}},{key:"isRotation",value:function(e){return this._isRotation=e,this}},{key:"isBoundingBox",value:function(e){return this._isBoundingBox=e,this}},{key:"isScale",value:function(e){return this._isScale=e,this}},{key:"usePointerToAttachGizmos",value:function(e){return this._usePointerToAttachGizmos=e,this}},{key:"build",value:function(){var e=new Kt.GizmoManager(this._scene);return e.positionGizmoEnabled=this._isPosition,e.rotationGizmoEnabled=this._isRotation,e.boundingBoxGizmoEnabled=this._isBoundingBox,e.scaleGizmoEnabled=this._isScale,e.usePointerToAttachGizmos=this._usePointerToAttachGizmos,e}}]),e}(),hn=function(){function e(t){Mt()(this,e),this._scene=t,this._sphericalCoordinates=null,this._target=null,this._name="camera".concat(Math.floor(1e3*Math.random()))}return wt()(e,[{key:"name",value:function(e){return this._name=e,this}},{key:"sphericalCoordinates",value:function(e){return this._sphericalCoordinates=e,this}},{key:"target",value:function(e){return this._target=e,this}},{key:"build",value:function(){var e=Wt()(this);return g()(e).call(e,(function(e){if(null===e)throw"There are missing variables to build a camera, e.g ".concat(e)})),new Kt.ArcRotateCamera(this._name,this._sphericalCoordinates.x,this._sphericalCoordinates.y,this._sphericalCoordinates.z,this._target,this._scene)}}]),e}(),dn=function(){function e(t){Mt()(this,e),this._scene=t,this._position=null,this._name="light".concat(Math.floor(1e3*Math.random())),this._intensity=1}return wt()(e,[{key:"position",value:function(e){return this._position=e,this}},{key:"name",value:function(e){return this._name=e,this}},{key:"intensity",value:function(e){return this._intensity=e,this}},{key:"build",value:function(){var e=Wt()(this);g()(e).call(e,(function(e){if(null===e)throw"There are missing variables to build a light, e.g ".concat(e)}));var t=new Kt.PointLight(this._name,this._position,this._scene);return t.intensity=this._intensity,t}}]),e}(),pn=function(){function e(t){Mt()(this,e),this._scene=t,this._name="referential".concat(Math.floor(1e3*Math.random())),this._isPickable=!0,this._boxParams={isVisible:!0,size:.25},this._size=1}return wt()(e,[{key:"name",value:function(e){return this._name=e,this}},{key:"isPickable",value:function(e){return this._isPickable=e,this}},{key:"boxParams",value:function(e){return this._boxParams=e,this}},{key:"size",value:function(e){return this._size=e,this}},{key:"build",value:function(){var e=this._size,t=Kt.Mesh.CreateLines("axisX".concat(this._name),[new Kt.Vector3.Zero,new Kt.Vector3(e,0,0),new Kt.Vector3(.95*e,.05*e,0),new Kt.Vector3(e,0,0),new Kt.Vector3(.95*e,-.05*e,0)],this._scene);t.color=new Kt.Color3(1,0,0),t.isPickable=!1;var n=Kt.Mesh.CreateLines("axisY".concat(this._name),[new Kt.Vector3.Zero,new Kt.Vector3(0,e,0),new Kt.Vector3(-.05*e,.95*e,0),new Kt.Vector3(0,e,0),new Kt.Vector3(.05*e,.95*e,0)],this._scene);n.color=new Kt.Color3(0,1,0),n.isPickable=!1;var o=Kt.Mesh.CreateLines("axisZ".concat(this._name),[new Kt.Vector3.Zero,new Kt.Vector3(0,0,e),new Kt.Vector3(0,-.05*e,.95*e),new Kt.Vector3(0,0,e),new Kt.Vector3(0,.05*e,.95*e)],this._scene);o.color=new Kt.Color3(0,0,1),o.isPickable=!1;var r=Kt.MeshBuilder.CreateBox(this._name,{size:this._boxParams.size},this._scene);return r.isVisible=this._boxParams.isVisible,r.isPickable=this._isPickable,t.parent=r,n.parent=r,o.parent=r,r}}]),e}(),vn=function(){function e(t){Mt()(this,e),this._scene=t,this._name="camera".concat(Math.floor(1e3*Math.random())),this._width=1,this._height=1,this._textureSrc=null,this._isPickable=!1}return wt()(e,[{key:"name",value:function(e){return this._name=e,this}},{key:"width",value:function(e){return this._width=e,this}},{key:"height",value:function(e){return this._height=e,this}},{key:"textureSrc",value:function(e){return this._textureSrc=e,this}},{key:"isPickable",value:function(e){return this._isPickable=e,this}},{key:"build",value:function(){var e=Kt.Mesh.CreateGround(this._name,this._width,this._height,1,this._scene);return e.translate(new Kt.Vector3(0,-1,0),.1,Kt.Space.WORLD),this._textureSrc&&(e.material=new Kt.StandardMaterial("Texture".concat(this._name),this._scene),e.material.ambientTexture=new Kt.Texture(this._textureSrc,this._scene),e.material.ambientTexture.uScale=1,e.material.ambientTexture.vScale=1),e.isPickable=this._isPickable,e}}]),e}(),bn=function(){function e(t){Mt()(this,e),this._scene=t,this._direction=null,this._name="Dlight".concat(Math.floor(1e3*Math.random())),this._intensity=1}return wt()(e,[{key:"direction",value:function(e){return this._direction=e,this}},{key:"name",value:function(e){return this._name=e,this}},{key:"intensity",value:function(e){return this._intensity=e,this}},{key:"build",value:function(){var e=Wt()(this);g()(e).call(e,(function(e){if(null===e)throw"There are missing variables to build a light, e.g ".concat(e)}));var t=new Kt.DirectionalLight(this._name,this._direction.normalize(),this._scene);return t.intensity=this._intensity,t}}]),e}(),yn=o(19),gn=function(){function e(){var t=this;if(Mt()(this,e),E()(this,"getAnnotations",(function(){return t.annotations})),Mn)return Mn;Mn=this,this.annotations={},this.retrieveAnnotationsFromDb()}return wt()(e,[{key:"retrieveAnnotationsFromDb",value:function(){var e=this;yn.MasterDB.subscribe({Scope:"Annotation",Name:"*"},(function(t){var n;console.log("Annotation update",t);var o=t.key.Annotation;g()(n=S()(o)).call(n,(function(t){var n=o[t];if(n.Type){var r=n.Type.toLowerCase(),a=n.Label;r in e.annotations||(e.annotations[r]={names:[],labels:[]}),e.annotations[r].names.push(t),e.annotations[r].labels.push(a||t)}}))}),(function(t){var n,o=t.value.Annotation;g()(n=S()(o)).call(n,(function(t){var n=o[t];if(n.Type){var r=n.Type.toLowerCase(),a=n.Label;r in e.annotations||(e.annotations[r]={names:[],labels:[]}),e.annotations[r].names.push(t),e.annotations[r].labels.push(a)}}))}))}}],[{key:"getInstance",value:function(){return new e}},{key:"getAnnotations",value:function(){return e.getInstance().getAnnotations()}}]),e}(),Mn=null,xn=gn;function wn(e,t){var n=S()(e);if(P.a){var o=P()(e);t&&(o=C()(o).call(o,(function(t){return x()(e,t).enumerable}))),n.push.apply(n,o)}return n}function Cn(e){for(var t=1;t<arguments.length;t++){var n,o=null!=arguments[t]?arguments[t]:{};if(t%2)g()(n=wn(Object(o),!0)).call(n,(function(t){E()(e,t,o[t])}));else if(b.a)p()(e,b()(o));else{var r;g()(r=wn(Object(o))).call(r,(function(t){h()(e,t,x()(o,t))}))}}return e}var kn=function(){function e(t){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};Mt()(this,e),E()(this,"getType",(function(){return e.TYPE})),this.name=t.name,this.mesh=t,this.keyValueMap=n,xn.getInstance()}return wt()(e,[{key:"dispose",value:function(){this.mesh.dispose()}},{key:"toDict",value:function(){var e,t,n=this;return{name:this.name,type:this.getType(),position:ln.ofBabylon(this.mesh.position).toArray(),quaternion:$()(e=$t.Maybe.fromNull(this.mesh.rotationQuaternion)).call(e,(function(e){return[e.w,e.x,e.y,e.z]})).orLazy((function(){var e=Kt.Quaternion.RotationYawPitchRoll(n.mesh.rotation.y,n.mesh.rotation.x,n.mesh.rotation.z);return[e.w,e.x,e.y,e.z]})),color:fn()(t=$t.Maybe.fromNull(this.mesh.material)).call(t,(function(e){var t;return $()(t=$t.Maybe.fromNull(e.diffuseColor)).call(t,(function(e){return[e.r,e.g,e.b]}))})).orSome([0,0,0]),keyValueMap:this.keyValueMap}}},{key:"toForm",value:function(){var e,t=this.toDict(),n=new Kt.Color3(t.color[0],t.color[1],t.color[2]),o={jsonSchema:{type:"object",properties:{oldName:{type:"string"},name:{type:"string",title:"Name"},type:{type:"string",title:"Type"},position:{type:"object",title:"Position",properties:{x:{type:"number",title:"x"},y:{type:"number",title:"y"},z:{type:"number",title:"z"}}},quaternion:{type:"object",title:"Orientation",properties:{w:{type:"number",title:"w"},x:{type:"number",title:"x"},y:{type:"number",title:"y"},z:{type:"number",title:"z"}}},color:{type:"string",title:"Color"},annotations:{title:"Annotations",type:"object",properties:{}}}},uiSchema:{type:{"ui:disabled":!0},color:{"ui:widget":"color"},oldName:{"ui:widget":"hidden"}},data:{oldName:t.name,name:t.name,type:t.type,position:{x:t.position[0],y:t.position[1],z:t.position[2]},quaternion:{w:t.quaternion[0],x:t.quaternion[1],y:t.quaternion[2],z:t.quaternion[3]},color:n.toHexString(),annotations:Cn({},t.keyValueMap)}},r=xn.getAnnotations();return g()(e=S()(r)).call(e,(function(e){r[e].labels.length>0&&(o.jsonSchema.properties.annotations.properties[e]={title:yn.Utils.capitalize(e),type:"string",enumNames:r[e].labels,enum:r[e].names})})),o}},{key:"ofForm",value:function(t){var n=new e(this.mesh);return n.name=t.name,n.mesh.name=t.name,n.mesh.position=new Kt.Vector3(t.position.x,t.position.y,t.position.z),n.mesh.rotationQuaternion=new Kt.Quaternion(t.quaternion.x,t.quaternion.y,t.quaternion.z,t.quaternion.w).normalize(),n.mesh.material&&(n.mesh.material.diffuseColor=Kt.Color3.FromHexString(t.color),n.mesh.material.emissiveColor=Kt.Color3.FromHexString(t.color)),n.keyValueMap=Cn({},t.annotations),n.getType=this.getType,n}}],[{key:"mapDict2Mesh",value:function(e,t){var n;if(!t)throw"can't map a null mesh";return g()(n=$t.Maybe.fromNull(e)).call(n,(function(n){var o,r,a,i;g()(o=$t.Maybe.fromNull(e.name)).call(o,(function(e){return t.name=e})),g()(r=$t.Maybe.fromNull(n.position)).call(r,(function(e){return t.position=ln.of(e).toBabylon()})),g()(a=$t.Maybe.fromNull(n.quaternion)).call(a,(function(e){var n=new Kt.Quaternion(e[1],e[2],e[3],e[0]);t.rotationQuaternion=n.normalize()})),g()(i=$t.Maybe.fromNull(n.color)).call(i,(function(e){var n,o=new Kt.Color3(e[0],e[1],e[2]);g()(n=$t.Maybe.fromNull(t.material)).call(n,(function(e){var n,r;g()(n=$t.Maybe.fromNull(e.diffuseColor)).call(n,(function(e){return t.material.diffuseColor=o})),g()(r=$t.Maybe.fromNull(e.emissiveColor)).call(r,(function(e){return t.material.emissiveColor=o}))}))}))})),t}}]),e}();E()(kn,"TYPE","NodeItem");var Pn=kn,Nn=function(e){function t(e){var n,o=arguments.length>1&&void 0!==arguments[1]?arguments[1]:t.DEFAULT_SIZE,r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};return Mt()(this,t),n=kt()(this,Nt()(t).call(this,e,r)),E()(Tt()(n),"getType",(function(){return t.TYPE})),n.size=o,n}return At()(t,e),wt()(t,[{key:"toDict",value:function(){var e=tn()(Nt()(t.prototype),"toDict",this).call(this);return e.size=this.size,e}}],[{key:"ofDict",value:function(e){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,o=(arguments.length>2&&void 0!==arguments[2]&&arguments[2],$t.Maybe.fromNull(n)),r=fn()(o).call(o,(function(e){return $t.Maybe.fromNull(e.size)})).orSome(t.DEFAULT_SIZE),a=fn()(o).call(o,(function(e){return $t.Maybe.fromNull(e.name)})).orSome("Box".concat(Math.floor(1e3*Math.random()))),i=fn()(o).call(o,(function(e){return $t.Maybe.fromNull(e.keyValueMap)})).orUndefined(),l=_n.createBox(e,new Kt.Color3(Math.random(),Math.random(),Math.random()),r,a);return Pn.mapDict2Mesh(n,l),new t(l,r,i)}}]),t}(Pn);E()(Nn,"DEFAULT_SIZE",.5),E()(Nn,"TYPE","Box");var Sn=Nn,Tn=o(73),En=function(){return Math.floor(1e3*Math.random())},An=function(){function e(){Mt()(this,e)}return wt()(e,null,[{key:"computeLocalCoordinateFromMesh",value:function(t,n){if(!t.parent)return n;var o=t.parent,r=ln.ofBabylon(o.position),a=e.getRotationMatrix(o),i=ln.ofBabylon(o.scaling);return $()(i).call(i,(function(e){return 1/e})).mul(a.dotVec(e.computeLocalCoordinateFromMesh(o,n).sub(r)))}},{key:"getRotationMatrix",value:function(e){var t=new Kt.Matrix,n=$t.Maybe.fromNull(e.rotationQuaternion);return g()(n).call(n,(function(e){return e.toRotationMatrix(t)})),n.orElseRun((function(){Kt.Quaternion.RotationYawPitchRoll(e.rotation.y,e.rotation.x,e.rotation.z).toRotationMatrix(t)})),rn.ofBabylonMatrix(t)}},{key:"showNormals",value:function(e,t){for(var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1,o=arguments.length>3&&void 0!==arguments[3]?arguments[3]:Kt.Color3.Red(),r=t.getVerticesData(Kt.VertexBuffer.NormalKind),a=t.getVerticesData(Kt.VertexBuffer.PositionKind),i=[],l=0;l<r.length;l+=3){var c=Kt.Vector3.FromArray(a,l),u=c.add(Kt.Vector3.FromArray(r,l).scaleInPlace(n));i.push([c.add(t.position),u.add(t.position)])}var s=Kt.MeshBuilder.CreateLineSystem("normalLines",{lines:i},e);return s.color=o,s.parent=t,s}},{key:"orthogonalBasisFromVector",value:function(e){for(var t=[new Kt.Vector3(1,0,0),new Kt.Vector3(0,1,0),new Kt.Vector3(0,0,1)],n=[e.x,e.y,e.z],o=0,r=0;r<3;r++)if(0!=n[r]){o=r;break}var a=t[(o+1)%3].add(t[o].scale(-n[(o+1)%3]/n[o]));a=a.normalize();var i=t[(o+2)%3].add(t[o].scale(-n[(o+2)%3]/n[o]));return i=(i=i.normalize()).subtract(a.scale(Kt.Vector3.Dot(a,i))),{u:Kt.Vector3.FromArray(n).normalize(),v:a,w:i.normalize()}}},{key:"cameraBuilder",value:function(e){return new hn(e)}},{key:"guizoManagerBuilder",value:function(e){return new mn(e)}},{key:"meshFromPositionAndFaces",value:function(e,t,n,o){var r=!(arguments.length>4&&void 0!==arguments[4])||arguments[4],a=new Kt.VertexData;a.positions=fn()(n).call(n,(function(e){return[e.x,e.y,e.z]})),a.indices=fn()(o).call(o,(function(e){return e}));var i=new Kt.Mesh(e,t);return a.applyToMesh(i,r),i}},{key:"triangulatePolygon",value:function(e){for(var t,n=Tn(fn()(t=$()(e).call(e,(function(e){return[e.x,e.y,e.z]}))).call(t,(function(e){return e})),null,3),o=n.length/3,r=[],a=0;a<o;a++){var i=3*a;r.push([n[i],n[i+1],n[i+2]])}return r}},{key:"computeOrientation",value:function(e){var t=e.length,n=$()(e).call(e,(function(e){return ln.ofBabylon(e)})),o=0;return g()(n).call(n,(function(e,r){var a=n[(r+1)%t].sub(n[r]);o+=ln.of([-e.getY(),e.getX(),e.getZ()]).dot(a)})),o/2}},{key:"pointAverage",value:function(e){return e&&0!=e.length?on()(e).call(e,(function(e,t){return e.add(t)}),Kt.Vector3.Zero()).scale(1/e.length):Kt.Vector3.Zero()}},{key:"pointAverageVec3",value:function(e){return e&&0!=e.length?on()(e).call(e,(function(e,t){return e.add(t)}),ln.ZERO).scale(1/e.length):ln.ZERO}},{key:"randomVector3",value:function(e,t){var n;return new Kt.Vector3.FromArray($()(n=[0,0,0]).call(n,(function(n){return e+(t-e)*Math.random()})))}}]),e}();E()(An,"createOrientedCone",(function(e){for(var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:new Kt.Vector3(1,0,0),n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:Object(Kt.Color3)(.5,.5,.5),o=arguments.length>3&&void 0!==arguments[3]?arguments[3]:"OrientedCone".concat(En()),r=!(arguments.length>4&&void 0!==arguments[4])||arguments[4],a=arguments.length>5&&void 0!==arguments[5]?arguments[5]:16,i={positions:[],faces:[]},l=t.length()/3,c=An.orthogonalBasisFromVector(t),u=c.v,s=c.w,f=un()(Kt.Vector3.Dot(Kt.Vector3.Cross(u,s),t)),m=0;m<a;m++){var h=f*(2*Math.PI/a)*m;i.positions.push(u.scale(l*Math.cos(h)).add(s.scale(l*Math.sin(h))))}i.positions.push(Kt.Vector3.Zero()),i.positions.push(t);for(var d=i.positions.length-1,p=i.positions.length-2,v=0;v<a;v++)i.faces.push([d,(v+1)%a,v]),i.faces.push([p,v,(v+1)%a]);var b=An.meshFromPositionAndFaces(o,e,i.positions,i.faces);b.convertToFlatShadedMesh();var y=new Kt.StandardMaterial("OrientedConeMaterial".concat(o),e);return y.diffuseColor=n,y.emissiveColor=n,b.material=y,b.isPickable=r,b})),E()(An,"createSphere",(function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:Object(Kt.Color3)(.5,.5,.5),n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1,o=arguments.length>3&&void 0!==arguments[3]?arguments[3]:"Sphere".concat(En()),r=!(arguments.length>4&&void 0!==arguments[4])||arguments[4],a=Kt.Mesh.CreateSphere(o,16,n,e),i=new Kt.StandardMaterial("SphereMaterial".concat(o),e);return i.diffuseColor=t,i.emissiveColor=t,a.material=i,a.isPickable=r,a})),E()(An,"createBox",(function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:Object(Kt.Color3)(.5,.5,.5),n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:Sn.DEFAULT_SIZE,o=arguments.length>3&&void 0!==arguments[3]?arguments[3]:"Box".concat(En()),r=!(arguments.length>4&&void 0!==arguments[4])||arguments[4],a=Kt.Mesh.CreateBox(o,n,e),i=new Kt.StandardMaterial("BoxMaterial".concat(o),e);return i.diffuseColor=t,i.emissiveColor=t,a.material=i,a.isPickable=r,a})),E()(An,"positionalLightBuilder",(function(e){return new dn(e)})),E()(An,"directionalLightBuilder",(function(e){return new bn(e)})),E()(An,"referentialBuilder",(function(e){return new pn(e)})),E()(An,"getGroundPosition",(function(e,t){var n=e.pick(e.pointerX,e.pointerY,(function(e){return e===t}));return n.hit?Ut()($t.Maybe).call($t.Maybe,n.pickedPoint):$t.Maybe.none()})),E()(An,"pickMesh",(function(e,t){var n=e.pick(e.pointerX,e.pointerY,(function(e){return e!==t&&e.isEnabled()}));return n.hit&&n.pickedMesh.isPickable?Ut()($t.Maybe).call($t.Maybe,n.pickedMesh):$t.Maybe.none()})),E()(An,"groundBuilder",(function(e){return new vn(e)}));var _n=An,jn=function(e){function t(e,n){var o,r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};return Mt()(this,t),(o=kt()(this,Nt()(t).call(this,e,r))).assetName=n,o}return At()(t,e),wt()(t,[{key:"toDict",value:function(){var e=tn()(Nt()(t.prototype),"toDict",this).call(this);return e.assetName=this.assetName,e}}]),t}(Pn),Rn=function(e){function t(e,n){var o,r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};return Mt()(this,t),o=kt()(this,Nt()(t).call(this,e.mesh,n,r)),E()(Tt()(o),"updateRobot",(function(e,t,n){var r=(new Date).getTime();n(e,.001*(r-t)),o.requestAnimationFrameId=requestAnimationFrame((function(){return o.updateRobot(e,r,n)}))})),E()(Tt()(o),"animate",(function(e){o.requestAnimationFrameId=requestAnimationFrame((function(){return o.updateRobot(Tt()(o),(new Date).getTime(),e)}))})),E()(Tt()(o),"getType",(function(){return t.TYPE})),o.requestAnimationFrameId=null,o.meshTree=e,o}return At()(t,e),wt()(t,[{key:"toDict",value:function(){return tn()(Nt()(t.prototype),"toDict",this).call(this)}},{key:"toForm",value:function(){var e=tn()(Nt()(t.prototype),"toForm",this).call(this);return e.jsonSchema.properties={oldName:e.jsonSchema.properties.oldName,name:e.jsonSchema.properties.name,type:e.jsonSchema.properties.type,assetName:{type:"string",title:"Asset Name"},position:e.jsonSchema.properties.position,quaternion:e.jsonSchema.properties.quaternion,color:e.jsonSchema.properties.color,annotations:e.jsonSchema.properties.annotations},e.uiSchema.assetName={"ui:disabled":!0},e.data.assetName=this.assetName,e}},{key:"dispose",value:function(){tn()(Nt()(t.prototype),"dispose",this).call(this),yn.MasterDB.unsubscribe({Scope:"Robot",Name:this.meshTree.id,Parameter:"tf"}),window.cancelAnimationFrame(this.requestAnimationFrameId)}}],[{key:"updateRobotMeshTree",value:function(e,t){t.mesh.position=new Kt.Vector3(e.position.x,e.position.y,e.position.z);var n=new Kt.Quaternion(e.orientation.x,e.orientation.y,e.orientation.z,e.orientation.w);t.mesh.rotationQuaternion=n.normalize()}},{key:"transformMesh",value:function(e,t){var n=Math.PI,o=e.getBoundingInfo().boundingSphere,r=_n.createSphere(t,new Kt.Color3(0,0,0),.25*o.radius,"pivotSphere".concat(e.name),!1);e.position.set(-o.center.x,-o.center.y,-o.center.z);var a=_n.createSphere(t,new Kt.Color3(0,0,0),.5*o.radius,"tfsphere".concat(e.name),!1);a.visibility=.25,a.scaling=ln.ONES.scale(1/o.radius).toBabylon(),a.addRotation(0,0,n),a.position.set(0,0,.25);var i=_n.createSphere(t,new Kt.Color3(0,0,0),1.9,e.name,!0);return i.visibility=.1,e.parent=r,r.parent=a,a.parent=i,i}},{key:"createRobotMeshTreeRecursive",value:function(e,t,n,o){var r,a=this;t||(t=_n.createSphere(o,new Kt.Color3(0,0,0),.5,e.name,!1));var i={mesh:t,children:[]},l=new Kt.Vector3(e.position.x,e.position.y,e.position.z),c=new Kt.Quaternion(e.orientation.x,e.orientation.y,e.orientation.z,e.orientation.w);return t.position=l,t.rotationQuaternion=c,n&&(t.parent=n),i.children=$()(r=e.child).call(r,(function(e){a.createRobotMeshTreeRecursive(e,_n.referentialBuilder(o).boxParams({isVisible:!1,size:.1}).build(),t,o)})),i}},{key:"createRobotMeshTree",value:function(e,n,o){return t.createRobotMeshTreeRecursive(e,n,null,o)}},{key:"builder",value:function(){return new In}}]),t}(jn);E()(Rn,"ROBOT_MESH_NAME","Tugbot.stl"),E()(Rn,"TYPE","Robot"),E()(Rn,"getDefaultAnimator",(function(e){return function(t,n){var o=t.mesh,r=_n.getRotationMatrix(o).prodVec(new ln([3,0,0])).toBabylon();o.position=o.position.add(r.scale(n)),o.rotate(Kt.Axis.Z,-Math.PI/2*n,Kt.Space.LOCAL),Math.random()<.01&&e.updateNodeInServer(o.name)}})),E()(Rn,"getSocketAnimator",(function(e,t){return yn.MasterDB.subscribe({Scope:"Robot",Name:e.meshTree.id,Parameter:"tf"},(function(n){var o=n.key.Robot[e.meshTree.id].Parameter.tf.Value;o&&(console.log("ROBOT TF UPDATE...",o),Rn.updateRobotMeshTree(o,e),console.log("Updating robot ",e),Math.random()<.01&&t.updateNodeInServer(e.name))}),(function(n){console.log("ROBOT INIT SUB...",n.value);var o=n.value.Robot[e.meshTree.id].Parameter.tf.Value;Rn.updateRobotMeshTree(o,e),console.log("Updating robot ",e),t.updateNodeInServer(e.name)})),function(e,t){}}));var In=function(){function e(){Mt()(this,e),this._name=null,this._meshTree=null,this._parentMesh=null,this._scene=null,this._isPickable=!0,this._id=null,this._keyValueMap={},this._assetName=null}return wt()(e,[{key:"name",value:function(e){return this._name=e,this}},{key:"meshTree",value:function(e){return this._meshTree=e,this}},{key:"parentMesh",value:function(e){return this._parentMesh=e,this}},{key:"scene",value:function(e){return this._scene=e,this}},{key:"isPickable",value:function(e){return this._isPickable=e,this}},{key:"id",value:function(e){return this._id=e,this}},{key:"keyValueMap",value:function(e){return this._keyValueMap=e,this}},{key:"assetName",value:function(e){return this._assetName=e,this}},{key:"build",value:function(){var e,t,n=this,o=$()(e=C()(t=S()(this)).call(t,(function(e){return"_parentMesh"!==e}))).call(e,(function(e){return n[e]}));return g()(o).call(o,(function(e){if(null===e)throw"There are missing variables to build a robot, e.g ".concat(e)})),this._meshTree.id=this._id,this._meshTree.name=this._name,this._meshTree.mesh.name=this._name,this._meshTree.mesh.isPickable=this._isPickable,this._meshTree.mesh.parent=this._parentMesh,_n.referentialBuilder(this._scene).isPickable(!1).boxParams({isVisible:!1,size:.1}).name("".concat(this._name,"Axis")).build().parent=this._meshTree.mesh,new Rn(this._meshTree,this._assetName,this._keyValueMap)}}]),e}(),On=Rn,Bn=null,zn=function(){function e(){if(Mt()(this,e),Bn)return Bn;Bn=this,this.meshCacheBySceneId={},this.count=0}return wt()(e,[{key:"hasKey",value:function(e,t){var n,o=t._uid;return fn()(n=$t.Maybe.fromNull(this.meshCacheBySceneId[o])).call(n,(function(t){return Dn(t[e])})).orSome(!1)}},{key:"put",value:function(e,t,n){var o=t._uid;return o in this.meshCacheBySceneId||(this.meshCacheBySceneId[o]={}),this.meshCacheBySceneId[o][e]=n,n.setEnabled(!1),this}},{key:"get",value:function(e,t){var n,o,r=this,a=t._uid;return $()(n=fn()(o=$t.Maybe.fromNull(this.meshCacheBySceneId[a])).call(o,(function(t){return Dn(t[e])}))).call(n,(function(t){var n;console.log("#Mesh: Found Mesh in cache, retrieving copy number",r.count);var o=t.clone(yt()(n="".concat(e)).call(n,r.count++));return console.log("#Mesh:",o),o})).orNull()}}],[{key:"getInstance",value:function(){return new e}}]),e}(),Dn=function(e){return $t.Maybe.fromNull(e)},Fn=zn,Vn=o(74),qn=o.n(Vn),Ln=-Math.PI/2,Un={position:[0,0,0],scaling:[1,-1,1],quaternion:[Math.cos(Ln/2),Math.sin(Ln/2),0,0]},Gn=function(e){function t(e){var n,o=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return Mt()(this,t),n=kt()(this,Nt()(t).call(this,e,o)),E()(Tt()(n),"getType",(function(){return t.TYPE})),n}return At()(t,e),wt()(t,[{key:"toForm",value:function(){var e=tn()(Nt()(t.prototype),"toForm",this).call(this);return e.uiSchema.name={"ui:disabled":!0},e}}],[{key:"ofDict",value:function(e){var n,o=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,r=(arguments.length>2&&void 0!==arguments[2]&&arguments[2],t.getRosOrigin(e)),a=_n.referentialBuilder(e).name(t.NAME).isPickable(!0).boxParams({isVisible:!0,size:.25}).build();return a.parent=r,Pn.mapDict2Mesh(o,a),new t(a,fn()(n=$t.Maybe.fromNull(o)).call(n,(function(e){return $t.Maybe.fromNull(e.keyValueMap)})).orUndefined())}},{key:"getRosOrigin",value:function(e){var t=Kt.MeshBuilder.CreateBox("ROS_ORIGIN",{size:.001},e);t.isVisible=!1,t.isPickable=!1,t.position=ln.of(Un.position).toBabylon(),t.scaling=ln.of(Un.scaling).toBabylon();var n=new Kt.Quaternion(Un.quaternion[1],Un.quaternion[2],Un.quaternion[3],Un.quaternion[0]);return t.rotationQuaternion=n.normalize(),t}},{key:"inverseCoord",value:function(e){var t,n=Un.quaternion,o=_n.getRotationMatrix({rotationQuaternion:new Kt.Quaternion(n[1],n[2],n[3],n[0])}),r=$()(t=ln.of(Un.scaling)).call(t,(function(e){return 1/e})),a=ln.of(Un.position),i=r.mul(o.dotVec(ln.ofBabylon(e).sub(a)));return $()(i).call(i,(function(e){return Math.abs(e)<1e-5?0:e})).toBabylon()}}]),t}(Pn);E()(Gn,"TYPE","GlobalRef"),E()(Gn,"NAME","Global ref");var Wn=Gn,Yn={name:"Triangular Antiprism (Octahedron)",category:["Antiprism"],vertex:[[0,0,1.414214],[1.414214,0,0],[0,1.414214,0],[-1.414214,0,0],[0,-1.414214,0],[0,0,-1.414214]],face:[[0,1,2],[0,2,3],[0,3,4],[0,4,1],[1,4,5],[1,5,2],[2,5,3],[3,5,4]]},Qn=function(e){function t(e,n){var o;return Mt()(this,t),o=kt()(this,Nt()(t).call(this,e,n)),E()(Tt()(o),"getType",(function(){return t.TYPE})),o}return At()(t,e),wt()(t,null,[{key:"ofDict",value:function(e){var n,o=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,r=(arguments.length>2&&void 0!==arguments[2]&&arguments[2],$()(n=$t.Maybe.fromNull(o)).call(n,(function(e){return e.name})).orSome("KeyPoint".concat(Math.floor(1e3*Math.random())))),a=Kt.MeshBuilder.CreatePolyhedron(r,{custom:Yn,size:t.DEFAULT_SIZE},e),i=new Kt.StandardMaterial("KeyPointMaterial".concat(r),e);a.material=i,a.convertToFlatShadedMesh();var l=_n.referentialBuilder(e).isPickable(!1).boxParams({isVisible:!1,size:.1*t.DEFAULT_SIZE}).name("".concat(r,"Axis")).build();return l.parent=a,Pn.mapDict2Mesh(o,a),new t(a,o.keyValueMap)}}]),t}(Pn);E()(Qn,"TYPE","KeyPoint"),E()(Qn,"DEFAULT_SIZE",.25);var Hn=Qn,Zn=o(75),Kn=o.n(Zn),Xn=o(33),Jn=o.n(Xn),$n={RADIUS:.25,CLOUD_FUNCTION_NAME:"backend.viewer"};function eo(e,t){var n=S()(e);if(P.a){var o=P()(e);t&&(o=C()(o).call(o,(function(t){return x()(e,t).enumerable}))),n.push.apply(n,o)}return n}function to(e){for(var t=1;t<arguments.length;t++){var n,o=null!=arguments[t]?arguments[t]:{};if(t%2)g()(n=eo(Object(o),!0)).call(n,(function(t){E()(e,t,o[t])}));else if(b.a)p()(e,b()(o));else{var r;g()(r=eo(Object(o))).call(r,(function(t){h()(e,t,x()(o,t))}))}}return e}var no=$n.RADIUS,oo=function(e){var t=function(e){for(var t=0,n=0;n<e.length-1;n++){t+=e[n+1].subtract(e[n]).length()}return t}(e),n=Math.ceil(2*t);return{points:Kt.Curve3.CreateCatmullRomSpline(e,n,!1).getPoints()}},ro=function(e){var t,n=function(e){for(var t=[],n=0;n<e.length-1;n++){var o=e[n+1].subtract(e[n]);t.push(Math.atan2(o.y,o.x))}return t.push(t[t.length-1]),t}(e.points);return $()(t=e.points).call(t,(function(e,t){return[e.x,e.y,n[t]]}))};function ao(e,t,n,o){var r,a,i=Qt()(n._children),l=$()(r=o.splinePath).call(r,(function(e){return new Kt.Vector3(e[0],e[1],0)}));return g()(i).call(i,(function(e){e.parent=o.mesh})),$()(a=o.keyPoints).call(a,(function(r,a){var i,c;(r.observers=new Kt.Observable,r.observers.add(lo(e,t)),r.index=a,r.name=yt()(i="".concat(n.name,"keyPointSpline")).call(i,a),r.position=ln.of(o.localPath[a]).toBabylon(),r.rotationQuaternion=Kt.Quaternion.Identity(),a>0&&a<o.keyPoints.length-1)&&(g()(c=r._children).call(c,(function(e){return e.dispose()})),po(e,r.material.diffuseColor,o.mesh,a,l,r.position)().parent=r);return r}))}function io(e,t,n,o,r){var a,i=arguments.length>5&&void 0!==arguments[5]?arguments[5]:ao,l=_n.pointAverage(e);console.log(yt()(a="Old average ".concat(n.position,", average ")).call(a,l)),e=$()(e).call(e,(function(e){return e.subtract(l)}));var c=oo(e),u=Kt.MeshBuilder.CreateLines(n.name,{points:c.points,updatable:!0},t);return u.position=n.position,u.rotationQuaternion=n.rotationQuaternion,u.locallyTranslate(l),u.material=n.material,u.visibility=n.visibility,u.parent=n.parent,o.localPath=$()(e).call(e,(function(e){return ln.ofBabylon(e).toArray()})),o.splinePath=ro(c),o.mesh=u,o.keyPoints=i(t,r,n,o),n.dispose(),e}var lo=function(e,t){return function(n){var o,r=n.updatedPointMesh,a=n.is2updateServer;g()(o=t.getNodeFromTree(r.parent.name)).call(o,(function(n){var o,i=r.index,l=n.item,c=l.mesh,u=$()(o=l.localPath).call(o,(function(e){return ln.of(e).toBabylon()}));u[i]=r.position,io(u,e,c,l,t),a&&t.updateNodeInServer(c.name)}))}};function co(e,t,n,o){return fo(e,o,t)}var uo=function(e,t,n,o){var r,a=t.index,i=t.parent.name;g()(r=n.getNodeFromTree(i)).call(r,(function(t){var r,l,c=a+o,u=t.item,s=u.localPath.length,f=u.mesh,m=[],h=$()(r=u.localPath).call(r,(function(e){return ln.of(e).toBabylon()}));if(c<0)m=yt()(l=[h[0].scale(3).subtract(h[1]).scale(.5)]).call(l,h);else if(c>s-1)m=yt()(h).call(h,[h[s-1].scale(3).subtract(h[s-2]).scale(.5)]);else{for(var d=a+Math.max(0,o),p=0;p<d;p++)m.push(h[p]);m.push(h[c].add(h[a]).scale(.5));for(var v=d;v<s;v++)m.push(h[v])}io(m,e,f,u,n,co),n.updateNodeInServer(i)}))},so=function(e,t,n){var o,r=[];return g()(o=n.getNodeFromTree(t.parent.name)).call(o,(function(n){2!==n.item.localPath.length&&r.push({icon:function(e){return a.a.createElement("i",fe()({className:"fas fa-times"},e))},action:function(n){!function(e,t,n){var o,r=t.index,a=t.parent.name;g()(o=n.getNodeFromTree(a)).call(o,(function(t){var o,i,l=t.item,c=l.mesh,u=$()(o=l.localPath).call(o,(function(e){return ln.of(e).toBabylon()}));Jn()(u).call(u,r,1),Jn()(i=l.keyPoints).call(i,r,1)[0].dispose(),io(u,e,c,l,n,co),n.updateNodeInServer(a)}))}(e,t,n),n.closeContextDial()},name:"Delete node"}),r.push({icon:function(e){return a.a.createElement("i",fe()({className:"fas fa-greater-than"},e))},action:function(n){uo(e,t,n,1),n.closeContextDial()},name:"Add next"}),r.push({icon:function(e){return a.a.createElement("i",fe()({className:"fas fa-less-than"},e))},action:function(n){uo(e,t,n,-1),n.closeContextDial()},name:"Add previous"})})),r},fo=function(e,t,n){var o,r,a=new Kt.Color3(.25,.25,.25),i=[],l=$()(o=t.localPath).call(o,(function(e){return ln.of(e).toBabylon()})),c=$()(r=t.splinePath).call(r,(function(e){return new Kt.Vector3(e[0],e[1],0)})),u=t.mesh;return g()(l).call(l,(function(t,o){var r,s,f=vo(e,a,u,o),m=0==o||o==l.length-1?f():(r=po(e,a,u,o,c,t)(),(s=vo(e,a,u,o)()).visibility=.1,r.parent=s,s);m.parent=u,m.position=t,m.index=o,m.observers=new Kt.Observable,i.push(m),m.observers.add(lo(e,n))})),g()(i).call(i,(function(t){t.onClick=function(){n.setContextActions(so(e,t,n))}})),i},mo=function(e){function t(e,n,o,r){var a,i=arguments.length>4&&void 0!==arguments[4]?arguments[4]:{};return Mt()(this,t),a=kt()(this,Nt()(t).call(this,e,i)),E()(Tt()(a),"getType",(function(){return t.TYPE})),a.localPath=n,a.keyPoints=o,a.splinePath=r,a}return At()(t,e),wt()(t,[{key:"toDict",value:function(){var e=tn()(Nt()(t.prototype),"toDict",this).call(this);return e.localPath=this.localPath,e.splinePath=this.splinePath,e}}],[{key:"ofDict",value:function(e){var n,o,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;if(!r||!a)throw"null dictionary describing path or null mainView";var i=r.name,l=$()(n=r.localPath).call(n,(function(e){return ln.of(e).toBabylon()})),c=ln.of(r.position).toBabylon(),u=oo(l),s=Kt.MeshBuilder.CreateLines(i,{points:u.points,updatable:!0},e);s.position=c;var f=new Kt.StandardMaterial("PathMaterial".concat(i),e),m=new Kt.Color3(r.color[0],r.color[1],r.color[2]);f.diffuseColor=m,f.emissiveColor=m,s.material=f,g()(o=$t.Maybe.fromNull(r.quaternion)).call(o,(function(e){var t=new Kt.Quaternion(e[1],e[2],e[3],e[0]);s.rotationQuaternion=t.normalize()}));var h=ro(u),d=fo(e,to({},r,{mesh:s,splinePath:h}),a);return new t(s,$()(l).call(l,(function(e){return[e.x,e.y,e.z]})),d,h,r.keyValueMap)}}]),t}(Pn);E()(mo,"TYPE","Path");var ho=mo;function po(e,t,n,o,r,a){return function(){var i,l,c=Kn()(i=$()(r).call(r,(function(e){return a.subtract(e).length()}))).call(i,(function(e){return e<1e-5})),u=r[c+1].subtract(r[c]).normalize().scale(no);return _n.createOrientedCone(e,u,t,yt()(l="".concat(n.name,"keyPointCone")).call(l,o),!1)}}function vo(e,t,n,o){return function(){var r;return _n.createSphere(e,t,no,yt()(r="".concat(n.name,"keyPointSpline")).call(r,o),!0)}}var bo=$n.RADIUS,yo=[[0,1,2],[2,3,0],[4,6,5],[6,4,7],[0,5,1],[5,0,4],[3,2,6],[6,7,3],[1,6,2],[6,1,5],[0,3,7],[7,4,0]];function go(e,t,n){var o,r=$()(o=e.localWall).call(o,(function(e){return ln.of(e).toBabylon()})),a=ln.of(e.position).toBabylon(),i=r[1].subtract(r[0]).normalize(),l=new Kt.Vector3(-i.y,i.x,0),c=[r[0].add(l.scale(e.size.width)),r[0].subtract(l.scale(e.size.width)),r[1].subtract(l.scale(e.size.width)),r[1].add(l.scale(e.size.width))],u=new Kt.Vector3(0,0,e.size.height),s={positions:[c[0],c[1],c[2],c[3],c[0].add(u),c[1].add(u),c[2].add(u),c[3].add(u)],faces:yo},f=_n.meshFromPositionAndFaces(t,n,s.positions,s.faces);return f.position=a,f}var Mo=function(e,t){return function(n){var o,r=n.updatedPointMesh,a=n.is2updateServer;g()(o=e.getNodeFromTree(r.parent.name)).call(o,(function(n){var o=r.index,i=n.item,l=i.mesh,c={position:ln.ofBabylon(l.position).toArray(),localWall:i.localWall,size:i.size};c.localWall[o]=ln.ofBabylon(r.position).toArray(),function(e,t,n,o){var r,a,i,l=_n.pointAverageVec3($()(r=e.localWall).call(r,(function(e){return ln.of(e)})));e.position=l.toArray(),e.localWall=$()(a=e.localWall).call(a,(function(e){return ln.of(e).sub(l).toArray()}));var c=go(e,n.name,t);c.position=n.position,c.rotationQuaternion=n.rotationQuaternion,c.locallyTranslate(l.toBabylon()),c.material=n.material,c.visibility=n.visibility,c.parent=n.parent,o.mesh=c,o.localWall=e.localWall;var u=Qt()(n._children);g()(u).call(u,(function(e){n.removeChild(e),e.parent=c})),g()(i=o.keyPoints).call(i,(function(t,n){t.position=ln.of(e.localWall[n]).toBabylon()})),n.dispose()}(c,t,l,i),a&&e.updateNodeInServer(l.name)}))}},xo=function(e,t,n,o){var r=[];return g()(t).call(t,(function(t,a){var i,l=_n.createSphere(e,new Kt.Color3(.25,.25,.25),bo,yt()(i="".concat(n.name,"keyPointWall")).call(i,a),!0);l.parent=n,l.position=t,l.index=a,l.observers=new Kt.Observable,l.observers.add(Mo(o,e)),r.push(l)})),r},wo=function(e){function t(e,n,o){var r,a=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{},i=arguments.length>4&&void 0!==arguments[4]?arguments[4]:{};return Mt()(this,t),r=kt()(this,Nt()(t).call(this,e,i)),E()(Tt()(r),"getType",(function(){return t.TYPE})),r.localWall=n,r.size=o,r.keyPoints=a,r}return At()(t,e),wt()(t,[{key:"toDict",value:function(){var e=tn()(Nt()(t.prototype),"toDict",this).call(this);return e.localWall=this.localWall,e.size=this.size,e}}],[{key:"ofDict",value:function(e){var n,o=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;if(!o)throw"null dictionary describing wall";var a=$t.Maybe.fromNull(o.name).orSome("Wall".concat(Math.floor(1e3*Math.random()))),i=go(o,a,e),l=new Kt.StandardMaterial("WallMaterial".concat(a),e),c=new Kt.Color3(o.color[0],o.color[1],o.color[2]);l.diffuseColor=c,l.emissiveColor=c,i.material=l,i.position.z+=.001;var u=xo(e,$()(n=o.localWall).call(n,(function(e){return ln.of(e).toBabylon()})),i,r);return new t(i,o.localWall,o.size,u,o.keyValueMap)}}]),t}(Pn);E()(wo,"TYPE","Wall");var Co=wo,ko=$n.RADIUS,Po=[[0,1,2],[2,3,0],[4,5,6],[6,7,4],[0,1,5],[5,4,0],[3,2,6],[6,7,3],[1,2,6],[6,5,1],[0,3,7],[7,4,0]];function No(e,t,n){var o,r=$()(o=e.corners).call(o,(function(e){return ln.of(e).toBabylon()})),a=r[1].subtract(r[0]),i=ln.of(e.position).toBabylon(),l=[r[0],r[0].add(Kt.Axis.X.scale(a.x)),r[0].add(new Kt.Vector3(a.x,a.y,0)),r[0].add(Kt.Axis.Y.scale(a.y))],c=new Kt.Vector3(0,0,a.z),u={positions:[l[0],l[1],l[2],l[3],l[0].add(c),l[1].add(c),l[2].add(c),l[3].add(c)],faces:Po},s=_n.meshFromPositionAndFaces(t,n,u.positions,u.faces);return s.position=i,s}var So=function(e,t){return function(n){var o,r=n.updatedPointMesh,a=n.is2updateServer;g()(o=e.getNodeFromTree(r.parent.name)).call(o,(function(n){var o=r.index,i=n.item,l=i.mesh,c=l.name,u={position:ln.ofBabylon(l.position).toArray(),corners:i.corners};u.corners[o]=ln.ofBabylon(r.position).toArray(),function(e,t,n,o){var r,a,i,l=_n.pointAverageVec3($()(r=e.corners).call(r,(function(e){return ln.of(e)})));e.position=l.toArray(),e.corners=$()(a=e.corners).call(a,(function(e){return ln.of(e).sub(l).toArray()}));var c=No(e,n.name,t);c.position=n.position,c.rotationQuaternion=n.rotationQuaternion,c.locallyTranslate(l.toBabylon()),c.material=n.material,c.visibility=n.visibility,c.parent=n.parent,o.mesh=c,o.corners=e.corners;var u=Qt()(n._children);g()(u).call(u,(function(e){n.removeChild(e),e.parent=c})),g()(i=o.keyPoints).call(i,(function(t,n){t.position=ln.of(e.corners[n]).toBabylon()})),n.dispose()}(u,t,l,i),a&&e.updateNodeInServer(c)}))}},To=function(e,t,n,o){var r=[];return g()(t).call(t,(function(t,a){var i,l=t,c=_n.createSphere(e,new Kt.Color3(.25,.25,.25),ko,yt()(i="".concat(n.name,"keyPoint")).call(i,a),!0);c.parent=n,c.position=l,c.index=a,c.observers=new Kt.Observable,c.observers.add(So(o,e)),r.push(c)})),r},Eo=function(e){function t(e,n,o){var r,a=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{};return Mt()(this,t),r=kt()(this,Nt()(t).call(this,e,a)),E()(Tt()(r),"getType",(function(){return t.TYPE})),r.corners=n,r.keyPoints=o,r}return At()(t,e),wt()(t,[{key:"toDict",value:function(){var e=tn()(Nt()(t.prototype),"toDict",this).call(this);return e.corners=this.corners,e}}],[{key:"ofDict",value:function(e){var n,o,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;if(!r)throw"null dictionary describing Box region";var i=$t.Maybe.fromNull(r.name).orSome("BoxRegion".concat(Math.floor(1e3*Math.random()))),l=No(r,i,e),c=new Kt.StandardMaterial("BoxRegionMaterial".concat(i),e),u=new Kt.Color3(r.color[0],r.color[1],r.color[2]);c.diffuseColor=u,c.emissiveColor=u,c.backFaceCulling=!1,l.material=c,l.visibility=.25,g()(n=$t.Maybe.fromNull(r.quaternion)).call(n,(function(e){var t=new Kt.Quaternion(e[1],e[2],e[3],e[0]);l.rotationQuaternion=t.normalize()}));var s=To(e,$()(o=r.corners).call(o,(function(e){return ln.of(e).toBabylon()})),l,a);return new t(l,r.corners,s,r.keyValueMap)}}]),t}(Pn);E()(Eo,"TYPE","BoxRegion");var Ao=Eo,_o=o(76),jo=o.n(_o),Ro=$n.RADIUS,Io=function(e){var t=[];return t.push(e[1]),t.push(e[0]),t.push(e[2]),t},Oo=function(e,t,n,o){var r,a,i,l,c=new Kt.Vector3(0,0,n),u={positions:[],faces:[]};u.positions=Qt()(t);for(var s=0;s<t.length;s++)u.positions.push(t[s].add(c));var f=t.length,m=_n.triangulatePolygon(t),h=$()(r=$()(a=_n.triangulatePolygon(jo()(i=u.positions).call(i,f))).call(a,(function(e){return $()(e).call(e,(function(e){return e+f}))}))).call(r,Io),d=function(e){for(var t=e.length,n=_n.computeOrientation(e),o=[],r=0;r<t;r++){var a=(r+1)%t;o.push([r,t+a,a]),o.push([r,t+r,t+a])}return n>0?o:$()(o).call(o,Io)}(t);return u.faces=yt()(l=yt()(m).call(m,h)).call(l,d),_n.meshFromPositionAndFaces(o,e,u.positions,u.faces)};function Bo(e,t,n,o){var r,a=Qt()(n._children);return g()(a).call(a,(function(e){n.removeChild(e),e.parent=o.mesh})),$()(r=o.keyPoints).call(r,(function(r,a){var i;return r.observers=new Kt.Observable,r.observers.add(Do(e,t)),r.index=a,r.name=yt()(i="".concat(n.name,"keyPoint")).call(i,a),r.position=ln.of(o.localPolygon[a]).toBabylon(),r}))}function zo(e,t,n,o,r){var a=arguments.length>5&&void 0!==arguments[5]?arguments[5]:Bo,i=_n.pointAverage(e);e=$()(e).call(e,(function(e){return e.subtract(i)}));var l=Oo(t,e,o.height,n.name);return l.position=n.position,l.rotationQuaternion=n.rotationQuaternion,l.locallyTranslate(i),l.material=n.material,l.visibility=n.visibility,l.parent=n.parent,o.localPolygon=$()(e).call(e,(function(e){return ln.ofBabylon(e).toArray()})),o.mesh=l,o.keyPoints=a(t,r,n,o),n.dispose(),e}var Do=function(e,t){return function(n){var o,r=n.updatedPointMesh,a=n.is2updateServer;g()(o=t.getNodeFromTree(r.parent.name)).call(o,(function(n){var o,i=r.index,l=n.item,c=l.mesh,u=c.name,s=$()(o=l.localPolygon).call(o,(function(e){return ln.of(e).toBabylon()}));s[i]=r.position,zo(s,e,c,l,t),a&&t.updateNodeInServer(u)}))}};function Fo(e,t,n,o){var r;return Lo(e,$()(r=o.localPolygon).call(r,(function(e){return ln.of(e).toBabylon()})),o.mesh,t)}var Vo=function(e,t,n,o){var r,a=t.index,i=t.parent.name;g()(r=n.getNodeFromTree(i)).call(r,(function(t){for(var r,i=t.item,l=i.localPolygon.length,c=yn.Utils.mod(a+o,l),u=i.mesh,s=$()(r=i.localPolygon).call(r,(function(e){return ln.of(e).toBabylon()})),f=[],m=a+Math.max(0,o),h=0;h<m;h++)f.push(s[h]);f.push(s[c].add(s[a]).scale(.5));for(var d=m;d<l;d++)f.push(s[d]);zo(f,e,u,i,n,Fo)}))},qo=function(e,t,n){var o,r=[];return g()(o=n.getNodeFromTree(t.parent.name)).call(o,(function(n){n.item.localPolygon.length>3&&r.push({icon:function(e){return a.a.createElement("i",fe()({className:"fas fa-times"},e))},action:function(n){!function(e,t,n){var o,r=t.index,a=t.parent.name;g()(o=n.getNodeFromTree(a)).call(o,(function(t){var o,i,l=t.item,c=l.mesh,u=$()(o=l.localPolygon).call(o,(function(e){return ln.of(e).toBabylon()}));Jn()(u).call(u,r,1),Jn()(i=l.keyPoints).call(i,r,1)[0].dispose(),zo(u,e,c,l,n),n.updateNodeInServer(a)}))}(e,t,n),n.closeContextDial()},name:"Delete node"}),r.push({icon:function(e){return a.a.createElement("i",fe()({className:"fas fa-greater-than"},e))},action:function(n){Vo(e,t,n,1),n.closeContextDial()},name:"Add next"}),r.push({icon:function(e){return a.a.createElement("i",fe()({className:"fas fa-less-than"},e))},action:function(n){Vo(e,t,n,-1),n.closeContextDial()},name:"Add previous"})})),r},Lo=function(e,t,n,o){var r=[];return g()(t).call(t,(function(t,a){var i,l=new Kt.Color3(.25,.25,.25),c=_n.createSphere(e,l,Ro,yt()(i="".concat(n.name,"keyPointPolygon")).call(i,a),!0);c.parent=n,c.position=t,c.index=a,c.observers=new Kt.Observable,r.push(c),c.observers.add(Do(e,o))})),g()(r).call(r,(function(t){t.onClick=function(){o.setContextActions(qo(e,t,o))}})),r},Uo=function(e){function t(e,n,o,r){var a,i=arguments.length>4&&void 0!==arguments[4]?arguments[4]:{};return Mt()(this,t),a=kt()(this,Nt()(t).call(this,e,i)),E()(Tt()(a),"getType",(function(){return t.TYPE})),a.localPolygon=n,a.height=o,a.keyPoints=r,a}return At()(t,e),wt()(t,[{key:"toDict",value:function(){var e=tn()(Nt()(t.prototype),"toDict",this).call(this);return e.localPolygon=this.localPolygon,e.height=this.height,e}}],[{key:"ofDict",value:function(e){var n,o,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;if(!r||!a)throw"null dictionary describing polygon or null mainView";var i=$()(n=r.localPolygon).call(n,(function(e){return ln.of(e).toBabylon()})),l=ln.of(r.position).toBabylon(),c=Oo(e,i,r.height,r.name);c.position=l;var u=new Kt.StandardMaterial("PolygonMaterial".concat(r.name),e),s=new Kt.Color3(r.color[0],r.color[1],r.color[2]);u.diffuseColor=s,u.emissiveColor=s,c.material=u,c.visibility=.5,g()(o=$t.Maybe.fromNull(r.quaternion)).call(o,(function(e){var t=new Kt.Quaternion(e[1],e[2],e[3],e[0]);c.rotationQuaternion=t.normalize()}));var f=Lo(e,i,c,a);return new t(c,$()(i).call(i,(function(e){return[e.x,e.y,e.z]})),r.height,f,r.keyValueMap)}}]),t}(Pn);E()(Uo,"TYPE","PolygonRegion");var Go=Uo,Wo=function(e){function t(e,n,o,r){var a;return Mt()(this,t),a=kt()(this,Nt()(t).call(this,e,r)),E()(Tt()(a),"getType",(function(){return t.TYPE})),a.size=n,a.textureSrc=o,a}return At()(t,e),wt()(t,[{key:"dispose",value:function(){tn()(Nt()(t.prototype),"dispose",this).call(this)}},{key:"toDict",value:function(){var e=tn()(Nt()(t.prototype),"toDict",this).call(this);return e.size=this.size,e.textureSrc=this.textureSrc,e}},{key:"toForm",value:function(){var e=this.toDict();return{jsonSchema:{type:"object",properties:{oldName:{type:"string"},name:{type:"string",title:"Name"},type:{type:"string",title:"Type"},assetName:{type:"string",title:"Asset Name"}}},uiSchema:{type:{"ui:disabled":!0},assetName:{"ui:disabled":!0},oldName:{"ui:widget":"hidden"}},data:{oldName:e.name,name:e.name,type:e.type,assetName:e.assetName}}}}]),t}(jn);E()(Wo,"TYPE","Map");var Yo=Wo,Qo={GlobalRef:Wn,Box:Sn,KeyPoint:Hn,Path:ho,Wall:Co,BoxRegion:Ao,PolygonRegion:Go},Ho={Robot:On,Map:Yo};function Zo(e){return e.type in Ho}function Ko(e,t,n){var o=$t.Maybe.fromNull(t.assetName).orSome(t.name),r=e.getAssetsActionMap()[o];r.memory.parentObj={parent:n},r.memory.nodeItemDict=t,r.memory.assetName=o,r.memory.name=t.name,r.action(e)}function Xo(e,t,n){var o,r=Qo[t.type];r&&g()(o=e.getSceneMemory()).call(o,(function(o){var a,i=o.scene,l=r.ofDict(i,t,e);g()(a=e.getNodeFromTree(n)).call(a,(function(e){l.mesh.parent=e.item.mesh})),e.addNodeItem2Tree(l,n,!1)}))}function Jo(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;if(t){var o=qn()(t).call(t,(function(e,t){return"GlobalRef"===e.item.type||e.name<t.name?-1:e.name>t.name?1:0}));g()(o).call(o,(function(t){Zo(t.item)?Ko(e,t.item,n):Xo(e,t.item,n),t.children.length>0&&Jo(e,t.children,t.name)}))}}function $o(e,t){var n;g()(n=e.getSceneMemory()).call(n,(function(n){var o=n.scene,r=!t;e.addNodeItem2Tree(Wn.ofDict(o),null,r)}))}var er=function(){function e(){Mt()(this,e)}return wt()(e,null,[{key:"importScene",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[],n=arguments.length>2&&void 0!==arguments[2]&&arguments[2];console.log("Importing scene...",e,t),t.length>0?Jo(e,t):$o(e,n),console.log("End Importing scene")}}]),e}(),tr=o(42),nr=function e(){Mt()(this,e)};E()(nr,"createGizmo",(function(e){var t=new Kt.RotationGizmo(new Kt.UtilityLayerRenderer(e));return t.xGizmo.dragBehavior.detach(),t.xGizmo.scaleRatio=0,t.yGizmo.dragBehavior.detach(),t.yGizmo.scaleRatio=0,t})),E()(nr,"createCamera",(function(e,t,n){var o=_n.cameraBuilder(e).sphericalCoordinates(new Kt.Vector3(0,0,14)).target(Kt.Vector3.Zero()).name("camera").build();return o.attachControl(t,!1),o.inertia=.85,o.collisionRadius=new Kt.Vector3(1,1,1),o.checkCollisions=!0,n(o),o})),E()(nr,"createLight",(function(e){return _n.directionalLightBuilder(e).name("light").direction(new Kt.Vector3(0,-1,0)).intensity(.35).build()})),E()(nr,"createMeshGround",(function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:20,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:20,o=Kt.Mesh.CreateGround("groundMesh",t,n,20,e);return o.translate(new Kt.Vector3(0,-1,0),.01,Kt.Space.WORLD),o.material=new Kt.StandardMaterial("wireframe",e),o.material.wireframe=!0,o.isPickable=!1,o.checkCollisions=!0,o})),E()(nr,"createScene",(function(e){var t=new Kt.Scene(e);return t.clearColor=Kt.Color3.Black,t.collisionsEnabled=!0,t._uid=t.getUniqueId(),t})),E()(nr,"createMouseLocationText",(function(e){var t=tr.AdvancedDynamicTexture.CreateFullscreenUI("UI",!0,e),n=new tr.TextBlock;return n.text="",n.color="white",n.fontSize=11,n.left=-560,n.top=-145,t.addControl(n),n}));var or=nr,rr=function e(){Mt()(this,e)};E()(rr,"retrieveScene",(function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:lr,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:ir("retrieving scene");yn.MasterDB.cloudFunction($n.CLOUD_FUNCTION_NAME,"retrieveScene",e,(function(e){return cr(e,t,n)}))}));var ar,ir=function(e){return function(t){var n;throw""+yt()(n="Exception caught in ".concat(e,": ")).call(n,t.error)}},lr=function(e){},cr=function(e,t,n){e.success?t(e):n(e)},ur=rr,sr=function(){function e(t){Mt()(this,e),this.scene=t}return wt()(e,[{key:"loadMesh",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:function(e){},n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:function(e){},o=arguments.length>3&&void 0!==arguments[3]?arguments[3]:function(e,t,n){},r=new Kt.AssetsManager(this.scene),a=r.addMeshTask("","",fr+"/static/meshes/",e);a.onSuccess=t,a.onError=o,r.onFinish=n,r.load()}}],[{key:"of",value:function(t){return new e(t)}}]),e}(),fr=""===window.location.port?"http://".concat(window.location.hostname):yt()(ar="http://".concat(window.location.hostname,":")).call(ar,window.location.port),mr=sr;function hr(e,t){var n=S()(e);if(P.a){var o=P()(e);t&&(o=C()(o).call(o,(function(t){return x()(e,t).enumerable}))),n.push.apply(n,o)}return n}function dr(e){for(var t=1;t<arguments.length;t++){var n,o=null!=arguments[t]?arguments[t]:{};if(t%2)g()(n=hr(Object(o),!0)).call(n,(function(t){E()(e,t,o[t])}));else if(b.a)p()(e,b()(o));else{var r;g()(r=hr(Object(o))).call(r,(function(t){h()(e,t,x()(o,t))}))}}return e}function pr(e,t,n){if(e.length==t.length){for(var o=!0,r=0;r<e.length;r++){var a=e[r],i=t[r];if(!n(a,i))return!1;o=o&&pr(a.children,i.children,n)}return o}return!1}function vr(e){return e.expanded=!0,e}function br(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:function(e){return!0};if(!e||0===e.length)return[];var n=[];return g()(e).call(e,(function(e){var o=dr({},e);if(t(o))n.push(vr(o));else if(o.children){var r=br(o.children,t);0!==r.length&&(o.children=r,n.push(vr(o)))}})),n}var yr=function(){function e(t){Mt()(this,e),this.tree=t}return wt()(e,[{key:"getNode",value:function(e){return function e(t,n){for(var o=0;o<t.length;o++){var r=t[o];if(n(r))return Ut()($t.Maybe).call($t.Maybe,r);var a=e(r.children,n);if(a.isSome())return a}return $t.Maybe.none()}(this.tree,e)}},{key:"getParentNode",value:function(e){return function e(t,n,o){var r;if(on()(r=$()(t).call(t,(function(e){return n(e)}))).call(r,(function(e,t){return e||t}),!1))return $t.Maybe.fromNull(o);for(var a=0;a<t.length;a++){var i=t[a],l=e(i.children,n,i);if(l.isSome())return l}return $t.Maybe.none()}(this.tree,e,null)}},{key:"equals",value:function(t){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:function(e,t){return e===t};return t.constructor===e?pr(this.tree,t.tree,n):pr(this.tree,t,n)}},{key:"map",value:function(t){return new e(function e(t,n,o){for(var r=0;r<t.length;r++){var a=t[r],i=o(a);i.children=[],e(a.children,i.children,o),n.push(i)}return n}(this.tree,[],t))}},{key:"filter",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:function(e){return!0};return br(this.tree,e)}}]),e}(),gr=function(){function e(t,n,o,r,a){Mt()(this,e),this.title=t,this.item=n,this.children=o,this.expanded=r,this.isVisible=a}return wt()(e,null,[{key:"dispose",value:function(t){var n;t.item.dispose(),g()(n=t.children).call(n,(function(t){e.dispose(t)}))}},{key:"toDict",value:function(t){var n;return{name:t.title,item:t.item.toDict(),children:$()(n=t.children).call(n,(function(t){return e.toDict(t)}))}}},{key:"builder",value:function(){return new Mr}}]),e}(),Mr=function(){function e(){Mt()(this,e),this._title=null,this._item={},this._children=[],this._expanded=!0,this._isVisible=!0}return wt()(e,[{key:"title",value:function(e){return this._title=e,this}},{key:"item",value:function(e){return this._item=e,this}},{key:"children",value:function(e){return this._children=e,this}},{key:"expanded",value:function(e){return this._expanded=e,this}},{key:"isVisible",value:function(e){return this._isVisible=e,this}},{key:"build",value:function(){var e;return g()(e=Wt()(this)).call(e,(function(e){if(null===e)throw"There are missing variables to build a TreeNode, e.g ".concat(e)})),new gr(this._title,this._item,this._children,this._expanded,this._isVisible)}}]),e}(),xr=gr,wr=$n.CLOUD_FUNCTION_NAME,Cr=function(){function e(t){var n=this;Mt()(this,e),E()(this,"getNodeFromTree",(function(e,t){return new yr(t).getNode((function(t){return e===t.title}))})),E()(this,"getParentFromChild",(function(e,t){return new yr(t).getParentNode((function(t){return e===t.title}))})),E()(this,"deleteNodeFromTreeUsingName",(function(e,t){var o,r=!(arguments.length>2&&void 0!==arguments[2])||arguments[2];return g()(o=n.getNodeFromTree(e,t)).call(o,(function(o){xr.dispose(o),r&&n.deleteNodeInServer(e);var a=n.getParentFromChild(e,t);g()(a).call(a,(function(t){var n;t.children=C()(n=t.children).call(n,(function(t){return t.title!==e}))})),t=C()(t).call(t,(function(t){return t.title!==e}))})),t})),E()(this,"getNodeFromTreeWithPredicate",(function(e,t){return new yr(t).getNode(e)})),E()(this,"addNodeItem2Tree",(function(e,t){var o=arguments.length>2&&void 0!==arguments[2]?arguments[2]:Wn.NAME,r=!(arguments.length>3&&void 0!==arguments[3])||arguments[3],a=!(arguments.length>4&&void 0!==arguments[4])||arguments[4];n.deleteNodeFromTreeUsingName(t.name,e,r);var i=xr.builder().title(t.name).item(t).isVisible(a).build();if(o){var l=n.getNodeFromTree(o,e);g()(l).call(l,(function(e){r&&n.addNodeItem2Server(i,e.title),e.children.push(i)}))}else e.push(i),r&&n.addNodeItem2Server(i,null);return e})),E()(this,"updateNodeInServer",(function(e,t){var o,r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;console.log("updateNodeInServer!",n.sceneName),g()(o=n.getNodeFromTree(e,t)).call(o,(function(o){var a,i=$()(a=n.getParentFromChild(e,t)).call(a,(function(e){return e.title})).orNull();yn.MasterDB.cloudFunction(wr,"updateNode",[xr.toDict(o),i,r,n.sceneName],(function(e){console.log("Update node with success?",e.success)}))}))})),E()(this,"addNodeItem2Server",(function(e,t){yn.MasterDB.cloudFunction(wr,"addNodeItem",[xr.toDict(e),t,n.sceneName],(function(e){console.log("Add node with success?",e.success)}))})),E()(this,"deleteNodeInServer",(function(e){yn.MasterDB.cloudFunction(wr,"deleteNodeByName",[e,n.sceneName],(function(e){console.log("Deleted node with success?",e.success)}))})),this.sceneName=t}return wt()(e,null,[{key:"ofScene",value:function(t){return new e(t)}}]),e}(),kr=o(77),Pr=o.n(kr),Nr=o(43),Sr=o.n(Nr),Tr=o(78),Er=o.n(Tr),Ar=o(44),_r=o.n(Ar),jr=o(79),Rr=o.n(jr),Ir=o(80),Or=o.n(Ir),Br=function(){function e(){Mt()(this,e),this.memory={}}return wt()(e,[{key:"action",value:function(e){var t;g()(t=e.getSceneMemory()).call(t,(function(e){e.gizmoManager.attachedMesh=null})),e.highlightNodeInTree&&e.highlightNodeInTree(),e.highlightNodeInScene&&e.highlightNodeInScene()}}]),e}(),zr=function(e){function t(){return Mt()(this,t),kt()(this,Nt()(t).call(this))}return At()(t,e),wt()(t,[{key:"onPointerDown",value:function(e,t){}},{key:"onPointerMove",value:function(e,t){}},{key:"onPointerUp",value:function(e){}}]),t}(Br),Dr=function(e){function t(){var e;return Mt()(this,t),Fr?kt()(e,Fr):(e=kt()(this,Nt()(t).call(this)),E()(Tt()(e),"setProperties",(function(e,t){var n;g()(n=e.getNodeFromTree(t)).call(n,(function(t){e.setProperties(t.item.toForm())}))})),E()(Tt()(e),"action",(function(n){tn()(Nt()(t.prototype),"action",Tt()(e)).call(Tt()(e),n),n.setSelectedAction(Tt()(e))})),E()(Tt()(e),"onPointerDown",(function(t,n){var o;1===t.buttons&&g()(o=n.getSceneMemory()).call(o,(function(t){var o,r=t.scene,a=t.ground,i=t.camera;e.maybeSelectedMesh=_n.pickMesh(r,a),g()(o=e.maybeSelectedMesh).call(o,(function(o){o.onClick?o.onClick():n.closeContextDial(),n.addGizmo(o.name),n.highlightNodeInTree(o.name),n.highlightNodeInScene(o.name),e.setProperties(n,o.name),i.detachControl(t.canvas)}))}))})),E()(Tt()(e),"onPointerMove",(function(t,n){var o;g()(o=n.getSceneMemory()).call(o,(function(t){var n=t.scene,o=t.ground,r=_n.getGroundPosition(n,o);g()(r).call(r,(function(t){var n;g()(n=e.maybeSelectedMesh).call(n,(function(n){var o=_n.computeLocalCoordinateFromMesh(n,new ln([t.x,t.y,t.z]));n.position=new Kt.Vector3(o.getX(),o.getY(),n.position.z),e.notifyObservers(n,!1)}))}))}))})),E()(Tt()(e),"onPointerUp",(function(t){var n;g()(n=t.getSceneMemory()).call(n,(function(n){var o,r=n.camera;g()(o=e.maybeSelectedMesh).call(o,(function(n){e.notifyObservers(n),e.setProperties(t,n.name),t.updateNodeInServer(n.name)})),e.maybeSelectedMesh=$t.Maybe.none(),r.attachControl(n.canvas,!0)}))})),e.key="dragObject",e.name="Drag Objects",e.maybeSelectedMesh=$t.Maybe.none(),e.icon=function(e){return a.a.createElement("i",fe()({className:"fas fa-mouse-pointer"},e))},Fr=Tt()(e),e)}return At()(t,e),wt()(t,[{key:"notifyObservers",value:function(e){var t,n=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];g()(t=$t.Maybe.fromNull(e.observers)).call(t,(function(t){return t.notifyObservers({updatedPointMesh:e,is2updateServer:n})}))}}],[{key:"getInstace",value:function(){return new t}}]),t}(zr),Fr=null,Vr=Dr,qr=null,Lr=function(e){function t(){var e;return Mt()(this,t),qr?kt()(e,qr):(e=kt()(this,Nt()(t).call(this)),E()(Tt()(e),"createKeyPoint",(function(e,t,n,o){var r=!(arguments.length>4&&void 0!==arguments[4])||arguments[4],a=arguments.length>5&&void 0!==arguments[5]?arguments[5]:Kt.Color3.Gray(),i=o.getRootNode().item.mesh,l=Hn.ofDict(n,{name:t,color:[a.r,a.g,a.b]}),c=l.mesh;c.parent=i;var u=_n.computeLocalCoordinateFromMesh({parent:i},ln.ofBabylon(e)).toBabylon();return c.setPositionWithLocalVector(u.add(Kt.Axis.Z.scale(Hn.DEFAULT_SIZE))),r&&o.addNodeItem2Tree(l,i.name,r),c})),E()(Tt()(e),"action",(function(n){tn()(Nt()(t.prototype),"action",Tt()(e)).call(Tt()(e),n),n.setSelectedAction(Tt()(e))})),E()(Tt()(e),"onPointerDown",(function(t,n){var o;0===t.button&&g()(o=n.getSceneMemory()).call(o,(function(t){var n,o=t.scene,r=t.ground,a=t.camera;e.maybeMousePos=_n.getGroundPosition(o,r),g()(n=e.maybeMousePos).call(n,(function(e){a.detachControl(t.canvas)}))}))})),E()(Tt()(e),"onPointerMove",(function(t,n){var o;g()(o=n.getSceneMemory()).call(o,(function(t){var o=t.scene,r=t.ground,a=_n.getGroundPosition(o,r);g()(a).call(a,(function(t){var r;g()(r=e.maybeMousePos).call(r,(function(r){e.tempMesh&&e.tempMesh.dispose(),e.tempMesh=e.createKeyPoint(t,"temp_key_point",o,n,!1)}))}))}))})),E()(Tt()(e),"onPointerUp",(function(t){var n;g()(n=t.getSceneMemory()).call(n,(function(n){var o=n.scene,r=n.camera,a=n.ground,i=_n.getGroundPosition(o,a);g()(i).call(i,(function(n){var r;g()(r=e.maybeMousePos).call(r,(function(r){e.tempMesh&&e.tempMesh.dispose(),e.createKeyPoint(n,"KeyPoint".concat(Math.floor(1e3*Math.random())),o,t,!0,new Kt.Color3(Math.random(),Math.random(),Math.random()))}))})),e.maybeMousePos=$t.Maybe.none(),r.attachControl(n.canvas,!0)}))})),e.key="addKeyPoint",e.name="Add Key Point",e.maybeMousePos=$t.Maybe.none(),e.tempMesh=null,e.icon=function(e){return a.a.createElement("i",fe()({className:"fas fa-map-marker"},e))},qr=Tt()(e),e)}return At()(t,e),wt()(t,null,[{key:"getInstace",value:function(){return new t}}]),t}(zr),Ur=null,Gr=function(e){function t(){var e;return Mt()(this,t),Ur?kt()(e,Ur):(e=kt()(this,Nt()(t).call(this)),E()(Tt()(e),"createBoxRegion",(function(e,t,n,o){var r=!(arguments.length>4&&void 0!==arguments[4])||arguments[4],a=arguments.length>5&&void 0!==arguments[5]?arguments[5]:Kt.Color3.Red(),i=arguments.length>6&&void 0!==arguments[6]?arguments[6]:1,l=o.getRootNode().item.mesh,c=$()(e).call(e,(function(e){return _n.computeLocalCoordinateFromMesh({parent:l},ln.ofBabylon(e))}));c[1]=c[1].add(ln.of([0,0,i]));var u=c[0].add(c[1]).scale(.5),s=$()(c).call(c,(function(e){return e.sub(u)})),f=Ao.ofDict(n,{name:t,position:u.toArray(),color:[a.r,a.g,a.b],corners:$()(s).call(s,(function(e){return e.toArray()}))},o);return f.mesh.parent=l,r&&o.addNodeItem2Tree(f,l.name,r),f.mesh})),E()(Tt()(e),"action",(function(n){tn()(Nt()(t.prototype),"action",Tt()(e)).call(Tt()(e),n),n.setSelectedAction(Tt()(e))})),E()(Tt()(e),"onPointerDown",(function(t,n){var o;g()(o=n.getSceneMemory()).call(o,(function(t){var n=t.scene,o=t.ground,r=t.camera,a=_n.getGroundPosition(n,o);e.maybeMousePos=a,g()(a).call(a,(function(e){r.detachControl(t.canvas)}))}))})),E()(Tt()(e),"onPointerMove",(function(t,n){var o;g()(o=n.getSceneMemory()).call(o,(function(t){var o=t.scene,r=t.ground,a=_n.getGroundPosition(o,r);g()(a).call(a,(function(t){var r;g()(r=e.maybeMousePos).call(r,(function(r){e.tempMesh&&e.tempMesh.dispose(),e.tempMesh=e.createBoxRegion([r,t],"temp_box_region",o,n,!1)}))}))}))})),E()(Tt()(e),"onPointerUp",(function(t){var n;g()(n=t.getSceneMemory()).call(n,(function(n){var o=n.scene,r=n.camera,a=n.ground,i=_n.getGroundPosition(o,a);g()(i).call(i,(function(n){var r;g()(r=e.maybeMousePos).call(r,(function(r){e.tempMesh.dispose(),e.createBoxRegion([r,n],"BoxRegion".concat(Math.floor(1e3*Math.random())),o,t,!0)}))})),e.maybeMousePos=$t.Maybe.none(),r.attachControl(n.canvas,!0)}))})),e.key="drawBoxRegion",e.name="Draw Box Region",e.maybeMousePos=$t.Maybe.none(),e.tempMesh=null,e.icon=function(e){return a.a.createElement("i",fe()({className:"fas fa-square"},e))},Ur=Tt()(e),e)}return At()(t,e),wt()(t,null,[{key:"getInstace",value:function(){return new t}}]),t}(zr),Wr=null,Yr=function(e){function t(){var e;return Mt()(this,t),Wr?kt()(e,Wr):(e=kt()(this,Nt()(t).call(this)),E()(Tt()(e),"createCurve",(function(e,t,n,o){var r=!(arguments.length>4&&void 0!==arguments[4])||arguments[4],a=arguments.length>5&&void 0!==arguments[5]?arguments[5]:Kt.Color3.White(),i=o.getRootNode().item.mesh,l=$()(e).call(e,(function(e){return _n.computeLocalCoordinateFromMesh({parent:i},ln.ofBabylon(e)).toBabylon()})),c=_n.pointAverage(l),u=$()(l).call(l,(function(e){return e.subtract(c)})),s=ho.ofDict(n,{name:t,position:ln.ofBabylon(c).toArray(),color:[a.r,a.g,a.b],localPath:$()(u).call(u,(function(e){return ln.ofBabylon(e).toArray()}))},o);s.mesh.parent=i,o.addNodeItem2Tree(s,i.name,r)})),E()(Tt()(e),"action",(function(n){tn()(Nt()(t.prototype),"action",Tt()(e)).call(Tt()(e),n),n.setSelectedAction(Tt()(e))})),E()(Tt()(e),"getDrawPathContextAction",(function(t,n,o){var r=[];return r.push({icon:function(e){return a.a.createElement("i",fe()({className:"fas fa-times"},e))},action:function(o){t.attachControl(n,!0),o.deleteNodeFromTreeUsingName("temp_curve",!1),e.mouseCurve=[],o.closeContextDial()},name:"Clear Path"}),e.mouseCurve.length>1&&r.push({icon:function(e){return a.a.createElement("i",fe()({className:"fas fa-check"},e))},action:function(r){t.attachControl(n,!0),r.deleteNodeFromTreeUsingName("temp_curve",!1),e.createCurve(e.mouseCurve,"Path".concat(Math.floor(1e3*Math.random())),o,r,!0),e.mouseCurve=[],r.closeContextDial()},name:"Create Path"}),r})),E()(Tt()(e),"onPointerDown",(function(t,n){var o;1===t.buttons&&g()(o=n.getSceneMemory()).call(o,(function(t){var o=t.scene,r=t.ground,a=t.camera,i=_n.getGroundPosition(o,r);g()(i).call(i,(function(r){a.detachControl(t.canvas),e.mouseCurve.push(r),1===e.mouseCurve.length?e.createCurve([e.mouseCurve[0],e.mouseCurve[0]],"temp_curve",o,n,!1):e.createCurve(e.mouseCurve,"temp_curve",o,n,!1),n.setContextActions(e.getDrawPathContextAction(a,t.canvas,o))}))}))})),E()(Tt()(e),"onPointerMove",(function(e,t){})),E()(Tt()(e),"onPointerUp",(function(e){})),e.key="drawPath",e.name="Draw Path",e.mouseCurve=[],e.icon=function(e){return a.a.createElement("i",fe()({className:"fas fa-bezier-curve"},e))},Wr=Tt()(e),e)}return At()(t,e),wt()(t,null,[{key:"getInstace",value:function(){return new t}}]),t}(zr),Qr=null,Hr=function(e){function t(){var e;return Mt()(this,t),Qr?kt()(e,Qr):(e=kt()(this,Nt()(t).call(this)),E()(Tt()(e),"createPolygonRegion",(function(e,t,n,o){var r=!(arguments.length>4&&void 0!==arguments[4])||arguments[4],a=arguments.length>5&&void 0!==arguments[5]?arguments[5]:Kt.Color3.Yellow(),i=arguments.length>6&&void 0!==arguments[6]?arguments[6]:1,l=o.getRootNode().item.mesh,c=$()(e).call(e,(function(e){return _n.computeLocalCoordinateFromMesh({parent:l},ln.ofBabylon(e))})),u=_n.pointAverageVec3(c),s=$()(c).call(c,(function(e){return e.sub(u)})),f=Go.ofDict(n,{name:t,position:u.toArray(),color:[a.r,a.g,a.b],localPolygon:$()(s).call(s,(function(e){return e.toArray()})),height:i},o);f.mesh.parent=l,o.addNodeItem2Tree(f,l.name,r)})),E()(Tt()(e),"action",(function(n){tn()(Nt()(t.prototype),"action",Tt()(e)).call(Tt()(e),n),n.setSelectedAction(Tt()(e))})),E()(Tt()(e),"getDrawPolygonContextAction",(function(t,n,o){var r=[];return r.push({icon:function(e){return a.a.createElement("i",fe()({className:"fas fa-times"},e))},action:function(o){t.attachControl(n,!0),o.deleteNodeFromTreeUsingName("temp_polygon_region",!1),e.mouseCurve=[],o.closeContextDial()},name:"Clear Polygon"}),e.mouseCurve.length>2&&r.push({icon:function(e){return a.a.createElement("i",fe()({className:"fas fa-check"},e))},action:function(r){t.attachControl(n,!0),r.deleteNodeFromTreeUsingName("temp_polygon_region",!1),e.createPolygonRegion(e.mouseCurve,"PolygonRegion".concat(Math.floor(1e3*Math.random())),o,r,!0),e.mouseCurve=[],r.closeContextDial()},name:"Create Polygon"}),r})),E()(Tt()(e),"onPointerDown",(function(t,n){var o;g()(o=n.getSceneMemory()).call(o,(function(t){var o=t.scene,r=t.ground,a=t.camera,i=_n.getGroundPosition(o,r);g()(i).call(i,(function(r){a.detachControl(t.canvas),e.mouseCurve.push(r),1===e.mouseCurve.length?e.createPolygonRegion([e.mouseCurve[0],e.mouseCurve[0]],"temp_polygon_region",o,n,!1):e.createPolygonRegion(e.mouseCurve,"temp_polygon_region",o,n,!1),n.setContextActions(e.getDrawPolygonContextAction(a,t.canvas,o))}))}))})),E()(Tt()(e),"onPointerMove",(function(e,t){})),E()(Tt()(e),"onPointerUp",(function(e){})),e.key="drawPolygonRegion",e.name="Draw Polygon Region",e.mouseCurve=[],e.icon=function(e){return a.a.createElement("i",fe()({className:"fas fa-draw-polygon"},e))},Qr=Tt()(e),e)}return At()(t,e),wt()(t,null,[{key:"getInstace",value:function(){return new t}}]),t}(zr),Zr=null,Kr=function(e){function t(){var e;return Mt()(this,t),Zr?kt()(e,Zr):(e=kt()(this,Nt()(t).call(this)),E()(Tt()(e),"createWall",(function(e,t,n,o){var r=!(arguments.length>4&&void 0!==arguments[4])||arguments[4],a=arguments.length>5&&void 0!==arguments[5]?arguments[5]:{width:.1,height:1},i=arguments.length>6&&void 0!==arguments[6]?arguments[6]:new Kt.Color3(.25,.25,.25),l=o.getRootNode().item.mesh,c=$()(e).call(e,(function(e){return _n.computeLocalCoordinateFromMesh({parent:l},ln.ofBabylon(e)).toBabylon()})),u=c[1].add(c[0]).scale(.5),s=$()(c).call(c,(function(e){return e.subtract(u)})),f=Co.ofDict(n,{name:t,position:ln.ofBabylon(u).toArray(),size:a,color:[i.r,i.g,i.b],localWall:$()(s).call(s,(function(e){return ln.ofBabylon(e).toArray()}))},o);return f.mesh.parent=l,r&&o.addNodeItem2Tree(f,l.name,r),f.mesh})),E()(Tt()(e),"action",(function(n){tn()(Nt()(t.prototype),"action",Tt()(e)).call(Tt()(e),n),n.setSelectedAction(Tt()(e))})),E()(Tt()(e),"onPointerDown",(function(t,n){var o;0===t.button&&g()(o=n.getSceneMemory()).call(o,(function(t){var n=t.scene,o=t.ground,r=t.camera,a=_n.getGroundPosition(n,o);e.maybeMousePos=a,g()(a).call(a,(function(e){r.detachControl(t.canvas)}))}))})),E()(Tt()(e),"onPointerMove",(function(t,n){var o;g()(o=n.getSceneMemory()).call(o,(function(t){var o=t.scene,r=t.ground,a=_n.getGroundPosition(o,r);g()(a).call(a,(function(t){var r;g()(r=e.maybeMousePos).call(r,(function(r){e.tempMesh&&e.tempMesh.dispose(),e.tempMesh=e.createWall([r,t],"temp_wall",o,n,!1)}))}))}))})),E()(Tt()(e),"onPointerUp",(function(t){var n;g()(n=t.getSceneMemory()).call(n,(function(n){var o=n.scene,r=n.camera,a=n.ground,i=_n.getGroundPosition(o,a);g()(i).call(i,(function(n){var r;g()(r=e.maybeMousePos).call(r,(function(r){e.tempMesh.dispose(),r.subtract(n).length()>.1&&e.createWall([r,n],"Wall".concat(Math.floor(1e3*Math.random())),o,t,!0)}))})),e.maybeMousePos=$t.Maybe.none(),r.attachControl(n.canvas,!0)}))})),e.key="drawWall",e.name="Draw wall",e.maybeMousePos=$t.Maybe.none(),e.tempMesh=null,e.icon=function(e){return a.a.createElement("i",fe()({className:"fas fa-arrows-alt-h"},e))},Zr=Tt()(e),e)}return At()(t,e),wt()(t,null,[{key:"getInstace",value:function(){return new t}}]),t}(zr),Xr=(o(88),o(39)),Jr=o.n(Xr),$r=yn.Utils.ofNull,ea=function(e){function t(e,n){var o;return Mt()(this,t),o=kt()(this,Nt()(t).call(this,e)),E()(Tt()(o),"getType",(function(){return t.TYPE})),o.robot=n,o.pointCloudSubscribe(),o}return At()(t,e),wt()(t,[{key:"pointCloudSubscribe",value:function(){var e=this;yn.MasterDB.subscribe({Scope:"Robot",Name:this.robot.id,Parameter:"front_lidar"},(function(t){var n,o,r,a,i,l,c;g()(n=fn()(o=fn()(r=fn()(a=fn()(i=fn()(l=fn()(c=$t.Maybe.fromNull(t)).call(c,(function(e){return $r(e.key)}))).call(l,(function(t){return $r(t.Robot[e.robot.id])}))).call(i,(function(e){return $r(e.Parameter)}))).call(a,(function(e){return $r(e.front_lidar)}))).call(r,(function(e){return $r(e.Value)}))).call(o,(function(e){return $r(e.points)}))).call(n,(function(t){return e.updatePointCloud(t)}))}),(function(t){var n,o,r,a,i,l,c;g()(n=fn()(o=fn()(r=fn()(a=fn()(i=fn()(l=fn()(c=$t.Maybe.fromNull(t.value)).call(c,(function(e){return $r(e.Robot)}))).call(l,(function(t){return $r(t[e.robot.id])}))).call(i,(function(e){return $r(e.Parameter)}))).call(a,(function(e){return $r(e.front_lidar)}))).call(r,(function(e){return $r(e.Value)}))).call(o,(function(e){return $r(e.points)}))).call(n,(function(t){return e.updatePointCloud(t)}))}))}},{key:"updatePointCloud",value:function(e){var t=new Kt.VertexData;t.positions=fn()(e).call(e,(function(e){return e}));var n=new Array(4*e.length);t.colors=Jr()(n).call(n,1),t.applyToMesh(this.mesh,!0)}},{key:"dispose",value:function(){tn()(Nt()(t.prototype),"dispose",this).call(this),yn.MasterDB.unsubscribe({Scope:"Robot",Name:this.robot.id,Parameter:"front_lidar"})}}],[{key:"ofDict",value:function(e){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,o=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;if(!n||!o)throw"null dictionary describing point cloud or null mainView";var r=new Kt.Mesh("cloudPoint".concat(n.name),e),a=new Kt.StandardMaterial("cloudPoint".concat(n.name,"Material"),e);return a.emissiveColor=new Kt.Color3(1,1,1),a.disableLighting=!0,a.pointsCloud=!0,a.pointSize=2,r.material=a,new t(r,n)}}]),t}(Pn);E()(ea,"TYPE","PointCloud");var ta=ea,na=function(e){function t(e){var n,o=arguments.length>1&&void 0!==arguments[1]?arguments[1]:function(e,t){return On.getDefaultAnimator(t)};return Mt()(this,t),n=kt()(this,Nt()(t).call(this)),E()(Tt()(n),"action",(function(e){tn()(Nt()(t.prototype),"action",Tt()(n)).call(Tt()(n),e),e.getNodeFromTree(n.robot.name).orElseRun((function(){return n.addRobot(e)})),e.setSelectedAction(ra.dragObjects)})),E()(Tt()(n),"getType",(function(){return t.TYPE})),n.robot=e,n.key="robotAction".concat(e.name),n.name=e.name,n.robotAnimatorFactory=o,n.icon=function(e){return a.a.createElement("i",fe()({className:"fas fa-robot"},e))},n}return At()(t,e),wt()(t,[{key:"createRobotFromMesh",value:function(e,t,n){var o,r,a,i=On.createRobotMeshTree(this.robot.robotTree,e,t),l=$()(o=fn()(r=$()(a=$t.Maybe.fromNull(this.memory.parentObj)).call(a,(function(e){return e.parent}))).call(r,(function(e){return n.getNodeFromTree(e)}))).call(o,(function(e){return e.item.mesh})).orSome(n.getRootNode().item.mesh),c=$t.Maybe.fromNull(this.memory.nodeItemDict),u=On.builder().id(this.robot.id).name($t.Maybe.fromNull(this.memory.name).orSome(this.robot.name)).assetName($t.Maybe.fromNull(this.memory.assetName).orSome(this.robot.name)).meshTree(i).parentMesh(l).scene(t).keyValueMap($()(c).call(c,(function(e){return e.keyValueMap})).orSome({})).build();u.animate(this.robotAnimatorFactory(u,n));var s=null==this.memory.parentObj;this.memory.parentObj=null,n.addNodeItem2Tree(u,l.name,s);var f=ta.ofDict(t,{name:this.robot.name,id:this.robot.id},n);f.mesh.parent=u.mesh,n.addNodeItem2Tree(f,u.name,!1)}},{key:"addRobot",value:function(e){var t,n=this;g()(t=e.getSceneMemory()).call(t,(function(t){var o=t.scene,r=Fn.getInstance().get(On.ROBOT_MESH_NAME,o);n.createRobotFromMesh(r,o,e)}))}}]),t}(Br);E()(na,"TYPE","RobotAction");var oa=na,ra={dragObjects:Vr.getInstace(),addKeyPoint:Lr.getInstace(),drawBoxRegion:Gr.getInstace(),drawPath:Yr.getInstace(),drawRegion:Hr.getInstace(),drawWalls:Kr.getInstace(),addRobot:new oa({id:"Test",name:"Test",robotTree:{name:"Test",position:{x:0,y:0,z:0},orientation:{w:1,x:0,y:0,z:0},child:[{name:"TestTF",position:{x:1,y:0,z:1},orientation:{w:Math.cos(-Math.PI/4),x:0,y:Math.sin(-Math.PI/4),z:0},child:[]}]}})},aa=function(e){function t(e,n,o,r,i){var l;return Mt()(this,t),l=kt()(this,Nt()(t).call(this)),E()(Tt()(l),"getType",(function(){return t.TYPE})),E()(Tt()(l),"deleteAsset",(function(){yn.MasterDB.cloudFunction($n.CLOUD_FUNCTION_NAME,"deleteMap",l.name,(function(e){console.log("Delete Maps",e)}))})),l.name=e,l.key="addMap".concat(e),l.textureSrc=n,l.resolution=o,l.origin=r,l.imageSize=i,l.icon=function(e){return a.a.createElement("i",fe()({},e,{className:"fas fa-map"}))},l}return At()(t,e),wt()(t,[{key:"getSensibilityFromArea",value:function(e){return la(e)}},{key:"addMap",value:function(e){var t,n=this,o=$t.Maybe.fromNull(e.getRootNode());g()(t=e.getSceneMemory()).call(t,(function(t){var r,a,i,l=t.scene,c=t.camera,u=n.resolution*n.imageSize[0],s=n.resolution*n.imageSize[1],f=_n.groundBuilder(l).name($t.Maybe.fromNull(n.memory.name).orSome(n.name)).width(u).height(s).textureSrc(n.textureSrc).build(),m=ln.of([-u/2,-s/2,0]).sub(ln.of(n.origin)),h=null==n.memory.parentObj;n.memory.parentObj=null,g()(o).call(o,(function(e){var t=e.item.mesh.parent;t.position=Wn.inverseCoord(m.toBabylon()),c.setTarget(new Kt.Vector3(t.position.x,t.position.y,t.position.z))})),c.panningSensibility=n.getSensibilityFromArea(u*s),console.log(yt()(r=yt()(a=yt()(i="Panning Sensibility: width(".concat(u,") height(")).call(i,s,") Area(")).call(a,u*s,") Sensibility(")).call(r,c.panningSensibility,")"));var d=new Yo(f,[u,s],n.textureSrc,$t.Maybe.fromNull(n.memory.assetName).orSome(n.name));e.addNodeItem2Tree(d,null,h),t.ground.dispose(),t.ground=or.createMeshGround(l,u,s)}))}},{key:"action",value:function(e){var n=this;tn()(Nt()(t.prototype),"action",this).call(this,e);var o=e.getNodeFromTree(this.name);g()(o).call(o,(function(e){})),o.orElseRun((function(){if(e.getObjectTree().length<2)return n.addMap(e);var t=e.getObjectTree()[1].title;e.deleteNodeFromTreeUsingName(t),n.addMap(e)})),e.setSelectedAction(ra.dragObjects)}}]),t}(Br);E()(aa,"TYPE","AddMapAction");var ia,la=function(e){return 1018.74*Math.exp(-464231e-10*e)},ca=aa,ua="Map",sa="Robot",fa={Map:function(e){return new ca(e.name,e.image,e.resolution,e.origin,e.size)},Robot:function(e){return new oa(e,On.getSocketAnimator)}},ma=""===window.location.port?"http://".concat(window.location.hostname):yt()(ia="http://".concat(window.location.hostname,":")).call(ia,window.location.port),ha=function(){function e(){var t=this;if(Mt()(this,e),E()(this,"getAssets",(function(){return t.assets})),E()(this,"getAssetsActionMap",(function(){return t.assetsActionMap})),E()(this,"addAfterLoad",(function(e){return t.afterLoad.push(e),t})),E()(this,"getMapUrl",(function(e){var t;return yt()(t="".concat(ma,"/static/maps/")).call(t,e)})),E()(this,"parseYaml",function(){var e=Or()(_r.a.mark((function e(n){var o,r,a,i,l,c;return _r.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return l={},c={image:function(e,t){return l[e]=t},resolution:function(e,t){return l[e]=Rr()(t)},origin:function(e,t){return l[e]=JSON.parse(t)}},g()(o=C()(r=C()(a=$()(i=n.split("\n")).call(i,(function(e){return e.split(": ")}))).call(a,(function(e){return e.length>=2}))).call(r,(function(e){return e[0]in c}))).call(o,(function(e){return c[e[0]](e[0],e[1])})),l.name=l.image.split("/").pop(),l.image=t.getMapUrl(l.image),console.log("Yaml text",n),e.next=8,t.getImageSize(l.image);case 8:return l.size=e.sent,e.abrupt("return",l);case 10:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()),E()(this,"finishSub",(function(e){var n;(console.log("FINISH SUB ",e,t.finishInitialSubscribers),++t.finishInitialSubscribers>2)&&g()(n=t.afterLoad).call(n,(function(e){return e()}))})),E()(this,"getMapSubscribe",(function(e){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:function(){};return function(o){var r,a,i,l;return g()(r=fn()(a=fn()(i=fn()(l=$t.Maybe.fromNull(e(o))).call(l,(function(e){return $t.Maybe.fromNull(e.Package)}))).call(i,(function(e){return $t.Maybe.fromNull(e.maps)}))).call(a,(function(e){return $t.Maybe.fromNull(e.File)}))).call(r,(function(e){var o,r,a=$()(o=C()(r=S()(e)).call(r,(function(e){return Er()(e).call(e,".yaml")}))).call(o,(function(e){return t.addMap(e)}));Sr.a.all(a).then((function(){return n()})).catch((function(e){return console.log("Caught exception",e)}))}))}})),E()(this,"getUpdateMapSub",(function(e,n){var o={del:function(o){var r,a,i,l;g()(r=fn()(a=fn()(i=fn()(l=$t.Maybe.fromNull(e(o))).call(l,(function(e){return $t.Maybe.fromNull(e.Package)}))).call(i,(function(e){return $t.Maybe.fromNull(e.maps)}))).call(a,(function(e){return $t.Maybe.fromNull(e.File)}))).call(r,(function(e){delete t.assets[S()(e)[0]],delete t.assetsActionMap[S()(e)[0]],n()}))},set:t.getMapSubscribe(e,n),subscribe:t.getMapSubscribe(e,n)};return function(e){o[e.event](e)}})),da)return da;da=this,this.assets={},this.assetsActionMap={},this.robots={},this.observers=[],this.afterLoad=[],this.finishInitialSubscribers=0,this.retrieveAssetsFromDb()}return wt()(e,[{key:"addObserver",value:function(e){return this.observers.push(e),this}},{key:"addAsset",value:function(e,t){this.assets[e]=t,this.assetsActionMap[e]=fa[t.type](t)}},{key:"addRobot",value:function(e){var t,n,o,r=this,a=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;if(e in this.robots||(this.robots[e]={id:e,name:null,tf:null}),g()(t=$t.Maybe.fromNull(a)).call(t,(function(t){return r.robots[e].name=t})),g()(n=$t.Maybe.fromNull(i)).call(n,(function(t){return r.robots[e].tf=t})),Pr()(o=Wt()(this.robots[e])).call(o,(function(e){return null!==e}))){var l=this.robots[e];l.tf.name=l.name,this.addAsset(l.name,{name:l.name,id:e,type:sa,robotTree:l.tf})}}},{key:"addMap",value:function(e){var t=this;return fetch(this.getMapUrl(e)).then((function(e){return e.text()})).then((function(e){return t.parseYaml(e)})).then((function(e){return e.type=ua,e})).then((function(e){return t.addAsset(e.name,e)}))}},{key:"getImageSize",value:function(e){return new Sr.a((function(t,n){var o=new Image;o.src=e,o.onload=function(){return t([o.naturalWidth,o.naturalHeight])}}))}},{key:"retrieveAssetsFromDb",value:function(){var e=this;yn.MasterDB.subscribe({Scope:"Robot",Name:"*",RobotName:"*"},(function(e){}),(function(t){var n,o;g()(n=fn()(o=$t.Maybe.fromNull(t.value)).call(o,(function(e){return $t.Maybe.fromNull(e.Robot)}))).call(n,(function(t){var n;g()(n=S()(t)).call(n,(function(n){return e.addRobot(n,t[n].RobotName)}))})),e.finishSub("RobotName")})),yn.MasterDB.subscribe({Scope:"Robot",Name:"*",Parameter:"tf"},(function(e){}),(function(t){var n,o;g()(n=fn()(o=$t.Maybe.fromNull(t.value)).call(o,(function(e){return $t.Maybe.fromNull(e.Robot)}))).call(n,(function(t){var n;g()(n=S()(t)).call(n,(function(n){return e.addRobot(n,null,t[n].Parameter.tf.Value)}))})),e.finishSub("Robot tf")})),yn.MasterDB.subscribe({Scope:"Package",File:"*",Name:"maps"},this.getUpdateMapSub((function(e){return e.key}),(function(){var t;return g()(t=e.observers).call(t,(function(e){return e()}))})),this.getMapSubscribe((function(e){return e.value}),(function(){return e.finishSub("Maps")})))}}],[{key:"getInstance",value:function(){return new e}}]),e}(),da=null,pa=ha;function va(e,t){var n=S()(e);if(P.a){var o=P()(e);t&&(o=C()(o).call(o,(function(t){return x()(e,t).enumerable}))),n.push.apply(n,o)}return n}var ba=function(e){function t(e){var n;return Mt()(this,t),n=kt()(this,Nt()(t).call(this,e)),E()(Tt()(n),"getSceneMemory",(function(){return n.sceneMemory})),E()(Tt()(n),"getAssetsActionMap",(function(){return pa.getInstance().getAssetsActionMap()})),E()(Tt()(n),"getRootNode",(function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:Qt()(n.objectTree);return C()(e).call(e,(function(e){return e.title===Wn.NAME}))[0]})),E()(Tt()(n),"getObjectTree",(function(){return n.objectTree})),E()(Tt()(n),"setSelectedAction",(function(e){})),E()(Tt()(n),"getNodeFromTree",(function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:Qt()(n.objectTree);return Cr.ofScene(n.sceneName).getNodeFromTree(e,t)})),E()(Tt()(n),"deleteNodeFromTreeUsingName",(function(e){!(arguments.length>1&&void 0!==arguments[1])||arguments[1];throw"Delete Node in viewer Exception"})),E()(Tt()(n),"updateNodeInServer",(function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;n.props.focusObject.Value===e&&n.setCameraToTarget(),Cr.ofScene(n.sceneName).updateNodeInServer(e,Qt()(n.objectTree),t)})),E()(Tt()(n),"addNodeItem2Tree",(function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:Wn.NAME,o=!(arguments.length>2&&void 0!==arguments[2])||arguments[2],r=!(arguments.length>3&&void 0!==arguments[3])||arguments[3],a=Cr.ofScene(n.sceneName).addNodeItem2Tree(Qt()(n.objectTree),e,t,o,r);n.objectTree=a})),E()(Tt()(n),"setCameraToTarget",(function(){var e;g()(e=n.sceneMemory).call(e,(function(e){var t=e.camera,o=n.props.focusObject.Value;n.getNodeFromTree(o).cata((function(){console.log("Set Camera",n.getRootNode().item.mesh._absolutePosition),t.setTarget(n.getRootNode().item.mesh._absolutePosition.clone())}),(function(e){console.log("Set Camera, Found Object",e.item.mesh),t.setTarget(e.item.mesh._absolutePosition.clone()),t.beta=0}))}))})),E()(Tt()(n),"retrieveSceneFromServer",(function(e){ur.retrieveScene(n.sceneName,(function(t){er.importScene(Tt()(n),t.result),vt()(e)}))})),E()(Tt()(n),"getAssets",(function(e){var t=pa.getInstance();t.addAfterLoad(e),Wt()(t.getAssets()).length>0&&e()})),E()(Tt()(n),"loadMeshes",(function(){var e,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:function(){};g()(e=n.getSceneMemory()).call(e,(function(e){var n=e.engine,o=e.scene;mr.of(o).loadMesh(On.ROBOT_MESH_NAME,(function(e){var t=On.transformMesh(e.loadedMeshes[0],o);Fn.getInstance().put(On.ROBOT_MESH_NAME,o,t)}),(function(e){n.runRenderLoop((function(){return o.render()})),t()}))}))})),E()(Tt()(n),"loadScene",(function(){n.loadMeshes((function(){return n.getAssets((function(){return n.retrieveSceneFromServer((function(){return n.setCameraToTarget()}))}))}))})),E()(Tt()(n),"cameraViewObservable",(function(e){var t=Math.abs(e.beta)<=.01;e.panningAxis=t?new Kt.Vector3(1,1,0):new Kt.Vector3(1,0,1)})),E()(Tt()(n),"createScene",(function(e,t){var o=or.createScene(e);return n.sceneMemory=Ut()($t.Maybe).call($t.Maybe,{engine:e,canvas:t,scene:o,camera:or.createCamera(o,t,(function(e){return e.onViewMatrixChangedObservable.add((function(){return n.cameraViewObservable(e)}))})),light:or.createLight(o),ground:or.createMeshGround(o),gizmoManager:or.createGizmo(o),highlightLayer:{hl:new Kt.HighlightLayer("hl1",o),lastHlMesh:null}}),o})),E()(Tt()(n),"componentDidUpdate",(function(e){var t=[{propVar:function(e){return e.sceneName.Value},action:function(){return n.sceneName=n.props.sceneName.Value}},{propVar:function(e){return e.focusObject.Value},action:n.setCameraToTarget}];$()(t).call(t,(function(t){var o=t.propVar,r=t.action;o(n.props)!==o(e)&&r()}))})),E()(Tt()(n),"componentDidMount",(function(){console.log("SceneViewer Did Mount!!"),n.loadScene()})),n.sceneName=e.sceneName.Value,n.sceneMemory=$t.Maybe.none(),n.objectTree=[],n}return At()(t,e),wt()(t,[{key:"render",value:function(){return a.a.createElement(Jt,{createScene:this.createScene,is2render:!1})}}],[{key:"getComponentFactory",value:function(e){return function(n){var o=function(e){for(var t=1;t<arguments.length;t++){var n,o=null!=arguments[t]?arguments[t]:{};if(t%2)g()(n=va(Object(o),!0)).call(n,(function(t){E()(e,t,o[t])}));else if(b.a)p()(e,b()(o));else{var r;g()(r=va(Object(o))).call(r,(function(t){h()(e,t,x()(o,t))}))}}return e}({sceneName:e},n);return a.a.createElement(t,o)}}}]),t}(r.Component);E()(ba,"EXTENSION",".3d"),ba.propTypes={sceneName:u.a.shape({Value:u.a.string}),focusObject:u.a.shape({Value:u.a.string})},ba.defaultProps={sceneName:{Value:"Pedro"},focusObject:{Value:""}};var ya=ba,ga=o(81),Ma=o.n(ga),xa=(o(89),o(82)),wa=o.n(xa),Ca=o(83),ka=o.n(Ca),Pa=Object(ee.makeStyles)((function(e){return{formControl:{margin:e.spacing(1),minWidth:120}}})),Na=function(e){var t,n=Pa(),o=a.a.createElement("div",null);return e.noneOption&&(o=a.a.createElement(le.a,{value:""},a.a.createElement("em",null,"None"))),a.a.createElement(wa.a,{variant:e.variant,className:n.formControl,style:e.style,hiddenLabel:void 0===e.label},a.a.createElement(Ma.a,{id:"demo-simple-select-filled-label"},e.label),a.a.createElement(ka.a,{labelId:"demo-simple-select-filled-label",id:"demo-simple-select-filled",value:e.value,onChange:e.onChange},o,$()(t=e.options).call(t,(function(e,t){return a.a.createElement(le.a,{key:t,value:e},e)}))))};Na.propTypes={value:u.a.string,options:u.a.array,noneOption:u.a.bool,label:u.a.string,variant:u.a.string,style:u.a.object,onChange:u.a.func},Na.defaultProps={value:"option2",options:["option1","option2","option3"],variant:"filled",noneOption:!0,onChange:function(e){return console.log(e.target.value)}};var Sa=Na,Ta=o(40),Ea=o(84),Aa=o.n(Ea),_a=o(85),ja=o.n(_a),Ra=o(86),Ia=function(e){var t=e.path,n=void 0===t?"":t,o=e.style,r=void 0===o?{}:o,i=Jr()(e),l=void 0===i?"#fff":i,c=e.width,u=void 0===c?"100%":c,s=e.height,f=void 0===s?"100%":s,m=e.className,h=void 0===m?"":m,d=e.viewBox,p=void 0===d?"0 0 24 24":d;return a.a.createElement("svg",{width:u,style:r,height:f,viewBox:p,xmlns:"http://www.w3.org/2000/svg",className:"svg-icon ".concat(h||""),xmlnsXlink:"http://www.w3.org/1999/xlink"},a.a.createElement("path",{fill:l,d:n}))},Oa={Close:a.a.createElement(Ia,{width:24,path:"M19 6.41L17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"}),ErrorOutline:a.a.createElement(Ia,{width:24,path:"M11 15h2v2h-2zm0-8h2v6h-2zm.99-5C6.47 2 2 6.48 2 12s4.47 10 9.99 10C17.52 22 22 17.52 22 12S17.52 2 11.99 2zM12 20c-4.42 0-8-3.58-8-8s3.58-8 8-8 8 3.58 8 8-3.58 8-8 8z"}),InfoOutlined:a.a.createElement(Ia,{width:24,path:"M11,9H13V7H11M12,20C7.59,20 4,16.41 4,12C4,7.59 7.59,4 12,4C16.41,4 20,7.59 20, 12C20,16.41 16.41,20 12,20M12,2A10,10 0 0,0 2,12A10,10 0 0,0 12,22A10,10 0 0,0 22,12A10, 10 0 0,0 12,2M11,17H13V11H11V17Z"}),ReportProblemOutlined:a.a.createElement(Ia,{width:24,path:"M12 5.99L19.53 19H4.47L12 5.99M12 2L1 21h22L12 2zm1 14h-2v2h2v-2zm0-6h-2v4h2v-4z"}),SuccessOutlined:a.a.createElement(Ia,{width:24,path:"M20,12A8,8 0 0,1 12,20A8,8 0 0,1 4,12A8,8 0 0,1 12,4C12.76,4 13.5,4.11 14.2, 4.31L15.77,2.74C14.61,2.26 13.34,2 12,2A10,10 0 0,0 2,12A10,10 0 0,0 12,22A10,10 0 0, 0 22,12M7.91,10.08L6.5,11.5L11,16L21,6L19.59,4.58L11,13.17L7.91,10.08Z"})},Ba={success:Oa.SuccessOutlined,warning:Oa.ReportProblemOutlined,error:Oa.ErrorOutline,info:Oa.InfoOutlined},za=function(e){var t,n=e.action,o=e.children,a=e.classes,i=e.className,l=e.closeText,c=void 0===l?"Close":l,u=e.color,s=e.icon,f=e.iconMapping,m=void 0===f?Ba:f,h=e.onClose,d=(e.role,e.severity),p=void 0===d?"success":d,v=e.variant,b=void 0===v?"standard":v,y=(e.theme,Ye()(e,["action","children","classes","className","closeText","color","icon","iconMapping","onClose","role","severity","variant","theme"]));return console.log("action",n),r.createElement("div",fe()({className:Aa()(a.root,a[yt()(t="".concat(b)).call(t,Object(Ra.capitalize)(u||p))],i)},y),!1!==s?r.createElement("div",{className:a.icon},s||m[p]||Ba[p]):null,r.createElement("div",{className:a.message},o),null!=n?r.createElement("div",{className:a.action},n):null,null==n&&h?r.createElement("div",{className:a.action},r.createElement(ja.a,{size:"small","aria-label":c,title:c,color:"inherit",onClick:h},Oa.Close)):null)};za.propTypes={action:u.a.node,children:u.a.node,classes:u.a.object,className:u.a.string,closeText:u.a.string,color:u.a.oneOf(["error","info","success","warning"]),icon:u.a.node,iconMapping:u.a.shape({error:u.a.node,info:u.a.node,success:u.a.node,warning:u.a.node}),onClose:u.a.func,role:u.a.string,severity:u.a.oneOf(["error","info","success","warning"]),variant:u.a.oneOf(["filled","outlined","standard"])};var Da=Object(ee.withStyles)((function(){return{root:{backgroundColor:"transparent",display:"flex",padding:"6px 16px"},filledSuccess:{color:"#fff",backgroundColor:"#4caf50"},filledInfo:{color:"#fff",backgroundColor:"#2196f3"},filledWarning:{color:"#fff",backgroundColor:"#ff9800"},filledError:{color:"#fff",backgroundColor:"#f44336"},icon:{marginRight:12,padding:"7px 0",display:"flex",fontSize:22,opacity:.9},message:{padding:"8px 0",display:"flex",flexDirection:"column",justifyContent:"center"},action:{display:"flex",alignItems:"center",marginLeft:"auto",paddingLeft:16,marginRight:-8}}}),{name:"MuiAlert"})(za),Fa=(o(90),function(e){function t(){var e,n,o;Mt()(this,t);for(var r=arguments.length,a=new Array(r),i=0;i<r;i++)a[i]=arguments[i];return o=kt()(this,(e=Nt()(t)).call.apply(e,yt()(n=[this]).call(n,a))),E()(Tt()(o),"autoClose",null),E()(Tt()(o),"handleClickButton",(function(e){e.onClick&&e.onClick(),o.close()})),E()(Tt()(o),"handleClickOverlay",(function(e){var t=o.props,n=t.closeOnClickOutside,r=t.onClickOutside,a=e.target===o.overlay;n&&a&&(r(),o.close())})),E()(Tt()(o),"close",(function(){qa(),Va()})),E()(Tt()(o),"keyboardClose",(function(e){var t=o.props,n=t.closeOnEscape,r=t.onKeypressEscape,a=27===e.keyCode;n&&a&&(r(e),o.close())})),E()(Tt()(o),"componentDidMount",(function(){document.addEventListener("keydown",o.keyboardClose,!1),o.autoClose=vt()((function(){(document.getElementById("react-confirm-alert")||document.getElementById("react-confirm-alert-body-element"))&&o.close()}),o.props.autoHideDuration)})),E()(Tt()(o),"componentWillUnmount",(function(){document.removeEventListener("keydown",o.keyboardClose,!1),clearTimeout(o.autoClose),o.props.willUnmount()})),E()(Tt()(o),"renderCustomUI",(function(){var e=o.props,t=e.title,n=e.message;return(0,e.customUI)({title:t,message:n,onClose:o.close})})),o}return At()(t,e),wt()(t,[{key:"render",value:function(){var e=this,t=this.props,n=t.message,o=t.customUI,r=t.severity,i=t.closeText,l=t.closable,c=t.theme;return a.a.createElement("div",{className:"react-confirm-alert-overlay",ref:function(t){return e.overlay=t},onClick:this.handleClickOverlay},a.a.createElement("div",{className:"react-confirm-alert"},o?this.renderCustomUI():a.a.createElement("div",{className:"react-confirm-alert-body"},a.a.createElement(Da,{theme:c,elevation:6,variant:"filled",severity:r,closeText:i,action:l?a.a.createElement("div",{className:"icon-container",onClick:function(){return e.close()}},Oa.Close):void 0},n))))}}]),t}(r.Component));function Va(){var e=document.getElementById("react-confirm-alert");Object(Ta.unmountComponentAtNode)(e),e.parentNode.removeChild(e)}function qa(){document.body.classList.remove("react-confirm-alert-body-element")}function La(e,t){document.body.classList.add("react-confirm-alert-body-element"),function(e,t){var n=document.getElementById("react-confirm-alert");n||(document.body.children[0].classList.add("react-confirm-alert-blur"),(n=document.createElement("div")).id="react-confirm-alert",document.body.appendChild(n)),Object(Ta.render)(a.a.createElement(Fa,fe()({},e,{theme:t})),n)}(e,t)}E()(Fa,"propTypes",{message:u.a.string,customUI:u.a.func,closeOnClickOutside:u.a.bool,closeOnEscape:u.a.bool,willUnmount:u.a.func,onClickOutside:u.a.func,onKeypressEscape:u.a.func,severity:u.a.string,closeText:u.a.string,autoHideDuration:u.a.number,closable:u.a.bool}),E()(Fa,"defaultProps",{closeOnClickOutside:!0,closeOnEscape:!0,willUnmount:function(){return null},onClickOutside:function(){return null},onKeypressEscape:function(){return null},severity:"info",closeText:"Close",autoHideDuration:6e3,closable:!0});function Ua(e,t){var n=S()(e);if(P.a){var o=P()(e);t&&(o=C()(o).call(o,(function(t){return x()(e,t).enumerable}))),n.push.apply(n,o)}return n}var Ga=function(e){return function(e){for(var t=1;t<arguments.length;t++){var n,o=null!=arguments[t]?arguments[t]:{};if(t%2)g()(n=Ua(Object(o),!0)).call(n,(function(t){E()(e,t,o[t])}));else if(b.a)p()(e,b()(o));else{var r;g()(r=Ua(Object(o))).call(r,(function(t){h()(e,t,x()(o,t))}))}}return e}({},e,{typography:{fontFamily:"Roboto",h1:{fontFamily:"Avenir"},h2:{fontFamily:"Avenir"},h3:{fontFamily:"Avenir"},h4:{fontFamily:"Avenir"},h5:{fontFamily:"Avenir"},h6:{fontFamily:"Avenir"},body1:{fontFamily:"Roboto"}}})},Wa={dark:Object(ee.createMuiTheme)(Ga({label:"dark",backgroundColor:"linear-gradient(114.01deg, #212121 0%, #050505 100.43%)",bottomNavigation:{background:"#212121"},globalStats:{borderColor:"#474747",subTextColor:"#CDCDCD",upperTextColor:"#E6E6E6"},palette:{type:"dark",primary:{main:"#36b5e6"},secondary:{main:"#CF6679"},green:{main:"#03DAC5"}},overrides:{MuiButton:{outlined:{margin:"8px"},text:{margin:"8px"},contained:{margin:"8px"},containedPrimary:{color:"inherit",margin:"8px"},containedSecondary:{color:"inherit",margin:"8px"}},MuiButtonGroup:{root:{margin:"0"},groupedContainedPrimary:{margin:"0"},groupedOutlined:{margin:"0"},groupedText:{margin:"0"}},MuiIconButton:{root:{color:"#36b5e6"}},MuiListItem:{button:{"&:hover":{backgroundColor:"rgba(54,181,230, 0.15)"}}},MuiFormControlLabel:{label:{color:"rgba(255,255,255,0.8)"}},MuiInputBase:{input:{font:"Roboto"}},MuiFilledInput:{root:{border:"4px"},underline:{"&::before":{borderRadius:"4px"}}}}})),light:Object(ee.createMuiTheme)(Ga({label:"light",backgroundColor:"linear-gradient(122.19deg, #FFFFFF 2.58%, #FFFFFF 76.23%)",bottomNavigation:{background:"#c3c3c3"},globalStats:{borderColor:"#E6E6E6",subTextColor:"#717171",upperTextColor:"#474747"},palette:{primary:{main:"#007197"},secondary:{main:"#BE2424"},green:{main:"#03DAC5"}},overrides:{MuiButton:{outlined:{margin:"8px"},text:{margin:"8px"},contained:{margin:"8px"},containedPrimary:{color:"white",margin:"8px"},containedSecondary:{color:"white",margin:"8px"}},MuiButtonGroup:{root:{margin:"0"},groupedContainedPrimary:{margin:"0"},groupedOutlined:{margin:"0"},groupedText:{margin:"0"}},MuiIconButton:{root:{color:"#007197"}},MuiListItem:{button:{"&:hover":{backgroundColor:"rgba(0,113,151, 0.15)"}}},MuiFormControlLabel:{label:{color:"rgba(0,0,0,0.8)"}},MuiInputBase:{input:{font:"Roboto"}},MuiFilledInput:{root:{border:"4px"},underline:{"&::before":{borderRadius:"4px"}}}}}))}}])}));