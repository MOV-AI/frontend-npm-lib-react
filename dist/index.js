!function(e,t){"object"==typeof exports&&"object"==typeof module?module.exports=t():"function"==typeof define&&define.amd?define([],t):"object"==typeof exports?exports.Movai=t():e.Movai=t()}(global,(function(){return function(e){var t={};function n(o){if(t[o])return t[o].exports;var r=t[o]={i:o,l:!1,exports:{}};return e[o].call(r.exports,r,r.exports,n),r.l=!0,r.exports}return n.m=e,n.c=t,n.d=function(e,t,o){n.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:o})},n.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},n.t=function(e,t){if(1&t&&(e=n(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var o=Object.create(null);if(n.r(o),Object.defineProperty(o,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var r in e)n.d(o,r,function(t){return e[t]}.bind(null,r));return o},n.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return n.d(t,"a",t),t},n.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},n.p="",n(n.s=101)}([function(e,t){e.exports=require("@babel/runtime-corejs3/helpers/esm/defineProperty")},function(e,t){e.exports=require("@babel/runtime-corejs3/core-js-stable/instance/for-each")},function(e,t){e.exports=require("@babylonjs/core")},function(e,t){e.exports=require("react")},function(e,t){e.exports=require("@babel/runtime-corejs3/helpers/esm/assertThisInitialized")},function(e,t){e.exports=require("@babel/runtime-corejs3/core-js-stable/instance/map")},function(e,t){e.exports=require("monet")},function(e,t){e.exports=require("prop-types")},function(e,t){e.exports=require("@babel/runtime-corejs3/helpers/esm/classCallCheck")},function(e,t){e.exports=require("@babel/runtime-corejs3/helpers/esm/createClass")},function(e,t){e.exports=require("@babel/runtime-corejs3/helpers/esm/getPrototypeOf")},function(e,t){e.exports=require("@babel/runtime-corejs3/helpers/esm/possibleConstructorReturn")},function(e,t){e.exports=require("@babel/runtime-corejs3/helpers/esm/extends")},function(e,t){e.exports=require("@babel/runtime-corejs3/helpers/esm/get")},function(e,t){e.exports=require("@babel/runtime-corejs3/helpers/esm/inherits")},function(e,t){e.exports=require("@babel/runtime-corejs3/core-js-stable/instance/flat-map")},function(e,t){e.exports=require("@babel/runtime-corejs3/core-js-stable/instance/filter")},function(e,t){e.exports=require("@babel/runtime-corejs3/core-js-stable/object/keys")},function(e,t){e.exports=require("@babel/runtime-corejs3/core-js-stable/object/get-own-property-descriptors")},function(e,t){e.exports=require("@babel/runtime-corejs3/core-js-stable/object/get-own-property-descriptor")},function(e,t){e.exports=require("@babel/runtime-corejs3/core-js-stable/object/get-own-property-symbols")},function(e,t){e.exports=require("@babel/runtime-corejs3/core-js-stable/instance/concat")},function(e,t){e.exports=require("@babel/runtime-corejs3/helpers/esm/classPrivateFieldGet")},function(e,t){e.exports=require("mov.ai-core")},function(e,t){e.exports=require("@babel/runtime-corejs3/core-js-stable/object/define-property")},function(e,t){e.exports=require("@babel/runtime-corejs3/core-js-stable/object/define-properties")},function(e,t){e.exports=require("@babel/runtime-corejs3/core-js-stable/instance/reduce")},function(e,t){e.exports=require("@babel/runtime-corejs3/helpers/esm/toConsumableArray")},function(e,t){e.exports=require("@babel/runtime-corejs3/core-js-stable/instance/some")},function(e,t){e.exports=require("@material-ui/core/styles")},function(e,t){e.exports=require("@babel/runtime-corejs3/helpers/esm/slicedToArray")},function(e,t){e.exports=require("@babel/runtime-corejs3/regenerator")},function(e,t){e.exports=require("@babel/runtime-corejs3/core-js-stable/object/values")},function(e,t){e.exports=require("@babel/runtime-corejs3/core-js-stable/instance/includes")},function(e,t){e.exports=require("@babel/runtime-corejs3/core-js-stable/number/parse-float")},function(e,t){e.exports=require("@material-ui/core")},function(e,t){e.exports=require("@babel/runtime-corejs3/core-js-stable/set-timeout")},function(e,t){e.exports=require("@babel/runtime-corejs3/helpers/esm/asyncToGenerator")},function(e,t){e.exports=require("@babel/runtime-corejs3/helpers/esm/objectWithoutProperties")},function(e,t){e.exports=require("@babel/runtime-corejs3/core-js-stable/instance/splice")},function(e,t){e.exports=require("@material-ui/icons/ChevronRight")},function(e,t){e.exports=require("@material-ui/core/MenuItem")},function(e,t){e.exports=require("@material-ui/core/Typography")},function(e,t){e.exports=require("@material-ui/icons/Search")},function(e,t){e.exports=require("react-resize-detector")},function(e,t){e.exports=require("@babel/runtime-corejs3/core-js-stable/instance/every")},function(e,t){e.exports=require("@babel/runtime-corejs3/core-js-stable/promise")},function(e,t){e.exports=require("@babel/runtime-corejs3/core-js-stable/instance/fill")},function(e,t){e.exports=require("@babel/runtime-corejs3/core-js-stable/weak-map")},function(e,t){e.exports=require("@babel/runtime-corejs3/helpers/esm/classPrivateFieldSet")},function(e,t){e.exports=require("react-dom")},function(e,t){e.exports=require("@material-ui/icons/Clear")},function(e,t){e.exports=require("@babylonjs/gui/2D")},function(e,t){e.exports=require("rbush")},function(e,t){e.exports=require("@material-ui/core/Button")},function(e,t){e.exports=require("@material-ui/core/Drawer")},function(e,t){e.exports=require("@material-ui/icons/ExpandMore")},function(e,t){e.exports=require("@material-ui/core/Collapse")},function(e,t){e.exports=require("@material-ui/core/Menu")},function(e,t){e.exports=require("material-table")},function(e,t){e.exports=require("@material-ui/icons/AddBox")},function(e,t){e.exports=require("@material-ui/icons/ArrowDownward")},function(e,t){e.exports=require("@material-ui/icons/Check")},function(e,t){e.exports=require("@material-ui/icons/ChevronLeft")},function(e,t){e.exports=require("@material-ui/icons/DeleteOutline")},function(e,t){e.exports=require("@material-ui/icons/Edit")},function(e,t){e.exports=require("@material-ui/icons/FilterList")},function(e,t){e.exports=require("@material-ui/icons/FirstPage")},function(e,t){e.exports=require("@material-ui/icons/LastPage")},function(e,t){e.exports=require("@material-ui/icons/Remove")},function(e,t){e.exports=require("@material-ui/icons/SaveAlt")},function(e,t){e.exports=require("@material-ui/icons/ViewColumn")},function(e,t){e.exports=require("@material-ui/core/Tabs")},function(e,t){e.exports=require("@material-ui/core/Tab")},function(e,t){e.exports=require("@material-ui/core/TextField")},function(e,t){e.exports=require("@material-ui/core/FormControlLabel")},function(e,t){e.exports=require("@material-ui/core/Switch")},function(e,t){e.exports=require("@material-ui/core/InputBase")},function(e,t){e.exports=require("@material-ui/core/Breadcrumbs")},function(e,t){e.exports=require("@material-ui/icons/NavigateNext")},function(e,t){e.exports=require("@babel/runtime-corejs3/core-js-stable/instance/sort")},function(e,t){e.exports=require("@babel/runtime-corejs3/core-js-stable/math/sign")},function(e,t){e.exports=require("earcut")},function(e,t){e.exports=require("lodash.isequal")},function(e,t){e.exports=require("@babel/runtime-corejs3/core-js-stable/instance/slice")},function(e,t){e.exports=require("@babel/runtime-corejs3/core-js-stable/instance/find-index")},function(e,t){e.exports=require("@babylonjs/core/Maths/math")},function(e,t){e.exports=require("lodash")},function(e,t){e.exports=require("@material-ui/core/InputLabel")},function(e,t){e.exports=require("@material-ui/core/FormControl")},function(e,t){e.exports=require("@material-ui/core/Select")},function(e,t){e.exports=require("clsx")},function(e,t){e.exports=require("@material-ui/core/IconButton")},function(e,t){e.exports=require("@material-ui/core/utils")},function(e,t){e.exports=require("@material-ui/core/colors")},function(e,t){e.exports=require("@babylonjs/loaders")},function(e,t){e.exports=require("@material-ui/core/FormHelperText")},function(e,t,n){var o=n(98),r=n(99);"string"==typeof(r=r.__esModule?r.default:r)&&(r=[[e.i,r,""]]);var i={insert:"head",singleton:!1},a=(o(r,i),r.locals?r.locals:{});e.exports=a},function(e,t,n){"use strict";var o,r=function(){return void 0===o&&(o=Boolean(window&&document&&document.all&&!window.atob)),o},i=function(){var e={};return function(t){if(void 0===e[t]){var n=document.querySelector(t);if(window.HTMLIFrameElement&&n instanceof window.HTMLIFrameElement)try{n=n.contentDocument.head}catch(e){n=null}e[t]=n}return e[t]}}(),a=[];function l(e){for(var t=-1,n=0;n<a.length;n++)if(a[n].identifier===e){t=n;break}return t}function c(e,t){for(var n={},o=[],r=0;r<e.length;r++){var i=e[r],c=t.base?i[0]+t.base:i[0],u=n[c]||0,s="".concat(c," ").concat(u);n[c]=u+1;var f=l(s),d={css:i[1],media:i[2],sourceMap:i[3]};-1!==f?(a[f].references++,a[f].updater(d)):a.push({identifier:s,updater:v(d,t),references:1}),o.push(s)}return o}function u(e){var t=document.createElement("style"),o=e.attributes||{};if(void 0===o.nonce){var r=n.nc;r&&(o.nonce=r)}if(Object.keys(o).forEach((function(e){t.setAttribute(e,o[e])})),"function"==typeof e.insert)e.insert(t);else{var a=i(e.insert||"head");if(!a)throw new Error("Couldn't find a style target. This probably means that the value for the 'insert' parameter is invalid.");a.appendChild(t)}return t}var s,f=(s=[],function(e,t){return s[e]=t,s.filter(Boolean).join("\n")});function d(e,t,n,o){var r=n?"":o.media?"@media ".concat(o.media," {").concat(o.css,"}"):o.css;if(e.styleSheet)e.styleSheet.cssText=f(t,r);else{var i=document.createTextNode(r),a=e.childNodes;a[t]&&e.removeChild(a[t]),a.length?e.insertBefore(i,a[t]):e.appendChild(i)}}function h(e,t,n){var o=n.css,r=n.media,i=n.sourceMap;if(r?e.setAttribute("media",r):e.removeAttribute("media"),i&&btoa&&(o+="\n/*# sourceMappingURL=data:application/json;base64,".concat(btoa(unescape(encodeURIComponent(JSON.stringify(i))))," */")),e.styleSheet)e.styleSheet.cssText=o;else{for(;e.firstChild;)e.removeChild(e.firstChild);e.appendChild(document.createTextNode(o))}}var m=null,p=0;function v(e,t){var n,o,r;if(t.singleton){var i=p++;n=m||(m=u(t)),o=d.bind(null,n,i,!1),r=d.bind(null,n,i,!0)}else n=u(t),o=h.bind(null,n,t),r=function(){!function(e){if(null===e.parentNode)return!1;e.parentNode.removeChild(e)}(n)};return o(e),function(t){if(t){if(t.css===e.css&&t.media===e.media&&t.sourceMap===e.sourceMap)return;o(e=t)}else r()}}e.exports=function(e,t){(t=t||{}).singleton||"boolean"==typeof t.singleton||(t.singleton=r());var n=c(e=e||[],t);return function(e){if(e=e||[],"[object Array]"===Object.prototype.toString.call(e)){for(var o=0;o<n.length;o++){var r=l(n[o]);a[r].references--}for(var i=c(e,t),u=0;u<n.length;u++){var s=l(n[u]);0===a[s].references&&(a[s].updater(),a.splice(s,1))}n=i}}}},function(e,t,n){(t=n(100)(!1)).push([e.i,"body.react-confirm-alert-body-element {\n  overflow: hidden;\n}\n\n.react-confirm-alert-blur {\n  filter: url(#gaussian-blur);\n  filter: blur(2px);\n  -webkit-filter: blur(2px);\n}\n\n.react-confirm-alert-overlay {\n  position: fixed;\n  top: calc(100vh - 300px);\n  left: 0;\n  right: 0;\n  bottom: 0;\n  z-index: 99;\n  display: -webkit-flex;\n  display: -moz-flex;\n  display: -ms-flex;\n  display: -o-flex;\n  display: flex;\n  justify-content: flex-start;\n  -ms-align-items: center;\n  align-items: flex-end;\n  opacity: 1;\n}\n\n.react-confirm-alert-body {\n  width: 400px;\n  padding: 30px;\n}\n\n.react-confirm-alert-svg {\n  position: absolute;\n  top: 0;\n  left: 0;\n}\n\n.react-confirm-alert-body > h1 {\n  margin-top: 0;\n}\n\n.react-confirm-alert-body > h3 {\n  margin: 0;\n  font-size: 16px;\n}\n\n.react-confirm-alert-button-group {\n  display: -webkit-flex;\n  display: -moz-flex;\n  display: -ms-flex;\n  display: -o-flex;\n  display: flex;\n  justify-content: flex-start;\n  margin-top: 20px;\n}\n\n.react-confirm-alert-button-group > button {\n  outline: none;\n  background: #333;\n  border: none;\n  display: inline-block;\n  padding: 6px 18px;\n  color: #eee;\n  margin-right: 10px;\n  border-radius: 5px;\n  font-size: 12px;\n  cursor: pointer;\n}\n\n.icon-container {\n  display: flex;\n  justify-content: center;\n  align-items: center;\n}\n\n.icon-container:hover {\n  cursor: pointer;\n}\n",""]),e.exports=t},function(e,t,n){"use strict";e.exports=function(e){var t=[];return t.toString=function(){return this.map((function(t){var n=function(e,t){var n=e[1]||"",o=e[3];if(!o)return n;if(t&&"function"==typeof btoa){var r=(a=o,l=btoa(unescape(encodeURIComponent(JSON.stringify(a)))),c="sourceMappingURL=data:application/json;charset=utf-8;base64,".concat(l),"/*# ".concat(c," */")),i=o.sources.map((function(e){return"/*# sourceURL=".concat(o.sourceRoot||"").concat(e," */")}));return[n].concat(i).concat([r]).join("\n")}var a,l,c;return[n].join("\n")}(t,e);return t[2]?"@media ".concat(t[2]," {").concat(n,"}"):n})).join("")},t.i=function(e,n,o){"string"==typeof e&&(e=[[null,e,""]]);var r={};if(o)for(var i=0;i<this.length;i++){var a=this[i][0];null!=a&&(r[a]=!0)}for(var l=0;l<e.length;l++){var c=[].concat(e[l]);o&&r[c[0]]||(n&&(c[2]?c[2]="".concat(n," and ").concat(c[2]):c[2]=n),t.push(c))}},t}},function(e,t,n){"use strict";n.r(t),n.d(t,"Button",(function(){return s})),n.d(t,"AbstractModal",(function(){return D})),n.d(t,"Drawer",(function(){return O})),n.d(t,"Collapse",(function(){return H})),n.d(t,"VerticalBar",(function(){return ne})),n.d(t,"ContextMenu",(function(){return se})),n.d(t,"Table",(function(){return Ke})),n.d(t,"Tabs",(function(){return nt})),n.d(t,"Text",(function(){return at})),n.d(t,"Themes",(function(){return Ua})),n.d(t,"Toggle",(function(){return pt})),n.d(t,"SearchInput",(function(){return jt})),n.d(t,"Breadcrumb",(function(){return qt})),n.d(t,"SceneViewer",(function(){return va})),n.d(t,"Select",(function(){return Pa})),n.d(t,"snackbar",(function(){return La}));var o=n(3),r=n.n(o),i=n(54),a=n.n(i),l=n(7),c=n.n(l),u=function(e){return r.a.createElement(a.a,{className:e.className,style:e.style,onClick:e.onClick,color:e.color,variant:e.variant,size:e.size,startIcon:e.startIcon,disabled:e.disabled},e.children)};u.propTypes={style:c.a.object,onClick:c.a.func,color:c.a.string,variant:c.a.string,size:c.a.string,startIcon:c.a.element,children:c.a.node.isRequired,disabled:c.a.bool},u.defaultProps={style:{},onClick:function(){return console.log("Click MOV.AI button")},color:"default",variant:"contained",size:"medium",startIcon:void 0,children:r.a.createElement("div",null),disabled:!1};var s=u,f=n(24),d=n.n(f),h=n(25),m=n.n(h),p=n(18),v=n.n(p),g=n(1),y=n.n(g),b=n(19),M=n.n(b),x=n(16),k=n.n(x),C=n(20),w=n.n(C),P=n(17),E=n.n(P),S=n(0),N=n.n(S),A=n(35);function T(e,t){var n=E()(e);if(w.a){var o=w()(e);t&&(o=k()(o).call(o,(function(t){return M()(e,t).enumerable}))),n.push.apply(n,o)}return n}function V(e){for(var t=1;t<arguments.length;t++){var n,o=null!=arguments[t]?arguments[t]:{};if(t%2)y()(n=T(Object(o),!0)).call(n,(function(t){N()(e,t,o[t])}));else if(v.a)m()(e,v()(o));else{var r;y()(r=T(Object(o))).call(r,(function(t){d()(e,t,M()(o,t))}))}}return e}var I={margin:"auto",position:"absolute",overflow:"auto",display:"flex",flexDirection:"column"},B=function(e){var t=function(){e.onSubmit()},n=function(){e.onCancel()};return r.a.createElement(A.Modal,{onKeyPress:function(e){"Enter"===e.key&&t()},open:e.open,onClose:n,style:{display:"flex",alignItems:"center",justifyContent:"center"}},r.a.createElement(A.Card,{style:V({},I,{width:e.width,height:e.height,minWidth:"260px",minHeight:"280px"})},r.a.createElement(A.CardContent,{style:{flexGrow:1,display:"flex",flexDirection:"column",minHeight:0}},r.a.createElement(A.Typography,{variant:"h5",style:{padding:"12px 0px 12px 6px",fontWeight:600}},e.title),r.a.createElement("div",{style:{paddingLeft:"6px",flexGrow:1,overflow:"auto",minHeight:0}},e.children)),r.a.createElement(A.Divider,null),r.a.createElement(A.CardActions,{style:{alignSelf:"flex-end"}},r.a.createElement(s,{onClick:n,variant:"outlined",color:e.cancelColor},e.cancelText),r.a.createElement(s,{color:e.submitColor,onClick:t},e.submitText))))};B.propTypes={onSubmit:c.a.func,onCancel:c.a.func,open:c.a.bool,title:c.a.string,submitText:c.a.string,submitColor:c.a.string,cancelText:c.a.string,cancelColor:c.a.string,width:c.a.string,height:c.a.string},B.defaultProps={onSubmit:function(){},onCancel:function(){},open:!1,title:"New",submitText:"Confirm",submitColor:"primary",cancelText:"Cancel",cancelColor:"inherit",width:"25%",height:"25%"};var D=B,j=n(55),F=n.n(j),R=function(e){return r.a.createElement(F.a,{style:e.style,anchor:e.anchor,open:e.open,onClose:e.onClose},e.children)};R.propTypes={style:c.a.object,anchor:c.a.string,open:c.a.bool,children:c.a.object},R.defaultProps={style:{},anchor:"left",open:!1,children:r.a.createElement("div",null)},R.ANCHOR={left:"left",right:"right",top:"top",bottom:"bottom"};var O=R,_=n(30),L=n.n(_),z=n(40),q=n.n(z),U=n(56),G=n.n(U),K=n(57),Y=n.n(K);function W(e,t){var n=E()(e);if(w.a){var o=w()(e);t&&(o=k()(o).call(o,(function(t){return M()(e,t).enumerable}))),n.push.apply(n,o)}return n}function Q(e){for(var t=1;t<arguments.length;t++){var n,o=null!=arguments[t]?arguments[t]:{};if(t%2)y()(n=W(Object(o),!0)).call(n,(function(t){N()(e,t,o[t])}));else if(v.a)m()(e,v()(o));else{var r;y()(r=W(Object(o))).call(r,(function(t){d()(e,t,M()(o,t))}))}}return e}var Z=function(e){var t=r.a.useState(e.open),n=L()(t,2),o=n[0],i=n[1];r.a.useEffect((function(){e.open!==o&&i(e.open)}),[e.open]);var a;return r.a.createElement(A.List,null,r.a.createElement(A.ListItem,{button:!0,onClick:(a=e.onClick,function(){i(!o),a()})},o?r.a.createElement(G.a,{style:Q({},e.iconStyle)}):r.a.createElement(q.a,{style:Q({},e.iconStyle)}),r.a.createElement("div",{style:{width:"100%"}},e.item)),e.divided?r.a.createElement(A.Divider,null):[],r.a.createElement(Y.a,{className:e.className,style:e.style,in:o},e.children))};Z.propTypes={item:c.a.object,onClick:c.a.func,open:c.a.bool,divided:c.a.bool,iconStyle:c.a.object},Z.defaultProps={item:r.a.createElement("div",null),onClick:function(){},open:!1,divided:!1,style:{},iconStyle:{}};var H=Z,X=n(5),J=n.n(X),$=n(29),ee=Object($.makeStyles)((function(e){return{container:{height:"100%",backgroundColor:function(e){return e.backgroundColor},width:function(e){return e.width},display:"flex",flexDirection:"column"},logoArea:{padding:"17px",textAlign:"center",alignItems:"center",justifyContent:"center"},navigationArea:{flexGrow:1,display:"flex",flexDirection:"column",alignItems:"center"},accountArea:{padding:"17px",textAlign:"center",alignItems:"center",justifyContent:"center"}}})),te=function(e){var t,n=ee(e);return r.a.createElement("div",{className:n.container},r.a.createElement("div",{className:n.logoArea},e.upperElement),r.a.createElement("div",{className:n.navigationArea},J()(t=e.navigationList).call(t,(function(e,t){return r.a.createElement("div",{key:t,style:{padding:"15px 0px"}},e)}))),r.a.createElement("div",{className:n.accountArea},e.lowerElement))};te.propTypes={upperElement:c.a.node.isRequired,navigationList:c.a.array,lowerElement:c.a.node.isRequired,width:c.a.string,backgroundColor:c.a.string},te.defaultProps={upperElement:r.a.createElement("div",null),navigationList:[r.a.createElement("div",null)],lowerElement:r.a.createElement("div",null),width:"68px",backgroundColor:"#424242"};var ne=te,oe=n(26),re=n.n(oe),ie=n(58),ae=n.n(ie),le=n(41),ce=n.n(le),ue=function(e){var t,n=r.a.useState(null),o=L()(n,2),i=o[0],a=o[1],l=function(){a(null)};return r.a.createElement("div",null,r.a.cloneElement(e.element,{onClick:function(t){void 0!==e.element.props.onClick&&e.element.props.onClick(),a(t.currentTarget)}}),r.a.createElement(ae.a,{id:"simple-menu",anchorEl:i,keepMounted:!0,open:Boolean(i),onClose:l},re()(t=e.menuList).call(t,(function(e,t,n){return console.log("item",t),t&&"function"!=typeof t&&e.push(r.a.createElement(ce.a,{onClick:function(){t.onClick(),(t.onClose||void 0===t.onClose)&&l()},key:n},t.element)),e}),[])))};ue.propTypes={element:c.a.node.isRequired,navigationList:c.a.array,lowerElement:c.a.node.isRequired,width:c.a.string,backgroundColor:c.a.string},ue.defaultProps={element:r.a.createElement("div",null,"Ahaha"),menuList:[{onClick:function(){return console.log("clicked 1")},element:"Profile",onClose:!0}],lowerElement:r.a.createElement("div",null),width:"68px",backgroundColor:"#424242"};var se=ue,fe=n(12),de=n.n(fe),he=n(59),me=n.n(he),pe=n(60),ve=n.n(pe),ge=n(61),ye=n.n(ge),be=n(62),Me=n.n(be),xe=n(63),ke=n.n(xe),Ce=n(51),we=n.n(Ce),Pe=n(64),Ee=n.n(Pe),Se=n(65),Ne=n.n(Se),Ae=n(66),Te=n.n(Ae),Ve=n(67),Ie=n.n(Ve),Be=n(68),De=n.n(Be),je=n(69),Fe=n.n(je),Re=n(70),Oe=n.n(Re),_e=n(43),Le=n.n(_e),ze=n(71),qe=n.n(ze),Ue={Add:Object(o.forwardRef)((function(e,t){return r.a.createElement(ve.a,de()({},e,{ref:t}))})),Check:Object(o.forwardRef)((function(e,t){return r.a.createElement(Me.a,de()({},e,{ref:t}))})),Clear:Object(o.forwardRef)((function(e,t){return r.a.createElement(we.a,de()({},e,{ref:t}))})),Delete:Object(o.forwardRef)((function(e,t){return r.a.createElement(Ee.a,de()({},e,{ref:t}))})),DetailPanel:Object(o.forwardRef)((function(e,t){return r.a.createElement(q.a,de()({},e,{ref:t}))})),Edit:Object(o.forwardRef)((function(e,t){return r.a.createElement(Ne.a,de()({},e,{ref:t}))})),Export:Object(o.forwardRef)((function(e,t){return r.a.createElement(Oe.a,de()({},e,{ref:t}))})),Filter:Object(o.forwardRef)((function(e,t){return r.a.createElement(Te.a,de()({},e,{ref:t}))})),FirstPage:Object(o.forwardRef)((function(e,t){return r.a.createElement(Ie.a,de()({},e,{ref:t}))})),LastPage:Object(o.forwardRef)((function(e,t){return r.a.createElement(De.a,de()({},e,{ref:t}))})),NextPage:Object(o.forwardRef)((function(e,t){return r.a.createElement(q.a,de()({},e,{ref:t}))})),PreviousPage:Object(o.forwardRef)((function(e,t){return r.a.createElement(ke.a,de()({},e,{ref:t}))})),ResetSearch:Object(o.forwardRef)((function(e,t){return r.a.createElement(we.a,de()({},e,{ref:t}))})),Search:Object(o.forwardRef)((function(e,t){return r.a.createElement(Le.a,de()({},e,{ref:t}))})),SortArrow:Object(o.forwardRef)((function(e,t){return r.a.createElement(ye.a,de()({},e,{ref:t}))})),ThirdStateCheck:Object(o.forwardRef)((function(e,t){return r.a.createElement(Fe.a,de()({},e,{ref:t}))})),ViewColumn:Object(o.forwardRef)((function(e,t){return r.a.createElement(qe.a,de()({},e,{ref:t}))}))},Ge=function(e){return r.a.createElement(me.a,{style:e.style,title:e.title,columns:e.columns,data:e.data,icons:Ue,actions:e.actions,options:e.options,components:e.components,localization:e.localization})};Ge.propTypes={style:c.a.object,title:c.a.string,columns:c.a.array,data:c.a.array,actions:c.a.array,options:c.a.object,components:c.a.object,localization:c.a.object},Ge.defaultProps={style:{},title:"",columns:[],data:[],actions:[],options:{actionsColumnIndex:-1,draggable:!1,grouping:!1,search:!1,toolbar:!1,searchFieldAlignment:"left",paging:!1},components:{}};var Ke=Ge,Ye=n(38),We=n.n(Ye),Qe=n(72),Ze=n.n(Qe),He=n(73),Xe=n.n(He),Je=n(42),$e=n.n(Je);function et(e){var t=e.children,n=e.selectedTab,o=e.index,i=We()(e,["children","selectedTab","index"]);return r.a.createElement($e.a,de()({component:"div",role:"tabpanel",hidden:n!==o,id:"tabpanel-".concat(o),"aria-labelledby":"tab-".concat(o)},i),n===o&&t)}et.propTypes={children:c.a.node,index:c.a.any.isRequired,selectedTab:c.a.any.isRequired};var tt=Object($.makeStyles)((function(e){return{root:{flexGrow:1,height:"100%"},tabPanel:{flexGrow:1,minHeight:0,height:"calc(100% - 48px)",overflowY:"auto"}}}));function nt(e){var t,n,o=tt(),i=r.a.useState(e.selectedTab),a=L()(i,2),l=a[0],c=a[1];r.a.useEffect((function(){e.selectedTab!==l&&c(e.selectedTab)}),[e.selectedTab]);return r.a.createElement("div",{className:o.root},r.a.createElement(Ze.a,{value:l,onChange:function(e,t){c(t)},indicatorColor:"primary",textColor:"primary"},J()(t=e.tabList).call(t,(function(e,t){return r.a.createElement(Xe.a,de()({key:t,label:e.label},function(e){return{id:"tab-".concat(e),"aria-controls":"tabpanel-".concat(e)}}(t)))}))),J()(n=e.tabList).call(n,(function(t,n){return r.a.createElement(et,{key:n,selectedTab:l,index:n,className:e.scrollable?o.tabPanel:void 0},t.component)})))}nt.propTypes={tabList:c.a.array,selectedTab:c.a.number,scrollable:c.a.bool},nt.defaultProps={tabList:[{label:"Tab 1",component:r.a.createElement("div",null,"Component 1")},{label:"Tab 2",component:r.a.createElement("div",null,"Lorem Ipsum is simply dummy text of the printing and typesetting industry. Lorem Ipsum has been the industry standard dummy text ever since the 1500s, when an unknown printer took a galley of type and scrambled it to make a type specimen book. It has survived not only five centuries, but also the leap into electronic typesetting, remaining essentially unchanged. It was popularised in the 1960s with the release of Letraset sheets containing Lorem Ipsum passages, and more recently with desktop publishing software like Aldus PageMaker including versions of Lorem Ipsum.")},{label:"Tab 3",component:r.a.createElement("div",null,"Component 3")}],selectedTab:0,scrollable:!0};var ot=n(74),rt=n.n(ot),it=function(e){return r.a.createElement(rt.a,e)};it.propTypes={},it.defaultProps={};var at=it,lt=n(75),ct=n.n(lt),ut=n(76),st=n.n(ut);n(94);function ft(e,t){var n=E()(e);if(w.a){var o=w()(e);t&&(o=k()(o).call(o,(function(t){return M()(e,t).enumerable}))),n.push.apply(n,o)}return n}function dt(e){for(var t=1;t<arguments.length;t++){var n,o=null!=arguments[t]?arguments[t]:{};if(t%2)y()(n=ft(Object(o),!0)).call(n,(function(t){N()(e,t,o[t])}));else if(v.a)m()(e,v()(o));else{var r;y()(r=ft(Object(o))).call(r,(function(t){d()(e,t,M()(o,t))}))}}return e}var ht=Object($.makeStyles)((function(e){return{label:{fontFamily:"Roboto",fontStyle:"normal",fontWeight:"normal",fontSize:"16px",marginLeft:0,marginRight:0}}})),mt=function(e){var t=ht();return r.a.createElement(ct.a,{control:r.a.createElement(st.a,{checked:e.toggle,onChange:e.onToggle,color:e.color,disabled:e.disabled,hidden:e.hidden}),labelPlacement:e.labelPlacement,label:e.label,classes:{label:t.label},style:dt({},e.style,{marginLeft:0,marginRight:0})})};mt.propTypes={toggle:c.a.bool,onToggle:c.a.func,label:c.a.string,color:c.a.string,labelPlacement:c.a.string,style:c.a.object},mt.defaultProps={color:"primary"};var pt=mt,vt=n(36),gt=n.n(vt),yt=n(21),bt=n.n(yt),Mt=n(8),xt=n.n(Mt),kt=n(9),Ct=n.n(kt),wt=n(11),Pt=n.n(wt),Et=n(10),St=n.n(Et),Nt=n(4),At=n.n(Nt),Tt=n(14),Vt=n.n(Tt),It=n(77),Bt=n.n(It),Dt=function(e){function t(){var e,n,o;xt()(this,t);for(var r=arguments.length,i=new Array(r),a=0;a<r;a++)i[a]=arguments[a];return o=Pt()(this,(e=St()(t)).call.apply(e,bt()(n=[this]).call(n,i))),N()(At()(o),"searchInput",void 0),N()(At()(o),"timer",void 0),N()(At()(o),"handleChange",(function(e){o.searchInput=e.target.value,o.props.enableTimeout?(o.timer&&clearTimeout(o.timer),o.timer=gt()(o.handleSearch,o.props.time)):o.handleSearch()})),N()(At()(o),"handleSearch",(function(){void 0!==o.searchInput&&o.props.onChange(o.searchInput)})),o}return Vt()(t,e),Ct()(t,[{key:"render",value:function(){var e=this.props,t=e.classes,n=e.style,o=e.placeholder;return r.a.createElement("div",{className:t.search,style:n},r.a.createElement("div",{className:t.searchIcon},r.a.createElement(Le.a,null)),r.a.createElement(Bt.a,{ref:this.setSearchInput,placeholder:o,classes:{root:t.inputRoot,input:t.inputInput},inputProps:{"aria-label":"search"},onChange:this.handleChange}))}}]),t}(o.Component);Dt.propTypes={placeholder:c.a.string,onChange:c.a.func,time:c.a.number,enableTimeout:c.a.bool,style:c.a.object},Dt.defaultProps={placeholder:"Search...",onChange:function(e){console.log(e)},time:250,enableTimeout:!0,style:{}};var jt=Object($.withStyles)((function(e){return{search:N()({position:"relative",borderRadius:e.shape.borderRadius,backgroundColor:Object($.fade)(e.palette.common.white,.15),"&:hover":{backgroundColor:Object($.fade)(e.palette.common.white,.25)},marginRight:e.spacing(2),marginLeft:0,width:"100%"},e.breakpoints.up("sm"),{marginLeft:e.spacing(3),width:"auto"}),searchIcon:{width:e.spacing(7),height:"100%",position:"absolute",pointerEvents:"none",display:"flex",alignItems:"center",justifyContent:"center"},inputRoot:{color:"inherit"},inputInput:N()({padding:e.spacing(1,1,1,7),transition:e.transitions.create("width"),width:"100%"},e.breakpoints.up("md"),{width:200})}}),{withTheme:!0})(Dt),Ft=n(78),Rt=n.n(Ft),Ot=n(79),_t=n.n(Ot),Lt=Object($.makeStyles)((function(e){return{root:{"& > * + *":{marginTop:e.spacing(2)}},link:{fontSize:"24px",fontWeight:800,fontFamily:"Avenir","&:hover":{cursor:"pointer",textDecoration:"underline"}},lastLabel:{fontSize:"24px",fontWeight:800,fontFamily:"Avenir"}}})),zt=function(e){var t,n=Lt();return r.a.createElement("div",{className:n.root},r.a.createElement(Rt.a,{separator:r.a.createElement(_t.a,{fontSize:"small"}),"aria-label":"breadcrumb",style:e.style},J()(t=e.pathList).call(t,(function(t,o){if(e.pathList.length-1!==o)return r.a.createElement($e.a,{key:o,color:"primary",variant:"inherit",className:n.link,onClick:t.function},t.label)})),r.a.createElement($e.a,{color:"textPrimary",className:n.lastLabel},e.pathList[e.pathList.length-1].label)))};zt.propTypes={pathList:c.a.array},zt.defaultProps={pathList:[{label:"Mov.ai",function:function(){return console.log("pth1/")}},{label:"User",function:function(){return console.log("path1/path2")}},{label:"John Doe"}]};var qt=zt,Ut=n(15),Gt=n.n(Ut),Kt=n(28),Yt=n.n(Kt),Wt=n(32),Qt=n.n(Wt),Zt=n(27),Ht=n.n(Zt),Xt=n(2),Jt=n(44),$t=n.n(Jt);function en(e,t){var n=E()(e);if(w.a){var o=w()(e);t&&(o=k()(o).call(o,(function(t){return M()(e,t).enumerable}))),n.push.apply(n,o)}return n}function tn(e){for(var t=1;t<arguments.length;t++){var n,o=null!=arguments[t]?arguments[t]:{};if(t%2)y()(n=en(Object(o),!0)).call(n,(function(t){N()(e,t,o[t])}));else if(v.a)m()(e,v()(o));else{var r;y()(r=en(Object(o))).call(r,(function(t){d()(e,t,M()(o,t))}))}}return e}var nn={display:"flex",flexDirection:"column",flexGrow:1},on=function(e){var t=Object(o.useRef)(null),n=e.antialias,i=e.engineOptions,a=e.adaptToDeviceRatio,l=e.sceneOptions,c=e.onRender,u=(e.onSceneReady,e.is2render),s=e.sceneFactory,f=We()(e,["antialias","engineOptions","adaptToDeviceRatio","sceneOptions","onRender","onSceneReady","is2render","sceneFactory"]),d=Object(o.useState)(!1),h=L()(d,2),m=h[0],p=h[1],v=Object(o.useState)(null),g=L()(v,2),y=g[0],b=g[1],M=Object(o.useState)({width:100,height:100}),x=L()(M,2),k=x[0],C=x[1];Object(o.useEffect)((function(){if(!m){p(!0);var o=new Xt.Engine(t.current,n,i,a),r=s?s(o):new Xt.Scene(o,l);if(b(r),r.isReady()?e.onSceneReady(r):r.onReadyObservable.addOnce((function(t){return e.onSceneReady(t)})),!u)return;o.runRenderLoop((function(){"function"==typeof c&&c(r),r.render()}))}return function(){null!==y&&y.dispose()}}),[t]);return m&&t.current.focus(),r.a.createElement("div",{style:tn({},nn)},r.a.createElement("canvas",de()({ref:t,width:k.width,height:k.height},f)),r.a.createElement($t.a,{handleWidth:!0,handleHeight:!0,onResize:function(e,t){C({width:e,height:t}),y&&y.getEngine().resize()}}))};on.propTypes={antialias:c.a.bool,engineOptions:c.a.object,adaptToDeviceRatio:c.a.bool,sceneOptions:c.a.object,onSceneReady:c.a.func,onRender:c.a.func,is2render:c.a.bool,sceneFactory:c.a.func},on.defaultProps={antialias:!0,onSceneReady:function(e){},is2render:!0};var rn=on,an=n(6),ln=n(80),cn=n.n(ln),un=n(13),sn=n.n(un),fn=function(){function e(t,n,o){xt()(this,e);for(var r=[t,n,o],i=0;i<r.length;i++)if(r[i].constructor!==Array||r[i].length<3)throw"One of the inputs is not a array";this.mat3=J()(r).call(r,(function(e){return new hn(e)}))}return Ct()(e,[{key:"prodVec",value:function(e){for(var t=new hn([0,0,0]),n=0;n<this.mat3.length;n++)t=t.add(this.mat3[n].scale(e.vec3[n]));return t}},{key:"dotVec",value:function(e){for(var t=[0,0,0],n=0;n<this.mat3.length;n++)t[n]=this.mat3[n].dot(e);return new hn(t)}},{key:"prod",value:function(t){var n=this.prodVec(t.mat3[0]),o=this.prodVec(t.mat3[1]),r=this.prodVec(t.mat3[2]);return new e(n.vec3,o.vec3,r.vec3)}},{key:"dot",value:function(t){var n=this.dotVec(t.mat3[0]),o=this.dotVec(t.mat3[1]),r=this.dotVec(t.mat3[2]);return new e(n.vec3,o.vec3,r.vec3)}},{key:"map",value:function(t){var n,o,r,i=J()(n=this.mat3[0]).call(n,t),a=J()(o=this.mat3[1]).call(o,t),l=J()(r=this.mat3[2]).call(r,t);return new e(i.vec3,a.vec3,l.vec3)}},{key:"equals",value:function(e){var t,n;return e.constructor===this.constructor&&re()(t=J()(n=this.mat3).call(n,(function(t,n){return t.equals(e.mat3[n])}))).call(t,(function(e,t){return e&&t}),!0)}}],[{key:"ofBabylonMatrix",value:function(t){var n=Xt.Matrix.GetAsMatrix3x3(t);return new e([n[0],n[1],n[2]],[n[3],n[4],n[5]],[n[6],n[7],n[8]])}},{key:"of",value:function(t,n,o){return new e(t,n,o)}},{key:"eye",value:function(){return new e([1,0,0],[0,1,0],[0,0,1])}}]),e}(),dn=function(){function e(t){var n=this;if(xt()(this,e),N()(this,"normalize",(function(){var e=n.length();if(0===e)throw"You can't normalize a zero norm vector";return n.scale(1/e)})),t.constructor!==Array||t.length<3)throw"".concat(t," is not a valid 3-vector");this.vec3=Ht()(t)}return Ct()(e,[{key:"getX",value:function(){return this.vec3[0]}},{key:"getY",value:function(){return this.vec3[1]}},{key:"getZ",value:function(){return this.vec3[2]}},{key:"add",value:function(e){return this.binaryOp(e,(function(e,t){return e+t}))}},{key:"sub",value:function(e){return this.binaryOp(e,(function(e,t){return e-t}))}},{key:"mul",value:function(e){return this.binaryOp(e,(function(e,t){return e*t}))}},{key:"binaryOp",value:function(t,n){var o=[];return o[0]=n(this.vec3[0],t.vec3[0]),o[1]=n(this.vec3[1],t.vec3[1]),o[2]=n(this.vec3[2],t.vec3[2]),new e(o)}},{key:"scale",value:function(e){var t;return J()(t=this).call(t,(function(t){return t*e}))}},{key:"dot",value:function(e){return this.vec3[0]*e.vec3[0]+this.vec3[1]*e.vec3[1]+this.vec3[2]*e.vec3[2]}},{key:"map",value:function(t){var n;return new e(J()(n=this.vec3).call(n,t))}},{key:"length",value:function(){return Math.sqrt(this.dot(this))}},{key:"toBabylon",value:function(){return new Xt.Vector3(this.vec3[0],this.vec3[1],this.vec3[2])}},{key:"toArray",value:function(){return this.vec3}},{key:"equals",value:function(e){var t,n;return e.constructor===this.constructor&&re()(t=J()(n=e.vec3).call(n,(function(t,n){return e.vec3[n]===t}))).call(t,(function(e,t){return e&&t}),!0)}},{key:"reduce",value:function(e,t){var n;return re()(n=this.vec3).call(n,e,t)}},{key:"getMax",value:function(){var e;return re()(e=this).call(e,(function(e,t){return Math.max(e,t)}),-Number.MAX_VALUE)}},{key:"getMin",value:function(){var e;return re()(e=this).call(e,(function(e,t){return Math.min(e,t)}),Number.MAX_VALUE)}}],[{key:"ofBabylon",value:function(t){return new e([t.x,t.y,t.z])}},{key:"of",value:function(t){return new e(t||[0,0,0])}},{key:"random",value:function(){var t;return new e(J()(t=[1,2,3]).call(t,Math.random()))}},{key:"orthogonalBasisFromVector",value:function(e){for(var t=fn.eye(),n=0,o=0;o<3;o++)if(0!=e.vec3[o]){n=o;break}var r=t.mat3[(n+1)%3].add(t.mat3[n].scale(-e.vec3[(n+1)%3]/e.vec3[n]));r=r.normalize();var i=t.mat3[(n+2)%3].add(t.mat3[n].scale(-e.vec3[(n+2)%3]/e.vec3[n]));return i=(i=i.normalize()).sub(r.scale(r.dot(i))),{u:e.normalize(),v:r,w:i.normalize()}}}]),e}();N()(dn,"ONES",dn.of([1,1,1])),N()(dn,"ZERO",dn.of([0,0,0]));var hn=dn,mn=n(23),pn=n(33),vn=n.n(pn),gn=function(){function e(){var t=this;if(xt()(this,e),N()(this,"getAnnotations",(function(){return t.annotations})),yn)return yn;yn=this,this.annotations={},this.observers=[],this.retrieveAnnotationsFromDb()}return Ct()(e,[{key:"pushObserver",value:function(e){this.observers.push(e)}},{key:"retrieveAnnotationsFromDb",value:function(){var e=this;mn.MasterDB.subscribe({Scope:"Annotation",Name:"*"},(function(t){var n;console.log("Annotation update",t);var o={del:function(t){return e.delAnnotation(t)},set:function(t){return e.addAnnotation(t)}},r=t.key.Annotation;o[t.event](r),y()(n=e.observers).call(n,(function(t){return t(e)}))}),(function(t){console.log("Annotation start",t);var n=t.value.Annotation;e.addAnnotation(n)}))}},{key:"delAnnotation",value:function(e){var t,n,o=this;if(e){var r=re()(t=E()(e)).call(t,(function(e,t){return e.push(t),e}),[]);y()(n=E()(this.annotations)).call(n,(function(e){var t,n,i=o.annotations[e];i.names=k()(t=i.names).call(t,(function(e){return!vn()(r).call(r,e)})),i.labels=k()(n=i.labels).call(n,(function(e){return!vn()(r).call(r,e)}))}))}}},{key:"addAnnotation",value:function(e){var t,n=this;e&&y()(t=E()(e)).call(t,(function(t){var o=e[t];if(o.Type){var r=o.Type.toLowerCase(),i=o.Label;r in n.annotations||(n.annotations[r]={names:[],labels:[]}),n.annotations[r].names.push(t),n.annotations[r].labels.push(i||t)}}))}}],[{key:"getInstance",value:function(){return new e}},{key:"getAnnotations",value:function(){return e.getInstance().getAnnotations()}}]),e}(),yn=null,bn=gn,Mn=function(){function e(){xt()(this,e)}return Ct()(e,null,[{key:"copy",value:function(e){mn.Clipboard.write("scene",e)}},{key:"paste",value:function(){return mn.Clipboard.read("scene")}}]),e}();function xn(e,t){var n=E()(e);if(w.a){var o=w()(e);t&&(o=k()(o).call(o,(function(t){return M()(e,t).enumerable}))),n.push.apply(n,o)}return n}function kn(e){for(var t=1;t<arguments.length;t++){var n,o=null!=arguments[t]?arguments[t]:{};if(t%2)y()(n=xn(Object(o),!0)).call(n,(function(t){N()(e,t,o[t])}));else if(v.a)m()(e,v()(o));else{var r;y()(r=xn(Object(o))).call(r,(function(t){d()(e,t,M()(o,t))}))}}return e}var Cn=mn.Utils.capitalize,wn=function(){function e(t){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};xt()(this,e),N()(this,"getType",(function(){return e.TYPE})),this.name=t.name,this.mesh=t,this.mesh.getMouseContextActions=this.getMouseContextActions,this.mesh.nodeItem=this,this.keyValueMap=n,bn.getInstance()}return Ct()(e,[{key:"dispose",value:function(){this.mesh.dispose()}},{key:"toDict",value:function(){var e,t,n=this;return{name:this.name,type:this.getType(),position:hn.ofBabylon(this.mesh.position).toArray(),quaternion:J()(e=an.Maybe.fromNull(this.mesh.rotationQuaternion)).call(e,(function(e){return[e.w,e.x,e.y,e.z]})).orLazy((function(){var e=Xt.Quaternion.RotationYawPitchRoll(n.mesh.rotation.y,n.mesh.rotation.x,n.mesh.rotation.z);return[e.w,e.x,e.y,e.z]})),color:Gt()(t=an.Maybe.fromNull(this.mesh.material)).call(t,(function(e){var t;return J()(t=an.Maybe.fromNull(e.diffuseColor)).call(t,(function(e){return[e.r,e.g,e.b]}))})).orSome([0,0,0]),keyValueMap:this.keyValueMap,isVisible:this.mesh.isEnabled()}}},{key:"toForm",value:function(){var t=this.toDict(),n=new Xt.Color3(t.color[0],t.color[1],t.color[2]),o={jsonSchema:{type:"object",properties:{oldName:{type:"string"},name:{type:"string",title:"Name"},type:{type:"string",title:"Type"},position:{type:"object",title:"Position",properties:{x:{type:"number",title:"x"},y:{type:"number",title:"y"},z:{type:"number",title:"z"}}},quaternion:{type:"object",title:"Orientation",properties:{w:{type:"number",title:"w"},x:{type:"number",title:"x"},y:{type:"number",title:"y"},z:{type:"number",title:"z"}}},color:{type:"string",title:"Color"}}},uiSchema:{type:{"ui:disabled":!0},color:{"ui:widget":"color"},oldName:{"ui:widget":"hidden"},position:{"ui:widget":"collapse"},quaternion:{"ui:widget":"collapse"}},data:{oldName:t.name,name:t.name,type:t.type,position:{x:t.position[0],y:t.position[1],z:t.position[2]},quaternion:{w:t.quaternion[0],x:t.quaternion[1],y:t.quaternion[2],z:t.quaternion[3]},color:n.toHexString()}};return e.setAnnotations2Form(o,this.keyValueMap),o}},{key:"ofForm",value:function(e){var t,n,o=this;this.name=e.name,this.mesh.name=e.name,y()(t=an.Maybe.fromNull(e.position)).call(t,(function(e){o.mesh.position=new Xt.Vector3(e.x,e.y,e.z)})),y()(n=an.Maybe.fromNull(e.quaternion)).call(n,(function(e){o.mesh.rotationQuaternion=new Xt.Quaternion(e.x,e.y,e.z,e.w).normalize()})),this.mesh.material&&(this.mesh.material.diffuseColor=Xt.Color3.FromHexString(e.color),this.mesh.material.emissiveColor=Xt.Color3.FromHexString(e.color)),this.keyValueMap=kn({},e.annotations)}},{key:"getMouseContextActions",value:function(e){var t=this;return[{title:"Copy",onClick:function(){return Mn.copy((function(e,n){var o;return y()(o=n.getSceneMemory()).call(o,(function(o){var r=o.scene,i=n.getRootNode().item,a=t.nodeItem,l=a.toDict();l.name+="*";var c=hn.ofBabylon(e).toArray();c[2]=l.position[2],l.position=c;var u=a.ofDict(r,l,n);u.mesh.parent=i.mesh,n.addNodeItem2Tree(u)}))}))}},{title:"Delete",onClick:function(){return e.deleteNodeFromTreeUsingName(t.name)}}]}}],[{key:"mapDict2Mesh",value:function(e,t){var n;if(!t)throw"can't map a null mesh";return y()(n=an.Maybe.fromNull(e)).call(n,(function(n){var o,r,i,a;y()(o=an.Maybe.fromNull(e.name)).call(o,(function(e){return t.name=e})),y()(r=an.Maybe.fromNull(n.position)).call(r,(function(e){return t.position=hn.of(e).toBabylon()})),y()(i=an.Maybe.fromNull(n.quaternion)).call(i,(function(e){var n=new Xt.Quaternion(e[1],e[2],e[3],e[0]);t.rotationQuaternion=n.normalize()})),y()(a=an.Maybe.fromNull(n.color)).call(a,(function(e){var n,o=new Xt.Color3(e[0],e[1],e[2]);y()(n=an.Maybe.fromNull(t.material)).call(n,(function(e){var n,r;y()(n=an.Maybe.fromNull(e.diffuseColor)).call(n,(function(e){return t.material.diffuseColor=o})),y()(r=an.Maybe.fromNull(e.emissiveColor)).call(r,(function(e){return t.material.emissiveColor=o}))}))}))})),t}},{key:"setAnnotations2Form",value:function(e){var t,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};e.jsonSchema.properties.annotations={title:"Annotations",type:"object",properties:{}},e.uiSchema.annotations={"ui:widget":"collapse"},e.data.annotations=kn({},n);var o=bn.getAnnotations();y()(t=E()(o)).call(t,(function(t){o[t].labels.length>0&&(e.jsonSchema.properties.annotations.properties[t]={title:Cn(t),type:"string",enumNames:o[t].labels,enum:o[t].names})}))}}]),e}();N()(wn,"TYPE","NodeItem");var Pn=wn,En=n(81),Sn=n.n(En),Nn=function(){function e(t){xt()(this,e),this._scene=t,this._isPosition=!1,this._isRotation=!1,this._isBoundingBox=!1,this._isScale=!1,this._usePointerToAttachGizmos=!1}return Ct()(e,[{key:"isPosition",value:function(e){return this._isPosition=e,this}},{key:"isRotation",value:function(e){return this._isRotation=e,this}},{key:"isBoundingBox",value:function(e){return this._isBoundingBox=e,this}},{key:"isScale",value:function(e){return this._isScale=e,this}},{key:"usePointerToAttachGizmos",value:function(e){return this._usePointerToAttachGizmos=e,this}},{key:"build",value:function(){var e=new Xt.GizmoManager(this._scene);return e.positionGizmoEnabled=this._isPosition,e.rotationGizmoEnabled=this._isRotation,e.boundingBoxGizmoEnabled=this._isBoundingBox,e.scaleGizmoEnabled=this._isScale,e.usePointerToAttachGizmos=this._usePointerToAttachGizmos,e}}]),e}(),An=function(){function e(t){xt()(this,e),this._scene=t,this._sphericalCoordinates=null,this._target=null,this._name="camera".concat(Math.floor(1e3*Math.random()))}return Ct()(e,[{key:"name",value:function(e){return this._name=e,this}},{key:"sphericalCoordinates",value:function(e){return this._sphericalCoordinates=e,this}},{key:"target",value:function(e){return this._target=e,this}},{key:"build",value:function(){var e=Qt()(this);return y()(e).call(e,(function(e){if(null===e)throw"There are missing variables to build a camera, e.g ".concat(e)})),new Xt.ArcRotateCamera(this._name,this._sphericalCoordinates.x,this._sphericalCoordinates.y,this._sphericalCoordinates.z,this._target,this._scene)}}]),e}(),Tn=function(){function e(t){xt()(this,e),this._scene=t,this._position=null,this._name="light".concat(Math.floor(1e3*Math.random())),this._intensity=1}return Ct()(e,[{key:"position",value:function(e){return this._position=e,this}},{key:"name",value:function(e){return this._name=e,this}},{key:"intensity",value:function(e){return this._intensity=e,this}},{key:"build",value:function(){var e=Qt()(this);y()(e).call(e,(function(e){if(null===e)throw"There are missing variables to build a light, e.g ".concat(e)}));var t=new Xt.PointLight(this._name,this._position,this._scene);return t.intensity=this._intensity,t}}]),e}(),Vn=function(){function e(t){xt()(this,e),this._scene=t,this._name="referential".concat(Math.floor(1e3*Math.random())),this._isPickable=!0,this._boxParams={isVisible:!0,size:.25},this._size=1}return Ct()(e,[{key:"name",value:function(e){return this._name=e,this}},{key:"isPickable",value:function(e){return this._isPickable=e,this}},{key:"boxParams",value:function(e){return this._boxParams=e,this}},{key:"size",value:function(e){return this._size=e,this}},{key:"build",value:function(){var e=this._size,t=Xt.Mesh.CreateLines("axisX".concat(this._name),[new Xt.Vector3.Zero,new Xt.Vector3(e,0,0),new Xt.Vector3(.95*e,.05*e,0),new Xt.Vector3(e,0,0),new Xt.Vector3(.95*e,-.05*e,0)],this._scene);t.color=new Xt.Color3(1,0,0),t.isPickable=!1;var n=Xt.Mesh.CreateLines("axisY".concat(this._name),[new Xt.Vector3.Zero,new Xt.Vector3(0,e,0),new Xt.Vector3(-.05*e,.95*e,0),new Xt.Vector3(0,e,0),new Xt.Vector3(.05*e,.95*e,0)],this._scene);n.color=new Xt.Color3(0,1,0),n.isPickable=!1;var o=Xt.Mesh.CreateLines("axisZ".concat(this._name),[new Xt.Vector3.Zero,new Xt.Vector3(0,0,e),new Xt.Vector3(0,-.05*e,.95*e),new Xt.Vector3(0,0,e),new Xt.Vector3(0,.05*e,.95*e)],this._scene);o.color=new Xt.Color3(0,0,1),o.isPickable=!1;var r=Xt.MeshBuilder.CreateBox(this._name,{size:this._boxParams.size},this._scene);return r.isVisible=this._boxParams.isVisible,r.isPickable=this._isPickable,t.parent=r,n.parent=r,o.parent=r,r}}]),e}(),In=function(){function e(t){xt()(this,e),this._scene=t,this._name="camera".concat(Math.floor(1e3*Math.random())),this._width=1,this._height=1,this._textureSrc=null,this._isPickable=!1}return Ct()(e,[{key:"name",value:function(e){return this._name=e,this}},{key:"width",value:function(e){return this._width=e,this}},{key:"height",value:function(e){return this._height=e,this}},{key:"textureSrc",value:function(e){return this._textureSrc=e,this}},{key:"isPickable",value:function(e){return this._isPickable=e,this}},{key:"build",value:function(){var e=Xt.Mesh.CreateGround(this._name,this._width,this._height,1,this._scene);return e.translate(new Xt.Vector3(0,-1,0),.1,Xt.Space.WORLD),this._textureSrc&&(e.material=new Xt.StandardMaterial("Texture".concat(this._name),this._scene),e.material.ambientTexture=new Xt.Texture(this._textureSrc,this._scene),e.material.ambientTexture.uScale=1,e.material.ambientTexture.vScale=1),e.isPickable=this._isPickable,e}}]),e}(),Bn=function(){function e(t){xt()(this,e),this._scene=t,this._direction=null,this._name="Dlight".concat(Math.floor(1e3*Math.random())),this._intensity=1}return Ct()(e,[{key:"direction",value:function(e){return this._direction=e,this}},{key:"name",value:function(e){return this._name=e,this}},{key:"intensity",value:function(e){return this._intensity=e,this}},{key:"build",value:function(){var e=Qt()(this);y()(e).call(e,(function(e){if(null===e)throw"There are missing variables to build a light, e.g ".concat(e)}));var t=new Xt.DirectionalLight(this._name,this._direction.normalize(),this._scene);return t.intensity=this._intensity,t}}]),e}(),Dn=function(e){function t(e){var n,o=arguments.length>1&&void 0!==arguments[1]?arguments[1]:t.DEFAULT_SIZE,r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};return xt()(this,t),n=Pt()(this,St()(t).call(this,e,r)),N()(At()(n),"getType",(function(){return t.TYPE})),n.size=o,n}return Vt()(t,e),Ct()(t,[{key:"toDict",value:function(){var e=sn()(St()(t.prototype),"toDict",this).call(this);return e.size=this.size,e}},{key:"ofDict",value:function(e){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,o=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;return t.ofDict(e,n,o)}}],[{key:"ofDict",value:function(e){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,o=(arguments.length>2&&void 0!==arguments[2]&&arguments[2],an.Maybe.fromNull(n)),r=Gt()(o).call(o,(function(e){return an.Maybe.fromNull(e.size)})).orSome(t.DEFAULT_SIZE),i=Gt()(o).call(o,(function(e){return an.Maybe.fromNull(e.name)})).orSome("Box".concat(Math.floor(1e3*Math.random()))),a=Gt()(o).call(o,(function(e){return an.Maybe.fromNull(e.keyValueMap)})).orUndefined(),l=_n.createBox(e,new Xt.Color3(Math.random(),Math.random(),Math.random()),r,i);return Pn.mapDict2Mesh(n,l),new t(l,r,a)}}]),t}(Pn);N()(Dn,"DEFAULT_SIZE",.5),N()(Dn,"TYPE","Box");var jn=Dn,Fn=n(82),Rn=function(){function e(){xt()(this,e)}return Ct()(e,null,[{key:"getWorldCoordinates",value:function(t,n){if(t.parent&&t.parent.name===Un.NAME)return hn.ofBabylon(n);var o=t.parent,r=hn.ofBabylon(o.position),i=e.getRotationMatrix(o),a=hn.ofBabylon(o.scaling);return i.prodVec(a.mul(e.getWorldCoordinates(t.parent,n))).add(r)}},{key:"getBabylonCoordinates",value:function(e){return Un.forwardCoordinates(e)}},{key:"getLocalCoordinatesFromWorld",value:function(t,n){if(t.parent&&t.parent.name===Un.NAME)return hn.ofBabylon(n);var o=t.parent,r=hn.ofBabylon(o.position),i=e.getRotationMatrix(o),a=hn.ofBabylon(o.scaling);return J()(a).call(a,(function(e){return 1/e})).mul(i.dotVec(e.getLocalCoordinatesFromWorld(o,n).sub(r)))}},{key:"computeLocalCoordinatesFromMesh",value:function(t,n){if(!t.parent)return n;var o=t.parent,r=hn.ofBabylon(o.position),i=e.getRotationMatrix(o),a=hn.ofBabylon(o.scaling);return J()(a).call(a,(function(e){return 1/e})).mul(i.dotVec(e.computeLocalCoordinatesFromMesh(o,n).sub(r)))}},{key:"getRotationMatrix",value:function(e){var t=new Xt.Matrix,n=an.Maybe.fromNull(e.rotationQuaternion);return y()(n).call(n,(function(e){return e.toRotationMatrix(t)})),n.orElseRun((function(){Xt.Quaternion.RotationYawPitchRoll(e.rotation.y,e.rotation.x,e.rotation.z).toRotationMatrix(t)})),fn.ofBabylonMatrix(t)}},{key:"showNormals",value:function(e,t){for(var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1,o=arguments.length>3&&void 0!==arguments[3]?arguments[3]:Xt.Color3.Red(),r=t.getVerticesData(Xt.VertexBuffer.NormalKind),i=t.getVerticesData(Xt.VertexBuffer.PositionKind),a=[],l=0;l<r.length;l+=3){var c=Xt.Vector3.FromArray(i,l),u=c.add(Xt.Vector3.FromArray(r,l).scaleInPlace(n));a.push([c.add(t.position),u.add(t.position)])}var s=Xt.MeshBuilder.CreateLineSystem("normalLines",{lines:a},e);return s.color=o,s.parent=t,s}},{key:"orthogonalBasisFromVector",value:function(e){for(var t=[new Xt.Vector3(1,0,0),new Xt.Vector3(0,1,0),new Xt.Vector3(0,0,1)],n=[e.x,e.y,e.z],o=0,r=0;r<3;r++)if(0!=n[r]){o=r;break}var i=t[(o+1)%3].add(t[o].scale(-n[(o+1)%3]/n[o]));i=i.normalize();var a=t[(o+2)%3].add(t[o].scale(-n[(o+2)%3]/n[o]));return a=(a=a.normalize()).subtract(i.scale(Xt.Vector3.Dot(i,a))),{u:Xt.Vector3.FromArray(n).normalize(),v:i,w:a.normalize()}}},{key:"cameraBuilder",value:function(e){return new An(e)}},{key:"guizoManagerBuilder",value:function(e){return new Nn(e)}},{key:"meshFromPositionAndFaces",value:function(e,t,n,o){var r=!(arguments.length>4&&void 0!==arguments[4])||arguments[4],i=new Xt.VertexData;i.positions=Gt()(n).call(n,(function(e){return[e.x,e.y,e.z]})),i.indices=Gt()(o).call(o,(function(e){return e}));var a=new Xt.Mesh(e,t);return i.applyToMesh(a,r),a}},{key:"triangulatePolygon",value:function(e){for(var t,n=Fn(Gt()(t=J()(e).call(e,(function(e){return[e.x,e.y,e.z]}))).call(t,(function(e){return e})),null,3),o=n.length/3,r=[],i=0;i<o;i++){var a=3*i;r.push([n[a],n[a+1],n[a+2]])}return r}},{key:"computeOrientation",value:function(e){var t=e.length,n=J()(e).call(e,(function(e){return hn.ofBabylon(e)})),o=0;return y()(n).call(n,(function(e,r){var i=n[(r+1)%t].sub(n[r]);o+=hn.of([-e.getY(),e.getX(),e.getZ()]).dot(i)})),o/2}},{key:"pointAverage",value:function(e){return e&&0!=e.length?re()(e).call(e,(function(e,t){return e.add(t)}),Xt.Vector3.Zero()).scale(1/e.length):Xt.Vector3.Zero()}},{key:"pointAverageVec3",value:function(e){return e&&0!=e.length?re()(e).call(e,(function(e,t){return e.add(t)}),hn.ZERO).scale(1/e.length):hn.ZERO}},{key:"randomVector3",value:function(e,t){var n;return new Xt.Vector3.FromArray(J()(n=[0,0,0]).call(n,(function(n){return e+(t-e)*Math.random()})))}},{key:"getMaterialFromColor",value:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"MaterialFromColor".concat(On()),o=new Xt.StandardMaterial(n,t);return o.diffuseColor=e,o.emissiveColor=e,o}}]),e}();N()(Rn,"createOrientedCone",(function(e){for(var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:new Xt.Vector3(1,0,0),n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:Xt.Color3.Gray(),o=arguments.length>3&&void 0!==arguments[3]?arguments[3]:"OrientedCone".concat(On()),r=!(arguments.length>4&&void 0!==arguments[4])||arguments[4],i=arguments.length>5&&void 0!==arguments[5]?arguments[5]:16,a={positions:[],faces:[]},l=t.length()/3,c=Rn.orthogonalBasisFromVector(t),u=c.v,s=c.w,f=Sn()(Xt.Vector3.Dot(Xt.Vector3.Cross(u,s),t)),d=0;d<i;d++){var h=f*(2*Math.PI/i)*d;a.positions.push(u.scale(l*Math.cos(h)).add(s.scale(l*Math.sin(h))))}a.positions.push(Xt.Vector3.Zero()),a.positions.push(t);for(var m=a.positions.length-1,p=a.positions.length-2,v=0;v<i;v++)a.faces.push([m,(v+1)%i,v]),a.faces.push([p,v,(v+1)%i]);var g=Rn.meshFromPositionAndFaces(o,e,a.positions,a.faces);g.convertToFlatShadedMesh();var y=new Xt.StandardMaterial("OrientedConeMaterial".concat(o),e);return y.diffuseColor=n,y.emissiveColor=n,g.material=y,g.isPickable=r,g})),N()(Rn,"createSphere",(function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:Xt.Color3.Gray(),n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1,o=arguments.length>3&&void 0!==arguments[3]?arguments[3]:"Sphere".concat(On()),r=!(arguments.length>4&&void 0!==arguments[4])||arguments[4],i=Xt.Mesh.CreateSphere(o,16,n,e),a=Rn.getMaterialFromColor(t,e,"SphereMaterial".concat(o));return i.material=a,i.isPickable=r,i})),N()(Rn,"createBox",(function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:Xt.Color3.Gray(),n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:jn.DEFAULT_SIZE,o=arguments.length>3&&void 0!==arguments[3]?arguments[3]:"Box".concat(On()),r=!(arguments.length>4&&void 0!==arguments[4])||arguments[4],i=Xt.Mesh.CreateBox(o,n,e),a=new Xt.StandardMaterial("BoxMaterial".concat(o),e);return a.diffuseColor=t,a.emissiveColor=t,i.material=a,i.isPickable=r,i})),N()(Rn,"createTubeFromPoints",(function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:Xt.Color3.Gray(),o=arguments.length>3&&void 0!==arguments[3]?arguments[3]:1,r=arguments.length>4&&void 0!==arguments[4]?arguments[4]:"Tube".concat(On()),i=!(arguments.length>5&&void 0!==arguments[5])||arguments[5],a=Xt.MeshBuilder.CreateTube(r,{path:t,radius:o,sideOrientation:Xt.Mesh.DOUBLESIDE,updatable:!0},e);return a.material=Rn.getMaterialFromColor(n,e,"Material".concat(r)),a.isPickable=i,a})),N()(Rn,"positionalLightBuilder",(function(e){return new Tn(e)})),N()(Rn,"directionalLightBuilder",(function(e){return new Bn(e)})),N()(Rn,"referentialBuilder",(function(e){return new Vn(e)})),N()(Rn,"getGroundPosition",(function(e,t){var n=e.pick(e.pointerX,e.pointerY,(function(e){return e===t}));return n.hit?Yt()(an.Maybe).call(an.Maybe,n.pickedPoint):an.Maybe.none()})),N()(Rn,"pickMesh",(function(e,t){var n=e.pick(e.pointerX,e.pointerY,(function(e){return e!==t&&e.isEnabled()}));return n.hit&&n.pickedMesh.isPickable?Yt()(an.Maybe).call(an.Maybe,n.pickedMesh):an.Maybe.none()})),N()(Rn,"groundBuilder",(function(e){return new In(e)})),N()(Rn,"piecewiseCurveDistance",(function(e){for(var t=0,n=0;n<e.length-1;n++){t+=e[n+1].subtract(e[n]).length()}return t})),N()(Rn,"getCurveOrientations",(function(e){for(var t=[],n=0;n<e.length-1;n++){var o=e[n+1].subtract(e[n]);t.push(Math.atan2(o.y,o.x))}return t.push(t[t.length-1]),t})),N()(Rn,"getSplineFromCurve",(function(e){var t=Math.ceil(e.length);return{points:Xt.Curve3.CreateCatmullRomSpline(e,t,!1).getPoints()}})),N()(Rn,"splineObj2redis",(function(e){var t,n=Rn.getCurveOrientations(e.points);return J()(t=e.points).call(t,(function(e,t){return[e.x,e.y,n[t]]}))}));var On=function(){return Math.floor(1e3*Math.random())},_n=Rn,Ln=-Math.PI/2,zn={position:[0,0,0],scaling:[1,-1,1],quaternion:[Math.cos(Ln/2),Math.sin(Ln/2),0,0]},qn=function(e){function t(e){var n,o=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return xt()(this,t),n=Pt()(this,St()(t).call(this,e,o)),N()(At()(n),"getType",(function(){return t.TYPE})),n}return Vt()(t,e),Ct()(t,[{key:"toForm",value:function(){var e=sn()(St()(t.prototype),"toForm",this).call(this);return e.uiSchema.name={"ui:disabled":!0},e}},{key:"getMouseContextActions",value:function(){return[]}}],[{key:"ofDict",value:function(e){var n,o=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,r=(arguments.length>2&&void 0!==arguments[2]&&arguments[2],t.getRosOrigin(e)),i=_n.referentialBuilder(e).name(t.NAME).isPickable(!0).boxParams({isVisible:!0,size:.25}).build();return i.parent=r,Pn.mapDict2Mesh(o,i),new t(i,Gt()(n=an.Maybe.fromNull(o)).call(n,(function(e){return an.Maybe.fromNull(e.keyValueMap)})).orUndefined())}},{key:"getRosOrigin",value:function(e){var t=Xt.MeshBuilder.CreateBox("ROS_ORIGIN",{size:.001},e);t.isVisible=!1,t.isPickable=!1,t.position=hn.of(zn.position).toBabylon(),t.scaling=hn.of(zn.scaling).toBabylon();var n=new Xt.Quaternion(zn.quaternion[1],zn.quaternion[2],zn.quaternion[3],zn.quaternion[0]);return t.rotationQuaternion=n.normalize(),t}},{key:"inverseCoordinates",value:function(e){var t,n=zn.quaternion,o=_n.getRotationMatrix({rotationQuaternion:new Xt.Quaternion(n[1],n[2],n[3],n[0])}),r=J()(t=hn.of(zn.scaling)).call(t,(function(e){return 1/e})),i=hn.of(zn.position),a=r.mul(o.dotVec(hn.ofBabylon(e).sub(i)));return J()(a).call(a,(function(e){return Math.abs(e)<1e-5?0:e})).toBabylon()}},{key:"forwardCoordinates",value:function(e){var t=zn.quaternion,n=_n.getRotationMatrix({rotationQuaternion:new Xt.Quaternion(t[1],t[2],t[3],t[0])}),o=hn.of(zn.scaling),r=hn.of(zn.position),i=n.prodVec(o.mul(hn.ofBabylon(e))).add(r);return J()(i).call(i,(function(e){return Math.abs(e)<1e-5?0:e})).toBabylon()}}]),t}(Pn);N()(qn,"TYPE","GlobalRef"),N()(qn,"NAME","Global ref");var Un=qn,Gn=function(e){function t(e,n){var o;return xt()(this,t),o=Pt()(this,St()(t).call(this,e,n)),N()(At()(o),"getType",(function(){return t.TYPE})),o}return Vt()(t,e),Ct()(t,[{key:"ofDict",value:function(e){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,o=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;return t.ofDict(e,n,o)}}],[{key:"ofDict",value:function(e){var n,o=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,r=(arguments.length>2&&void 0!==arguments[2]&&arguments[2],J()(n=an.Maybe.fromNull(o)).call(n,(function(e){return e.name})).orSome("KeyPoint".concat(Math.floor(1e3*Math.random())))),i=Xt.MeshBuilder.CreatePolyhedron(r,{custom:Kn,size:t.DEFAULT_SIZE},e),a=new Xt.StandardMaterial("KeyPointMaterial".concat(r),e);i.material=a,i.convertToFlatShadedMesh();var l=_n.referentialBuilder(e).isPickable(!1).boxParams({isVisible:!1,size:.1*t.DEFAULT_SIZE}).name("".concat(r,"Axis")).build();return l.parent=i,Pn.mapDict2Mesh(o,i),new t(i,o.keyValueMap)}}]),t}(Pn);N()(Gn,"TYPE","KeyPoint"),N()(Gn,"DEFAULT_SIZE",.25);var Kn={name:"Triangular Antiprism (Octahedron)",category:["Antiprism"],vertex:[[0,0,1.414214],[1.414214,0,0],[0,1.414214,0],[-1.414214,0,0],[0,-1.414214,0],[0,0,-1.414214]],face:[[0,1,2],[0,2,3],[0,3,4],[0,4,1],[1,4,5],[1,5,2],[2,5,3],[3,5,4]]},Yn=Gn,Wn=n(39),Qn=n.n(Wn),Zn=n(34),Hn=n.n(Zn),Xn={RADIUS:.4,POINTS_DENSITY:2,CLOUD_FUNCTION_NAME:"backend.viewer"};function Jn(e,t){var n=E()(e);if(w.a){var o=w()(e);t&&(o=k()(o).call(o,(function(t){return M()(e,t).enumerable}))),n.push.apply(n,o)}return n}function $n(e){for(var t=1;t<arguments.length;t++){var n,o=null!=arguments[t]?arguments[t]:{};if(t%2)y()(n=Jn(Object(o),!0)).call(n,(function(t){N()(e,t,o[t])}));else if(v.a)m()(e,v()(o));else{var r;y()(r=Jn(Object(o))).call(r,(function(t){d()(e,t,M()(o,t))}))}}return e}var eo=Xn.RADIUS,to=function(e){function t(e,n,o,r){var i,a=arguments.length>4&&void 0!==arguments[4]?arguments[4]:{};return xt()(this,t),i=Pt()(this,St()(t).call(this,e,a)),N()(At()(i),"getType",(function(){return t.TYPE})),i.localPath=n,i.keyPoints=o,i.splinePath=r,i.selectedKeyPointIndex=-1,i}return Vt()(t,e),Ct()(t,[{key:"toDict",value:function(){var e=sn()(St()(t.prototype),"toDict",this).call(this);return e.localPath=this.localPath,e.splinePath=this.splinePath,e}},{key:"toForm",value:function(){var e=sn()(St()(t.prototype),"toForm",this).call(this);if(this.selectedKeyPointIndex>=0){e.jsonSchema.properties.selectedKeyPoint={type:"object",title:"KeyPoint ".concat(this.selectedKeyPointIndex),properties:{x:{type:"number",title:"x"},y:{type:"number",title:"y"},z:{type:"number",title:"z"}}},e.uiSchema.selectedKeyPoint={"ui:widget":"collapse"},e.uiSchema.position={"ui:widget":"hidden"},e.uiSchema.quaternion={"ui:widget":"hidden"},e.uiSchema.color={"ui:widget":"hidden"},e.uiSchema.annotations={"ui:widget":"hidden"};var n=this.keyPoints[this.selectedKeyPointIndex],o=_n.getWorldCoordinates(n,n.position).toArray();return e.data.selectedKeyPoint={x:o[0],y:o[1],z:o[2]},e}return e}},{key:"ofForm",value:function(e){if(sn()(St()(t.prototype),"ofForm",this).call(this,e),this.selectedKeyPointIndex>=0){var n,o=this.keyPoints[this.selectedKeyPointIndex],r=e.selectedKeyPoint,i=Xt.Vector3.FromArray(J()(n=[r.x,r.y,r.z]).call(n,Hn.a)),a=_n.getLocalCoordinatesFromWorld(o,i).toArray();o.position=new Xt.Vector3(a[0],a[1],a[2]),o.observers.notifyObservers({updatedPointMesh:o,is2updateServer:!1})}}},{key:"ofDict",value:function(e){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,o=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;return t.ofDict(e,n,o)}}],[{key:"ofDict",value:function(e){var n,o,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;if(!r||!i)throw"null dictionary describing path or null mainView";var a=r.name,l=J()(n=r.localPath).call(n,(function(e){return hn.of(e).toBabylon()})),c=_n.getSplineFromCurve(l),u=c.points,s=null;(s=1===u.length?Xt.MeshBuilder.CreateLines(a,{points:u,updatable:!0},e):_n.createTubeFromPoints(e,u,Xt.Color3.Gray(),eo/8,a)).position=hn.of(r.position).toBabylon(),s.material=_n.getMaterialFromColor(Xt.Color3.FromArray(r.color),e,"PathMaterial".concat(a)),s.rotationQuaternion=J()(o=an.Maybe.fromNull(r.quaternion)).call(o,(function(e){return new Xt.Quaternion(e[1],e[2],e[3],e[0]).normalize()})).orSome(Xt.Quaternion.Identity());var f=_n.splineObj2redis(c),d=uo(e,$n({},r,{mesh:s,splinePath:f}),i),h=new t(s,J()(l).call(l,(function(e){return[e.x,e.y,e.z]})),d,f,r.keyValueMap);return s.onClick=oo(i,h),h}}]),t}(Pn);N()(to,"TYPE","Path");var no=to,oo=function(e,t){return function(){var n;e.closeContextDial(),y()(n=e.getNodeFromTree(t.name)).call(n,(function(e){return e.item.selectedKeyPointIndex=-1}))}};function ro(e,t,n,o){var r,i,a=Ht()(n._children),l=J()(r=o.splinePath).call(r,(function(e){return new Xt.Vector3(e[0],e[1],0)}));return y()(a).call(a,(function(e){e.parent=o.mesh})),J()(i=o.keyPoints).call(i,(function(t,r){var i,a;(t.index=r,t.name=bt()(i="".concat(n.name,"keyPointSpline")).call(i,r),t.position=hn.of(o.localPath[r]).toBabylon(),t.rotationQuaternion=Xt.Quaternion.Identity(),r>0&&r<o.keyPoints.length-1)&&(y()(a=t._children).call(a,(function(e){return e.dispose()})),so(e,t.material.diffuseColor,o.mesh,r,l,t.position)().parent=t);return t}))}function io(e,t,n,o,r){var i=arguments.length>5&&void 0!==arguments[5]?arguments[5]:ro,a=_n.pointAverage(e);e=J()(e).call(e,(function(e){return e.subtract(a)}));var l=_n.getSplineFromCurve(e),c=_n.createTubeFromPoints(t,l.points,Xt.Color3.Gray(),eo/8,n.name);return c.position=n.position,c.rotationQuaternion=n.rotationQuaternion,c.locallyTranslate(a),c.material=n.material,c.visibility=n.visibility,c.parent=n.parent,c.onClick=n.onClick,o.localPath=J()(e).call(e,(function(e){return hn.ofBabylon(e).toArray()})),o.splinePath=_n.splineObj2redis(l),o.mesh=c,o.keyPoints=i(t,r,n,o),n.dispose(),e}function ao(e,t,n,o){return uo(e,o,t)}var lo=function(e,t,n,o){var r,i=t.index,a=t.parent.name;y()(r=n.getNodeFromTree(a)).call(r,(function(t){var r,l,c=i+o,u=t.item,s=u.localPath.length,f=u.mesh,d=[],h=J()(r=u.localPath).call(r,(function(e){return hn.of(e).toBabylon()}));if(c<0)d=bt()(l=[h[0].scale(3).subtract(h[1]).scale(.5)]).call(l,h);else if(c>s-1)d=bt()(h).call(h,[h[s-1].scale(3).subtract(h[s-2]).scale(.5)]);else{for(var m=i+Math.max(0,o),p=0;p<m;p++)d.push(h[p]);d.push(h[c].add(h[i]).scale(.5));for(var v=m;v<s;v++)d.push(h[v])}io(d,e,f,u,n,ao),n.updateNodeInServer(a)}))},co=function(e,t,n){var o,i=[];return y()(o=n.getNodeFromTree(t.parent.name)).call(o,(function(n){2!==n.item.localPath.length&&i.push({icon:function(e){return r.a.createElement("i",de()({className:"fas fa-trash"},e))},action:function(n){!function(e,t,n){var o,r=t.index,i=t.parent.name;y()(o=n.getNodeFromTree(i)).call(o,(function(t){var o,a,l=t.item,c=l.mesh,u=J()(o=l.localPath).call(o,(function(e){return hn.of(e).toBabylon()}));Qn()(u).call(u,r,1),Qn()(a=l.keyPoints).call(a,r,1)[0].dispose(),io(u,e,c,l,n,ao),n.updateNodeInServer(i)}))}(e,t,n),n.closeContextDial()},name:"Delete node [DEL]"}),i.push({icon:function(e){return r.a.createElement("i",de()({className:"fas fa-less-than"},e))},action:function(n){lo(e,t,n,-1),n.closeContextDial()},name:"Add previous"}),i.push({icon:function(e){return r.a.createElement("i",de()({className:"fas fa-greater-than"},e))},action:function(n){lo(e,t,n,1),n.closeContextDial()},name:"Add next"})})),i},uo=function(e,t,n){var o,r,i=new Xt.Color3(.25,.25,.25),a=[],l=J()(o=t.localPath).call(o,(function(e){return hn.of(e).toBabylon()})),c=J()(r=t.splinePath).call(r,(function(e){return new Xt.Vector3(e[0],e[1],0)})),u=t.mesh;return y()(l).call(l,(function(t,o){var r,s,f=fo(e,i,u,o),d=0===o||o===l.length-1?f():(r=so(e,i,u,o,c,t)(),(s=fo(e,i,u,o)()).visibility=.1,r.parent=s,s);d.parent=u,d.position=t,d.index=o,d.observers=new Xt.Observable,a.push(d),d.observers.add(function(e,t){return function(n){var o,r=n.updatedPointMesh,i=n.is2updateServer;r.parent&&y()(o=t.getNodeFromTree(r.parent.name)).call(o,(function(n){var o,a,l=r.index,c=n.item,u=c.mesh,s=J()(o=c.localPath).call(o,(function(e){return hn.of(e).toBabylon()}));(s[l]=r.position,io(s,e,u,c,t),l>0&&l<s.length-1&&t.highlightMeshInScene([c.keyPoints[l]._children[0]]),i)&&(t.updateNodeInServer(u.name),y()(a=t.getNodeFromTree(u.name)).call(a,(function(e){e.item.selectedKeyPointIndex=l,t.setProperties(e.item.toForm())})))}))}}(e,n))})),y()(a).call(a,(function(t){t.onClick=function(){n.setContextActions(co(e,t,n))}})),a};function so(e,t,n,o,r,i){return function(){var a,l,c=re()(a=J()(r).call(r,(function(e){return i.subtract(e).length()}))).call(a,(function(e,t,n){return e.value<t?e:{value:t,index:n}}),{value:Number.MAX_VALUE,index:-1}).index,u=r[c+1].subtract(r[c]).normalize().scale(eo);return _n.createOrientedCone(e,u,t,bt()(l="".concat(n.name,"keyPointCone")).call(l,o),!1)}}function fo(e,t,n,o){return function(){var r;return _n.createSphere(e,t,eo,bt()(r="".concat(n.name,"keyPointSpline")).call(r,o),!0)}}var ho=function(e){function t(e,n,o){var r,i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{},a=arguments.length>4&&void 0!==arguments[4]?arguments[4]:{};return xt()(this,t),r=Pt()(this,St()(t).call(this,e,a)),N()(At()(r),"getType",(function(){return t.TYPE})),r.localWall=n,r.size=o,r.keyPoints=i,r}return Vt()(t,e),Ct()(t,[{key:"toDict",value:function(){var e=sn()(St()(t.prototype),"toDict",this).call(this);return e.localWall=this.localWall,e.size=this.size,e}},{key:"ofDict",value:function(e){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,o=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;return t.ofDict(e,n,o)}}],[{key:"ofDict",value:function(e){var n,o=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;if(!o)throw"null dictionary describing wall";var i=an.Maybe.fromNull(o.name).orSome("Wall".concat(Math.floor(1e3*Math.random()))),a=vo(o,i,e),l=new Xt.StandardMaterial("WallMaterial".concat(i),e),c=new Xt.Color3(o.color[0],o.color[1],o.color[2]);l.diffuseColor=c,l.emissiveColor=c,a.material=l,a.position.z+=.001;var u=yo(e,J()(n=o.localWall).call(n,(function(e){return hn.of(e).toBabylon()})),a,r);return new t(a,o.localWall,o.size,u,o.keyValueMap)}}]),t}(Pn);N()(ho,"TYPE","Wall");var mo=Xn.RADIUS,po=[[0,1,2],[2,3,0],[4,6,5],[6,4,7],[0,5,1],[5,0,4],[3,2,6],[6,7,3],[1,6,2],[6,1,5],[0,3,7],[7,4,0]];function vo(e,t,n){var o,r=J()(o=e.localWall).call(o,(function(e){return hn.of(e).toBabylon()})),i=hn.of(e.position).toBabylon(),a=r[1].subtract(r[0]).normalize(),l=new Xt.Vector3(-a.y,a.x,0),c=[r[0].add(l.scale(e.size.width)),r[0].subtract(l.scale(e.size.width)),r[1].subtract(l.scale(e.size.width)),r[1].add(l.scale(e.size.width))],u=new Xt.Vector3(0,0,e.size.height),s={positions:[c[0],c[1],c[2],c[3],c[0].add(u),c[1].add(u),c[2].add(u),c[3].add(u)],faces:po},f=_n.meshFromPositionAndFaces(t,n,s.positions,s.faces);return f.position=i,f}var go=function(e,t){return function(n){var o,r=n.updatedPointMesh,i=n.is2updateServer;y()(o=e.getNodeFromTree(r.parent.name)).call(o,(function(n){var o=r.index,a=n.item,l=a.mesh,c={position:hn.ofBabylon(l.position).toArray(),localWall:a.localWall,size:a.size};c.localWall[o]=hn.ofBabylon(r.position).toArray(),function(e,t,n,o){var r,i,a,l=_n.pointAverageVec3(J()(r=e.localWall).call(r,(function(e){return hn.of(e)})));e.position=l.toArray(),e.localWall=J()(i=e.localWall).call(i,(function(e){return hn.of(e).sub(l).toArray()}));var c=vo(e,n.name,t);c.position=n.position,c.rotationQuaternion=n.rotationQuaternion,c.locallyTranslate(l.toBabylon()),c.material=n.material,c.visibility=n.visibility,c.parent=n.parent,o.mesh=c,o.localWall=e.localWall;var u=Ht()(n._children);y()(u).call(u,(function(e){n.removeChild(e),e.parent=c})),y()(a=o.keyPoints).call(a,(function(t,n){t.position=hn.of(e.localWall[n]).toBabylon()})),n.dispose()}(c,t,l,a),i&&e.updateNodeInServer(l.name)}))}},yo=function(e,t,n,o){var r=[];return y()(t).call(t,(function(t,i){var a,l=_n.createSphere(e,new Xt.Color3(.25,.25,.25),mo,bt()(a="".concat(n.name,"keyPointWall")).call(a,i),!0);l.parent=n,l.position=t,l.index=i,l.observers=new Xt.Observable,l.observers.add(go(o,e)),r.push(l)})),r},bo=ho,Mo=n(83),xo=n.n(Mo),ko=function(e){function t(e,n,o){var r,i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{};return xt()(this,t),r=Pt()(this,St()(t).call(this,e,i)),N()(At()(r),"getType",(function(){return t.TYPE})),r.corners=n,r.keyPoints=o,r}return Vt()(t,e),Ct()(t,[{key:"toDict",value:function(){var e=sn()(St()(t.prototype),"toDict",this).call(this);return e.corners=this.corners,e}},{key:"toForm",value:function(){var e,n,o=sn()(St()(t.prototype),"toForm",this).call(this);o.jsonSchema.properties.dimensions={type:"object",title:"Dimensions",properties:{lower:{type:"object",title:"Lower Corner",properties:{x:{type:"number",title:"x"},y:{type:"number",title:"y"}}},size:{type:"object",title:"Size",properties:{scaleX:{type:"number",title:"scale-X"},scaleY:{type:"number",title:"scale-Y"}}}}},o.uiSchema.dimensions={"ui:widget":"collapse"};var r=J()(e=J()(n=this.keyPoints).call(n,(function(e){return _n.getWorldCoordinates(e,e.position)}))).call(e,(function(e){return e.toArray()}));return o.data.dimensions={lower:{x:r[0][0],y:r[0][1]},size:{scaleX:this.corners[1][0]-this.corners[0][0],scaleY:this.corners[1][1]-this.corners[0][1]}},o}},{key:"ofForm",value:function(e){var n=this.toForm().data.dimensions;xo()(n,e.dimensions)?sn()(St()(t.prototype),"ofForm",this).call(this,e):this.ofFormDimensions(e)}},{key:"ofDict",value:function(e){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,o=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;return t.ofDict(e,n,o)}},{key:"ofFormDimensions",value:function(e){var t,n,o=this,r=Xt.Vector3.FromArray(J()(t=[e.dimensions.lower.x,e.dimensions.lower.y,0]).call(t,Hn.a)),i=J()(n=[e.dimensions.size.scaleX,e.dimensions.size.scaleY]).call(n,Hn.a),a=_n.getLocalCoordinatesFromWorld(this.keyPoints[0],r).toArray(),l=function(e){return o.keyPoints[e].observers.notifyObservers({updatedPointMesh:o.keyPoints[e],is2updateServer:!1})};this.keyPoints[0].position=new Xt.Vector3(a[0],a[1],this.keyPoints[0].position.z),l(0),this.keyPoints[1].position=new Xt.Vector3(a[0]+i[0],a[1]+i[1],this.keyPoints[1].position.z),l(1)}}],[{key:"ofDict",value:function(e){var n,o,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;if(!r)throw"null dictionary describing Box region";var a=an.Maybe.fromNull(r.name).orSome("BoxRegion".concat(Math.floor(1e3*Math.random()))),l=Po(r,a,e),c=new Xt.StandardMaterial("BoxRegionMaterial".concat(a),e),u=new Xt.Color3(r.color[0],r.color[1],r.color[2]);c.diffuseColor=u,c.emissiveColor=u,c.backFaceCulling=!1,l.material=c,l.visibility=.25,y()(n=an.Maybe.fromNull(r.quaternion)).call(n,(function(e){var t=new Xt.Quaternion(e[1],e[2],e[3],e[0]);l.rotationQuaternion=t.normalize()}));var s=So(e,J()(o=r.corners).call(o,(function(e){return hn.of(e).toBabylon()})),l,i);return new t(l,r.corners,s,r.keyValueMap)}}]),t}(Pn);N()(ko,"TYPE","BoxRegion");var Co=Xn.RADIUS,wo=[[0,1,2],[2,3,0],[4,5,6],[6,7,4],[0,1,5],[5,4,0],[3,2,6],[6,7,3],[1,2,6],[6,5,1],[0,3,7],[7,4,0]];function Po(e,t,n){var o,r=J()(o=e.corners).call(o,(function(e){return hn.of(e).toBabylon()})),i=r[1].subtract(r[0]),a=hn.of(e.position).toBabylon(),l=[r[0],r[0].add(Xt.Axis.X.scale(i.x)),r[0].add(new Xt.Vector3(i.x,i.y,0)),r[0].add(Xt.Axis.Y.scale(i.y))],c=new Xt.Vector3(0,0,i.z),u={positions:[l[0],l[1],l[2],l[3],l[0].add(c),l[1].add(c),l[2].add(c),l[3].add(c)],faces:wo},s=_n.meshFromPositionAndFaces(t,n,u.positions,u.faces);return s.position=a,s}var Eo=function(e,t){return function(n){var o,r=n.updatedPointMesh,i=n.is2updateServer;y()(o=e.getNodeFromTree(r.parent.name)).call(o,(function(n){var o,a=r.index,l=n.item,c=l.mesh,u=c.name,s={position:hn.ofBabylon(c.position).toArray(),corners:l.corners};(s.corners[a]=hn.ofBabylon(r.position).toArray(),function(e,t,n,o){var r,i,a,l=_n.pointAverageVec3(J()(r=e.corners).call(r,(function(e){return hn.of(e)})));e.position=l.toArray(),e.corners=J()(i=e.corners).call(i,(function(e){return hn.of(e).sub(l).toArray()}));var c=Po(e,n.name,t);c.position=n.position,c.rotationQuaternion=n.rotationQuaternion,c.locallyTranslate(l.toBabylon()),c.material=n.material,c.visibility=n.visibility,c.parent=n.parent,o.mesh=c,o.corners=e.corners;var u=Ht()(n._children);y()(u).call(u,(function(e){n.removeChild(e),e.parent=c})),y()(a=o.keyPoints).call(a,(function(t,n){t.position=hn.of(e.corners[n]).toBabylon()})),n.dispose()}(s,t,c,l),e.addGizmo(),i)&&(e.updateNodeInServer(u),y()(o=e.getNodeFromTree(u)).call(o,(function(t){e.setProperties(t.item.toForm())})))}))}},So=function(e,t,n,o){var r=[];return y()(t).call(t,(function(t,i){var a,l=t,c=_n.createSphere(e,new Xt.Color3(.25,.25,.25),Co,bt()(a="".concat(n.name,"keyPoint")).call(a,i),!0);c.parent=n,c.position=l,c.index=i,c.observers=new Xt.Observable,c.observers.add(Eo(o,e)),r.push(c)})),r},No=ko,Ao=n(84),To=n.n(Ao),Vo=Xn.RADIUS,Io=mn.Utils.mod,Bo=function(e){function t(e,n,o,r){var i,a=arguments.length>4&&void 0!==arguments[4]?arguments[4]:{};return xt()(this,t),i=Pt()(this,St()(t).call(this,e,a)),N()(At()(i),"getType",(function(){return t.TYPE})),i.localPolygon=n,i.height=o,i.keyPoints=r,i}return Vt()(t,e),Ct()(t,[{key:"toDict",value:function(){var e=sn()(St()(t.prototype),"toDict",this).call(this);return e.localPolygon=this.localPolygon,e.height=this.height,e}},{key:"ofDict",value:function(e){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,o=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;return t.ofDict(e,n,o)}}],[{key:"ofDict",value:function(e){var n,o,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;if(!r||!i)throw"null dictionary describing polygon or null mainView";var a=J()(n=r.localPolygon).call(n,(function(e){return hn.of(e).toBabylon()})),l=hn.of(r.position).toBabylon(),c=jo(e,a,r.height,r.name);c.position=l;var u=new Xt.StandardMaterial("PolygonMaterial".concat(r.name),e),s=new Xt.Color3(r.color[0],r.color[1],r.color[2]);u.diffuseColor=s,u.emissiveColor=s,c.material=u,c.visibility=.5,y()(o=an.Maybe.fromNull(r.quaternion)).call(o,(function(e){var t=new Xt.Quaternion(e[1],e[2],e[3],e[0]);c.rotationQuaternion=t.normalize()}));var f=qo(e,a,c,i);return new t(c,J()(a).call(a,(function(e){return[e.x,e.y,e.z]})),r.height,f,r.keyValueMap)}}]),t}(Pn);N()(Bo,"TYPE","PolygonRegion");var Do=function(e){var t=[];return t.push(e[1]),t.push(e[0]),t.push(e[2]),t},jo=function(e,t,n,o){var r,i,a,l,c=new Xt.Vector3(0,0,n),u={positions:[],faces:[]};u.positions=Ht()(t);for(var s=0;s<t.length;s++)u.positions.push(t[s].add(c));var f=t.length,d=_n.triangulatePolygon(t),h=J()(r=J()(i=_n.triangulatePolygon(To()(a=u.positions).call(a,f))).call(i,(function(e){return J()(e).call(e,(function(e){return e+f}))}))).call(r,Do),m=function(e){for(var t=e.length,n=_n.computeOrientation(e),o=[],r=0;r<t;r++){var i=(r+1)%t;o.push([r,t+i,i]),o.push([r,t+r,t+i])}return n>0?o:J()(o).call(o,Do)}(t);return u.faces=bt()(l=bt()(d).call(d,h)).call(l,m),_n.meshFromPositionAndFaces(o,e,u.positions,u.faces)};function Fo(e,t,n,o){var r,i=Ht()(n._children);return y()(i).call(i,(function(e){n.removeChild(e),e.parent=o.mesh})),J()(r=o.keyPoints).call(r,(function(r,i){var a;return r.observers=new Xt.Observable,r.observers.add(Oo(e,t)),r.index=i,r.name=bt()(a="".concat(n.name,"keyPoint")).call(a,i),r.position=hn.of(o.localPolygon[i]).toBabylon(),r}))}function Ro(e,t,n,o,r){var i=arguments.length>5&&void 0!==arguments[5]?arguments[5]:Fo,a=_n.pointAverage(e);e=J()(e).call(e,(function(e){return e.subtract(a)}));var l=jo(t,e,o.height,n.name);return l.position=n.position,l.rotationQuaternion=n.rotationQuaternion,l.locallyTranslate(a),l.material=n.material,l.visibility=n.visibility,l.parent=n.parent,o.localPolygon=J()(e).call(e,(function(e){return hn.ofBabylon(e).toArray()})),o.mesh=l,o.keyPoints=i(t,r,n,o),n.dispose(),e}var Oo=function(e,t){return function(n){var o,r=n.updatedPointMesh,i=n.is2updateServer;r.parent&&y()(o=t.getNodeFromTree(r.parent.name)).call(o,(function(n){var o,a=r.index,l=n.item,c=l.mesh,u=c.name,s=J()(o=l.localPolygon).call(o,(function(e){return hn.of(e).toBabylon()}));s[a]=r.position,Ro(s,e,c,l,t),i&&t.updateNodeInServer(u)}))}};function _o(e,t,n,o){var r;return qo(e,J()(r=o.localPolygon).call(r,(function(e){return hn.of(e).toBabylon()})),o.mesh,t)}var Lo=function(e,t,n,o){var r,i=t.index,a=t.parent.name;y()(r=n.getNodeFromTree(a)).call(r,(function(t){for(var r,a=t.item,l=a.localPolygon.length,c=Io(i+o,l),u=a.mesh,s=J()(r=a.localPolygon).call(r,(function(e){return hn.of(e).toBabylon()})),f=[],d=i+Math.max(0,o),h=0;h<d;h++)f.push(s[h]);f.push(s[c].add(s[i]).scale(.5));for(var m=d;m<l;m++)f.push(s[m]);Ro(f,e,u,a,n,_o)}))},zo=function(e,t,n){var o,i=[];return y()(o=n.getNodeFromTree(t.parent.name)).call(o,(function(n){n.item.localPolygon.length>3&&i.push({icon:function(e){return r.a.createElement("i",de()({className:"fas fa-trash"},e))},action:function(n){!function(e,t,n){var o,r=t.index,i=t.parent.name;y()(o=n.getNodeFromTree(i)).call(o,(function(t){var o,a,l=t.item,c=l.mesh,u=J()(o=l.localPolygon).call(o,(function(e){return hn.of(e).toBabylon()}));Qn()(u).call(u,r,1),Qn()(a=l.keyPoints).call(a,r,1)[0].dispose(),Ro(u,e,c,l,n),n.updateNodeInServer(i)}))}(e,t,n),n.closeContextDial()},name:"Delete node [DEL]"}),i.push({icon:function(e){return r.a.createElement("i",de()({className:"fas fa-less-than"},e))},action:function(n){Lo(e,t,n,-1),n.closeContextDial()},name:"Add previous"}),i.push({icon:function(e){return r.a.createElement("i",de()({className:"fas fa-greater-than"},e))},action:function(n){Lo(e,t,n,1),n.closeContextDial()},name:"Add next"})})),i},qo=function(e,t,n,o){var r=[];return y()(t).call(t,(function(t,i){var a,l=new Xt.Color3(.25,.25,.25),c=_n.createSphere(e,l,Vo,bt()(a="".concat(n.name,"keyPointPolygon")).call(a,i),!0);c.parent=n,c.position=t,c.index=i,c.observers=new Xt.Observable,r.push(c),c.observers.add(Oo(e,o))})),y()(r).call(r,(function(t){t.onClick=function(){o.setContextActions(zo(e,t,o))}})),r},Uo=Bo,Go=n(31),Ko=n.n(Go),Yo=n(37),Wo=n.n(Yo),Qo=function(){function e(){xt()(this,e),this.memory={}}return Ct()(e,[{key:"action",value:function(e){var t;y()(t=e.getSceneMemory()).call(t,(function(e){e.gizmoManager.attachedMesh=null,e.camera.attachControl(e.canvas,!0)})),e.highlightNodeInTree&&e.highlightNodeInTree(),e.highlightNodeInScene&&e.highlightNodeInScene(),e.closeContextDial&&e.closeContextDial(),e.setContextActionIndex&&e.setContextActionIndex()}}]),e}(),Zo=function(e){function t(e,n){var o,r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};return xt()(this,t),(o=Pt()(this,St()(t).call(this,e,r))).assetName=n,o}return Vt()(t,e),Ct()(t,[{key:"toDict",value:function(){var e=sn()(St()(t.prototype),"toDict",this).call(this);return e.assetName=this.assetName,e}}]),t}(Pn);function Ho(e,t){var n=E()(e);if(w.a){var o=w()(e);t&&(o=k()(o).call(o,(function(t){return M()(e,t).enumerable}))),n.push.apply(n,o)}return n}var Xo=function(e){function t(e,n,o,r){var i;return xt()(this,t),i=Pt()(this,St()(t).call(this,e,r)),N()(At()(i),"getType",(function(){return t.TYPE})),i.size=n,i.textureSrc=o,i}return Vt()(t,e),Ct()(t,[{key:"dispose",value:function(){sn()(St()(t.prototype),"dispose",this).call(this)}},{key:"toDict",value:function(){var e=sn()(St()(t.prototype),"toDict",this).call(this);return e.size=this.size,e.textureSrc=this.textureSrc,e}},{key:"toForm",value:function(){var e=this.toDict();return{jsonSchema:{type:"object",properties:{oldName:{type:"string"},name:{type:"string",title:"Name"},type:{type:"string",title:"Type"},assetName:{type:"string",title:"Asset Name"}}},uiSchema:{type:{"ui:disabled":!0},assetName:{"ui:disabled":!0},oldName:{"ui:widget":"hidden"}},data:{oldName:e.name,name:e.name,type:e.type,assetName:e.assetName}}}},{key:"ofForm",value:function(e){this.name=e.name,this.mesh.name=e.name,this.keyValueMap=function(e){for(var t=1;t<arguments.length;t++){var n,o=null!=arguments[t]?arguments[t]:{};if(t%2)y()(n=Ho(Object(o),!0)).call(n,(function(t){N()(e,t,o[t])}));else if(v.a)m()(e,v()(o));else{var r;y()(r=Ho(Object(o))).call(r,(function(t){d()(e,t,M()(o,t))}))}}return e}({},e.annotations)}}]),t}(Zo);N()(Xo,"TYPE","Map");var Jo=Xo,$o=n(52),er=function e(){xt()(this,e)};N()(er,"createGizmo",(function(e){var t=new Xt.RotationGizmo(new Xt.UtilityLayerRenderer(e));return t.xGizmo.dragBehavior.detach(),t.xGizmo.scaleRatio=0,t.yGizmo.dragBehavior.detach(),t.yGizmo.scaleRatio=0,t})),N()(er,"createCamera",(function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:function(e){},o=1,r=_n.cameraBuilder(e).sphericalCoordinates(new Xt.Vector3(0,0,14)).target(Xt.Vector3.Zero()).name("camera").build();return r.attachControl(t,!1),r.inertia=.7,r.collisionRadius=new Xt.Vector3(o,o,o),r.panningInertia=.5,r.checkCollisions=!0,r.panningSensibility=0,r.lowerRadiusLimit=2,n(r),r})),N()(er,"createLight",(function(e){return _n.directionalLightBuilder(e).name("light").direction(new Xt.Vector3(0,-1,0)).intensity(.35).build()})),N()(er,"createMeshGround",(function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:20,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:20,o=Xt.Mesh.CreateGround("groundMesh",t,n,20,e);return o.translate(new Xt.Vector3(0,-1,0),.01,Xt.Space.WORLD),o.material=new Xt.StandardMaterial("wireframe",e),o.material.wireframe=!0,o.isPickable=!1,o.checkCollisions=!0,o})),N()(er,"createScene",(function(e){var t=new Xt.Scene(e);return t.clearColor=Xt.Color3.Black,t.collisionsEnabled=!0,t._uid=t.getUniqueId(),t})),N()(er,"createMouseLocationText",(function(e){var t=$o.AdvancedDynamicTexture.CreateFullscreenUI("UI",!0,e),n=new $o.TextBlock;return n.text="",n.color="white",n.fontSize=17,n.left=-560,n.top=-145,t.addControl(n),n}));var tr=er,nr=function(e){function t(){return xt()(this,t),Pt()(this,St()(t).call(this))}return Vt()(t,e),Ct()(t,[{key:"onPointerDown",value:function(e,t){}},{key:"onPointerMove",value:function(e,t){}},{key:"onPointerUp",value:function(e){}},{key:"onKeyDown",value:function(e,t){var n={Escape:or(ai.orbit),KeyG:or(ai.dragObjects),KeyP:or(ai.drawPath),KeyB:or(ai.drawBoxRegion),KeyR:or(ai.drawRegion),KeyK:or(ai.addKeyPoint),KeyC:or(ai.drawGraph)};e.code in n&&n[e.code](t)}}]),t}(Qo),or=function(e){return function(t){e.action(t),t.setSelectedAction(e)}},rr=nr,ir=function(e){function t(){var e;return xt()(this,t),ar?Pt()(e,ar):(e=Pt()(this,St()(t).call(this)),N()(At()(e),"action",(function(n){sn()(St()(t.prototype),"action",At()(e)).call(At()(e),n),n.setSelectedAction(At()(e))})),N()(At()(e),"onPointerDown",(function(t,n){var o;1!==t.buttons&&2!==t.buttons||y()(o=n.getSceneMemory()).call(o,(function(o){var r,i=o.scene,a=o.ground,l=o.camera,c=o.canvas;e.maybeSelectedMesh=_n.pickMesh(i,a),y()(r=e.maybeSelectedMesh).call(r,(function(o){var r;l.detachControl(c),y()(r=_n.getGroundPosition(i,a)).call(r,(function(r){var i=_n.computeLocalCoordinatesFromMesh(o,hn.ofBabylon(r));e.mousePointInLocal=i,e.clickPointInLocal=i,e.shiftFromCenterOfMass=i.sub(hn.ofBabylon(o.position)),o.onClick?o.onClick():n.closeContextDial(),e.handleMeshRightClick(t,n,o),n.addGizmo(o.name),n.highlightNodeInTree(o.name),n.highlightMeshInScene([o]),e.setProperties(n,o.name)}))})),e.maybeSelectedMesh.orLazy((function(){var o;return y()(o=n.getMouseCoordinatesFromRoot()).call(o,(function(o){return e.handleRightClickWithoutMesh(t,n,o)}))}))}))})),N()(At()(e),"handleMeshRightClick",(function(e,t,n){2===e.buttons&&n&&n.getMouseContextActions&&t.setMouseContextActions(e,n.getMouseContextActions(t))})),N()(At()(e),"handleRightClickWithoutMesh",(function(t,n,o){2===t.buttons&&n.setMouseContextActions(t,[{title:"Paste",onClick:e.getPasteOnClick(o,n)}])})),N()(At()(e),"getPasteOnClick",(function(e,t){return function(){var n=Mn.paste();n&&"function"==typeof n&&n(e,t)}})),N()(At()(e),"onPointerMove",(function(t,n){var o;1===t.buttons&&y()(o=n.getSceneMemory()).call(o,(function(t){var n=t.scene,o=t.ground,r=_n.getGroundPosition(n,o);y()(r).call(r,(function(t){var n;y()(n=e.maybeSelectedMesh).call(n,(function(n){var o=_n.computeLocalCoordinatesFromMesh(n,hn.ofBabylon(t)),r=o.sub(e.shiftFromCenterOfMass);n.position=new Xt.Vector3(r.getX(),r.getY(),n.position.z),e.notifyObservers(n,!1,o.sub(e.mousePointInLocal)),e.mousePointInLocal=o}))}))}))})),N()(At()(e),"onPointerUp",(function(t){var n;y()(n=t.getSceneMemory()).call(n,(function(n){var o,r=n.camera,i=n.scene,a=n.ground,l=n.canvas;y()(o=e.maybeSelectedMesh).call(o,(function(n){var o;y()(o=_n.getGroundPosition(i,a)).call(o,(function(o){var r=_n.computeLocalCoordinatesFromMesh(n,hn.ofBabylon(o)).sub(e.clickPointInLocal);e.notifyObservers(n,!0,hn.ZERO),e.setProperties(t,n.name),t.updateNodeInServer(n.name),e.undoManager.addIt(e.getUndoAbleAction(n,r,t))}))})),e.maybeSelectedMesh=an.Maybe.none(),e.shiftFromCenterOfMass=hn.ZERO,e.mousePointInLocal=hn.ZERO,r.attachControl(l,!0)}))})),N()(At()(e),"onKeyDown",(function(n,o){for(var r=[{predicate:function(e){var t;return vn()(t=["Backspace","Delete"]).call(t,e.code)},action:e.getDeleteButtonAction(o)},{predicate:function(e){return e.ctrlKey&&!e.shiftKey&&"KeyZ"===e.code},action:function(){return e.undoManager.undo()}},{predicate:function(e){return e.ctrlKey&&e.shiftKey&&"KeyZ"===e.code},action:function(){return e.undoManager.redo()}},{predicate:function(e){return e.ctrlKey&&"KeyC"===e.code},action:function(){var e;return y()(e=an.Maybe.fromNull(o.getHighlightedNodeName())).call(e,(function(e){var t;return y()(t=o.getNodeFromTree(e)).call(t,(function(e){var t=e.item.mesh;t.getMouseContextActions&&t.getMouseContextActions(o)[0].onClick()}))}))}},{predicate:function(e){return e.ctrlKey&&"KeyV"===e.code},action:function(){var t;y()(t=o.getMouseCoordinatesFromRoot()).call(t,(function(t){return e.getPasteOnClick(t,o)()}))}},{predicate:function(e){return!0},action:function(){return sn()(St()(t.prototype),"onKeyDown",At()(e)).call(At()(e),n,o)}}],i=0;i<r.length;i++){var a=r[i];if(a.predicate(n)){a.action();break}}})),N()(At()(e),"setProperties",(function(e,t){return gt()((function(){return e.setPropertiesWithName(t)}),100)})),e.key="dragObject",e.name="Grab Objects [G]",e.icon=function(e){return r.a.createElement("i",de()({className:"fas fa-mouse-pointer"},e))},e.maybeSelectedMesh=an.Maybe.none(),e.shiftFromCenterOfMass=hn.ZERO,e.mousePointInLocal=hn.ZERO,e.clickPointInLocal=hn.ZERO,e.undoManager=new mn.UndoManager,ar=At()(e),e)}return Vt()(t,e),Ct()(t,[{key:"getDeleteButtonAction",value:function(e){return function(){var t;return y()(t=an.Maybe.fromNull(e.getHighlightedNodeName())).call(t,(function(t){var n=e.getNodeFromTree(t);y()(n).call(n,(function(){return e.onDeleteNode(t)})),n.orElseRun((function(){e.getContextActions()[0].action(e)}))}))}}},{key:"notifyObservers",value:function(e,t,n){var o;y()(o=an.Maybe.fromNull(e.observers)).call(o,(function(o){return o.notifyObservers({updatedPointMesh:e,is2updateServer:t,displacement:n.toBabylon()})}))}},{key:"getUndoAbleAction",value:function(e,t,n){var o=this;return mn.UndoManager.actionBuilder().doAction((function(){var r=hn.ofBabylon(e.position).add(t);e.position=r.toBabylon(),o.notifyObservers(e,!0,t),n.updateNodeInServer(e.name)})).undoAction((function(){var r=t.scale(-1),i=hn.ofBabylon(e.position).add(r);e.position=i.toBabylon(),o.notifyObservers(e,!0,r),n.updateNodeInServer(e.name)})).build()}}],[{key:"getInstance",value:function(){return new t}}]),t}(rr),ar=null,lr=ir,cr=null,ur=function(e){function t(){var e;return xt()(this,t),cr?Pt()(e,cr):(e=Pt()(this,St()(t).call(this)),N()(At()(e),"createKeyPoint",(function(e,t,n,o){var r=!(arguments.length>4&&void 0!==arguments[4])||arguments[4],i=arguments.length>5&&void 0!==arguments[5]?arguments[5]:Xt.Color3.Gray(),a=o.getRootNode().item.mesh,l=Yn.ofDict(n,{name:t,color:[i.r,i.g,i.b]}),c=l.mesh;c.parent=a;var u=_n.computeLocalCoordinatesFromMesh({parent:a},hn.ofBabylon(e)).toBabylon();return c.setPositionWithLocalVector(u.add(Xt.Axis.Z.scale(Yn.DEFAULT_SIZE))),r&&o.addNodeItem2Tree(l,a.name,r),c})),N()(At()(e),"action",(function(n){sn()(St()(t.prototype),"action",At()(e)).call(At()(e),n),n.setSelectedAction(At()(e))})),N()(At()(e),"onPointerDown",(function(t,n){var o;0===t.button&&y()(o=n.getSceneMemory()).call(o,(function(t){var n,o=t.scene,r=t.ground,i=t.camera;e.maybeMousePos=_n.getGroundPosition(o,r),y()(n=e.maybeMousePos).call(n,(function(e){i.detachControl(t.canvas)}))}))})),N()(At()(e),"onPointerMove",(function(t,n){var o;y()(o=n.getSceneMemory()).call(o,(function(t){var o=t.scene,r=t.ground,i=_n.getGroundPosition(o,r);y()(i).call(i,(function(t){var r;y()(r=e.maybeMousePos).call(r,(function(r){e.tempMesh&&e.tempMesh.dispose(),e.tempMesh=e.createKeyPoint(t,"temp_key_point",o,n,!1)}))}))}))})),N()(At()(e),"onPointerUp",(function(t){var n;y()(n=t.getSceneMemory()).call(n,(function(n){var o=n.scene,r=n.camera,i=n.ground,a=_n.getGroundPosition(o,i);y()(a).call(a,(function(n){var r;y()(r=e.maybeMousePos).call(r,(function(r){e.tempMesh&&e.tempMesh.dispose();var i="KeyPoint".concat(Math.floor(1e3*Math.random()));e.createKeyPoint(n,i,o,t,!0,new Xt.Color3(Math.random(),Math.random(),Math.random())),t.setPropertiesWithName(i)}))})),e.maybeMousePos=an.Maybe.none(),r.attachControl(n.canvas,!0)}))})),e.key="addKeyPoint",e.name="Add Key Point [K]",e.maybeMousePos=an.Maybe.none(),e.tempMesh=null,e.icon=function(e){return r.a.createElement("i",de()({className:"fas fa-map-marker"},e))},cr=At()(e),e)}return Vt()(t,e),Ct()(t,null,[{key:"getInstance",value:function(){return new t}}]),t}(rr),sr=function(e){function t(){var e;return xt()(this,t),fr?Pt()(e,fr):(e=Pt()(this,St()(t).call(this)),N()(At()(e),"action",(function(n){sn()(St()(t.prototype),"action",At()(e)).call(At()(e),n),n.setSelectedAction(At()(e))})),N()(At()(e),"onPointerDown",(function(t,n){var o;1===t.buttons&&y()(o=n.getSceneMemory()).call(o,(function(t){var n=t.scene,o=t.ground,r=t.camera,i=_n.getGroundPosition(n,o);e.maybeMousePos=i,y()(i).call(i,(function(e){r.detachControl(t.canvas)}))}))})),N()(At()(e),"onPointerMove",(function(t,n){var o;y()(o=n.getSceneMemory()).call(o,(function(t){var o=t.scene,r=t.ground,i=_n.getGroundPosition(o,r);y()(i).call(i,(function(t){var r;y()(r=e.maybeMousePos).call(r,(function(r){e.tempMesh&&e.tempMesh.dispose(),e.tempMesh=e.createBoxRegion([r,t],dr,o,n,!1)}))}))}))})),N()(At()(e),"onPointerUp",(function(t){var n;y()(n=t.getSceneMemory()).call(n,(function(n){var o=n.scene,r=n.camera,i=n.ground,a=_n.getGroundPosition(o,i);y()(a).call(a,(function(n){var r;y()(r=e.maybeMousePos).call(r,(function(r){e.tempMesh.dispose();var i="BoxRegion".concat(Math.floor(1e3*Math.random()));e.createBoxRegion([r,n],i,o,t,!0),t.setPropertiesWithName(i)}))})),e.maybeMousePos=an.Maybe.none(),r.attachControl(n.canvas,!0),t.renderMenus()}))})),N()(At()(e),"createBoxRegion",(function(e,t,n,o){var r=!(arguments.length>4&&void 0!==arguments[4])||arguments[4],i=arguments.length>5&&void 0!==arguments[5]?arguments[5]:Xt.Color3.Red(),a=arguments.length>6&&void 0!==arguments[6]?arguments[6]:1,l=o.getRootNode().item.mesh,c=J()(e).call(e,(function(e){return _n.computeLocalCoordinatesFromMesh({parent:l},hn.ofBabylon(e))}));c[1]=c[1].add(hn.of([0,0,a]));var u=c[0].add(c[1]).scale(.5),s=J()(c).call(c,(function(e){return e.sub(u)})),f=No.ofDict(n,{name:t,position:u.toArray(),color:[i.r,i.g,i.b],corners:J()(s).call(s,(function(e){return e.toArray()}))},o);return f.mesh.parent=l,r&&o.addNodeItem2Tree(f,l.name,r),f.mesh})),e.key="drawBoxRegion",e.name="Draw Box Region [B]",e.maybeMousePos=an.Maybe.none(),e.tempMesh=null,e.icon=function(e){return r.a.createElement("i",de()({className:"fas fa-square"},e))},fr=At()(e),e)}return Vt()(t,e),Ct()(t,null,[{key:"getInstance",value:function(){return new t}}]),t}(rr),fr=null,dr="temp_box_region",hr=sr,mr=function(e){function t(){var e;return xt()(this,t),pr?Pt()(e,pr):(e=Pt()(this,St()(t).call(this)),N()(At()(e),"action",(function(n){sn()(St()(t.prototype),"action",At()(e)).call(At()(e),n),n.setSelectedAction(At()(e))})),N()(At()(e),"onPointerDown",(function(t,n){var o;1===t.buttons&&y()(o=n.getSceneMemory()).call(o,(function(t){var o=t.scene,r=t.ground,i=t.camera,a=t.canvas,l=_n.getGroundPosition(o,r);y()(l).call(l,(function(t){i.detachControl(a),e.mouseCurve.push(t);var r=1===e.mouseCurve.length?[e.mouseCurve[0],e.mouseCurve[0]]:e.mouseCurve;e.createCurve(r,vr,o,n,!1),n.setContextActions(e.getDrawPathContextAction(i,a,o))}))}))})),N()(At()(e),"onPointerMove",(function(e,t){})),N()(At()(e),"onPointerUp",(function(e){})),N()(At()(e),"onKeyDown",(function(n,o){var r;y()(r=o.getSceneMemory()).call(r,(function(r){var i=r.scene,a=r.camera,l=r.canvas,c=e.getDrawPathContextAction(a,l,i),u={Enter:function(){return c[1].action(o)},Delete:function(){return c[0].action(o)},Backspace:function(){return c[0].action(o)},Escape:function(){0===e.mouseCurve.length&&sn()(St()(t.prototype),"onKeyDown",At()(e)).call(At()(e),n,o),c[0].action(o)}};n.code in u?u[n.code]():sn()(St()(t.prototype),"onKeyDown",At()(e)).call(At()(e),n,o)}))})),N()(At()(e),"createCurve",(function(e,t,n,o){var r=!(arguments.length>4&&void 0!==arguments[4])||arguments[4],i=arguments.length>5&&void 0!==arguments[5]?arguments[5]:Xt.Color3.Gray(),a=o.getRootNode().item.mesh,l=J()(e).call(e,(function(e){return _n.computeLocalCoordinatesFromMesh({parent:a},hn.ofBabylon(e)).toBabylon()})),c=_n.pointAverage(l),u=J()(l).call(l,(function(e){return e.subtract(c)})),s=no.ofDict(n,{name:t,position:hn.ofBabylon(c).toArray(),color:[i.r,i.g,i.b],localPath:J()(u).call(u,(function(e){return hn.ofBabylon(e).toArray()}))},o);s.mesh.parent=a,o.addNodeItem2Tree(s,a.name,r)})),N()(At()(e),"getDrawPathContextAction",(function(t,n,o){var i=[];return i.push({icon:function(e){return r.a.createElement("i",de()({className:"fas fa-trash"},e))},action:function(o){t.attachControl(n,!0),o.deleteNodeFromTreeUsingName(vr,!1),e.mouseCurve=[],o.closeContextDial()},name:"Clear Path [ESC | DEL | Backspace]"}),e.mouseCurve.length>1&&i.push({icon:function(e){return r.a.createElement("i",de()({className:"fas fa-check"},e))},action:function(r){t.attachControl(n,!0),r.deleteNodeFromTreeUsingName(vr,!1);var i="Path".concat(Math.floor(1e3*Math.random()));e.createCurve(e.mouseCurve,i,o,r,!0),e.mouseCurve=[],r.setPropertiesWithName(i),r.closeContextDial()},name:"Create Path [Enter]"}),i})),e.key="drawPath",e.name="Draw Path [P]",e.mouseCurve=[],e.icon=function(e){return r.a.createElement("i",de()({className:"fas fa-bezier-curve"},e))},pr=At()(e),e)}return Vt()(t,e),Ct()(t,null,[{key:"getInstance",value:function(){return new t}}]),t}(rr),pr=null,vr="temp_curve",gr=mr,yr=null,br=function(e){function t(){var e;return xt()(this,t),yr?Pt()(e,yr):(e=Pt()(this,St()(t).call(this)),N()(At()(e),"action",(function(n){sn()(St()(t.prototype),"action",At()(e)).call(At()(e),n),n.setSelectedAction(At()(e))})),N()(At()(e),"getDrawPolygonContextAction",(function(t,n,o){var i=[];return i.push({icon:function(e){return r.a.createElement("i",de()({className:"fas fa-trash"},e))},action:function(o){t.attachControl(n,!0),o.deleteNodeFromTreeUsingName("temp_polygon_region",!1),e.mouseCurve=[],o.closeContextDial()},name:"Clear Polygon [ESC | DEL | Backspace]"}),e.mouseCurve.length>2&&i.push({icon:function(e){return r.a.createElement("i",de()({className:"fas fa-check"},e))},action:function(r){t.attachControl(n,!0),r.deleteNodeFromTreeUsingName("temp_polygon_region",!1);var i="PolygonRegion".concat(Math.floor(1e3*Math.random()));e.createPolygonRegion(e.mouseCurve,i,o,r,!0),e.mouseCurve=[],r.setPropertiesWithName(i),r.closeContextDial()},name:"Create Polygon [Enter]"}),i})),N()(At()(e),"onPointerDown",(function(t,n){var o;y()(o=n.getSceneMemory()).call(o,(function(t){var o=t.scene,r=t.ground,i=t.camera,a=_n.getGroundPosition(o,r);y()(a).call(a,(function(r){i.detachControl(t.canvas),e.mouseCurve.push(r);var a=1===e.mouseCurve.length?[e.mouseCurve[0],e.mouseCurve[0]]:e.mouseCurve;e.createPolygonRegion(a,"temp_polygon_region",o,n,!1),n.setContextActions(e.getDrawPolygonContextAction(i,t.canvas,o))}))}))})),N()(At()(e),"onPointerMove",(function(e,t){})),N()(At()(e),"onPointerUp",(function(e){})),N()(At()(e),"onKeyDown",(function(n,o){var r;y()(r=o.getSceneMemory()).call(r,(function(r){var i=r.scene,a=r.camera,l=e.getDrawPolygonContextAction(a,r.canvas,i),c={Enter:function(){return l[1].action(o)},Delete:function(){return l[0].action(o)},Backspace:function(){return l[0].action(o)},Escape:function(){0===e.mouseCurve.length&&sn()(St()(t.prototype),"onKeyDown",At()(e)).call(At()(e),n,o),l[0].action(o)}};n.code in c?c[n.code]():sn()(St()(t.prototype),"onKeyDown",At()(e)).call(At()(e),n,o)}))})),N()(At()(e),"createPolygonRegion",(function(e,t,n,o){var r=!(arguments.length>4&&void 0!==arguments[4])||arguments[4],i=arguments.length>5&&void 0!==arguments[5]?arguments[5]:Xt.Color3.Yellow(),a=arguments.length>6&&void 0!==arguments[6]?arguments[6]:1,l=o.getRootNode().item.mesh,c=J()(e).call(e,(function(e){return _n.computeLocalCoordinatesFromMesh({parent:l},hn.ofBabylon(e))})),u=_n.pointAverageVec3(c),s=J()(c).call(c,(function(e){return e.sub(u)})),f=Uo.ofDict(n,{name:t,position:u.toArray(),color:[i.r,i.g,i.b],localPolygon:J()(s).call(s,(function(e){return e.toArray()})),height:a},o);f.mesh.parent=l,o.addNodeItem2Tree(f,l.name,r)})),e.key="drawPolygonRegion",e.name="Draw Polygon Region [R]",e.mouseCurve=[],e.icon=function(e){return r.a.createElement("i",de()({className:"fas fa-draw-polygon"},e))},yr=At()(e),e)}return Vt()(t,e),Ct()(t,null,[{key:"getInstance",value:function(){return new t}}]),t}(rr),Mr=function(e){function t(){var e;return xt()(this,t),xr?Pt()(e,xr):(e=Pt()(this,St()(t).call(this)),N()(At()(e),"action",(function(n){sn()(St()(t.prototype),"action",At()(e)).call(At()(e),n),n.setSelectedAction(At()(e))})),N()(At()(e),"onPointerDown",(function(e,t){})),N()(At()(e),"onPointerMove",(function(e,t){})),N()(At()(e),"onPointerUp",(function(e){})),e.key="orbit",e.name="Orbit [ESC]",e.maybeSelectedMesh=an.Maybe.none(),e.icon=function(e){return r.a.createElement("i",de()({className:"fas fa-globe"},e))},xr=At()(e),e)}return Vt()(t,e),Ct()(t,null,[{key:"getInstance",value:function(){return new t}}]),t}(rr),xr=null,kr=Mr,Cr=n(85),wr=n.n(Cr),Pr=n(86),Er=n(45),Sr=n.n(Er),Nr=n(48),Ar=n.n(Nr),Tr=n(49),Vr=n.n(Tr),Ir=n(22),Br=n.n(Ir),Dr=function(){function e(){xt()(this,e),jr.set(this,{writable:!0,value:{}}),Fr.set(this,{writable:!0,value:{}}),Rr.set(this,{writable:!0,value:{}})}return Ct()(e,[{key:"addVertex",value:function(e){e in Br()(this,Fr)||(Br()(this,Fr)[e]={},Br()(this,jr)[e]={})}},{key:"delVertex",value:function(t){var n,o,r=this;t in Br()(this,Fr)&&(delete Br()(this,Fr)[t],y()(n=E()(Br()(this,jr)[t])).call(n,(function(n){delete Br()(r,Rr)[e.edgeKey(t,n)],delete Br()(r,Rr)[e.edgeKey(n,t)]})),delete Br()(this,jr)[t],y()(o=E()(Br()(this,jr))).call(o,(function(e){t in Br()(r,jr)[e]&&delete Br()(r,jr)[e][t]})))}},{key:"addEdge",value:function(t,n){return this.addVertex(t),this.addVertex(n),Br()(this,Rr)[e.edgeKey(t,n)]={},Br()(this,Rr)[e.edgeKey(n,t)]={},Br()(this,jr)[t][n]=!0,Br()(this,jr)[n][t]=!0,this}},{key:"delEdge",value:function(t,n){var o=e.edgeKey(t,n),r=e.edgeKey(n,t);(o in Br()(this,Rr)||r in Br()(this,Rr))&&(delete Br()(this,Rr)[o],delete Br()(this,Rr)[r],delete Br()(this,jr)[t][n],delete Br()(this,jr)[n][t])}},{key:"hasEdge",value:function(e,t){return this.getEdgeProp(e,t).isSome()}},{key:"getNeighbors",value:function(e){return e in Br()(this,jr)?E()(Br()(this,jr)[e]):[]}},{key:"getEdgeProp",value:function(t,n){var o=e.edgeKey(t,n);return o in Br()(this,Rr)?Yt()(an.Maybe).call(an.Maybe,Br()(this,Rr)[o]):an.Maybe.none()}},{key:"setEdgeProp",value:function(t,n,o){var r=e.edgeKey(t,n);return r in Br()(this,Rr)&&(Br()(this,Rr)[r]=o),this}},{key:"getVertexProp",value:function(e){return e in Br()(this,Fr)?Yt()(an.Maybe).call(an.Maybe,Br()(this,Fr)[e]):an.Maybe.none()}},{key:"setVertexProp",value:function(e,t){return e in Br()(this,Fr)&&(Br()(this,Fr)[e]=t),this}},{key:"getEdges",value:function(){return Br()(this,Rr)}},{key:"getVertices",value:function(){return Br()(this,Fr)}},{key:"getAdjMap",value:function(){return Br()(this,jr)}},{key:"setAdjacentMap",value:function(e){Vr()(this,jr,e)}},{key:"setVertices",value:function(e){Vr()(this,Fr,e)}},{key:"setEdges",value:function(e){Vr()(this,Rr,e)}}]),e}(),jr=new Ar.a,Fr=new Ar.a,Rr=new Ar.a;N()(Dr,"edgeKey",(function(e,t){var n;return bt()(n="".concat(e,"_")).call(n,t)})),N()(Dr,"key2Edge",(function(e){return e.split("_")}));var Or=Dr,_r=n(53),Lr=n.n(_r);function zr(e,t){var n=E()(e);if(w.a){var o=w()(e);t&&(o=k()(o).call(o,(function(t){return M()(e,t).enumerable}))),n.push.apply(n,o)}return n}function qr(e){for(var t=1;t<arguments.length;t++){var n,o=null!=arguments[t]?arguments[t]:{};if(t%2)y()(n=zr(Object(o),!0)).call(n,(function(t){N()(e,t,o[t])}));else if(v.a)m()(e,v()(o));else{var r;y()(r=zr(Object(o))).call(r,(function(t){d()(e,t,M()(o,t))}))}}return e}var Ur=function(){function e(){var t=this;xt()(this,e),N()(this,"getVertexByIndex",(function(n){var o;return Gt()(o=t.graph.getVertexProp(n)).call(o,(function(t){return an.Maybe.fromNull(t[e.NAMESPACES.vertex])}))})),this.graph=new Or,this.rTreeVertices=new Kr,this.rTreeEdges=new Wr,this.vertexGenerator=0}return Ct()(e,[{key:"getAbstractGraph",value:function(){return this.graph}},{key:"getAdjMap",value:function(){return this.graph.getAdjMap()}},{key:"addVertex",value:function(t,n){var o=this,r=arguments.length>2&&void 0!==arguments[2]&&arguments[2],i=this.getVertex(t);i.orElseRun((function(){var i=new Gr(t,n||o.vertexGenerator++,r);o.rTreeVertices.insert(i),o.graph.addVertex(i.id),o.graph.setVertexProp(i.id,N()({},e.NAMESPACES.vertex,i))}))}},{key:"delVertex",value:function(e){var t,n=this;y()(t=this.getVertex(e)).call(t,(function(e){var t=e.id;n.rTreeVertices.remove(e),n.graph.delVertex(t)}))}},{key:"addEdge",value:function(t){var n,o=this,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[],i=L()(t,2),a=i[0],l=i[1],c=L()(r,2),u=c[0],s=c[1];return this.addVertex(a,u),this.addVertex(l,s),y()(n=this.getVertex(a)).call(n,(function(t){var n;return y()(n=o.getVertex(l)).call(n,(function(n){var r=o.getEdgeByIndex(t.id,n.id).orLazy((function(){return new Yr(t,n)})),i=o.getEdgeByIndex(n.id,t.id).orLazy((function(){return new Yr(n,t)}));o.rTreeEdges.remove(r,(function(e,t){return e.equals(t)})),o.rTreeEdges.insert(r),o.graph.addEdge(t.id,n.id),o.graph.setEdgeProp(t.id,n.id,N()({},e.NAMESPACES.edge,r)),o.graph.setEdgeProp(n.id,t.id,N()({},e.NAMESPACES.edge,i))}))})),this}},{key:"delEdge",value:function(e,t){var n,o=this;y()(n=this.getEdge(e,t)).call(n,(function(e){var t,n,r=J()(t=e.edge).call(t,(function(e){return e.id}));(n=o.graph).delEdge.apply(n,Ht()(r)),o.rTreeEdges.remove(e,(function(e,t){return e.equals(t)}))}))}},{key:"hasEdge",value:function(e,t){var n,o=this;return Gt()(n=this.getVertex(e)).call(n,(function(e){var n;return J()(n=o.getVertex(t)).call(n,(function(t){return o.graph.hasEdge(e.id,t.id)}))})).orSome(!1)}},{key:"getVertex",value:function(e){var t=this.rTreeVertices.search(Gr.of(e).toBBox());return t.length>0?Yt()(an.Maybe).call(an.Maybe,t.length>1?this.getMinDistanceVertex(t,e):t[0]):an.Maybe.none()}},{key:"getNeighbors",value:function(t){var n,o=this,r=[];return y()(n=this.getVertex(t)).call(n,(function(t){var n;y()(n=o.graph.getNeighbors(t.id)).call(n,(function(t){var n;y()(n=o.graph.getVertexProp(t)).call(n,(function(t){r.push(t[e.NAMESPACES.vertex])}))}))})),r}},{key:"updateVertex",value:function(t,n){var o,r=this;y()(o=this.graph.getVertexProp(t)).call(o,(function(o){var i,a=o[e.NAMESPACES.vertex];a.position=n,r.rTreeVertices.remove(a),r.rTreeVertices.insert(a),y()(i=r.graph.getNeighbors(t)).call(i,(function(n){var o;y()(o=r.graph.getEdgeProp(t,n)).call(o,(function(t){var n=t[e.NAMESPACES.edge];r.rTreeEdges.remove(n,(function(e,t){return e.equals(t)})),r.rTreeEdges.insert(n)}))}))}))}},{key:"getEdge",value:function(e,t){var n=t?e.add(t).scale(.5):e,o=this.rTreeEdges.search(Gr.of(n).toBBox());return o.length>0?Yt()(an.Maybe).call(an.Maybe,o.length>1?this.getMinDistanceEdge(o,n):o[0]):an.Maybe.none()}},{key:"getEdgeByIndex",value:function(t,n){var o;return J()(o=this.graph.getEdgeProp(t,n)).call(o,(function(t){return t[e.NAMESPACES.edge]}))}},{key:"getMinDistanceEdge",value:function(e,t){var n=Number.MAX_VALUE,o=-1;return y()(e).call(e,(function(e,r){var i,a,l=J()(i=J()(a=e.edge).call(a,(function(e){return e.position}))).call(i,hn.ofBabylon),c=l[1].sub(l[0]),u=hn.ofBabylon(t).sub(l[0]),s=c.dot(u)/c.dot(c),f=u.sub(c.scale(s)).length();n>f&&(n=f,o=r)})),e[o]}},{key:"getMinDistanceVertex",value:function(e,t){var n=Number.MAX_VALUE,o=-1;return y()(e).call(e,(function(e,r){var i=hn.ofBabylon(e.position),a=hn.ofBabylon(t),l=i.sub(a).length();n>l&&(n=l,o=r)})),e[o]}},{key:"getVertices",value:function(){return this.graph.getVertices()}},{key:"getEdges",value:function(){return this.graph.getEdges()}},{key:"importData",value:function(t){var n,o=this,r=t.adjMap,i=qr({},t.vertices),a=qr({},t.edges);y()(n=E()(r)).call(n,(function(t){var n;y()(n=E()(r[t])).call(n,(function(n){var r,l,c,u=i[t],s=i[n],f=a[Or.edgeKey(t,n)];y()(r=o.graph.getVertexProp(t)).call(r,(function(t){t[e.NAMESPACES.vertex].keyValueMap=u.keyValueMap})),y()(l=o.graph.getVertexProp(n)).call(l,(function(t){t[e.NAMESPACES.vertex].keyValueMap=s.keyValueMap})),y()(c=o.graph.getEdgeProp(t,n)).call(c,(function(t){var n=t[e.NAMESPACES.edge];n.keyValueMap=f.keyValueMap,n.weight=f.weight}))}))})),this.vertexGenerator=t.vertexGenerator}}]),e}();N()(Ur,"NAMESPACES",{vertex:"rVertex",edge:"rEdge"});var Gr=function(){function e(t,n,o){var r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{};xt()(this,e),this.position=t,this.id=n,this.keyValueMap=r,this.isCurve=o}return Ct()(e,[{key:"toBBox",value:function(){var e=this.position;return{minX:e.x-Xn.RADIUS/4,minY:e.y-Xn.RADIUS/4,maxX:e.x+Xn.RADIUS/4,maxY:e.y+Xn.RADIUS/4}}}],[{key:"of",value:function(t){return new e(t)}}]),e}(),Kr=function(e){function t(){return xt()(this,t),Pt()(this,St()(t).apply(this,arguments))}return Vt()(t,e),Ct()(t,[{key:"toBBox",value:function(e){return e.toBBox()}},{key:"compareMinX",value:function(e,t){return e.position.x-t.position.x}},{key:"compareMinY",value:function(e,t){return e.position.y-t.position.y}}]),t}(Lr.a),Yr=function(){function e(t,n){var o=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};xt()(this,e),this.edge=[t,n],this.keyValueMap=o,this.weight=1}return Ct()(e,[{key:"equals",value:function(t){var n,o,r,i;if(!(t instanceof e))return!1;var a=J()(n=t.edge).call(n,(function(e){return e.id}));return Sr()(o=J()(r=J()(i=this.edge).call(i,(function(e){return e.id}))).call(r,(function(e){return vn()(a).call(a,e)}))).call(o,(function(e){return e}))}},{key:"toBBox",value:function(){var e=this.edge;return{minX:re()(e).call(e,(function(e,t){return Math.min(e,t.position.x-Xn.RADIUS/4)}),Number.MAX_VALUE),minY:re()(e).call(e,(function(e,t){return Math.min(e,t.position.y-Xn.RADIUS/4)}),Number.MAX_VALUE),maxX:re()(e).call(e,(function(e,t){return Math.max(e,t.position.x+Xn.RADIUS/4)}),Number.MIN_VALUE),maxY:re()(e).call(e,(function(e,t){return Math.max(e,t.position.y+Xn.RADIUS/4)}),Number.MIN_VALUE)}}}],[{key:"of",value:function(t,n){return new e(Gr.of(t),Gr.of(n))}}]),e}(),Wr=function(e){function t(){return xt()(this,t),Pt()(this,St()(t).apply(this,arguments))}return Vt()(t,e),Ct()(t,[{key:"toBBox",value:function(e){return e.toBBox()}},{key:"compareMinX",value:function(e,t){return e.toBBox().minX-t.toBBox().minX}},{key:"compareMinY",value:function(e,t){return e.toBBox().minY-t.toBBox().minY}}]),t}(Lr.a);function Qr(e,t){var n=E()(e);if(w.a){var o=w()(e);t&&(o=k()(o).call(o,(function(t){return M()(e,t).enumerable}))),n.push.apply(n,o)}return n}function Zr(e){for(var t=1;t<arguments.length;t++){var n,o=null!=arguments[t]?arguments[t]:{};if(t%2)y()(n=Qr(Object(o),!0)).call(n,(function(t){N()(e,t,o[t])}));else if(v.a)m()(e,v()(o));else{var r;y()(r=Qr(Object(o))).call(r,(function(t){d()(e,t,M()(o,t))}))}}return e}var Hr={get:n(87).get},Xr=function(e){function t(e,n){var o,i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:t.NAME,a=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{};xt()(this,t);var l=e._uid;if(l in Jr&&!Jr[l].mesh.isDisposed())return Pt()(o,Jr[l]);var c=$r(e,i);return c.onClick=function(){return o.graphFormMapper=o.getDefaultFormMapper()},o=Pt()(this,St()(t).call(this,c,a)),N()(At()(o),"getType",(function(){return t.TYPE})),N()(At()(o),"createVertexMesh",(function(e){var n=e.isCurve,r=t.getVertexMesh(o.scene,e.position,n?Xt.Color3.Blue():Xt.Color3.Gray(),n?2*Xn.RADIUS/3:Xn.RADIUS);r.parent=o.mesh,r.vertexId=e.id,o.addObserver2VertexMesh(r),o.addOnClickVertex(r),o.meshByVertexId[e.id]=r})),N()(At()(o),"getVertexObs",(function(){return function(e){var t=e.updatedPointMesh,n=e.is2updateServer,r=t.position,i=t.vertexId;o.updateVertexPosition(i,r,n),o.updateCurvedNeighbors([i],n),n&&(o.graphFormMapper=o.getToFormVertex(t),o.mainView.setProperties(o.toForm()))}})),N()(At()(o),"getEdgeObs",(function(){return function(e){var t,n=e.updatedPointMesh,r=e.is2updateServer,i=e.displacement,a=n.edgeIndexes,l=J()(t=J()(a).call(a,(function(e){return o.meshByVertexId[e].position}))).call(t,hn.ofBabylon),c=hn.ofBabylon(i);y()(l).call(l,(function(e,t){return o.updateVertexPosition(a[t],e.add(c).toBabylon(),r,a)})),o.updateCurvedNeighbors(a,r),r&&(o.graphFormMapper=o.getToFormEdge(n),o.mainView.setProperties(o.toForm()))}})),N()(At()(o),"getOnClickEdge",(function(e){return function(){var t,n=[],i=J()(t=e.edgeIndexes).call(t,(function(e){return o.meshByVertexId[e].position}));n.push({icon:function(e){return r.a.createElement("i",de()({className:"fas fa-trash"},e))},action:function(){var t,n;(t=o).delEdge.apply(t,Ht()(i)),y()(n=e.edgeIndexes).call(n,(function(e){var t,n;return y()(t=k()(n=o.graph.getVertexByIndex(e)).call(n,(function(e){return e.isCurve}))).call(t,(function(e){var t=e.position;return o.delVertex(t)}))})),o.mainView.closeContextDial(),o.mainView.updateNodeInServer(o.name)},name:"Delete Edge [Del]"}),o.mainView.setContextActions(n)}})),Jr[l]=At()(o),o.graph=new Ur,o.scene=e,o.mainView=n,o.meshByEdgeId={},o.meshByVertexId={},o.graphFormMapper=o.getDefaultFormMapper(),o}return Vt()(t,e),Ct()(t,[{key:"toDict",value:function(){var e,n,o=this,r=sn()(St()(t.prototype),"toDict",this).call(this),i=this.graph.getAdjMap(),a=Zr({},this.graph.getVertices()),l=Zr({},this.graph.getEdges());return y()(e=E()(a)).call(e,(function(e){var t;y()(t=o.graph.getVertexByIndex(e)).call(t,(function(t){var n=t.position,o=t.id,r=t.keyValueMap;a[e]={position:hn.ofBabylon(n).toArray(),id:o,keyValueMap:r}}))})),y()(n=E()(l)).call(n,(function(e){var t,n,r=Or.key2Edge(e);y()(t=(n=o.graph).getEdgeByIndex.apply(n,Ht()(r))).call(t,(function(t){var n=t.edge,o=t.keyValueMap,i=t.weight;l[e]={ids:r,positions:J()(n).call(n,(function(e){var t=e.position;return hn.ofBabylon(t).toArray()})),keyValueMap:o,weight:i,isCurve:J()(n).call(n,(function(e){return e.isCurve}))}}))})),r.adjMap=i,r.vertices=a,r.edges=l,r.vertexGenerator=this.graph.vertexGenerator,r}},{key:"toForm",value:function(){var e=sn()(St()(t.prototype),"toForm",this).call(this);return delete e.jsonSchema.properties.position,delete e.jsonSchema.properties.quaternion,delete e.jsonSchema.properties.color,delete e.uiSchema.position,delete e.uiSchema.quaternion,delete e.uiSchema.color,delete e.data.position,delete e.data.quaternion,delete e.data.color,this.graphFormMapper.toForm(e)}},{key:"ofForm",value:function(e){this.name=e.name,this.mesh.name=e.name,this.graphFormMapper.ofForm(e)}},{key:"getDefaultFormMapper",value:function(){var e=this;return{toForm:function(e){return e},ofForm:function(t){return e.keyValueMap=Zr({},t.annotations)}}}},{key:"getToFormVertex",value:function(e){var t=this;return{toForm:function(n){var o;return J()(o=t.graph.getVertex(e.position)).call(o,(function(t){return n.jsonSchema.properties.positionVertex={type:"object",title:"Position Vertex ".concat(t.id),properties:{x:{type:"number",title:"x"},y:{type:"number",title:"y"},z:{type:"number",title:"z"}}},n.uiSchema.positionVertex={"ui:widget":"collapse"},n.data.positionVertex={x:e.position.x,y:e.position.y,z:e.position.z},Pn.setAnnotations2Form(n,t.keyValueMap),n.jsonSchema.properties.annotations.title="Annotations Vertex ".concat(t.id),n})).orSome(n)},ofForm:function(n){var o,r,i=Hr.get(n,"positionVertex",e.position);i=J()(o=[i.x,i.y,i.z]).call(o,Hn.a),y()(r=t.graph.getVertex(e.position)).call(r,(function(e){return e.keyValueMap=Zr({},Hr.get(n,"annotations",{}))})),t.updateVertexPosition(e.vertexId,Xt.Vector3.FromArray(i),!1)}}}},{key:"getToFormEdge",value:function(e){var t=this;return{toForm:function(n){var o,r,i,a,l=J()(o=k()(r=J()(i=e.edgeIndexes).call(i,(function(e){var n;return J()(n=an.Maybe.fromNull(t.meshByVertexId[e])).call(n,(function(e){return e.position}))}))).call(r,(function(e){return e.isSome()}))).call(o,(function(e){return Yt()(e).call(e)}));return console.log("FORM2EDGE",l),0===l.length?n:J()(a=t.graph.getEdge(l[0],l[1])).call(a,(function(t){n.jsonSchema.properties.positionEdge={type:"object",title:"Position Edge ".concat(e.edgeIndexes),properties:{x:{type:"number",title:"x"},y:{type:"number",title:"y"},z:{type:"number",title:"z"}}},n.jsonSchema.properties.weight={type:"number",title:"Weight"},n.uiSchema.positionEdge={"ui:widget":"collapse"};var o=_n.pointAverage(l);return n.data.positionEdge={x:o.x,y:o.y,z:o.z},n.data.weight=t.weight,Pn.setAnnotations2Form(n,t.keyValueMap),n.jsonSchema.properties.annotations.title="Annotations Edge ".concat(e.edgeIndexes),n})).orSome(n)},ofForm:function(n){var o,r,i,a=e.edgeIndexes,l=J()(a).call(a,(function(e){return t.meshByVertexId[e].position})),c=_n.pointAverage(l),u=Hr.get(n,"positionEdge",c);u=J()(o=[u.x,u.y,u.z]).call(o,Hn.a),u=Xt.Vector3.FromArray(u),y()(l).call(l,(function(e,n){return t.updateVertexPosition(a[n],e.add(u.subtract(c)),!1)}));var s=function(e){e.keyValueMap=Zr({},Hr.get(n,"annotations",{})),e.weight=Hn()(n.weight)};y()(r=t.graph.getEdgeByIndex(a[0],a[1])).call(r,s),y()(i=t.graph.getEdgeByIndex(a[1],a[0])).call(i,s)}}}},{key:"addEdge",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[],n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:[!1,!1],o=L()(e,2),r=o[0],i=o[1],a=L()(t,2),l=a[0],c=a[1],u=L()(n,2),s=u[0],f=u[1];if(!this.hasEdge(r,i))return this.buildVertex(r,l,s),this.buildVertex(i,c,f),this.buildEdge(r,i),this}},{key:"addCurveEdge",value:function(e){for(var n=t.getCurveEdgePoints(e,.75),o=0;o<n.length-1;o++){var r=[n[o],n[o+1]];this.addEdge(r,[],[0!==o,o!==n.length-2])}return this}},{key:"delEdge",value:function(e,t){var n,o=this;y()(n=this.graph.getEdge(e,t)).call(n,(function(e){var t,n,r=e.edge,i=J()(r).call(r,(function(e){return e.id})),a=Or.edgeKey(i[0],i[1]),l=Or.edgeKey(i[1],i[0]);y()(t=an.Maybe.fromNull(o.meshByEdgeId[a])).call(t,(function(e){return e.dispose()})),delete o.meshByEdgeId[a],delete o.meshByEdgeId[l],(n=o.graph).delEdge.apply(n,Ht()(J()(r).call(r,(function(e){return e.position}))));var c=o.graph.getAbstractGraph();y()(r).call(r,(function(e){var t=e.id,n=e.position;0===c.getNeighbors(t).length&&o.delVertex(n)}))}))}},{key:"hasEdge",value:function(e,t){return this.graph.hasEdge(e,t)}},{key:"buildVertex",value:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]&&arguments[2];this.doesVertexCollideWithEdge(e)&&this.resolveVertexEdgeCollision(e),this.buildSimpleVertex(e,t,n)}},{key:"buildSimpleVertex",value:function(e,t){var n=this,o=arguments.length>2&&void 0!==arguments[2]&&arguments[2],r=this.graph.getVertex(e);y()(r).call(r,(function(e){var t=e.isCurve,o=e.id;t&&(n.graph.getAbstractGraph().getNeighbors(o).length>=2&&(e.isCurve=!1,n.meshByVertexId[e.id].dispose(),n.createVertexMesh(e)))})),r.orElseRun((function(){var r;n.graph.addVertex(e,t,o),y()(r=n.graph.getVertex(e)).call(r,n.createVertexMesh)}))}},{key:"addObserver2VertexMesh",value:function(e){e.observers=new Xt.Observable,e.observers.add(this.getVertexObs())}},{key:"updateCurvedNeighbors",value:function(e,t){var n,o,r=this;y()(n=J()(o=this.getCurvedNeighbors(e)).call(o,(function(e){var t=e.id,n=e.position;return{id:t,position:r.heatFlow(t,n)}}))).call(n,(function(e){var n=e.id,o=e.position;return r.updateVertexPosition(n,o,t)}))}},{key:"getCurvedNeighbors",value:function(e){var t,n,o=[],r={};y()(e).call(e,(function(e){return r[e]=!0}));for(var i=this.graph.getAbstractGraph(),a=k()(t=Gt()(n=J()(e).call(e,(function(e){return i.getNeighbors(e)}))).call(n,(function(e){return e}))).call(t,(function(e){return!(e in r)}));a.length>0;){var l,c=a.pop();r[c]=!0,y()(l=this.graph.getVertexByIndex(c)).call(l,(function(e){var t,n=e.isCurve,l=e.id;n&&(o.push(e),a.push.apply(a,Ht()(k()(t=i.getNeighbors(l)).call(t,(function(e){return!(e in r)})))))}))}return o}},{key:"heatFlow",value:function(e,t){var n,o,r,i,a=this.graph.getAbstractGraph(),l=J()(n=J()(o=k()(r=J()(i=a.getNeighbors(e)).call(i,this.graph.getVertexByIndex)).call(r,(function(e){return e.isSome()}))).call(o,(function(e){return Yt()(e).call(e)}))).call(n,(function(e){return e.position})),c=t,u=c.scale(l.length).subtract(re()(l).call(l,(function(e,t){return e.add(t)}),Xt.Vector3.Zero()));return c.add(u.scale(-.1))}},{key:"addOnClickVertex",value:function(e){var t=this;e.onClick=function(){var n=[];n.push({icon:function(e){return r.a.createElement("i",de()({className:"fas fa-trash"},e))},action:function(){t.delVertex(e.position),t.mainView.closeContextDial(),t.mainView.updateNodeInServer(t.name)},name:"Delete Node [Del]"}),t.mainView.setContextActions(n)}}},{key:"highlightCurveEdge",value:function(e){var t,n=this,o=J()(t=this.getCurvedNeighbors([e])).call(t,(function(e){var t=e.id;return n.meshByVertexId[t]}));this.mainView.highlightMeshInScene(o)}},{key:"delVertex",value:function(e){var t,n=this;y()(t=this.graph.getVertex(e)).call(t,(function(t){var o,r,i=t.id,a=n.graph.getNeighbors(e);y()(a).call(a,(function(t){var o=t.position;return n.delEdge(e,o)})),y()(o=an.Maybe.fromNull(n.meshByVertexId[i])).call(o,(function(e){return e.dispose()})),delete n.meshByVertexId[i],n.graph.delVertex(e),y()(r=k()(a).call(a,(function(e){return e.isCurve}))).call(r,(function(e){var t=e.position;return n.delVertex(t)}))}))}},{key:"updateVertexPosition",value:function(e,t){var n,o=this,r=!(arguments.length>2&&void 0!==arguments[2])||arguments[2],i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:[];this.meshByVertexId[e].position=t,this.graph.updateVertex(e,t),y()(n=this.graph.getNeighbors(t)).call(n,(function(n){var a,l=e,c=n.id;o.isEdgeInPair(l,c,i)||(o.meshByEdgeId[Or.edgeKey(l,c)].dispose(),y()(a=o.graph.getEdgeByIndex(l,c)).call(a,(function(e){o.buildEdge(t,n.position)})));r&&o.mainView.updateNodeInServer(o.name)}))}},{key:"isEdgeInPair",value:function(e,t,n){return n.length>0&&vn()(n).call(n,e)&&vn()(n).call(n,t)}},{key:"doesVertexCollideWithEdge",value:function(e){var t=this,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:Xn.RADIUS/4;return this.graph.getVertex(e).cata((function(){var o;return J()(o=t.graph.getEdge(e)).call(o,(function(t){var o,r,i=J()(o=J()(r=t.edge).call(r,(function(e){return e.position}))).call(o,hn.ofBabylon),a=i[1].sub(i[0]),l=hn.ofBabylon(e).sub(i[0]),c=a.dot(l)/a.dot(a);return!(c<0||c>1)&&l.sub(a.scale(c)).length()<=n}))}),(function(e){return an.Maybe.none()})).orSome(!1)}},{key:"resolveVertexEdgeCollision",value:function(e){var t,n=this;y()(t=this.graph.getEdge(e)).call(t,(function(t){var o,r,i,a=J()(o=J()(r=t.edge).call(r,(function(e){return e.position}))).call(o,hn.ofBabylon),l=a[1].sub(a[0]).normalize(),c=hn.ofBabylon(e).sub(a[0]),u=l.scale(c.dot(l)),s=J()(i=t.edge).call(i,(function(e){return e.position}));n.delEdge(s[0],s[1]);var f=a[0].add(u).toBabylon();n.addEdge([s[0],f]),n.addEdge([f,s[1]])}))}},{key:"buildEdge",value:function(e,n){var o,r=this,i=this.graph;i.addEdge([e,n]),y()(o=i.getVertex(e)).call(o,(function(e){var o;return y()(o=i.getVertex(n)).call(o,(function(n){var o=t.getEdgeMesh(r.scene,[e.position,n.position]);o.parent=r.mesh;var i=e.id,a=n.id;o.edgeIndexes=[i,a],r.addObserver2EdgeMesh(o),r.addOnClickEdge(o),r.meshByEdgeId[Or.edgeKey(i,a)]=o,r.meshByEdgeId[Or.edgeKey(a,i)]=o}))}))}},{key:"addObserver2EdgeMesh",value:function(e){e.observers=new Xt.Observable,e.observers.add(this.getEdgeObs())}},{key:"addOnClickEdge",value:function(e){e.onClick=this.getOnClickEdge(e)}}],[{key:"ofDict",value:function(e){var n,o=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null,i=new t(e,r,o.name,o.keyValueMap),a=o.adjMap,l=o.edges;return y()(n=E()(a)).call(n,(function(e){var t;y()(t=E()(a[e])).call(t,(function(t){if(e<t){var n,o,r=l[Or.edgeKey(e,t)],a=J()(n=J()(o=r.positions).call(o,hn.of)).call(n,(function(e){return e.toBabylon()}));i.addEdge(a,[e,t],r.isCurve)}}))})),i.graph.importData(o),i}},{key:"getEdgeWithVertexMeshes",value:function(e,n){var o=arguments.length>2&&void 0!==arguments[2]?arguments[2]:Xt.Color3.Gray(),r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:Xn.RADIUS,i=J()(n).call(n,(function(n){return t.getVertexMesh(e,n,o,r)}));return i.push(t.getEdgeMesh(e,n,o,r)),i}},{key:"getCurveEdgeWithVertexMeshes",value:function(e,n){var o=arguments.length>2&&void 0!==arguments[2]?arguments[2]:Xt.Color3.Gray(),r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:Xn.RADIUS,i=[],a=n[0],l=n[2];return i.push(t.getVertexMesh(e,a,o,r)),i.push(t.getVertexMesh(e,l,o,r)),i.push(t.getCurveEdgeMesh(e,n,o,r)),i}},{key:"getVertexMesh",value:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:Xt.Color3.Gray(),o=arguments.length>3&&void 0!==arguments[3]?arguments[3]:Xn.RADIUS,r=_n.createSphere(e,n,o);return r.position=t,r}},{key:"getEdgeMesh",value:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:Xt.Color3.Gray(),o=arguments.length>3&&void 0!==arguments[3]?arguments[3]:Xn.RADIUS;return _n.createTubeFromPoints(e,t,n,o/4)}},{key:"getCurveEdgeMesh",value:function(e,n){var o=arguments.length>2&&void 0!==arguments[2]?arguments[2]:Xt.Color3.Gray(),r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:Xn.RADIUS,i=arguments.length>4&&void 0!==arguments[4]?arguments[4]:.25;return _n.createTubeFromPoints(e,t.getCurveEdgePoints(n,i),o,r/4)}},{key:"getCurveEdgePoints",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:.25,n=L()(e,3),o=n[0],r=n[1],i=n[2],a=o.subtract(r.scale(2)).add(i),l=a.length(),c=l<.001?2:l/Math.max(1e-6,t);return c=Math.floor(c),Xt.Curve3.CreateQuadraticBezier(o,r,i,c).getPoints()}}]),t}(Pn);N()(Xr,"TYPE","GraphItem"),N()(Xr,"NAME","Roads");var Jr={},$r=function(e,t){var n=_n.createSphere(e,Xt.Color3.Gray(),Number.MIN_VALUE,t,!1);return n.position=Xt.Vector3.Zero(),n.scaling=Xt.Vector3.One(),n.rotationQuaternion=Pr.Quaternion.Identity(),n.visibility=0,n},ei=Xr,ti=function(e){function t(){var e;return xt()(this,t),ni?Pt()(e,ni):(e=Pt()(this,St()(t).call(this)),N()(At()(e),"action",(function(n){sn()(St()(t.prototype),"action",At()(e)).call(At()(e),n),n.setSelectedAction(At()(e));var o=e.getContextActions();n.setContextActions(o),n.setContextActionIndex(wr()(o).call(o,(function(t){return t.mode===e.mode})))})),N()(At()(e),"onPointerDown",(function(t,n){1===t.buttons&&e.mousePosConsumer(n)((function(t,o){var r;(r={},N()(r,oi.line,e.onPointerDownLine),N()(r,oi.curve,e.onPointerDownCurve),r)[e.mode](t,o,n)}))})),N()(At()(e),"onPointerMove",(function(t,n){e.mousePosConsumer(n)((function(t,o){var r,i=o.scene,a=o.ground;(_n.pickMesh(i,a).cata((function(){return n.highlightMeshInScene()}),(function(e){return n.highlightMeshInScene([e],Xt.Color3.Green())})),0!==e.mouseCurve.length)&&(r={},N()(r,oi.line,e.onPointerMoveLine),N()(r,oi.curve,e.onPointerMoveCurve),r)[e.mode](t,o,n)}))})),N()(At()(e),"onPointerUp",(function(e){var t;y()(t=e.getGraph()).call(t,(function(t){return e.setPropertiesWithName(t.item.name)}))})),N()(At()(e),"onKeyDown",(function(n,o){var r={Delete:function(){return e.escapeAction(n,o)},Backspace:function(){return e.escapeAction(n,o)},Escape:function(){return e.escapeAction(n,o)}};n.code in r?r[n.code]():sn()(St()(t.prototype),"onKeyDown",At()(e)).call(At()(e),n,o)})),N()(At()(e),"escapeAction",(function(n,o){e.mouseCurve.length>0?(e.deletePreviewMeshes(),e.mouseCurve=[]):sn()(St()(t.prototype),"onKeyDown",At()(e)).call(At()(e),n,o)})),N()(At()(e),"deletePreviewMeshes",(function(){var t;y()(t=e.previewMeshes).call(t,(function(e){return e.dispose()})),e.previewMeshes=[]})),N()(At()(e),"mousePosConsumer",(function(e){return function(t){var n;y()(n=e.getSceneMemory()).call(n,(function(e){var n=e.scene,o=e.ground,r=_n.getGroundPosition(n,o);y()(r).call(r,(function(n){return t(n,e)}))}))}})),N()(At()(e),"createGraphItemIfNone",(function(e,t){return t.getGraph().orElseRun((function(){var n=new ei(e,t);n.mesh.parent=t.getRootNode().item.mesh,t.addNodeItem2Tree(n)}))})),N()(At()(e),"onPointerDownLine",(function(t,n,o){var r=n.camera,i=n.canvas,a=n.scene;r.detachControl(i),0===e.mouseCurve.length?e.mouseCurve.push(t):(e.createEdge([e.mouseCurve[0],t],a,o,(function(e){return function(t){return e.addEdge(t)}})),e.mouseCurve=[],r.attachControl(i,!0))})),N()(At()(e),"onPointerMoveLine",(function(t,n,o){var r,i=n.scene,a=o.getRootNode().item.mesh,l=ri(o)([e.mouseCurve[0],t]);e.deletePreviewMeshes(),e.previewMeshes=ei.getEdgeWithVertexMeshes(i,l,Xt.Color3.Blue(),Xn.RADIUS/2),y()(r=e.previewMeshes).call(r,(function(e){e.visibility=.25,e.parent=a}))})),N()(At()(e),"onPointerDownCurve",(function(t,n,o){var r=n.camera,i=n.canvas,a=n.scene;r.detachControl(i),e.mouseCurve.length<=1?e.mouseCurve.push(t):(e.createEdge([e.mouseCurve[0],e.mouseCurve[1],t],a,o,(function(e){return function(t){return e.addCurveEdge(t)}})),e.mouseCurve=[],r.attachControl(i,!0))})),N()(At()(e),"onPointerMoveCurve",(function(t,n,o){if(e.mouseCurve.length<2)e.onPointerMoveLine(t,n,o);else{var r,i,a,l,c=n.scene,u=o.getRootNode().item.mesh,s=ri(o)(bt()(r=[]).call(r,Ht()(e.mouseCurve),[t]));e.deletePreviewMeshes(),e.previewMeshes=bt()(i=bt()(a=ei.getCurveEdgeWithVertexMeshes(c,s,Xt.Color3.Green(),Xn.RADIUS/2)).call(a,ei.getEdgeWithVertexMeshes(c,[s[0],s[1]],Xt.Color3.Blue(),Xn.RADIUS/2))).call(i,ei.getEdgeWithVertexMeshes(c,[s[1],s[2]],Xt.Color3.Blue(),Xn.RADIUS/2)),y()(l=e.previewMeshes).call(l,(function(e){e.visibility=.25,e.parent=u}))}})),N()(At()(e),"createEdge",(function(t,n,o,r){var i,a=ri(o)(t);e.createGraphItemIfNone(n,o),y()(i=o.getGraph()).call(i,(function(e){var t=e.item;r(t)(a),o.updateNodeInServer(t.name)})),e.deletePreviewMeshes()})),e.key="drawGraph",e.name="Draw Graph [C]",e.icon=function(e){return r.a.createElement("i",de()({className:"fas fa-project-diagram"},e))},e.mouseCurve=[],e.previewMeshes=[],e.mode=oi.line,ni=At()(e),e)}return Vt()(t,e),Ct()(t,[{key:"getContextActions",value:function(){var e=this;return[{icon:function(e){return r.a.createElement("i",de()({className:"fas fa-grip-lines-vertical"},e))},action:function(t){var n;t.setContextActionIndex(0),e.mode=oi.line,e.mouseCurve=[],y()(n=e.previewMeshes).call(n,(function(e){return e.dispose()})),e.previewMeshes=[]},name:"Line Mode",mode:oi.line},{icon:function(e){return r.a.createElement("i",de()({className:"fas fa-bezier-curve"},e))},action:function(t){var n;t.setContextActionIndex(1),e.mode=oi.curve,e.mouseCurve=[],y()(n=e.previewMeshes).call(n,(function(e){return e.dispose()})),e.previewMeshes=[]},name:"Curve Mode",mode:oi.curve}]}}],[{key:"getInstance",value:function(){return new t}}]),t}(rr),ni=null,oi={line:"line",curve:"curve",free:"free"},ri=function(e){var t=e.getRootNode().item.mesh;return function(e){return J()(e).call(e,(function(e){return _n.computeLocalCoordinatesFromMesh({parent:t},hn.ofBabylon(e)).toBabylon()}))}},ii=ti,ai={orbit:kr.getInstance(),dragObjects:lr.getInstance(),drawPath:gr.getInstance(),drawBoxRegion:hr.getInstance(),addKeyPoint:ur.getInstance(),drawRegion:br.getInstance(),drawGraph:ii.getInstance()},li=n(46),ci=n.n(li),ui=function(){function e(t){xt()(this,e),this.yamlSrc=t,this.cachedMap=null}var t,n;return Ct()(e,[{key:"load",value:(n=Wo()(Ko.a.mark((function t(){var n,o,r;return Ko.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(!this.cachedMap){t.next=2;break}return t.abrupt("return",this.cachedMap);case 2:return t.next=4,fetch(e.getMapUrl(this.yamlSrc));case 4:return n=t.sent,t.t0=this,t.next=8,n.text();case 8:return t.t1=t.sent,t.next=11,t.t0.parseYaml.call(t.t0,t.t1);case 11:return o=t.sent,r={textureSrc:o.image,resolution:o.resolution,origin:o.origin,imageSize:o.size},this.cachedMap=r,t.abrupt("return",r);case 15:case"end":return t.stop()}}),t,this)}))),function(){return n.apply(this,arguments)})},{key:"parseYaml",value:(t=Wo()(Ko.a.mark((function t(n){var o,r,i,a,l,c;return Ko.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return l={},c={image:function(t,n){return l[t]=e.getMapUrl(n)},resolution:function(e,t){return l[e]=Hn()(t)},origin:function(e,t){return l[e]=JSON.parse(t)}},console.log("Yaml text",n),y()(o=k()(r=k()(i=J()(a=n.split("\n")).call(a,(function(e){return e.split(": ")}))).call(i,(function(e){return e.length>=2}))).call(r,(function(e){return e[0]in c}))).call(o,(function(e){return c[e[0]](e[0],e[1])})),t.next=6,this.getImageSize(l.image);case 6:return l.size=t.sent,t.abrupt("return",l);case 8:case"end":return t.stop()}}),t,this)}))),function(e){return t.apply(this,arguments)})},{key:"getImageSize",value:function(e){return new ci.a((function(t,n){var o=new Image;o.src=e,o.onload=function(){return t([o.naturalWidth,o.naturalHeight])}}))}}]),e}();N()(ui,"getMapUrl",(function(e){return"/static/maps/".concat(e)}));var si=function(e){function t(e,n){var o;return xt()(this,t),o=Pt()(this,St()(t).call(this)),N()(At()(o),"getType",(function(){return t.TYPE})),N()(At()(o),"deleteAsset",(function(){})),N()(At()(o),"download",Wo()(Ko.a.mark((function e(){var t,n,i;return Ko.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,o.mapLoader.load();case 2:t=e.sent,n=t.textureSrc,i=o.mapLoader.yamlSrc,r.a.createElement("div",{style:{display:"flex",flexDirection:"column"}},r.a.createElement("div",{style:{display:"flex",flexDirection:"row"}},r.a.createElement("div",{style:{marginRight:"5px"}},"Image:"),r.a.createElement("a",{href:n,download:!0},n)),r.a.createElement("div",{style:{display:"flex",flexDirection:"row"}},r.a.createElement("div",{style:{marginRight:"5px"}},"Yaml:"),r.a.createElement("a",{href:ui.getMapUrl(i),download:!0},i)));case 6:case"end":return e.stop()}}),e)})))),o.name=e,o.key="addMap".concat(e),o.mapLoader=n,o.icon=function(e){return r.a.createElement("i",de()({},e,{className:"fas fa-map"}))},o}return Vt()(t,e),Ct()(t,[{key:"addMap",value:function(e){var t,n=this,o=an.Maybe.fromNull(e.getRootNode());y()(t=e.getSceneMemory()).call(t,function(){var t=Wo()(Ko.a.mark((function t(r){var i,a,l,c,u,s,f,d,h,m,p,v,g,b;return Ko.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return a=r.scene,l=r.camera,t.next=4,n.mapLoader.load();case 4:c=t.sent,u=c.textureSrc,s=c.resolution,f=c.origin,d=c.imageSize,h=s*d[0],m=s*d[1],p=_n.groundBuilder(a).name(an.Maybe.fromNull(n.memory.name).orSome(n.name)).width(h).height(m).textureSrc(u).build(),v=hn.of([-h/2,-m/2,0]).sub(hn.of(f)),y()(o).call(o,(function(e){var t=e.item.mesh.parent;t.position=Un.inverseCoordinates(v.toBabylon()),l.setTarget(new Xt.Vector3(t.position.x,t.position.y,t.position.z))})),g=new Jo(p,[h,m],n.textureSrc,an.Maybe.fromNull(n.memory.assetName).orSome(n.name)),b=J()(i=an.Maybe.fromNull(n.memory.isImport)).call(i,(function(e){return!e})).orSome(!0),e.addNodeItem2Tree(g,null,b),r.ground.dispose(),r.ground=tr.createMeshGround(a,h,m);case 19:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}())}},{key:"action",value:function(e){var n=this;sn()(St()(t.prototype),"action",this).call(this,e);var o=e.getNodeFromTree(this.name);y()(o).call(o,(function(e){})),o.orElseRun((function(){if(e.getObjectTree().length<2)return n.addMap(e)})),e.setSelectedAction(ai.orbit)}}]),t}(Qo);N()(si,"TYPE","AddMapAction");var fi=si,di=function(e){function t(e,n){var o,r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};return xt()(this,t),o=Pt()(this,St()(t).call(this,e.mesh,n,r)),N()(At()(o),"updateRobot",(function(e,t,n){var r=(new Date).getTime();n(e,.001*(r-t)),o.requestAnimationFrameId=requestAnimationFrame((function(){return o.updateRobot(e,r,n)}))})),N()(At()(o),"animate",(function(e){o.requestAnimationFrameId=requestAnimationFrame((function(){return o.updateRobot(At()(o),(new Date).getTime(),e)}))})),N()(At()(o),"getType",(function(){return t.TYPE})),o.requestAnimationFrameId=null,o.meshTree=e,o}return Vt()(t,e),Ct()(t,[{key:"toDict",value:function(){return sn()(St()(t.prototype),"toDict",this).call(this)}},{key:"toForm",value:function(){var e=sn()(St()(t.prototype),"toForm",this).call(this);return e.jsonSchema.properties={oldName:e.jsonSchema.properties.oldName,name:e.jsonSchema.properties.name,type:e.jsonSchema.properties.type,assetName:{type:"string",title:"Asset Name"},position:e.jsonSchema.properties.position,quaternion:e.jsonSchema.properties.quaternion,color:e.jsonSchema.properties.color,annotations:e.jsonSchema.properties.annotations},e.uiSchema.assetName={"ui:disabled":!0},e.data.assetName=this.assetName,e}},{key:"dispose",value:function(){sn()(St()(t.prototype),"dispose",this).call(this),mn.MasterDB.unsubscribe({Scope:"Robot",Name:this.meshTree.id,Parameter:"tf"}),window.cancelAnimationFrame(this.requestAnimationFrameId)}}],[{key:"updateRobotMeshTree",value:function(e,t){t.mesh.position=new Xt.Vector3(e.position.x,e.position.y,e.position.z);var n=new Xt.Quaternion(e.orientation.x,e.orientation.y,e.orientation.z,e.orientation.w);t.mesh.rotationQuaternion=n.normalize()}},{key:"transformMesh",value:function(e,t){var n=Math.PI/2,o=e.getBoundingInfo().boundingSphere;e.position.set(-o.center.x,-o.center.y,-o.center.z);var r=_n.createSphere(t,new Xt.Color3(0,0,0),.5*o.radius,"tfsphere".concat(e.name),!1);r.visibility=.25,r.scaling=hn.ONES.scale(1/o.radius).toBabylon(),r.addRotation(n,0,0),r.position.set(0,0,.25);var i=_n.createSphere(t,new Xt.Color3(0,0,0),1.9,e.name,!0);return i.visibility=.1,e.parent=r,r.parent=i,i}},{key:"createRobotMeshTreeRecursive",value:function(e,t,n,o){var r,i=this;t||(t=_n.createSphere(o,new Xt.Color3(0,0,0),.5,e.name,!1));var a={mesh:t,children:[]},l=new Xt.Vector3(e.position.x,e.position.y,e.position.z),c=new Xt.Quaternion(e.orientation.x,e.orientation.y,e.orientation.z,e.orientation.w);return t.position=l,t.rotationQuaternion=c,n&&(t.parent=n),a.children=J()(r=e.child).call(r,(function(e){i.createRobotMeshTreeRecursive(e,_n.referentialBuilder(o).boxParams({isVisible:!1,size:.1}).build(),t,o)})),a}},{key:"createRobotMeshTree",value:function(e,n,o){return t.createRobotMeshTreeRecursive(e,n,null,o)}},{key:"builder",value:function(){return new hi}}]),t}(Zo);N()(di,"ROBOT_MESH_NAME","Tugbot.stl"),N()(di,"TYPE","Robot"),N()(di,"getDefaultAnimator",(function(e){return function(t,n){var o=t.mesh,r=_n.getRotationMatrix(o).prodVec(new hn([3,0,0])).toBabylon();o.position=o.position.add(r.scale(n)),o.rotate(Xt.Axis.Z,-Math.PI/2*n,Xt.Space.LOCAL),Math.random()<.01&&e.updateNodeInServer(o.name)}})),N()(di,"getSocketAnimator",(function(e,t){return mn.MasterDB.subscribe({Scope:"Robot",Name:e.meshTree.id,Parameter:"tf"},(function(n){var o=n.key.Robot[e.meshTree.id].Parameter.tf.Value;o&&(console.log("ROBOT TF UPDATE...",o),di.updateRobotMeshTree(o,e),console.log("Updating robot ",e),Math.random()<.01&&t.updateNodeInServer(e.name))}),(function(n){console.log("ROBOT INIT SUB...",n.value);var o=n.value.Robot[e.meshTree.id].Parameter.tf.Value;di.updateRobotMeshTree(o,e),console.log("Updating robot ",e),t.updateNodeInServer(e.name)})),function(e,t){}}));var hi=function(){function e(){xt()(this,e),this._name=null,this._meshTree=null,this._parentMesh=null,this._scene=null,this._isPickable=!0,this._id=null,this._keyValueMap={},this._assetName=null}return Ct()(e,[{key:"name",value:function(e){return this._name=e,this}},{key:"meshTree",value:function(e){return this._meshTree=e,this}},{key:"parentMesh",value:function(e){return this._parentMesh=e,this}},{key:"scene",value:function(e){return this._scene=e,this}},{key:"isPickable",value:function(e){return this._isPickable=e,this}},{key:"id",value:function(e){return this._id=e,this}},{key:"keyValueMap",value:function(e){return this._keyValueMap=e,this}},{key:"assetName",value:function(e){return this._assetName=e,this}},{key:"build",value:function(){var e,t,n=this,o=J()(e=k()(t=E()(this)).call(t,(function(e){return"_parentMesh"!==e}))).call(e,(function(e){return n[e]}));return y()(o).call(o,(function(e){if(null===e)throw"There are missing variables to build a robot, e.g ".concat(e)})),this._meshTree.id=this._id,this._meshTree.name=this._name,this._meshTree.mesh.name=this._name,this._meshTree.mesh.isPickable=this._isPickable,this._meshTree.mesh.parent=this._parentMesh,_n.referentialBuilder(this._scene).isPickable(!1).boxParams({isVisible:!1,size:.1}).name("".concat(this._name,"Axis")).build().parent=this._meshTree.mesh,new di(this._meshTree,this._assetName,this._keyValueMap)}}]),e}(),mi=di,pi=n(47),vi=n.n(pi),gi=mn.Utils.ofNull,yi=function(e){function t(e,n){var o;return xt()(this,t),o=Pt()(this,St()(t).call(this,e)),N()(At()(o),"getType",(function(){return t.TYPE})),o.robot=n,o.pointCloudSubscribe(),o}return Vt()(t,e),Ct()(t,[{key:"pointCloudSubscribe",value:function(){var e=this;mn.MasterDB.subscribe({Scope:"Robot",Name:this.robot.id,Parameter:"front_lidar"},(function(t){var n,o,r,i,a,l,c;y()(n=Gt()(o=Gt()(r=Gt()(i=Gt()(a=Gt()(l=Gt()(c=an.Maybe.fromNull(t)).call(c,(function(e){return gi(e.key)}))).call(l,(function(t){return gi(t.Robot[e.robot.id])}))).call(a,(function(e){return gi(e.Parameter)}))).call(i,(function(e){return gi(e.front_lidar)}))).call(r,(function(e){return gi(e.Value)}))).call(o,(function(e){return gi(e.points)}))).call(n,(function(t){return e.updatePointCloud(t)}))}),(function(t){var n,o,r,i,a,l,c;y()(n=Gt()(o=Gt()(r=Gt()(i=Gt()(a=Gt()(l=Gt()(c=an.Maybe.fromNull(t.value)).call(c,(function(e){return gi(e.Robot)}))).call(l,(function(t){return gi(t[e.robot.id])}))).call(a,(function(e){return gi(e.Parameter)}))).call(i,(function(e){return gi(e.front_lidar)}))).call(r,(function(e){return gi(e.Value)}))).call(o,(function(e){return gi(e.points)}))).call(n,(function(t){return e.updatePointCloud(t)}))}))}},{key:"updatePointCloud",value:function(e){var t=new Xt.VertexData;t.positions=Gt()(e).call(e,(function(e){return e}));var n=new Array(4*e.length);t.colors=vi()(n).call(n,1),t.applyToMesh(this.mesh,!0)}},{key:"dispose",value:function(){sn()(St()(t.prototype),"dispose",this).call(this),mn.MasterDB.unsubscribe({Scope:"Robot",Name:this.robot.id,Parameter:"front_lidar"})}}],[{key:"ofDict",value:function(e){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,o=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;if(!n||!o)throw"null dictionary describing point cloud or null mainView";var r=new Xt.Mesh("cloudPoint".concat(n.name),e),i=new Xt.StandardMaterial("cloudPoint".concat(n.name,"Material"),e);return i.emissiveColor=new Xt.Color3(1,1,1),i.disableLighting=!0,i.pointsCloud=!0,i.pointSize=2,r.material=i,new t(r,n)}}]),t}(Pn);N()(yi,"TYPE","PointCloud");var bi=yi,Mi=function(){function e(){if(xt()(this,e),ki)return ki;ki=this,this.meshCacheBySceneId={},this.count=0}return Ct()(e,[{key:"hasKey",value:function(e,t){var n,o=t._uid;return Gt()(n=an.Maybe.fromNull(this.meshCacheBySceneId[o])).call(n,(function(t){return xi(t[e])})).cata((function(){return!1}),(function(){return!0}))}},{key:"put",value:function(e,t,n){var o=t._uid;return o in this.meshCacheBySceneId||(this.meshCacheBySceneId[o]={}),this.meshCacheBySceneId[o][e]=n,n.setEnabled(!1),this}},{key:"get",value:function(e,t){var n,o,r=this,i=t._uid;return J()(n=Gt()(o=an.Maybe.fromNull(this.meshCacheBySceneId[i])).call(o,(function(t){return xi(t[e])}))).call(n,(function(t){var n;console.log("#Mesh: Found Mesh in cache, retrieving copy number",r.count);var o=t.clone(bt()(n="".concat(e)).call(n,r.count++));return console.log("#Mesh:",o),o})).orNull()}},{key:"del",value:function(e){var t=e._uid;t in this.meshCacheBySceneId&&delete this.meshCacheBySceneId[t]}}],[{key:"getInstance",value:function(){return new e}}]),e}(),xi=function(e){return an.Maybe.fromNull(e)},ki=null,Ci=Mi,wi=(n(95),function(){function e(t){var n=this;xt()(this,e),N()(this,"load",(function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:function(e){return e};return new ci.a((function(o,r){var i=Ci.getInstance();if(i.hasKey(e,n.scene)){var a;console.log(bt()(a="Found Mesh ".concat(e," in cache for scene ")).call(a,n.scene)),o(t(i.get(e,n.scene)))}else{console.log("Loading mesh....");var l=new Xt.AssetsManager(n.scene),c=l.addMeshTask("","",Pi,e);c.onSuccess=function(t){console.log("Load Success",e);var o=t.loadedMeshes[0];o.name=e,i.put(e,n.scene,o)},c.onError=function(e,t,n){return r({message:t,exception:n})},l.onFinish=function(r){console.log("Load finish "),o(t(i.get(e,n.scene)))},l.load()}}))})),this.scene=t}return Ct()(e,null,[{key:"of",value:function(t){return new e(t)}}]),e}());N()(wi,"getMeshUrl",(function(e){var t;return bt()(t="".concat(Pi)).call(t,e)}));var Pi="/static/meshes/",Ei=wi;function Si(e,t){var n=E()(e);if(w.a){var o=w()(e);t&&(o=k()(o).call(o,(function(t){return M()(e,t).enumerable}))),n.push.apply(n,o)}return n}var Ni=function(e){function t(e){var n,o=arguments.length>1&&void 0!==arguments[1]?arguments[1]:function(e,t){return mi.getDefaultAnimator(t)};return xt()(this,t),n=Pt()(this,St()(t).call(this)),N()(At()(n),"action",(function(e){sn()(St()(t.prototype),"action",At()(n)).call(At()(n),e),e.getNodeFromTree(n.robot.name).orElseRun((function(){return n.addRobot(e)})),e.setSelectedAction(ai.dragObjects)})),N()(At()(n),"getRobot",(function(e,t,o){var r=mi.createRobotMeshTree(n.robot.robotTree,t,e),i=an.Maybe.fromNull(n.memory.nodeItemDict);return mi.builder().id(n.robot.id).name(an.Maybe.fromNull(n.memory.name).orSome(n.robot.name)).assetName(an.Maybe.fromNull(n.memory.assetName).orSome(n.robot.name)).meshTree(r).parentMesh(o).scene(e).keyValueMap(J()(i).call(i,(function(e){return e.keyValueMap})).orSome({})).build()})),N()(At()(n),"getCloudPoint",(function(e,t,o){var r=bi.ofDict(e,{name:n.robot.name,id:n.robot.id},t);return r.mesh.parent=o.mesh,r})),N()(At()(n),"getParentMesh",(function(e){var t,o,r;return J()(t=Gt()(o=J()(r=an.Maybe.fromNull(n.memory.parentObj)).call(r,(function(e){return e.parent}))).call(o,(function(t){return e.getNodeFromTree(t)}))).call(t,(function(e){return e.item.mesh})).orSome(e.getRootNode().item.mesh)})),N()(At()(n),"getType",(function(){return t.TYPE})),n.robot=e,n.key="robotAction".concat(e.name),n.name=e.name,n.robotAnimatorFactory=o,n.icon=function(e){return r.a.createElement("i",de()({className:"fas fa-robot"},e))},n}return Vt()(t,e),Ct()(t,[{key:"addRobot",value:function(e){var t,n=this;y()(t=e.getSceneMemory()).call(t,(function(t){var o=t.scene,r=function(e){for(var t=1;t<arguments.length;t++){var n,o=null!=arguments[t]?arguments[t]:{};if(t%2)y()(n=Si(Object(o),!0)).call(n,(function(t){N()(e,t,o[t])}));else if(v.a)m()(e,v()(o));else{var r;y()(r=Si(Object(o))).call(r,(function(t){d()(e,t,M()(o,t))}))}}return e}({},n.memory);Ei.of(o).load(mi.ROBOT_MESH_NAME,(function(e){return mi.transformMesh(e,o)})).then((function(t){return n.createRobotFromMesh(t,o,e,r)}))})),this.memory.isImport=!1}},{key:"createRobotFromMesh",value:function(e,t,n,o){var r=this.getParentMesh(n),i=this.getRobot(t,e,r);i.animate(this.robotAnimatorFactory(i,n));var a=an.Maybe.fromNull(o.isImport).orSome(!1);n.addNodeItem2Tree(i,r.name,!a);var l=this.getCloudPoint(t,n,i);n.addNodeItem2Tree(l,i.name,!1),n.renderMenus()}}]),t}(Qo);N()(Ni,"TYPE","RobotAction");var Ai=Ni,Ti=function(e){function t(e,n){var o,r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};return xt()(this,t),o=Pt()(this,St()(t).call(this,e,n,r)),N()(At()(o),"getType",(function(){return t.TYPE})),o}return Vt()(t,e),Ct()(t,[{key:"toDict",value:function(){return sn()(St()(t.prototype),"toDict",this).call(this)}},{key:"toForm",value:function(){var e=sn()(St()(t.prototype),"toForm",this).call(this);return e.jsonSchema.properties={oldName:e.jsonSchema.properties.oldName,name:e.jsonSchema.properties.name,type:e.jsonSchema.properties.type,assetName:{type:"string",title:"Asset Name"},position:e.jsonSchema.properties.position,quaternion:e.jsonSchema.properties.quaternion,color:e.jsonSchema.properties.color,annotations:e.jsonSchema.properties.annotations},e.uiSchema.assetName={"ui:disabled":!0},e.data.assetName=this.assetName,e}},{key:"getMouseContextActions",value:function(e){var n;return k()(n=sn()(St()(t.prototype),"getMouseContextActions",this).call(this,e)).call(n,(function(e){return"Delete"===e.title}))}}]),t}(Zo);N()(Ti,"TYPE","Mesh");var Vi=Ti;function Ii(e,t){var n=E()(e);if(w.a){var o=w()(e);t&&(o=k()(o).call(o,(function(t){return M()(e,t).enumerable}))),n.push.apply(n,o)}return n}var Bi=function(e){function t(e){var n;return xt()(this,t),n=Pt()(this,St()(t).call(this)),N()(At()(n),"addMesh",(function(e){var t;y()(t=e.getSceneMemory()).call(t,(function(t){var o=t.scene,r=function(e){for(var t=1;t<arguments.length;t++){var n,o=null!=arguments[t]?arguments[t]:{};if(t%2)y()(n=Ii(Object(o),!0)).call(n,(function(t){N()(e,t,o[t])}));else if(v.a)m()(e,v()(o));else{var r;y()(r=Ii(Object(o))).call(r,(function(t){d()(e,t,M()(o,t))}))}}return e}({},n.memory);Ei.of(o).load(n.key).then(n.transformMesh(e,o,r)).then(n.addMesh2Scene(e,o,r))})),n.memory.isImport=!1})),N()(At()(n),"transformMesh",(function(e,t,o){return function(r){var i,a,l,c=n.getParentMesh(e);r.parent=c,r.createNormals();var u=an.Maybe.fromNull(o.isImport).orSome(!1),s=an.Maybe.fromNull(o.nodeItemDict);r.position=J()(i=Gt()(s).call(s,(function(e){return u?Yt()(an.Maybe).call(an.Maybe,e.position):an.Maybe.none()}))).call(i,Xt.Vector3.FromArray).orSome(Xt.Vector3.Zero()),r.rotationQuaternion=J()(a=Gt()(s).call(s,(function(e){return u?Yt()(an.Maybe).call(an.Maybe,e.quaternion):an.Maybe.none()}))).call(a,(function(e){return new Xt.Quaternion(e[1],e[2],e[3],e[0])})).orSome(Xt.Quaternion.Identity());var f=new Xt.StandardMaterial("Mesh".concat(r.name),t),d=J()(l=Gt()(s).call(s,(function(e){return u?Yt()(an.Maybe).call(an.Maybe,e.color):an.Maybe.none()}))).call(l,Xt.Color3.FromArray).orSome(Xt.Color3.Gray());return f.diffuseColor=d,f.emissiveColor=d,r.material=f,r}})),N()(At()(n),"addMesh2Scene",(function(e,t,o){return function(t){var r,i,a,l=n.getParentMesh(e),c=an.Maybe.fromNull(o.isImport).orSome(!1),u=Gt()(r=an.Maybe.fromNull(o.nodeItemDict)).call(r,(function(e){return c?Yt()(an.Maybe).call(an.Maybe,e.name):an.Maybe.none()})).orSome(bt()(i="".concat(n.name)).call(i,Math.floor(100*Math.random())));t.name=u;var s=new Vi(t,n.name,Gt()(a=an.Maybe.fromNull(o.nodeItemDict)).call(a,(function(e){return c?Yt()(an.Maybe).call(an.Maybe,e.keyValueMap):an.Maybe.none()})).orSome({}));e.addNodeItem2Tree(s,l.name,!c),e.renderMenus()}})),N()(At()(n),"getParentMesh",(function(e){var t,o,r;return J()(t=Gt()(o=J()(r=an.Maybe.fromNull(n.memory.parentObj)).call(r,(function(e){return e.parent}))).call(o,(function(t){return e.getNodeFromTree(t)}))).call(t,(function(e){return e.item.mesh})).orSome(e.getRootNode().item.mesh)})),N()(At()(n),"getType",(function(){return t.TYPE})),N()(At()(n),"deleteAsset",(function(){})),N()(At()(n),"download",Wo()(Ko.a.mark((function e(){return Ko.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:r.a.createElement("div",{style:{display:"flex",flexDirection:"column"}},r.a.createElement("div",{style:{display:"flex",flexDirection:"row"}},r.a.createElement("div",{style:{marginRight:"5px"}},"Mesh:"),r.a.createElement("a",{href:Ei.getMeshUrl(n.key),download:!0},n.key)));case 1:case"end":return e.stop()}}),e)})))),n.key=e.id,n.name=e.name,n.icon=function(e){return r.a.createElement("i",de()({},e,{className:"fas fa-draw-polygon"}))},n}return Vt()(t,e),Ct()(t,[{key:"action",value:function(e){var n;sn()(St()(t.prototype),"action",this).call(this,e),console.log(bt()(n="Mesh ".concat(this.key," : ")).call(n,this.name),this.memory),this.addMesh(e),e.setSelectedAction(ai.dragObjects)}}]),t}(Qo);N()(Bi,"TYPE","AddMeshAction");var Di=Bi,ji={Map:"Map",Robot:"Robot",Mesh:"Mesh"},Fi={Map:function(e){return new fi(e.name,e.loader)},Robot:function(e){return new Ai(e,mi.getSocketAnimator)},Mesh:function(e){return new Di(e)}},Ri={GlobalRef:Un,Box:jn,KeyPoint:Yn,Path:no,Wall:bo,BoxRegion:No,PolygonRegion:Uo,GraphItem:ei};function Oi(e){return e.type in ji}function _i(e,t,n){var o=an.Maybe.fromNull(t.assetName).orSome(t.name),r=e.getAssetsActionMap(),i=an.Maybe.fromNull(r[o]).orSome(r[o.split(".")[0]]);i?(i.memory.parentObj={parent:n},i.memory.nodeItemDict=t,i.memory.assetName=o,i.memory.name=t.name,i.memory.isImport=!0,i.action(e)):console.log("Action ".concat(o,", has not found, keep importing..."))}function Li(e,t,n){var o,r=Ri[t.type];r&&y()(o=e.getSceneMemory()).call(o,(function(o){var i,a=o.scene,l=r.ofDict(a,t,e);l.mesh.setEnabled(t.isVisible),y()(i=e.getNodeFromTree(n)).call(i,(function(e){l.mesh.parent=e.item.mesh})),e.addNodeItem2Tree(l,n,!1,t.isVisible)}))}function zi(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;if(t){var o=cn()(t).call(t,(function(e,t){return"GlobalRef"===e.item.type||e.name<t.name?-1:e.name>t.name?1:0}));y()(o).call(o,(function(t){Oi(t.item)?_i(e,t.item,n):Li(e,t.item,n),t.children.length>0&&zi(e,t.children,t.name)}))}}function qi(e,t){var n;y()(n=e.getSceneMemory()).call(n,(function(n){var o=n.scene,r=!t;e.addNodeItem2Tree(Un.ofDict(o),null,r)}))}var Ui=function(){function e(){xt()(this,e)}return Ct()(e,null,[{key:"importScene",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[],n=arguments.length>2&&void 0!==arguments[2]&&arguments[2];console.log("Importing scene...",e,t),t.length>0?zi(e,t):qi(e,n),console.log("End Importing scene")}}]),e}(),Gi=function e(){xt()(this,e)};N()(Gi,"retrieveScene",(function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:Yi,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:Ki("retrieving scene");mn.MasterDB.cloudFunction(Xn.CLOUD_FUNCTION_NAME,"retrieveScene",e,(function(e){return Wi(e,t,n)}))}));var Ki=function(e){return function(t){var n;throw""+bt()(n="Exception caught in ".concat(e,": ")).call(n,t.error)}},Yi=function(e){},Wi=function(e,t,n){e.success?t(e):n(e)},Qi=Gi;function Zi(e,t){var n=E()(e);if(w.a){var o=w()(e);t&&(o=k()(o).call(o,(function(t){return M()(e,t).enumerable}))),n.push.apply(n,o)}return n}function Hi(e){for(var t=1;t<arguments.length;t++){var n,o=null!=arguments[t]?arguments[t]:{};if(t%2)y()(n=Zi(Object(o),!0)).call(n,(function(t){N()(e,t,o[t])}));else if(v.a)m()(e,v()(o));else{var r;y()(r=Zi(Object(o))).call(r,(function(t){d()(e,t,M()(o,t))}))}}return e}function Xi(e,t,n){if(e.length==t.length){for(var o=!0,r=0;r<e.length;r++){var i=e[r],a=t[r];if(!n(i,a))return!1;o=o&&Xi(i.children,a.children,n)}return o}return!1}function Ji(e){return e.expanded=!0,e}function $i(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:function(e){return!0};if(!e||0===e.length)return[];var n=[];return y()(e).call(e,(function(e){var o=Hi({},e);if(t(o))n.push(Ji(o));else if(o.children){var r=$i(o.children,t);0!==r.length&&(o.children=r,n.push(Ji(o)))}})),n}var ea=function(){function e(t){xt()(this,e),this.tree=t}return Ct()(e,[{key:"getNode",value:function(e){return function e(t,n){for(var o=0;o<t.length;o++){var r=t[o];if(n(r))return Yt()(an.Maybe).call(an.Maybe,r);var i=e(r.children,n);if(i.isSome())return i}return an.Maybe.none()}(this.tree,e)}},{key:"getParentNode",value:function(e){return function e(t,n,o){var r;if(re()(r=J()(t).call(t,(function(e){return n(e)}))).call(r,(function(e,t){return e||t}),!1))return an.Maybe.fromNull(o);for(var i=0;i<t.length;i++){var a=t[i],l=e(a.children,n,a);if(l.isSome())return l}return an.Maybe.none()}(this.tree,e,null)}},{key:"equals",value:function(t){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:function(e,t){return e===t};return t.constructor===e?Xi(this.tree,t.tree,n):Xi(this.tree,t,n)}},{key:"map",value:function(t){return new e(function e(t,n,o){for(var r=0;r<t.length;r++){var i=t[r],a=o(i);a.children=[],e(i.children,a.children,o),n.push(a)}return n}(this.tree,[],t))}},{key:"filter",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:function(e){return!0};return $i(this.tree,e)}}]),e}(),ta=function(){function e(t,n,o,r,i){xt()(this,e),this.title=t,this.item=n,this.children=o,this.expanded=r,this.isVisible=i}return Ct()(e,null,[{key:"dispose",value:function(t){var n;t.item.dispose(),y()(n=t.children).call(n,(function(t){e.dispose(t)}))}},{key:"toDict",value:function(t){var n;return{name:t.title,item:t.item.toDict(),children:J()(n=t.children).call(n,(function(t){return e.toDict(t)}))}}},{key:"builder",value:function(){return new na}}]),e}(),na=function(){function e(){xt()(this,e),this._title=null,this._item={},this._children=[],this._expanded=!0,this._isVisible=!0}return Ct()(e,[{key:"title",value:function(e){return this._title=e,this}},{key:"item",value:function(e){return this._item=e,this}},{key:"children",value:function(e){return this._children=e,this}},{key:"expanded",value:function(e){return this._expanded=e,this}},{key:"isVisible",value:function(e){return this._isVisible=e,this}},{key:"build",value:function(){var e;return y()(e=Qt()(this)).call(e,(function(e){if(null===e)throw"There are missing variables to build a TreeNode, e.g ".concat(e)})),new ta(this._title,this._item,this._children,this._expanded,this._isVisible)}}]),e}(),oa=ta,ra=Xn.CLOUD_FUNCTION_NAME,ia=function(){function e(t){var n=this;xt()(this,e),N()(this,"getNodeFromTree",(function(e,t){return new ea(t).getNode((function(t){return e===t.title}))})),N()(this,"getParentFromChild",(function(e,t){return new ea(t).getParentNode((function(t){return e===t.title}))})),N()(this,"deleteNodeFromTreeUsingName",(function(e,t){var o,r=!(arguments.length>2&&void 0!==arguments[2])||arguments[2];return y()(o=n.getNodeFromTree(e,t)).call(o,(function(o){oa.dispose(o),r&&n.deleteNodeInServer(e);var i=n.getParentFromChild(e,t);y()(i).call(i,(function(t){var n;t.children=k()(n=t.children).call(n,(function(t){return t.title!==e}))})),t=k()(t).call(t,(function(t){return t.title!==e}))})),t})),N()(this,"getNodeFromTreeWithPredicate",(function(e,t){return new ea(t).getNode(e)})),N()(this,"addNodeItem2Tree",(function(e,t){var o=arguments.length>2&&void 0!==arguments[2]?arguments[2]:Un.NAME,r=!(arguments.length>3&&void 0!==arguments[3])||arguments[3],i=!(arguments.length>4&&void 0!==arguments[4])||arguments[4];n.deleteNodeFromTreeUsingName(t.name,e,r);var a=oa.builder().title(t.name).item(t).isVisible(i).build();if(o){var l=n.getNodeFromTree(o,e);y()(l).call(l,(function(e){r&&n.addNodeItem2Server(a,e.title),e.children.push(a)}))}else e.push(a),r&&n.addNodeItem2Server(a,null);return e})),N()(this,"updateNodeInServer",(function(e,t){var o,r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;console.log("updateNodeInServer!",n.sceneName),y()(o=n.getNodeFromTree(e,t)).call(o,(function(o){var i,a=J()(i=n.getParentFromChild(e,t)).call(i,(function(e){return e.title})).orNull();mn.MasterDB.cloudFunction(ra,"updateNode",[oa.toDict(o),a,r,n.sceneName],(function(e){console.log("Update node with success?",e.success)}))}))})),N()(this,"addNodeItem2Server",(function(e,t){mn.MasterDB.cloudFunction(ra,"addNodeItem",[oa.toDict(e),t,n.sceneName],(function(e){console.log("Add node with success?",e.success)}))})),N()(this,"deleteNodeInServer",(function(e){mn.MasterDB.cloudFunction(ra,"deleteNodeByName",[e,n.sceneName],(function(e){console.log("Deleted node with success?",e.success)}))})),this.sceneName=t}return Ct()(e,null,[{key:"ofScene",value:function(t){return new e(t)}}]),e}(),aa=function(){function e(){var t=this;if(xt()(this,e),N()(this,"getAssets",(function(){return t.assets})),N()(this,"getAssetsActionMap",(function(){return t.assetsActionMap})),N()(this,"addAfterLoad",(function(e){return t.afterLoad.push(e),t})),N()(this,"signalObservers",(function(){var e;return y()(e=t.observers).call(e,(function(e){return e()}))})),N()(this,"subs",[function(){return mn.MasterDB.subscribe({Scope:"Robot",Name:"*",RobotName:"*"},(function(e){}),(function(e){var n,o;y()(n=Gt()(o=ca(e.value)).call(o,ua("Robot"))).call(n,(function(e){var n;y()(n=E()(e)).call(n,(function(n){return t.addRobot(n,e[n].RobotName)}))})),t.finishSub("RobotName")}))},function(){return mn.MasterDB.subscribe({Scope:"Robot",Name:"*",Parameter:"tf"},(function(e){}),(function(e){var n,o;y()(n=Gt()(o=ca(e.value)).call(o,ua("Robot"))).call(n,(function(e){var n;y()(n=E()(e)).call(n,(function(n){return t.addRobot(n,null,e[n].Parameter.tf.Value)}))})),t.finishSub("Robot tf")}))},function(){return mn.MasterDB.subscribe({Scope:"Package",File:"*",Name:"maps",FileLabel:"*"},t.getMapUpdater((function(e){return e.key}),t.signalObservers),t.getMapSubscriber((function(e){return e.value}),(function(){return t.finishSub("Maps")})))},function(){return mn.MasterDB.subscribe({Scope:"Package",File:"*",Name:"meshes",FileLabel:"*"},t.getMeshUpdater(),t.getMeshSubscriber((function(e){return e.value}),(function(){return t.finishSub("Meshes")})))}]),N()(this,"finishSub",(function(e){var n;(console.log("FINISH SUB ",e,t.finishInitialSubscribers),++t.finishInitialSubscribers>t.subs.length-1)&&y()(n=t.afterLoad).call(n,(function(e){return e()}))})),N()(this,"getMapSubscriber",(function(e){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:function(){};return function(o){var r;return y()(r=t.getMapFileData(e,o)).call(r,(function(e){var o,r;y()(o=k()(r=E()(e)).call(r,(function(e){return vn()(e).call(e,".yaml")}))).call(o,t.addMap),n()}))}})),N()(this,"getMapUpdater",(function(e){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:function(){},o={del:function(o){var r;y()(r=t.getMapFileData(e,o)).call(r,(function(e){var n=E()(e)[0];n=n.split(".")[0],delete t.assets[n],delete t.assetsActionMap[n]})),n()},set:t.getMapSubscriber(e,n),subscribe:t.getMapSubscriber(e,n)};return function(e){console.log("MAP UPDATE",e),o[e.event](e)}})),N()(this,"addMap",(function(e){var n={name:e.split(".")[0],loader:new ui(e),type:ji.Map};t.addAsset(n.name,n)})),N()(this,"getMapFileData",(function(e,t){var n,o,r;return Gt()(n=Gt()(o=Gt()(r=ca(e(t))).call(r,ua("Package"))).call(o,ua("maps"))).call(n,ua("File"))})),N()(this,"getMeshSubscriber",(function(e){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:function(){};return function(o){var r;y()(r=t.getMeshFileData(e,o)).call(r,(function(e){var n;return y()(n=E()(e)).call(n,(function(n){var o={id:n,name:e[n].FileLabel,type:ji.Mesh};t.addAsset(o.name,o)}))})),n()}})),N()(this,"getMeshUpdater",(function(){var e={del:function(e){var n;y()(n=t.getMeshFileData((function(e){return e.key}),e)).call(n,(function(e){var n=E()(e)[0];delete t.assets[n],delete t.assetsActionMap[n]})),t.signalObservers()},set:t.getMeshSubscriber((function(e){return e.key}),t.signalObservers),subscribe:t.getMeshSubscriber((function(e){return e.key}),t.signalObservers)};return function(t){return e[t.event](t)}})),N()(this,"getMeshFileData",(function(e,t){var n,o,r;return Gt()(n=Gt()(o=Gt()(r=ca(e(t))).call(r,ua("Package"))).call(o,ua("meshes"))).call(n,ua("File"))})),la)return la;la=this,this.assets={},this.assetsActionMap={},this.robots={},this.observers=[],this.afterLoad=[],this.finishInitialSubscribers=0,this.retrieveAssetsFromDb()}return Ct()(e,[{key:"addObserver",value:function(e){return this.observers.push(e),this}},{key:"addAsset",value:function(e,t){try{this.assets[e]=t,this.assetsActionMap[e]=Fi[t.type](t)}catch(e){console.log("Caught exception while adding asset",e)}}},{key:"retrieveAssetsFromDb",value:function(){var e;y()(e=this.subs).call(e,(function(e){return e()}))}},{key:"addRobot",value:function(e){var t,n,o,r=this,i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;if(e in this.robots||(this.robots[e]={id:e,name:null,tf:null}),y()(t=ca(i)).call(t,(function(t){return r.robots[e].name=t})),y()(n=ca(a)).call(n,(function(t){return r.robots[e].tf=t})),Sr()(o=Qt()(this.robots[e])).call(o,(function(e){return null!==e}))){var l=this.robots[e];l.tf.name=l.name,this.addAsset(l.name,{name:l.name,id:e,type:ji.Robot,robotTree:l.tf})}}}],[{key:"getInstance",value:function(){return new e}}]),e}(),la=null,ca=an.Maybe.fromNull,ua=function(e){return(t=ca,function(e){return function(n){return t(e(n))}})(function(e){return function(t){return t[e]}}(e));var t},sa=aa,fa=function(){function e(t,n,o){xt()(this,e),this.state=t,this.next=n,this.while=o,this.requestAnimeId=null}return Ct()(e,[{key:"play",value:function(){var e=this;return this.requestAnimeId=requestAnimationFrame((function(){if(!e.while(e.state))return e.stop();e.state=e.next(e.state),e.play()})),this}},{key:"stop",value:function(){return cancelAnimationFrame(this.requestAnimeId),this}}],[{key:"builder",value:function(){return new da}}]),e}(),da=function(){function e(){xt()(this,e),this._state=null,this._next=null,this._end=null}return Ct()(e,[{key:"initialState",value:function(e){return this._state=e,this}},{key:"nextState",value:function(e){return this._next=e,this}},{key:"while",value:function(e){return this._end=e,this}},{key:"build",value:function(){var e;if(Yt()(e=[this._state,this._next,this._end]).call(e,(function(e){return null==e})))throw"Animator properties are missing";return new fa(this._state,this._next,this._end)}}]),e}(),ha=function e(){xt()(this,e)};function ma(e,t){var n=E()(e);if(w.a){var o=w()(e);t&&(o=k()(o).call(o,(function(t){return M()(e,t).enumerable}))),n.push.apply(n,o)}return n}N()(ha,"onPointerDown",(function(e){return function(t){var n;e.mousePosClick=e.getMouseCoordinatesFromRoot().orSome(Xt.Vector3.Zero()),e.mousePosMove=e.mousePosClick,y()(n=e.sceneMemory).call(n,(function(e){var n=e.camera,o=e.canvas;(2===t.buttons||4===t.buttons||t.ctrlKey)&&n.detachControl(o)}))}})),N()(ha,"onPointerUp",(function(e){return function(t){var n;y()(n=e.sceneMemory).call(n,(function(e){var t=e.camera,n=e.canvas;t.attachControl(n,!0)}))}})),N()(ha,"onPointerMove",(function(e){return function(t){var n;y()(n=e.sceneMemory).call(n,(function(n){var o,r=n.mouseLocationText,i=n.camera;y()(o=e.getMouseCoordinatesFromRoot()).call(o,(function(n){!function(e,t){var n;e.text=bt()(n="x: ".concat(t.x.toFixed(2),", y: ")).call(n,t.y.toFixed(2))}(r,n);var o=function(){var t=n.subtract(e.mousePosMove),o=_n.getBabylonCoordinates(t).scale(-1);!function(e,t){fa.builder().initialState({camera:e,time:0,T:(new Date).getTime()}).nextState((function(e){var n=e.camera,o=e.time,r=(e.T,t.scale(.1));return n.position=n.position.add(r),n.setTarget(n.target.add(r)),{camera:n,time:o+.1,T:(new Date).getTime()}})).while((function(e){return e.time<=1})).build().play()}(i,o),e.mousePosMove=n},a=[{predicate:t.ctrlKey&&1===t.buttons,action:o},{predicate:4===t.buttons,action:o}],l=k()(a).call(a,(function(e){return e.predicate}));l.length>0&&l[0].action()}))}))}}));var pa=function(e){function t(e){var n;return xt()(this,t),n=Pt()(this,St()(t).call(this,e)),N()(At()(n),"getSceneMemory",(function(){return n.sceneMemory})),N()(At()(n),"getAssetsActionMap",(function(){return sa.getInstance().getAssetsActionMap()})),N()(At()(n),"getRootNode",(function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:Ht()(n.objectTree);return k()(e).call(e,(function(e){return e.title===Un.NAME}))[0]})),N()(At()(n),"getObjectTree",(function(){return n.objectTree})),N()(At()(n),"setSelectedAction",(function(){})),N()(At()(n),"getNodeFromTree",(function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:Ht()(n.objectTree);return ia.ofScene(n.sceneName).getNodeFromTree(e,t)})),N()(At()(n),"deleteNodeFromTreeUsingName",(function(){throw"Delete Node in viewer Exception"})),N()(At()(n),"updateNodeInServer",(function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;n.props.focusObject.Value===e&&n.setCameraToTarget(),ia.ofScene(n.sceneName).updateNodeInServer(e,Ht()(n.objectTree),t)})),N()(At()(n),"addNodeItem2Tree",(function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:Un.NAME,o=!(arguments.length>2&&void 0!==arguments[2])||arguments[2],r=!(arguments.length>3&&void 0!==arguments[3])||arguments[3],i=ia.ofScene(n.sceneName).addNodeItem2Tree(Ht()(n.objectTree),e,t,o,r);n.objectTree=i})),N()(At()(n),"setCameraToTarget",(function(){var e;y()(e=n.sceneMemory).call(e,(function(e){var t=e.camera,o=n.props.focusObject.Value;n.getNodeFromTree(o).cata((function(){console.log("Set Camera",n.getRootNode().item.mesh._absolutePosition),t.setTarget(n.getRootNode().item.mesh._absolutePosition.clone())}),(function(e){console.log("Set Camera, Found Object",e.item.mesh),t.setTarget(e.item.mesh._absolutePosition.clone())}))}))})),N()(At()(n),"onPointerDown",(function(e){ha.onPointerDown(At()(n))(e)})),N()(At()(n),"onPointerUp",(function(e){ha.onPointerUp(At()(n))(e)})),N()(At()(n),"onPointerMove",(function(e){ha.onPointerMove(At()(n))(e)})),N()(At()(n),"onResize",(function(e,t){var o;0==e&&0==t||y()(o=n.getSceneMemory()).call(o,(function(n){var o=n.mouseLocationText;o.left=-e/2+e/17,o.top=-t/2+t/30}))})),N()(At()(n),"retrieveSceneFromServer",(function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:function(){};Qi.retrieveScene(n.sceneName,(function(t){Ui.importScene(At()(n),t.result),gt()(e)}))})),N()(At()(n),"getAssets",(function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:function(){},t=sa.getInstance();t.addAfterLoad(e),Qt()(t.getAssets()).length>0&&e()})),N()(At()(n),"loadScene",(function(){return n.getAssets((function(){return n.retrieveSceneFromServer(n.renderScene)}))})),N()(At()(n),"renderScene",(function(){var e;y()(e=n.getSceneMemory()).call(e,(function(e){var t=e.engine,n=e.scene;return t.runRenderLoop((function(){return n.render()}))})),n.setCameraToTarget()})),N()(At()(n),"onSceneReady",(function(e){var t=e.getEngine(),o=t.getRenderingCanvas();n.addCanvasEventListeners(o);var r=tr.createMouseLocationText(e);return n.sceneMemory=Yt()(an.Maybe).call(an.Maybe,{engine:t,canvas:o,scene:e,camera:tr.createCamera(e,o),light:tr.createLight(e),ground:tr.createMeshGround(e),gizmoManager:tr.createGizmo(e),highlightLayer:{hl:new Xt.HighlightLayer("hl1",e),lastHlMeshes:[]},mouseLocationText:r}),e})),N()(At()(n),"componentDidUpdate",(function(e){var t=[{propVar:function(e){return e.sceneName.Value},action:function(){return n.sceneName=n.props.sceneName.Value}},{propVar:function(e){return e.focusObject.Value},action:n.setCameraToTarget}];J()(t).call(t,(function(t){var o=t.propVar,r=t.action;o(n.props)!==o(e)&&r()}))})),N()(At()(n),"componentDidMount",(function(){console.log("SceneViewer Did Mount!! "),n.loadScene()})),n.sceneName=e.sceneName.Value,n.sceneMemory=an.Maybe.none(),n.objectTree=[],n}return Vt()(t,e),Ct()(t,[{key:"getGraph",value:function(){return new ea(this.objectTree).getNode((function(e){return ei.TYPE===e.item.getType()}))}},{key:"addCanvasEventListeners",value:function(e){var t=this,n=[{name:"pointerdown",function:function(e){return t.onPointerDown(e)}},{name:"pointerup",function:function(e){return t.onPointerUp(e)}},{name:"pointermove",function:function(e){return t.onPointerMove(e)}}];y()(n).call(n,(function(t){return e.addEventListener(t.name,t.function,!1)}))}},{key:"getMouseCoordinatesFromRoot",value:function(){var e,t=this;return Gt()(e=this.sceneMemory).call(e,(function(e){var n=e.scene,o=e.ground,r=_n.getGroundPosition(n,o);return Gt()(r).call(r,(function(e){var n;return J()(n=an.Maybe.fromNull(t.getRootNode())).call(n,(function(t){return _n.computeLocalCoordinatesFromMesh(t.item.mesh,hn.ofBabylon(e)).toBabylon()}))}))}))}},{key:"render",value:function(){return r.a.createElement("div",{style:{display:"flex",flexGrow:1}},r.a.createElement(rn,{onSceneReady:this.onSceneReady,is2render:!1,sceneFactory:tr.createScene}),r.a.createElement($t.a,{handleWidth:!0,handleHeight:!0,onResize:this.onResize}))}}],[{key:"getComponentFactory",value:function(e){return function(n){var o=function(e){for(var t=1;t<arguments.length;t++){var n,o=null!=arguments[t]?arguments[t]:{};if(t%2)y()(n=ma(Object(o),!0)).call(n,(function(t){N()(e,t,o[t])}));else if(v.a)m()(e,v()(o));else{var r;y()(r=ma(Object(o))).call(r,(function(t){d()(e,t,M()(o,t))}))}}return e}({sceneName:e},n);return r.a.createElement(t,o)}}}]),t}(o.Component);N()(pa,"EXTENSION",".3d"),pa.propTypes={sceneName:c.a.shape({Value:c.a.string}),focusObject:c.a.shape({Value:c.a.string})},pa.defaultProps={sceneName:{Value:"Pedro"},focusObject:{Value:""}};var va=pa,ga=n(88),ya=n.n(ga),ba=(n(96),n(89)),Ma=n.n(ba),xa=n(90),ka=n.n(xa),Ca=Object($.makeStyles)((function(e){return{formControl:{margin:e.spacing(1),minWidth:120}}})),wa=function(e){var t,n=Ca(),o=r.a.createElement("div",null);return e.noneOption&&(o=r.a.createElement(ce.a,{value:""},r.a.createElement("em",null,"None"))),r.a.createElement(Ma.a,{variant:e.variant,className:n.formControl,style:e.style,hiddenLabel:void 0===e.label},r.a.createElement(ya.a,{id:"demo-simple-select-filled-label"},e.label),r.a.createElement(ka.a,{labelId:"demo-simple-select-filled-label",id:"demo-simple-select-filled",value:e.value,onChange:e.onChange},o,J()(t=e.options).call(t,(function(e,t){return r.a.createElement(ce.a,{key:t,value:e},e)}))))};wa.propTypes={value:c.a.string,options:c.a.array,noneOption:c.a.bool,label:c.a.string,variant:c.a.string,style:c.a.object,onChange:c.a.func},wa.defaultProps={value:"option2",options:["option1","option2","option3"],variant:"filled",noneOption:!0,onChange:function(e){return console.log(e.target.value)}};var Pa=wa,Ea=n(50),Sa=n(91),Na=n.n(Sa),Aa=n(92),Ta=n.n(Aa),Va=n(93),Ia=function(e){var t=e.path,n=void 0===t?"":t,o=e.style,i=void 0===o?{}:o,a=vi()(e),l=void 0===a?"#fff":a,c=e.width,u=void 0===c?"100%":c,s=e.height,f=void 0===s?"100%":s,d=e.className,h=void 0===d?"":d,m=e.viewBox,p=void 0===m?"0 0 24 24":m;return r.a.createElement("svg",{width:u,style:i,height:f,viewBox:p,xmlns:"http://www.w3.org/2000/svg",className:"svg-icon ".concat(h||""),xmlnsXlink:"http://www.w3.org/1999/xlink"},r.a.createElement("path",{fill:l,d:n}))},Ba={Close:r.a.createElement(Ia,{width:24,path:"M19 6.41L17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"}),ErrorOutline:r.a.createElement(Ia,{width:24,path:"M11 15h2v2h-2zm0-8h2v6h-2zm.99-5C6.47 2 2 6.48 2 12s4.47 10 9.99 10C17.52 22 22 17.52 22 12S17.52 2 11.99 2zM12 20c-4.42 0-8-3.58-8-8s3.58-8 8-8 8 3.58 8 8-3.58 8-8 8z"}),InfoOutlined:r.a.createElement(Ia,{width:24,path:"M11,9H13V7H11M12,20C7.59,20 4,16.41 4,12C4,7.59 7.59,4 12,4C16.41,4 20,7.59 20, 12C20,16.41 16.41,20 12,20M12,2A10,10 0 0,0 2,12A10,10 0 0,0 12,22A10,10 0 0,0 22,12A10, 10 0 0,0 12,2M11,17H13V11H11V17Z"}),ReportProblemOutlined:r.a.createElement(Ia,{width:24,path:"M12 5.99L19.53 19H4.47L12 5.99M12 2L1 21h22L12 2zm1 14h-2v2h2v-2zm0-6h-2v4h2v-4z"}),SuccessOutlined:r.a.createElement(Ia,{width:24,path:"M20,12A8,8 0 0,1 12,20A8,8 0 0,1 4,12A8,8 0 0,1 12,4C12.76,4 13.5,4.11 14.2, 4.31L15.77,2.74C14.61,2.26 13.34,2 12,2A10,10 0 0,0 2,12A10,10 0 0,0 12,22A10,10 0 0, 0 22,12M7.91,10.08L6.5,11.5L11,16L21,6L19.59,4.58L11,13.17L7.91,10.08Z"})},Da={success:Ba.SuccessOutlined,warning:Ba.ReportProblemOutlined,error:Ba.ErrorOutline,info:Ba.InfoOutlined},ja=function(e){var t,n=e.action,r=e.children,i=e.classes,a=e.className,l=e.closeText,c=void 0===l?"Close":l,u=e.color,s=e.icon,f=e.iconMapping,d=void 0===f?Da:f,h=e.onClose,m=(e.role,e.severity),p=void 0===m?"success":m,v=e.variant,g=void 0===v?"standard":v,y=(e.theme,We()(e,["action","children","classes","className","closeText","color","icon","iconMapping","onClose","role","severity","variant","theme"]));return console.log("action",n),o.createElement("div",de()({className:Na()(i.root,i[bt()(t="".concat(g)).call(t,Object(Va.capitalize)(u||p))],a)},y),!1!==s?o.createElement("div",{className:i.icon},s||d[p]||Da[p]):null,o.createElement("div",{className:i.message},r),null!=n?o.createElement("div",{className:i.action},n):null,null==n&&h?o.createElement("div",{className:i.action},o.createElement(Ta.a,{size:"small","aria-label":c,title:c,color:"inherit",onClick:h},Ba.Close)):null)};ja.propTypes={action:c.a.node,children:c.a.node,classes:c.a.object,className:c.a.string,closeText:c.a.string,color:c.a.oneOf(["error","info","success","warning"]),icon:c.a.node,iconMapping:c.a.shape({error:c.a.node,info:c.a.node,success:c.a.node,warning:c.a.node}),onClose:c.a.func,role:c.a.string,severity:c.a.oneOf(["error","info","success","warning"]),variant:c.a.oneOf(["filled","outlined","standard"])};var Fa=Object($.withStyles)((function(){return{root:{backgroundColor:"transparent",display:"flex",padding:"6px 16px"},filledSuccess:{color:"#fff",backgroundColor:"#4caf50"},filledInfo:{color:"#fff",backgroundColor:"#2196f3"},filledWarning:{color:"#fff",backgroundColor:"#ff9800"},filledError:{color:"#fff",backgroundColor:"#f44336"},icon:{marginRight:12,padding:"7px 0",display:"flex",fontSize:22,opacity:.9},message:{padding:"8px 0",display:"flex",flexDirection:"column",justifyContent:"center"},action:{display:"flex",alignItems:"center",marginLeft:"auto",paddingLeft:16,marginRight:-8}}}),{name:"MuiAlert"})(ja),Ra=(n(97),function(e){function t(){var e,n,o;xt()(this,t);for(var r=arguments.length,i=new Array(r),a=0;a<r;a++)i[a]=arguments[a];return o=Pt()(this,(e=St()(t)).call.apply(e,bt()(n=[this]).call(n,i))),N()(At()(o),"autoClose",null),N()(At()(o),"handleClickButton",(function(e){e.onClick&&e.onClick(),o.close()})),N()(At()(o),"handleClickOverlay",(function(e){var t=o.props,n=t.closeOnClickOutside,r=t.onClickOutside,i=e.target===o.overlay;n&&i&&(r(),o.close())})),N()(At()(o),"close",(function(){_a(),Oa()})),N()(At()(o),"keyboardClose",(function(e){var t=o.props,n=t.closeOnEscape,r=t.onKeypressEscape,i=27===e.keyCode;n&&i&&(r(e),o.close())})),N()(At()(o),"componentDidMount",(function(){document.addEventListener("keydown",o.keyboardClose,!1),o.autoClose=gt()((function(){(document.getElementById("react-confirm-alert")||document.getElementById("react-confirm-alert-body-element"))&&o.close()}),o.props.autoHideDuration)})),N()(At()(o),"componentWillUnmount",(function(){document.removeEventListener("keydown",o.keyboardClose,!1),clearTimeout(o.autoClose),o.props.willUnmount()})),N()(At()(o),"renderCustomUI",(function(){var e=o.props,t=e.title,n=e.message;return(0,e.customUI)({title:t,message:n,onClose:o.close})})),o}return Vt()(t,e),Ct()(t,[{key:"render",value:function(){var e=this,t=this.props,n=t.message,o=t.customUI,i=t.severity,a=t.closeText,l=t.closable,c=t.theme;return r.a.createElement("div",{className:"react-confirm-alert-overlay",ref:function(t){return e.overlay=t},onClick:this.handleClickOverlay},r.a.createElement("div",{className:"react-confirm-alert"},o?this.renderCustomUI():r.a.createElement("div",{className:"react-confirm-alert-body"},r.a.createElement(Fa,{theme:c,elevation:6,variant:"filled",severity:i,closeText:a,action:l?r.a.createElement("div",{className:"icon-container",onClick:function(){return e.close()}},Ba.Close):void 0},n))))}}]),t}(o.Component));function Oa(){var e=document.getElementById("react-confirm-alert");Object(Ea.unmountComponentAtNode)(e),e.parentNode.removeChild(e)}function _a(){document.body.classList.remove("react-confirm-alert-body-element")}function La(e,t){document.body.classList.add("react-confirm-alert-body-element"),function(e,t){var n=document.getElementById("react-confirm-alert");n||(document.body.children[0].classList.add("react-confirm-alert-blur"),(n=document.createElement("div")).id="react-confirm-alert",document.body.appendChild(n)),Object(Ea.render)(r.a.createElement(Ra,de()({},e,{theme:t})),n)}(e,t)}N()(Ra,"propTypes",{message:c.a.string,customUI:c.a.func,closeOnClickOutside:c.a.bool,closeOnEscape:c.a.bool,willUnmount:c.a.func,onClickOutside:c.a.func,onKeypressEscape:c.a.func,severity:c.a.string,closeText:c.a.string,autoHideDuration:c.a.number,closable:c.a.bool}),N()(Ra,"defaultProps",{closeOnClickOutside:!0,closeOnEscape:!0,willUnmount:function(){return null},onClickOutside:function(){return null},onKeypressEscape:function(){return null},severity:"info",closeText:"Close",autoHideDuration:6e3,closable:!0});function za(e,t){var n=E()(e);if(w.a){var o=w()(e);t&&(o=k()(o).call(o,(function(t){return M()(e,t).enumerable}))),n.push.apply(n,o)}return n}var qa=function(e){return function(e){for(var t=1;t<arguments.length;t++){var n,o=null!=arguments[t]?arguments[t]:{};if(t%2)y()(n=za(Object(o),!0)).call(n,(function(t){N()(e,t,o[t])}));else if(v.a)m()(e,v()(o));else{var r;y()(r=za(Object(o))).call(r,(function(t){d()(e,t,M()(o,t))}))}}return e}({},e,{typography:{fontFamily:"Roboto",h1:{fontFamily:"Avenir"},h2:{fontFamily:"Avenir"},h3:{fontFamily:"Avenir"},h4:{fontFamily:"Avenir"},h5:{fontFamily:"Avenir"},h6:{fontFamily:"Avenir"},body1:{fontFamily:"Roboto"}}})},Ua={dark:Object($.createMuiTheme)(qa({label:"dark",backgroundColor:"linear-gradient(114.01deg, #212121 0%, #050505 100.43%)",bottomNavigation:{background:"#212121"},globalStats:{borderColor:"#474747",subTextColor:"#CDCDCD",upperTextColor:"#E6E6E6"},palette:{type:"dark",primary:{main:"#36b5e6"},secondary:{main:"#CF6679"},green:{main:"#03DAC5"}},overrides:{MuiButton:{outlined:{margin:"8px"},text:{margin:"8px"},contained:{margin:"8px"},containedPrimary:{color:"inherit",margin:"8px"},containedSecondary:{color:"inherit",margin:"8px"}},MuiButtonGroup:{root:{margin:"0"},groupedContainedPrimary:{margin:"0"},groupedOutlined:{margin:"0"},groupedText:{margin:"0"}},MuiIconButton:{root:{color:"#36b5e6"}},MuiListItem:{button:{"&:hover":{backgroundColor:"rgba(54,181,230, 0.15)"}}},MuiFormControlLabel:{label:{color:"rgba(255,255,255,0.8)"}},MuiInputBase:{input:{font:"Roboto"}},MuiFilledInput:{root:{border:"4px"},underline:{"&::before":{borderRadius:"4px"}}}}})),light:Object($.createMuiTheme)(qa({label:"light",backgroundColor:"linear-gradient(122.19deg, #FFFFFF 2.58%, #FFFFFF 76.23%)",bottomNavigation:{background:"#c3c3c3"},globalStats:{borderColor:"#E6E6E6",subTextColor:"#717171",upperTextColor:"#474747"},palette:{primary:{main:"#007197"},secondary:{main:"#BE2424"},green:{main:"#03DAC5"}},overrides:{MuiButton:{outlined:{margin:"8px"},text:{margin:"8px"},contained:{margin:"8px"},containedPrimary:{color:"white",margin:"8px"},containedSecondary:{color:"white",margin:"8px"}},MuiButtonGroup:{root:{margin:"0"},groupedContainedPrimary:{margin:"0"},groupedOutlined:{margin:"0"},groupedText:{margin:"0"}},MuiIconButton:{root:{color:"#007197"}},MuiListItem:{button:{"&:hover":{backgroundColor:"rgba(0,113,151, 0.15)"}}},MuiFormControlLabel:{label:{color:"rgba(0,0,0,0.8)"}},MuiInputBase:{input:{font:"Roboto"}},MuiFilledInput:{root:{border:"4px"},underline:{"&::before":{borderRadius:"4px"}}}}}))}}])}));