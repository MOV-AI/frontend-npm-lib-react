!function(e,t){"object"==typeof exports&&"object"==typeof module?module.exports=t():"function"==typeof define&&define.amd?define([],t):"object"==typeof exports?exports.Movai=t():e.Movai=t()}(global,(function(){return function(e){var t={};function n(r){if(t[r])return t[r].exports;var o=t[r]={i:r,l:!1,exports:{}};return e[r].call(o.exports,o,o.exports,n),o.l=!0,o.exports}return n.m=e,n.c=t,n.d=function(e,t,r){n.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:r})},n.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},n.t=function(e,t){if(1&t&&(e=n(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var r=Object.create(null);if(n.r(r),Object.defineProperty(r,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var o in e)n.d(r,o,function(t){return e[t]}.bind(null,o));return r},n.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return n.d(t,"a",t),t},n.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},n.p="",n(n.s=76)}([function(e,t){e.exports=require("@babel/runtime/helpers/esm/defineProperty")},function(e,t){e.exports=require("@babylonjs/core")},function(e,t){e.exports=require("react")},function(e,t){e.exports=require("@babel/runtime/helpers/esm/assertThisInitialized")},function(e,t){e.exports=require("prop-types")},function(e,t){e.exports=require("@babel/runtime/helpers/esm/getPrototypeOf")},function(e,t){e.exports=require("monet")},function(e,t){e.exports=require("@babel/runtime/helpers/esm/classCallCheck")},function(e,t){e.exports=require("@babel/runtime/helpers/esm/createClass")},function(e,t){e.exports=require("@babel/runtime/helpers/esm/extends")},function(e,t){e.exports=require("@babel/runtime/helpers/esm/possibleConstructorReturn")},function(e,t){e.exports=require("@babel/runtime/helpers/esm/get")},function(e,t){e.exports=require("@babel/runtime/helpers/esm/inherits")},function(e,t){e.exports=require("mov-fe-lib-core")},function(e,t){e.exports=require("@babel/runtime/helpers/esm/classPrivateFieldGet")},function(e,t){e.exports=require("@babel/runtime/helpers/esm/toConsumableArray")},function(e,t){e.exports=require("@material-ui/core/styles")},function(e,t){e.exports=require("@babel/runtime/helpers/esm/slicedToArray")},function(e,t){e.exports=require("@babel/runtime/regenerator")},function(e,t){e.exports=require("@material-ui/core")},function(e,t){e.exports=require("@babel/runtime/helpers/esm/asyncToGenerator")},function(e,t){e.exports=require("@babel/runtime/helpers/esm/objectWithoutProperties")},function(e,t){e.exports=require("@material-ui/icons/ChevronRight")},function(e,t){e.exports=require("@material-ui/core/MenuItem")},function(e,t){e.exports=require("@material-ui/core/Typography")},function(e,t){e.exports=require("lodash")},function(e,t){e.exports=require("@material-ui/icons/Search")},function(e,t){e.exports=require("react-resize-detector")},function(e,t){e.exports=require("@babel/runtime/helpers/esm/classPrivateFieldSet")},function(e,t){e.exports=require("react-dom")},function(e,t){e.exports=require("@material-ui/icons/Clear")},function(e,t){e.exports=require("@babylonjs/gui/2D")},function(e,t){e.exports=require("rbush")},function(e,t){e.exports=require("@material-ui/core/Button")},function(e,t){e.exports=require("@material-ui/core/Drawer")},function(e,t){e.exports=require("@material-ui/icons/ExpandMore")},function(e,t){e.exports=require("@material-ui/core/Collapse")},function(e,t){e.exports=require("@material-ui/core/Menu")},function(e,t){e.exports=require("material-table")},function(e,t){e.exports=require("@material-ui/icons/AddBox")},function(e,t){e.exports=require("@material-ui/icons/ArrowDownward")},function(e,t){e.exports=require("@material-ui/icons/Check")},function(e,t){e.exports=require("@material-ui/icons/ChevronLeft")},function(e,t){e.exports=require("@material-ui/icons/DeleteOutline")},function(e,t){e.exports=require("@material-ui/icons/Edit")},function(e,t){e.exports=require("@material-ui/icons/FilterList")},function(e,t){e.exports=require("@material-ui/icons/FirstPage")},function(e,t){e.exports=require("@material-ui/icons/LastPage")},function(e,t){e.exports=require("@material-ui/icons/Remove")},function(e,t){e.exports=require("@material-ui/icons/SaveAlt")},function(e,t){e.exports=require("@material-ui/icons/ViewColumn")},function(e,t){e.exports=require("@material-ui/core/Tabs")},function(e,t){e.exports=require("@material-ui/core/Tab")},function(e,t){e.exports=require("@material-ui/core/TextField")},function(e,t){e.exports=require("@material-ui/core/FormControlLabel")},function(e,t){e.exports=require("@material-ui/core/Switch")},function(e,t){e.exports=require("@material-ui/core/InputBase")},function(e,t){e.exports=require("@material-ui/core/Breadcrumbs")},function(e,t){e.exports=require("@material-ui/icons/NavigateNext")},function(e,t){e.exports=require("earcut")},function(e,t){e.exports=require("lodash.isequal")},function(e,t){e.exports=require("@babylonjs/core/Maths/math")},function(e,t){e.exports=require("@material-ui/core/InputLabel")},function(e,t){e.exports=require("@material-ui/core/FormControl")},function(e,t){e.exports=require("@material-ui/core/Select")},function(e,t){e.exports=require("clsx")},function(e,t){e.exports=require("@material-ui/core/IconButton")},function(e,t){e.exports=require("@material-ui/core/utils")},function(e,t){e.exports=require("@babel/runtime/helpers/esm/taggedTemplateLiteral")},function(e,t){e.exports=require("styled-components")},function(e,t){e.exports=require("@material-ui/core/colors")},function(e,t){e.exports=require("@babylonjs/loaders")},function(e,t,n){var r=n(73),o=n(74);"string"==typeof(o=o.__esModule?o.default:o)&&(o=[[e.i,o,""]]);var i={insert:"head",singleton:!1};r(o,i);e.exports=o.locals||{}},function(e,t,n){"use strict";var r,o=function(){return void 0===r&&(r=Boolean(window&&document&&document.all&&!window.atob)),r},i=function(){var e={};return function(t){if(void 0===e[t]){var n=document.querySelector(t);if(window.HTMLIFrameElement&&n instanceof window.HTMLIFrameElement)try{n=n.contentDocument.head}catch(e){n=null}e[t]=n}return e[t]}}(),a=[];function c(e){for(var t=-1,n=0;n<a.length;n++)if(a[n].identifier===e){t=n;break}return t}function u(e,t){for(var n={},r=[],o=0;o<e.length;o++){var i=e[o],u=t.base?i[0]+t.base:i[0],s=n[u]||0,l="".concat(u," ").concat(s);n[u]=s+1;var f=c(l),h={css:i[1],media:i[2],sourceMap:i[3]};-1!==f?(a[f].references++,a[f].updater(h)):a.push({identifier:l,updater:v(h,t),references:1}),r.push(l)}return r}function s(e){var t=document.createElement("style"),r=e.attributes||{};if(void 0===r.nonce){var o=n.nc;o&&(r.nonce=o)}if(Object.keys(r).forEach((function(e){t.setAttribute(e,r[e])})),"function"==typeof e.insert)e.insert(t);else{var a=i(e.insert||"head");if(!a)throw new Error("Couldn't find a style target. This probably means that the value for the 'insert' parameter is invalid.");a.appendChild(t)}return t}var l,f=(l=[],function(e,t){return l[e]=t,l.filter(Boolean).join("\n")});function h(e,t,n,r){var o=n?"":r.media?"@media ".concat(r.media," {").concat(r.css,"}"):r.css;if(e.styleSheet)e.styleSheet.cssText=f(t,o);else{var i=document.createTextNode(o),a=e.childNodes;a[t]&&e.removeChild(a[t]),a.length?e.insertBefore(i,a[t]):e.appendChild(i)}}function d(e,t,n){var r=n.css,o=n.media,i=n.sourceMap;if(o?e.setAttribute("media",o):e.removeAttribute("media"),i&&btoa&&(r+="\n/*# sourceMappingURL=data:application/json;base64,".concat(btoa(unescape(encodeURIComponent(JSON.stringify(i))))," */")),e.styleSheet)e.styleSheet.cssText=r;else{for(;e.firstChild;)e.removeChild(e.firstChild);e.appendChild(document.createTextNode(r))}}var p=null,m=0;function v(e,t){var n,r,o;if(t.singleton){var i=m++;n=p||(p=s(t)),r=h.bind(null,n,i,!1),o=h.bind(null,n,i,!0)}else n=s(t),r=d.bind(null,n,t),o=function(){!function(e){if(null===e.parentNode)return!1;e.parentNode.removeChild(e)}(n)};return r(e),function(t){if(t){if(t.css===e.css&&t.media===e.media&&t.sourceMap===e.sourceMap)return;r(e=t)}else o()}}e.exports=function(e,t){(t=t||{}).singleton||"boolean"==typeof t.singleton||(t.singleton=o());var n=u(e=e||[],t);return function(e){if(e=e||[],"[object Array]"===Object.prototype.toString.call(e)){for(var r=0;r<n.length;r++){var o=c(n[r]);a[o].references--}for(var i=u(e,t),s=0;s<n.length;s++){var l=c(n[s]);0===a[l].references&&(a[l].updater(),a.splice(l,1))}n=i}}}},function(e,t,n){(t=n(75)(!1)).push([e.i,"body.react-confirm-alert-body-element {\n  overflow: hidden;\n}\n\n.react-confirm-alert-blur {\n  filter: url(#gaussian-blur);\n  filter: blur(2px);\n  -webkit-filter: blur(2px);\n}\n\n.react-confirm-alert-overlay {\n  position: fixed;\n  top: calc(100vh - 300px);\n  left: 0;\n  right: 0;\n  bottom: 0;\n  z-index: 99;\n  display: -webkit-flex;\n  display: -moz-flex;\n  display: -ms-flex;\n  display: -o-flex;\n  display: flex;\n  justify-content: flex-start;\n  -ms-align-items: center;\n  align-items: flex-end;\n  opacity: 1;\n}\n\n.react-confirm-alert-body {\n  width: 400px;\n  padding: 30px;\n}\n\n.react-confirm-alert-svg {\n  position: absolute;\n  top: 0;\n  left: 0;\n}\n\n.react-confirm-alert-body > h1 {\n  margin-top: 0;\n}\n\n.react-confirm-alert-body > h3 {\n  margin: 0;\n  font-size: 16px;\n}\n\n.react-confirm-alert-button-group {\n  display: -webkit-flex;\n  display: -moz-flex;\n  display: -ms-flex;\n  display: -o-flex;\n  display: flex;\n  justify-content: flex-start;\n  margin-top: 20px;\n}\n\n.react-confirm-alert-button-group > button {\n  outline: none;\n  background: #333;\n  border: none;\n  display: inline-block;\n  padding: 6px 18px;\n  color: #eee;\n  margin-right: 10px;\n  border-radius: 5px;\n  font-size: 12px;\n  cursor: pointer;\n}\n\n.icon-container {\n  display: flex;\n  justify-content: center;\n  align-items: center;\n}\n\n.icon-container:hover {\n  cursor: pointer;\n}\n",""]),e.exports=t},function(e,t,n){"use strict";e.exports=function(e){var t=[];return t.toString=function(){return this.map((function(t){var n=function(e,t){var n=e[1]||"",r=e[3];if(!r)return n;if(t&&"function"==typeof btoa){var o=(a=r,c=btoa(unescape(encodeURIComponent(JSON.stringify(a)))),u="sourceMappingURL=data:application/json;charset=utf-8;base64,".concat(c),"/*# ".concat(u," */")),i=r.sources.map((function(e){return"/*# sourceURL=".concat(r.sourceRoot||"").concat(e," */")}));return[n].concat(i).concat([o]).join("\n")}var a,c,u;return[n].join("\n")}(t,e);return t[2]?"@media ".concat(t[2]," {").concat(n,"}"):n})).join("")},t.i=function(e,n,r){"string"==typeof e&&(e=[[null,e,""]]);var o={};if(r)for(var i=0;i<this.length;i++){var a=this[i][0];null!=a&&(o[a]=!0)}for(var c=0;c<e.length;c++){var u=[].concat(e[c]);r&&o[u[0]]||(n&&(u[2]?u[2]="".concat(n," and ").concat(u[2]):u[2]=n),t.push(u))}},t}},function(e,t,n){"use strict";n.r(t),n.d(t,"Button",(function(){return l})),n.d(t,"AbstractModal",(function(){return g})),n.d(t,"ConfirmAlertModal",(function(){return M})),n.d(t,"Drawer",(function(){return w})),n.d(t,"Collapse",(function(){return I})),n.d(t,"VerticalBar",(function(){return L})),n.d(t,"ContextMenu",(function(){return W})),n.d(t,"Table",(function(){return Se})),n.d(t,"Tabs",(function(){return Fe})),n.d(t,"Text",(function(){return Ue})),n.d(t,"Themes",(function(){return Sa})),n.d(t,"Toggle",(function(){return Xe})),n.d(t,"SearchInput",(function(){return pt})),n.d(t,"Breadcrumb",(function(){return xt})),n.d(t,"SceneViewer",(function(){return Xi})),n.d(t,"Select",(function(){return aa})),n.d(t,"snackbar",(function(){return Ea})),n.d(t,"Style",(function(){return Aa}));var r=n(2),o=n.n(r),i=n(33),a=n.n(i),c=n(4),u=n.n(c),s=function(e){return o.a.createElement(a.a,{className:e.className,style:e.style,onClick:e.onClick,color:e.color,variant:e.variant,size:e.size,startIcon:e.startIcon,disabled:e.disabled},e.children)};s.propTypes={style:u.a.object,onClick:u.a.func,color:u.a.string,variant:u.a.string,size:u.a.string,startIcon:u.a.element,children:u.a.node.isRequired,disabled:u.a.bool},s.defaultProps={style:{},onClick:function(){return console.log("Click MOV.AI button")},color:"default",variant:"contained",size:"medium",startIcon:void 0,children:o.a.createElement("div",null),disabled:!1};var l=s,f=n(0),h=n.n(f),d=n(19);function p(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function m(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?p(Object(n),!0).forEach((function(t){h()(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):p(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var v={margin:"auto",position:"absolute",overflow:"auto",display:"flex",flexDirection:"column"},y=function(e){var t=function(){e.onSubmit()},n=function(){e.onCancel()};return o.a.createElement(d.Modal,{onKeyPress:function(e){"Enter"===e.key&&t()},open:e.open,onClose:n,style:{display:"flex",alignItems:"center",justifyContent:"center"}},o.a.createElement(d.Card,{style:m(m({},v),{},{width:e.width,height:e.height,minWidth:"260px",minHeight:"280px"})},o.a.createElement(d.CardContent,{style:{flexGrow:1,display:"flex",flexDirection:"column",minHeight:0}},o.a.createElement(d.Typography,{variant:"h5",style:{padding:"12px 0px 12px 6px",fontWeight:600}},e.title),o.a.createElement("div",{style:{paddingLeft:"6px",flexGrow:1,overflow:"auto",minHeight:0}},e.children)),o.a.createElement(d.Divider,null),o.a.createElement(d.CardActions,{style:{alignSelf:"flex-end"}},o.a.createElement(l,{onClick:n,variant:"outlined",color:e.cancelColor},e.cancelText),o.a.createElement(l,{color:e.submitColor,onClick:t},e.submitText))))};y.propTypes={onSubmit:u.a.func,onCancel:u.a.func,open:u.a.bool,title:u.a.string,submitText:u.a.string,submitColor:u.a.string,cancelText:u.a.string,cancelColor:u.a.string,width:u.a.string,height:u.a.string},y.defaultProps={onSubmit:function(){},onCancel:function(){},open:!1,title:"New",submitText:"Confirm",submitColor:"primary",cancelText:"Cancel",cancelColor:"inherit",width:"25%",height:"25%"};var g=y,b=function(e){return o.a.createElement(g,{onSubmit:e.onSubmit,onCancel:e.onCancel,open:e.open,title:e.title,submitText:e.submitText,submitColor:e.submitColor,cancelText:e.cancelText,cancelColor:e.cancelColor},o.a.createElement("div",null,e.message),o.a.createElement("div",null,e.children))};b.propTypes={title:u.a.string,message:u.a.string,onSubmit:u.a.func,onCancel:u.a.func,open:u.a.bool,submitText:u.a.string,submitColor:u.a.string,cancelText:u.a.string,cancelColor:u.a.string},b.defaultProps={title:"Insert Text here",message:"Are you sure?",onSubmit:function(){},onCancel:function(){},open:!1,submitText:"Delete",submitColor:"secondary",cancelText:"Cancel",cancelColor:"primary"};var M=b,x=n(34),E=n.n(x),k=function(e){return o.a.createElement(E.a,{style:e.style,anchor:e.anchor,open:e.open,onClose:e.onClose},e.children)};k.propTypes={style:u.a.object,anchor:u.a.string,open:u.a.bool,children:u.a.object},k.defaultProps={style:{},anchor:"left",open:!1,children:o.a.createElement("div",null)},k.ANCHOR={left:"left",right:"right",top:"top",bottom:"bottom"};var w=k,P=n(17),C=n.n(P),S=n(22),O=n.n(S),N=n(35),R=n.n(N),D=n(36),A=n.n(D);function T(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function j(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?T(Object(n),!0).forEach((function(t){h()(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):T(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var V=function(e){var t=o.a.useState(e.open),n=C()(t,2),r=n[0],i=n[1];o.a.useEffect((function(){e.open!==r&&i(e.open)}),[e.open]);var a;return o.a.createElement(d.List,null,o.a.createElement(d.ListItem,{button:!0,onClick:(a=e.onClick,function(){i(!r),a()})},r?o.a.createElement(R.a,{style:j({},e.iconStyle)}):o.a.createElement(O.a,{style:j({},e.iconStyle)}),o.a.createElement("div",{style:{width:"100%"}},e.item)),e.divided?o.a.createElement(d.Divider,null):[],o.a.createElement(A.a,{className:e.className,style:e.style,in:r},e.children))};V.propTypes={item:u.a.object,onClick:u.a.func,open:u.a.bool,divided:u.a.bool,iconStyle:u.a.object},V.defaultProps={item:o.a.createElement("div",null),onClick:function(){},open:!1,divided:!1,style:{},iconStyle:{}};var I=V,B=n(16),F=Object(B.makeStyles)((function(e){return{container:{height:"100%",backgroundColor:function(e){return e.backgroundColor},width:function(e){return e.width},display:"flex",flexDirection:"column"},logoArea:{padding:"17px",textAlign:"center",alignItems:"center",justifyContent:"center"},navigationArea:{flexGrow:1,display:"flex",flexDirection:"column",alignItems:"center"},accountArea:{padding:"17px",textAlign:"center",alignItems:"center",justifyContent:"center"}}})),_=function(e){var t=F(e);return o.a.createElement("div",{className:t.container},o.a.createElement("div",{className:t.logoArea},e.upperElement),o.a.createElement("div",{className:t.navigationArea},e.navigationList.map((function(e,t){return o.a.createElement("div",{key:t,style:{padding:"15px 0px"}},e)}))),o.a.createElement("div",{className:t.accountArea},e.lowerElement))};_.propTypes={upperElement:u.a.node.isRequired,navigationList:u.a.array,lowerElement:u.a.node.isRequired,width:u.a.string,backgroundColor:u.a.string},_.defaultProps={upperElement:o.a.createElement("div",null),navigationList:[o.a.createElement("div",null)],lowerElement:o.a.createElement("div",null),width:"68px",backgroundColor:"#424242"};var L=_,z=n(37),U=n.n(z),q=n(23),G=n.n(q),K=function(e){var t=o.a.useState(null),n=C()(t,2),r=n[0],i=n[1],a=function(){i(null)};return o.a.createElement("div",null,o.a.cloneElement(e.element,{onClick:function(t){void 0!==e.element.props.onClick&&e.element.props.onClick(),i(t.currentTarget)}}),o.a.createElement(U.a,{id:"simple-menu",anchorEl:r,keepMounted:!0,open:Boolean(r),onClose:a},e.menuList.reduce((function(e,t,n){return console.log("item",t),t&&"function"!=typeof t&&e.push(o.a.createElement(G.a,{onClick:function(){t.onClick(),(t.onClose||void 0===t.onClose)&&a()},key:n},t.element)),e}),[])))};K.propTypes={element:u.a.node.isRequired,navigationList:u.a.array,lowerElement:u.a.node.isRequired,width:u.a.string,backgroundColor:u.a.string},K.defaultProps={element:o.a.createElement("div",null,"Ahaha"),menuList:[{onClick:function(){return console.log("clicked 1")},element:"Profile",onClose:!0}],lowerElement:o.a.createElement("div",null),width:"68px",backgroundColor:"#424242"};var W=K,Y=n(9),Q=n.n(Y),Z=n(38),H=n.n(Z),X=n(39),J=n.n(X),$=n(40),ee=n.n($),te=n(41),ne=n.n(te),re=n(42),oe=n.n(re),ie=n(30),ae=n.n(ie),ce=n(43),ue=n.n(ce),se=n(44),le=n.n(se),fe=n(45),he=n.n(fe),de=n(46),pe=n.n(de),me=n(47),ve=n.n(me),ye=n(48),ge=n.n(ye),be=n(49),Me=n.n(be),xe=n(26),Ee=n.n(xe),ke=n(50),we=n.n(ke),Pe={Add:Object(r.forwardRef)((function(e,t){return o.a.createElement(J.a,Q()({},e,{ref:t}))})),Check:Object(r.forwardRef)((function(e,t){return o.a.createElement(ne.a,Q()({},e,{ref:t}))})),Clear:Object(r.forwardRef)((function(e,t){return o.a.createElement(ae.a,Q()({},e,{ref:t}))})),Delete:Object(r.forwardRef)((function(e,t){return o.a.createElement(ue.a,Q()({},e,{ref:t}))})),DetailPanel:Object(r.forwardRef)((function(e,t){return o.a.createElement(O.a,Q()({},e,{ref:t}))})),Edit:Object(r.forwardRef)((function(e,t){return o.a.createElement(le.a,Q()({},e,{ref:t}))})),Export:Object(r.forwardRef)((function(e,t){return o.a.createElement(Me.a,Q()({},e,{ref:t}))})),Filter:Object(r.forwardRef)((function(e,t){return o.a.createElement(he.a,Q()({},e,{ref:t}))})),FirstPage:Object(r.forwardRef)((function(e,t){return o.a.createElement(pe.a,Q()({},e,{ref:t}))})),LastPage:Object(r.forwardRef)((function(e,t){return o.a.createElement(ve.a,Q()({},e,{ref:t}))})),NextPage:Object(r.forwardRef)((function(e,t){return o.a.createElement(O.a,Q()({},e,{ref:t}))})),PreviousPage:Object(r.forwardRef)((function(e,t){return o.a.createElement(oe.a,Q()({},e,{ref:t}))})),ResetSearch:Object(r.forwardRef)((function(e,t){return o.a.createElement(ae.a,Q()({},e,{ref:t}))})),Search:Object(r.forwardRef)((function(e,t){return o.a.createElement(Ee.a,Q()({},e,{ref:t}))})),SortArrow:Object(r.forwardRef)((function(e,t){return o.a.createElement(ee.a,Q()({},e,{ref:t}))})),ThirdStateCheck:Object(r.forwardRef)((function(e,t){return o.a.createElement(ge.a,Q()({},e,{ref:t}))})),ViewColumn:Object(r.forwardRef)((function(e,t){return o.a.createElement(we.a,Q()({},e,{ref:t}))}))},Ce=function(e){return o.a.createElement(H.a,{style:e.style,title:e.title,columns:e.columns,data:e.data,icons:Pe,actions:e.actions,options:e.options,components:e.components,localization:e.localization})};Ce.propTypes={style:u.a.object,title:u.a.string,columns:u.a.array,data:u.a.array,actions:u.a.array,options:u.a.object,components:u.a.object,localization:u.a.object},Ce.defaultProps={style:{},title:"",columns:[],data:[],actions:[],options:{actionsColumnIndex:-1,draggable:!1,grouping:!1,search:!1,toolbar:!1,searchFieldAlignment:"left",paging:!1},components:{}};var Se=Ce,Oe=n(21),Ne=n.n(Oe),Re=n(51),De=n.n(Re),Ae=n(52),Te=n.n(Ae),je=n(24),Ve=n.n(je);function Ie(e){var t=e.children,n=e.selectedTab,r=e.index,i=Ne()(e,["children","selectedTab","index"]);return o.a.createElement(Ve.a,Q()({component:"div",role:"tabpanel",hidden:n!==r,id:"tabpanel-".concat(r),"aria-labelledby":"tab-".concat(r)},i),n===r&&t)}Ie.propTypes={children:u.a.node,index:u.a.any.isRequired,selectedTab:u.a.any.isRequired};var Be=Object(B.makeStyles)((function(e){return{root:{flexGrow:1,height:"100%"},tabPanel:{flexGrow:1,minHeight:0,height:"calc(100% - 48px)",overflowY:"auto"}}}));function Fe(e){var t=Be(),n=o.a.useState(e.selectedTab),r=C()(n,2),i=r[0],a=r[1];o.a.useEffect((function(){e.selectedTab!==i&&a(e.selectedTab)}),[e.selectedTab]);return o.a.createElement("div",{className:t.root},o.a.createElement(De.a,{value:i,onChange:function(e,t){a(t)},indicatorColor:"primary",textColor:"primary"},e.tabList.map((function(e,t){return o.a.createElement(Te.a,Q()({key:t,label:e.label},function(e){return{id:"tab-".concat(e),"aria-controls":"tabpanel-".concat(e)}}(t)))}))),e.tabList.map((function(n,r){return o.a.createElement(Ie,{key:r,selectedTab:i,index:r,className:e.scrollable?t.tabPanel:void 0},n.component)})))}Fe.propTypes={tabList:u.a.array,selectedTab:u.a.number,scrollable:u.a.bool},Fe.defaultProps={tabList:[{label:"Tab 1",component:o.a.createElement("div",null,"Component 1")},{label:"Tab 2",component:o.a.createElement("div",null,"Lorem Ipsum is simply dummy text of the printing and typesetting industry. Lorem Ipsum has been the industry standard dummy text ever since the 1500s, when an unknown printer took a galley of type and scrambled it to make a type specimen book. It has survived not only five centuries, but also the leap into electronic typesetting, remaining essentially unchanged. It was popularised in the 1960s with the release of Letraset sheets containing Lorem Ipsum passages, and more recently with desktop publishing software like Aldus PageMaker including versions of Lorem Ipsum.")},{label:"Tab 3",component:o.a.createElement("div",null,"Component 3")}],selectedTab:0,scrollable:!0};var _e=n(53),Le=n.n(_e),ze=function(e){return o.a.createElement(Le.a,e)};ze.propTypes={},ze.defaultProps={};var Ue=ze,qe=n(54),Ge=n.n(qe),Ke=n(55),We=n.n(Ke);n(70);function Ye(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function Qe(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?Ye(Object(n),!0).forEach((function(t){h()(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Ye(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var Ze=Object(B.makeStyles)((function(e){return{label:{fontFamily:"Roboto",fontStyle:"normal",fontWeight:"normal",fontSize:"16px",marginLeft:0,marginRight:0}}})),He=function(e){var t=Ze();return o.a.createElement(Ge.a,{control:o.a.createElement(We.a,{checked:e.toggle,onChange:e.onToggle,color:e.color,disabled:e.disabled,hidden:e.hidden}),labelPlacement:e.labelPlacement,label:e.label,classes:{label:t.label},style:Qe(Qe({},e.style),{},{marginLeft:0,marginRight:0})})};He.propTypes={toggle:u.a.bool,onToggle:u.a.func,label:u.a.string,color:u.a.string,labelPlacement:u.a.string,style:u.a.object},He.defaultProps={color:"primary"};var Xe=He,Je=n(7),$e=n.n(Je),et=n(8),tt=n.n(et),nt=n(3),rt=n.n(nt),ot=n(12),it=n.n(ot),at=n(10),ct=n.n(at),ut=n(5),st=n.n(ut),lt=n(56),ft=n.n(lt);function ht(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=st()(e);if(t){var o=st()(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return ct()(this,n)}}var dt=function(e){it()(n,e);var t=ht(n);function n(){var e;$e()(this,n);for(var r=arguments.length,o=new Array(r),i=0;i<r;i++)o[i]=arguments[i];return e=t.call.apply(t,[this].concat(o)),h()(rt()(e),"searchInput",void 0),h()(rt()(e),"timer",void 0),h()(rt()(e),"handleChange",(function(t){e.searchInput=t.target.value,e.props.enableTimeout?(e.timer&&clearTimeout(e.timer),e.timer=setTimeout(e.handleSearch,e.props.time)):e.handleSearch()})),h()(rt()(e),"handleSearch",(function(){void 0!==e.searchInput&&e.props.onChange(e.searchInput)})),e}return tt()(n,[{key:"render",value:function(){var e=this.props,t=e.classes,n=e.style,r=e.placeholder;return o.a.createElement("div",{className:t.search,style:n},o.a.createElement("div",{className:t.searchIcon},o.a.createElement(Ee.a,null)),o.a.createElement(ft.a,{ref:this.setSearchInput,placeholder:r,classes:{root:t.inputRoot,input:t.inputInput},inputProps:{"aria-label":"search"},onChange:this.handleChange}))}}]),n}(r.Component);dt.propTypes={placeholder:u.a.string,onChange:u.a.func,time:u.a.number,enableTimeout:u.a.bool,style:u.a.object},dt.defaultProps={placeholder:"Search...",onChange:function(e){console.log(e)},time:250,enableTimeout:!0,style:{}};var pt=Object(B.withStyles)((function(e){return{search:h()({position:"relative",borderRadius:e.shape.borderRadius,backgroundColor:Object(B.fade)(e.palette.common.white,.15),"&:hover":{backgroundColor:Object(B.fade)(e.palette.common.white,.25)},marginRight:e.spacing(2),marginLeft:0,width:"100%"},e.breakpoints.up("sm"),{marginLeft:e.spacing(3),width:"auto"}),searchIcon:{width:e.spacing(7),height:"100%",position:"absolute",pointerEvents:"none",display:"flex",alignItems:"center",justifyContent:"center"},inputRoot:{color:"inherit"},inputInput:h()({padding:e.spacing(1,1,1,7),transition:e.transitions.create("width"),width:"100%"},e.breakpoints.up("md"),{width:200})}}),{withTheme:!0})(dt),mt=n(57),vt=n.n(mt),yt=n(58),gt=n.n(yt),bt=Object(B.makeStyles)((function(e){return{root:{"& > * + *":{marginTop:e.spacing(2)}},link:{fontSize:"24px",fontWeight:800,fontFamily:"Avenir","&:hover":{cursor:"pointer",textDecoration:"underline"}},lastLabel:{fontSize:"24px",fontWeight:800,fontFamily:"Avenir"}}})),Mt=function(e){var t=bt();return o.a.createElement("div",{className:t.root},o.a.createElement(vt.a,{separator:o.a.createElement(gt.a,{fontSize:"small"}),"aria-label":"breadcrumb",style:e.style},e.pathList.map((function(n,r){if(e.pathList.length-1!==r)return o.a.createElement(Ve.a,{key:r,color:"primary",variant:"inherit",className:t.link,onClick:n.function},n.label)})),o.a.createElement(Ve.a,{color:"textPrimary",className:t.lastLabel},e.pathList[e.pathList.length-1].label)))};Mt.propTypes={pathList:u.a.array},Mt.defaultProps={pathList:[{label:"Mov.ai",function:function(){return console.log("pth1/")}},{label:"User",function:function(){return console.log("path1/path2")}},{label:"John Doe"}]};var xt=Mt,Et=n(15),kt=n.n(Et),wt=n(1),Pt=n(27),Ct=n.n(Pt);function St(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function Ot(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?St(Object(n),!0).forEach((function(t){h()(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):St(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var Nt={display:"flex",flexDirection:"column",flexGrow:1},Rt=function(e){var t=Object(r.useRef)(null),n=e.antialias,i=e.engineOptions,a=e.adaptToDeviceRatio,c=e.sceneOptions,u=e.onRender,s=(e.onSceneReady,e.is2render),l=e.sceneFactory,f=Ne()(e,["antialias","engineOptions","adaptToDeviceRatio","sceneOptions","onRender","onSceneReady","is2render","sceneFactory"]),h=Object(r.useState)(!1),d=C()(h,2),p=d[0],m=d[1],v=Object(r.useState)(null),y=C()(v,2),g=y[0],b=y[1],M=Object(r.useState)({width:100,height:100}),x=C()(M,2),E=x[0],k=x[1];Object(r.useEffect)((function(){if(!p){m(!0);var r=new wt.Engine(t.current,n,i,a),o=l?l(r):new wt.Scene(r,c);if(b(o),o.isReady()?e.onSceneReady(o):o.onReadyObservable.addOnce((function(t){return e.onSceneReady(t)})),!s)return;r.runRenderLoop((function(){"function"==typeof u&&u(o),o.render()}))}return function(){null!==g&&g.dispose()}}),[t]);return p&&t.current.focus(),o.a.createElement("div",{style:Ot({},Nt)},o.a.createElement("canvas",Q()({ref:t,width:E.width,height:E.height},f)),o.a.createElement(Ct.a,{handleWidth:!0,handleHeight:!0,onResize:function(e,t){k({width:e,height:t<=window.innerHeight?t:.85*window.innerHeight}),g&&g.getEngine().resize()}}))};Rt.propTypes={antialias:u.a.bool,engineOptions:u.a.object,adaptToDeviceRatio:u.a.bool,sceneOptions:u.a.object,onSceneReady:u.a.func,onRender:u.a.func,is2render:u.a.bool,sceneFactory:u.a.func},Rt.defaultProps={antialias:!0,onSceneReady:function(e){},is2render:!0};var Dt=Rt,At=n(6),Tt=n(11),jt=n.n(Tt),Vt=function(){function e(t,n){$e()(this,e),this.vec=[t,n].map((function(e){return e||0}))}return tt()(e,[{key:"toArray",value:function(){return this.vec}},{key:"add",value:function(e){return this.op(e,(function(e,t){return e+t}))}},{key:"sub",value:function(e){return this.op(e,(function(e,t){return e-t}))}},{key:"mul",value:function(e){return this.op(e,(function(e,t){return e*t}))}},{key:"div",value:function(e){return this.op(e,(function(e,t){return e/t}))}},{key:"dot",value:function(e){return this.vec.reduce((function(t,n,r){return t+n*e.vec[r]}),0)}},{key:"prod",value:function(t){return new e(this.x*t.x-this.y*t.y,this.x*t.y+this.y*t.x)}},{key:"length",value:function(){return Math.sqrt(this.dot(this))}},{key:"normalize",value:function(){return this.scale(1/this.length())}},{key:"dual",value:function(){return new e(-this.y,this.x)}},{key:"sym",value:function(){return this.scale(-1)}},{key:"conj",value:function(){return new e(this.x,-this.y)}},{key:"scale",value:function(e){return this.map((function(t){return t*e}))}},{key:"map",value:function(t){return e.fromArray(this.vec.map(t))}},{key:"op",value:function(t,n){return e.fromArray(this.vec.map((function(e,r){return n(e,t.vec[r])})))}},{key:"reduce",value:function(e,t){return this.vec.reduce(e,t)}},{key:"toObject",value:function(){return{x:this.x,y:this.y}}},{key:"toString",value:function(){return"{x: ".concat(this.x,", y:").concat(this.y,"}")}},{key:"x",get:function(){return this.vec[0]}},{key:"y",get:function(){return this.vec[1]}}],[{key:"fromArray",value:function(t){if(t.length<2)throw new Error("array must have size > 2");return new e(t[0],t[1])}},{key:"of",value:function(t,n){return new e(t,n)}}]),e}();h()(Vt,"ZERO",new Vt(0,0)),h()(Vt,"e1",new Vt(1,0)),h()(Vt,"e2",new Vt(0,1));var It=Vt,Bt=function(){function e(t){var n=this;if($e()(this,e),h()(this,"normalize",(function(){var e=n.length();if(0===e)throw new Error("You can't normalize a zero norm vector");return n.scale(1/e)})),t.constructor!==Array||t.length<3)throw new Error("".concat(t," is not a valid 3-vector"));this.vec3=kt()(t)}return tt()(e,[{key:"add",value:function(e){return this.op(e,(function(e,t){return e+t}))}},{key:"sub",value:function(e){return this.op(e,(function(e,t){return e-t}))}},{key:"mul",value:function(e){return this.op(e,(function(e,t){return e*t}))}},{key:"op",value:function(t,n){var r=[];return r[0]=n(this.vec3[0],t.vec3[0]),r[1]=n(this.vec3[1],t.vec3[1]),r[2]=n(this.vec3[2],t.vec3[2]),new e(r)}},{key:"scale",value:function(e){return this.map((function(t){return t*e}))}},{key:"dot",value:function(e){return this.vec3[0]*e.vec3[0]+this.vec3[1]*e.vec3[1]+this.vec3[2]*e.vec3[2]}},{key:"map",value:function(t){return new e(this.vec3.map(t))}},{key:"length",value:function(){return Math.sqrt(this.dot(this))}},{key:"toBabylon",value:function(){return new wt.Vector3(this.vec3[0],this.vec3[1],this.vec3[2])}},{key:"toArray",value:function(){return this.vec3}},{key:"toVec2",value:function(){return new It(this.x,this.y)}},{key:"equals",value:function(e){return e.constructor===this.constructor&&e.vec3.map((function(t,n){return e.vec3[n]===t})).reduce((function(e,t){return e&&t}),!0)}},{key:"reduce",value:function(e,t){return this.vec3.reduce(e,t)}},{key:"getMax",value:function(){return this.reduce((function(e,t){return Math.max(e,t)}),-Number.MAX_VALUE)}},{key:"getMin",value:function(){return this.reduce((function(e,t){return Math.min(e,t)}),Number.MAX_VALUE)}},{key:"someNaNOrInfinite",value:function(){return this.vec3.some((function(e){return isNaN(e)||!isFinite(e)}))}},{key:"x",get:function(){return this.vec3[0]}},{key:"y",get:function(){return this.vec3[1]}},{key:"z",get:function(){return this.vec3[2]}}],[{key:"ofBabylon",value:function(t){return new e([t.x,t.y,t.z])}},{key:"of",value:function(t){return new e(t||[0,0,0])}},{key:"fromArray",value:function(t){return e.of(t)}},{key:"random",value:function(){return new e([1,2,3].map(Math.random()))}},{key:"orthogonalBasisFromVector",value:function(t){for(var n=[e.e1,e.e2,e.e3],r=0,o=0;o<3;o++)if(0!==t.vec3[o]){r=o;break}var i=n[(r+1)%3].add(n[r].scale(-t.vec3[(r+1)%3]/t.vec3[r]));i=i.normalize();var a=n[(r+2)%3].add(n[r].scale(-t.vec3[(r+2)%3]/t.vec3[r]));return a=(a=a.normalize()).sub(i.scale(i.dot(a))),{u:t.normalize(),v:i,w:a.normalize()}}}]),e}();h()(Bt,"ONES",Bt.of([1,1,1])),h()(Bt,"ZERO",Bt.of([0,0,0])),h()(Bt,"e1",new Bt([1,0,0])),h()(Bt,"e2",new Bt([0,1,0])),h()(Bt,"e3",new Bt([0,0,1]));var Ft=Bt,_t=n(13),Lt=function(){function e(){var t=this;if($e()(this,e),h()(this,"getAnnotations",(function(){return t.annotations})),zt)return zt;zt=this,this.annotations={},this.observers=[]}return tt()(e,[{key:"load",value:function(){return this.retrieveAnnotationsFromDb(),this}},{key:"pushObserver",value:function(e){return this.observers.push(e),this}},{key:"retrieveAnnotationsFromDb",value:function(){var e=this;_t.MasterDB.subscribe({Scope:"Annotation",Name:"*"},(function(t){console.log("Annotation update",t);var n={del:function(t){return e.delAnnotation(t)},set:function(t){return e.addAnnotation(t)}},r=t.key.Annotation;t.event in n&&(n[t.event](r),e.observers.forEach((function(t){return t(e)})))}),(function(t){console.log("Annotation start",t);var n=t.value.Annotation;e.addAnnotation(n)}))}},{key:"delAnnotation",value:function(e){var t=this;if(e){var n=Object.keys(e).reduce((function(e,t){return e.push(t),e}),[]);Object.keys(this.annotations).forEach((function(e){var r=t.annotations[e];r.names=r.names.filter((function(e){return!n.includes(e)})),r.labels=r.labels.filter((function(e){return!n.includes(e)}))}))}}},{key:"addAnnotation",value:function(e){var t=this;e&&Object.keys(e).forEach((function(n){var r=e[n];if(r.Type){var o=r.Type.toLowerCase(),i=r.Label;o in t.annotations||(t.annotations[o]={names:[],labels:[]}),t.annotations[o].names.push(n),t.annotations[o].labels.push(i||n)}}))}}],[{key:"getInstance",value:function(){return new e}},{key:"getAnnotations",value:function(){return e.getInstance().getAnnotations()}}]),e}(),zt=null,Ut=Lt,qt=function(){function e(){$e()(this,e)}return tt()(e,null,[{key:"copy",value:function(e){_t.Clipboard.write("scene",e)}},{key:"paste",value:function(){return _t.Clipboard.read("scene")}}]),e}();function Gt(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function Kt(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?Gt(Object(n),!0).forEach((function(t){h()(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Gt(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var Wt=_t.Utils.capitalize,Yt=function(){function e(t){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};$e()(this,e),h()(this,"getType",(function(){return e.TYPE})),this.name=t.name,this.mesh=t,this.mesh.getMouseContextActions=this.getMouseContextActions,this.mesh.nodeItem=this,this.keyValueMap=n,Ut.getInstance()}return tt()(e,[{key:"dispose",value:function(){this.mesh.dispose()}},{key:"toDict",value:function(){var e=this;return{name:this.name,type:this.getType(),position:Ft.ofBabylon(this.mesh.position).toArray(),quaternion:At.Maybe.fromNull(this.mesh.rotationQuaternion).map((function(e){return[e.w,e.x,e.y,e.z]})).orLazy((function(){var t=wt.Quaternion.RotationYawPitchRoll(e.mesh.rotation.y,e.mesh.rotation.x,e.mesh.rotation.z);return[t.w,t.x,t.y,t.z]})),color:At.Maybe.fromNull(this.mesh.material).flatMap((function(e){return At.Maybe.fromNull(e.diffuseColor).map((function(e){return[e.r,e.g,e.b]}))})).orSome([0,0,0]),keyValueMap:this.keyValueMap,isVisible:this.mesh.isEnabled()}}},{key:"toForm",value:function(){var t=this.toDict(),n=new wt.Color3(t.color[0],t.color[1],t.color[2]),r={jsonSchema:{type:"object",properties:{oldName:{type:"string"},name:{type:"string",title:"Name"},type:{type:"string",title:"Type"},position:{type:"object",title:"Position",properties:{x:{type:"number",title:"x"},y:{type:"number",title:"y"},z:{type:"number",title:"z"}}},quaternion:{type:"object",title:"Orientation",properties:{w:{type:"number",title:"w"},x:{type:"number",title:"x"},y:{type:"number",title:"y"},z:{type:"number",title:"z"}}},color:{type:"string",title:"Color"}}},uiSchema:{type:{"ui:disabled":!0},color:{"ui:widget":"color"},oldName:{"ui:widget":"hidden"},position:{"ui:widget":"collapse"},quaternion:{"ui:widget":"collapse"}},data:{oldName:t.name,name:t.name,type:t.type,position:{x:t.position[0],y:t.position[1],z:t.position[2]},quaternion:{w:t.quaternion[0],x:t.quaternion[1],y:t.quaternion[2],z:t.quaternion[3]},color:n.toHexString()}};return e.setAnnotations2Form(r,this.keyValueMap),r}},{key:"ofForm",value:function(e){var t=this;this.name=e.name,this.mesh.name=e.name,At.Maybe.fromNull(e.position).forEach((function(e){t.mesh.position=new wt.Vector3(e.x,e.y,e.z)})),At.Maybe.fromNull(e.quaternion).forEach((function(e){t.mesh.rotationQuaternion=new wt.Quaternion(e.x,e.y,e.z,e.w).normalize()})),this.mesh.material&&(this.mesh.material.diffuseColor=wt.Color3.FromHexString(e.color),this.mesh.material.emissiveColor=wt.Color3.FromHexString(e.color)),this.keyValueMap=Kt({},e.annotations)}},{key:"getMouseContextActions",value:function(e){var t=this;return[{title:"Copy",onClick:function(){return qt.copy((function(e,n){return n.getSceneMemory().forEach((function(r){var o=r.scene,i=n.getRootNode().item,a=t.nodeItem,c=a.toDict();c.name+="*";var u=Ft.ofBabylon(e).toArray();u[2]=c.position[2],c.position=u;var s=a.ofDict(o,c,n);s.mesh.parent=i.mesh,n.addNodeItem2Tree(s)}))}))}},{title:"Delete",onClick:function(){return e.deleteNodeFromTreeUsingName(t.name)}}]}}],[{key:"mapDict2Mesh",value:function(e,t){if(!t)throw"can't map a null mesh";return At.Maybe.fromNull(e).forEach((function(n){At.Maybe.fromNull(e.name).forEach((function(e){return t.name=e})),At.Maybe.fromNull(n.position).forEach((function(e){return t.position=Ft.of(e).toBabylon()})),At.Maybe.fromNull(n.quaternion).forEach((function(e){var n=new wt.Quaternion(e[1],e[2],e[3],e[0]);t.rotationQuaternion=n.normalize()})),At.Maybe.fromNull(n.color).forEach((function(e){var n=new wt.Color3(e[0],e[1],e[2]);At.Maybe.fromNull(t.material).forEach((function(e){At.Maybe.fromNull(e.diffuseColor).forEach((function(e){return t.material.diffuseColor=n})),At.Maybe.fromNull(e.emissiveColor).forEach((function(e){return t.material.emissiveColor=n}))}))}))})),t}},{key:"setAnnotations2Form",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};e.jsonSchema.properties.annotations={title:"Annotations",type:"object",properties:{}},e.uiSchema.annotations={"ui:widget":"collapse"},e.data.annotations=Kt({},t);var n=Ut.getAnnotations();Object.keys(n).forEach((function(t){n[t].labels.length>0&&(e.jsonSchema.properties.annotations.properties[t]={title:Wt(t),type:"string",enumNames:n[t].labels,enum:n[t].names})}))}}]),e}();h()(Yt,"TYPE","NodeItem");var Qt=Yt,Zt=function(){function e(t,n,r){$e()(this,e);for(var o=[t,n,r],i=0;i<o.length;i++)if(o[i].constructor!==Array||o[i].length<3)throw Error("One of the inputs is not a array");this.mat3=o.map((function(e){return new Ft(e)}))}return tt()(e,[{key:"prodVec",value:function(e){for(var t=new Ft([0,0,0]),n=0;n<this.mat3.length;n++)t=t.add(this.mat3[n].scale(e.vec3[n]));return t}},{key:"dotVec",value:function(e){for(var t=[0,0,0],n=0;n<this.mat3.length;n++)t[n]=this.mat3[n].dot(e);return new Ft(t)}},{key:"prod",value:function(t){var n=this.prodVec(t.mat3[0]),r=this.prodVec(t.mat3[1]),o=this.prodVec(t.mat3[2]);return new e(n.vec3,r.vec3,o.vec3)}},{key:"dot",value:function(t){var n=this.dotVec(t.mat3[0]),r=this.dotVec(t.mat3[1]),o=this.dotVec(t.mat3[2]);return new e(n.vec3,r.vec3,o.vec3)}},{key:"map",value:function(t){var n=this.mat3[0].map(t),r=this.mat3[1].map(t),o=this.mat3[2].map(t);return new e(n.vec3,r.vec3,o.vec3)}},{key:"equals",value:function(e){return e.constructor===this.constructor&&this.mat3.map((function(t,n){return t.equals(e.mat3[n])})).reduce((function(e,t){return e&&t}),!0)}}],[{key:"ofBabylonMatrix",value:function(t){var n=wt.Matrix.GetAsMatrix3x3(t);return new e([n[0],n[1],n[2]],[n[3],n[4],n[5]],[n[6],n[7],n[8]])}},{key:"of",value:function(t,n,r){return new e(t,n,r)}},{key:"eye",value:function(){return new e([1,0,0],[0,1,0],[0,0,1])}}]),e}(),Ht=function(){function e(t){$e()(this,e),this._scene=t,this._isPosition=!1,this._isRotation=!1,this._isBoundingBox=!1,this._isScale=!1,this._usePointerToAttachGizmos=!1}return tt()(e,[{key:"isPosition",value:function(e){return this._isPosition=e,this}},{key:"isRotation",value:function(e){return this._isRotation=e,this}},{key:"isBoundingBox",value:function(e){return this._isBoundingBox=e,this}},{key:"isScale",value:function(e){return this._isScale=e,this}},{key:"usePointerToAttachGizmos",value:function(e){return this._usePointerToAttachGizmos=e,this}},{key:"build",value:function(){var e=new wt.GizmoManager(this._scene);return e.positionGizmoEnabled=this._isPosition,e.rotationGizmoEnabled=this._isRotation,e.boundingBoxGizmoEnabled=this._isBoundingBox,e.scaleGizmoEnabled=this._isScale,e.usePointerToAttachGizmos=this._usePointerToAttachGizmos,e}}]),e}(),Xt=function(){function e(t){$e()(this,e),this._scene=t,this._sphericalCoordinates=null,this._target=null,this._name="camera".concat(Math.floor(1e3*Math.random()))}return tt()(e,[{key:"name",value:function(e){return this._name=e,this}},{key:"sphericalCoordinates",value:function(e){return this._sphericalCoordinates=e,this}},{key:"target",value:function(e){return this._target=e,this}},{key:"build",value:function(){return Object.values(this).forEach((function(e){if(null===e)throw"There are missing variables to build a camera, e.g ".concat(e)})),new wt.ArcRotateCamera(this._name,this._sphericalCoordinates.x,this._sphericalCoordinates.y,this._sphericalCoordinates.z,this._target,this._scene)}}]),e}(),Jt=function(){function e(t){$e()(this,e),this._scene=t,this._position=null,this._name="light".concat(Math.floor(1e3*Math.random())),this._intensity=1}return tt()(e,[{key:"position",value:function(e){return this._position=e,this}},{key:"name",value:function(e){return this._name=e,this}},{key:"intensity",value:function(e){return this._intensity=e,this}},{key:"build",value:function(){Object.values(this).forEach((function(e){if(null===e)throw"There are missing variables to build a light, e.g ".concat(e)}));var e=new wt.PointLight(this._name,this._position,this._scene);return e.intensity=this._intensity,e}}]),e}(),$t=function(){function e(t){$e()(this,e),this._scene=t,this._name="referential".concat(Math.floor(1e3*Math.random())),this._isPickable=!0,this._boxParams={isVisible:!0,size:.25},this._size=1}return tt()(e,[{key:"name",value:function(e){return this._name=e,this}},{key:"isPickable",value:function(e){return this._isPickable=e,this}},{key:"boxParams",value:function(e){return this._boxParams=e,this}},{key:"size",value:function(e){return this._size=e,this}},{key:"build",value:function(){var e=this._size,t=wt.Mesh.CreateLines("axisX".concat(this._name),[new wt.Vector3.Zero,new wt.Vector3(e,0,0),new wt.Vector3(.95*e,.05*e,0),new wt.Vector3(e,0,0),new wt.Vector3(.95*e,-.05*e,0)],this._scene);t.color=new wt.Color3(1,0,0),t.isPickable=!1;var n=wt.Mesh.CreateLines("axisY".concat(this._name),[new wt.Vector3.Zero,new wt.Vector3(0,e,0),new wt.Vector3(-.05*e,.95*e,0),new wt.Vector3(0,e,0),new wt.Vector3(.05*e,.95*e,0)],this._scene);n.color=new wt.Color3(0,1,0),n.isPickable=!1;var r=wt.Mesh.CreateLines("axisZ".concat(this._name),[new wt.Vector3.Zero,new wt.Vector3(0,0,e),new wt.Vector3(0,-.05*e,.95*e),new wt.Vector3(0,0,e),new wt.Vector3(0,.05*e,.95*e)],this._scene);r.color=new wt.Color3(0,0,1),r.isPickable=!1;var o=wt.MeshBuilder.CreateBox(this._name,{size:this._boxParams.size},this._scene);return o.isVisible=this._boxParams.isVisible,o.isPickable=this._isPickable,t.parent=o,n.parent=o,r.parent=o,o}}]),e}(),en=function(){function e(t){$e()(this,e),this._scene=t,this._name="camera".concat(Math.floor(1e3*Math.random())),this._width=1,this._height=1,this._textureSrc=null,this._isPickable=!1}return tt()(e,[{key:"name",value:function(e){return this._name=e,this}},{key:"width",value:function(e){return this._width=e,this}},{key:"height",value:function(e){return this._height=e,this}},{key:"textureSrc",value:function(e){return this._textureSrc=e,this}},{key:"isPickable",value:function(e){return this._isPickable=e,this}},{key:"build",value:function(){var e=wt.Mesh.CreateGround(this._name,this._width,this._height,1,this._scene);return e.translate(new wt.Vector3(0,-1,0),.1,wt.Space.WORLD),this._textureSrc&&(e.material=new wt.StandardMaterial("Texture".concat(this._name),this._scene),e.material.ambientTexture=new wt.Texture(this._textureSrc,this._scene),e.material.ambientTexture.uScale=1,e.material.ambientTexture.vScale=1),e.isPickable=this._isPickable,e}}]),e}(),tn=function(){function e(t){$e()(this,e),this._scene=t,this._direction=null,this._name="Dlight".concat(Math.floor(1e3*Math.random())),this._intensity=1}return tt()(e,[{key:"direction",value:function(e){return this._direction=e,this}},{key:"name",value:function(e){return this._name=e,this}},{key:"intensity",value:function(e){return this._intensity=e,this}},{key:"build",value:function(){Object.values(this).forEach((function(e){if(null===e)throw"There are missing variables to build a light, e.g ".concat(e)}));var e=new wt.DirectionalLight(this._name,this._direction.normalize(),this._scene);return e.intensity=this._intensity,e}}]),e}(),nn=n(59),rn=n.n(nn);function on(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=st()(e);if(t){var o=st()(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return ct()(this,n)}}var an=function(e){it()(n,e);var t=on(n);function n(e){var r,o=arguments.length>1&&void 0!==arguments[1]?arguments[1]:n.DEFAULT_SIZE,i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};return $e()(this,n),r=t.call(this,e,i),h()(rt()(r),"getType",(function(){return n.TYPE})),r.size=o,r}return tt()(n,[{key:"toDict",value:function(){var e=jt()(st()(n.prototype),"toDict",this).call(this);return e.size=this.size,e}},{key:"ofDict",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;return n.ofDict(e,t,r)}}],[{key:"ofDict",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,r=At.Maybe.fromNull(t),o=r.flatMap((function(e){return At.Maybe.fromNull(e.size)})).orSome(n.DEFAULT_SIZE),i=r.flatMap((function(e){return At.Maybe.fromNull(e.name)})).orSome("Box".concat(Math.floor(1e3*Math.random()))),a=r.flatMap((function(e){return At.Maybe.fromNull(e.keyValueMap)})).orUndefined(),c=ln.createBox(e,new wt.Color3(Math.random(),Math.random(),Math.random()),o,i);return Qt.mapDict2Mesh(t,c),new n(c,o,a)}}]),n}(Qt);h()(an,"DEFAULT_SIZE",.5),h()(an,"TYPE","Box");var cn=an,un=function(){function e(){$e()(this,e)}return tt()(e,null,[{key:"getWorldCoordinates",value:function(t,n){if(t.parent&&t.parent.name===mn.NAME)return Ft.ofBabylon(n);var r=t.parent,o=Ft.ofBabylon(r.position),i=e.getRotationMatrix(r),a=Ft.ofBabylon(r.scaling);return i.prodVec(a.mul(e.getWorldCoordinates(t.parent,n))).add(o)}},{key:"getBabylonCoordinates",value:function(e){return mn.forwardCoordinates(e)}},{key:"getLocalCoordinatesFromWorld",value:function(t,n){if(t.parent&&t.parent.name===mn.NAME)return Ft.ofBabylon(n);var r=t.parent,o=Ft.ofBabylon(r.position),i=e.getRotationMatrix(r);return Ft.ofBabylon(r.scaling).map((function(e){return 1/e})).mul(i.dotVec(e.getLocalCoordinatesFromWorld(r,n).sub(o)))}},{key:"computeLocalCoordinatesFromMesh",value:function(t,n){if(!t.parent)return n;var r=t.parent,o=Ft.ofBabylon(r.position),i=e.getRotationMatrix(r);return Ft.ofBabylon(r.scaling).map((function(e){return 1/e})).mul(i.dotVec(e.computeLocalCoordinatesFromMesh(r,n).sub(o)))}},{key:"getRotationMatrix",value:function(e){var t=new wt.Matrix,n=At.Maybe.fromNull(e.rotationQuaternion);return n.forEach((function(e){return e.toRotationMatrix(t)})),n.orElseRun((function(){wt.Quaternion.RotationYawPitchRoll(e.rotation.y,e.rotation.x,e.rotation.z).toRotationMatrix(t)})),Zt.ofBabylonMatrix(t)}},{key:"showNormals",value:function(e,t){for(var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1,r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:wt.Color3.Red(),o=t.getVerticesData(wt.VertexBuffer.NormalKind),i=t.getVerticesData(wt.VertexBuffer.PositionKind),a=[],c=0;c<o.length;c+=3){var u=wt.Vector3.FromArray(i,c),s=u.add(wt.Vector3.FromArray(o,c).scaleInPlace(n));a.push([u.add(t.position),s.add(t.position)])}var l=wt.MeshBuilder.CreateLineSystem("normalLines",{lines:a},e);return l.color=r,l.parent=t,l}},{key:"orthogonalBasisFromVector",value:function(e){for(var t=[new wt.Vector3(1,0,0),new wt.Vector3(0,1,0),new wt.Vector3(0,0,1)],n=[e.x,e.y,e.z],r=0,o=0;o<3;o++)if(0!==n[o]){r=o;break}var i=t[(r+1)%3].add(t[r].scale(-n[(r+1)%3]/n[r]));i=i.normalize();var a=t[(r+2)%3].add(t[r].scale(-n[(r+2)%3]/n[r]));return a=(a=a.normalize()).subtract(i.scale(wt.Vector3.Dot(i,a))),{u:wt.Vector3.FromArray(n).normalize(),v:i,w:a.normalize()}}},{key:"cameraBuilder",value:function(e){return new Xt(e)}},{key:"gizmoManagerBuilder",value:function(e){return new Ht(e)}},{key:"meshFromPositionAndFaces",value:function(e,t,n,r){var o=!(arguments.length>4&&void 0!==arguments[4])||arguments[4],i=new wt.VertexData;i.positions=n.flatMap((function(e){return[e.x,e.y,e.z]})),i.indices=r.flatMap((function(e){return e}));var a=new wt.Mesh(e,t);return i.applyToMesh(a,o),a}},{key:"triangulatePolygon",value:function(e){for(var t=rn()(e.map((function(e){return[e.x,e.y,e.z]})).flatMap((function(e){return e})),null,3),n=t.length/3,r=[],o=0;o<n;o++){var i=3*o;r.push([t[i],t[i+1],t[i+2]])}return r}},{key:"computeOrientation",value:function(e){var t=e.length,n=e.map((function(e){return Ft.ofBabylon(e)})),r=0;return n.forEach((function(e,o){var i=n[(o+1)%t].sub(n[o]);r+=Ft.of([-e.y,e.x,e.z]).dot(i)})),r/2}},{key:"pointAverage",value:function(e){return e&&0!==e.length?e.reduce((function(e,t){return e.add(t)}),wt.Vector3.Zero()).scale(1/e.length):wt.Vector3.Zero()}},{key:"pointAverageVec3",value:function(e){return e&&0!==e.length?e.reduce((function(e,t){return e.add(t)}),Ft.ZERO).scale(1/e.length):Ft.ZERO}},{key:"randomVector3",value:function(e,t){return new wt.Vector3.FromArray([0,0,0].map((function(n){return e+(t-e)*Math.random()})))}},{key:"getMaterialFromColor",value:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"MaterialFromColor".concat(sn()),r=new wt.StandardMaterial(n,t);return r.diffuseColor=e,r.emissiveColor=e,r}}]),e}();h()(un,"toLocalCoordinates",(function(e){var t=e.getRootNode().item.mesh;return function(e){var n=function(e){return un.computeLocalCoordinatesFromMesh({parent:t},Ft.ofBabylon(e)).toBabylon()};return Array.isArray(e)?e.map(n):n(e)}})),h()(un,"createOrientedCone",(function(e){for(var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:new wt.Vector3(1,0,0),n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:wt.Color3.Gray(),r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:"OrientedCone".concat(sn()),o=!(arguments.length>4&&void 0!==arguments[4])||arguments[4],i=arguments.length>5&&void 0!==arguments[5]?arguments[5]:16,a={positions:[],faces:[]},c=t.length()/3,u=un.orthogonalBasisFromVector(t),s=u.v,l=u.w,f=Math.sign(wt.Vector3.Dot(wt.Vector3.Cross(s,l),t)),h=0;h<i;h++){var d=f*(2*Math.PI/i)*h;a.positions.push(s.scale(c*Math.cos(d)).add(l.scale(c*Math.sin(d))))}a.positions.push(wt.Vector3.Zero()),a.positions.push(t);for(var p=a.positions.length-1,m=a.positions.length-2,v=0;v<i;v++)a.faces.push([p,(v+1)%i,v]),a.faces.push([m,v,(v+1)%i]);var y=un.meshFromPositionAndFaces(r,e,a.positions,a.faces);y.convertToFlatShadedMesh();var g=new wt.StandardMaterial("OrientedConeMaterial".concat(r),e);return g.diffuseColor=n,g.emissiveColor=n,y.material=g,y.isPickable=o,y})),h()(un,"createSphere",(function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:wt.Color3.Gray(),n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1,r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:"Sphere".concat(sn()),o=!(arguments.length>4&&void 0!==arguments[4])||arguments[4],i=wt.Mesh.CreateSphere(r,16,n,e),a=un.getMaterialFromColor(t,e,"SphereMaterial".concat(r));return i.material=a,i.isPickable=o,i})),h()(un,"createBox",(function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:wt.Color3.Gray(),n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:cn.DEFAULT_SIZE,r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:"Box".concat(sn()),o=!(arguments.length>4&&void 0!==arguments[4])||arguments[4],i=wt.Mesh.CreateBox(r,n,e),a=new wt.StandardMaterial("BoxMaterial".concat(r),e);return a.diffuseColor=t,a.emissiveColor=t,i.material=a,i.isPickable=o,i})),h()(un,"createTubeFromPoints",(function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:wt.Color3.Gray(),r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:1,o=arguments.length>4&&void 0!==arguments[4]?arguments[4]:"Tube".concat(sn()),i=!(arguments.length>5&&void 0!==arguments[5])||arguments[5],a=wt.MeshBuilder.CreateTube(o,{path:t,radius:r,sideOrientation:wt.Mesh.DOUBLESIDE,updatable:!0},e);return a.material=un.getMaterialFromColor(n,e,"Material".concat(o)),a.isPickable=i,a})),h()(un,"positionalLightBuilder",(function(e){return new Jt(e)})),h()(un,"directionalLightBuilder",(function(e){return new tn(e)})),h()(un,"referentialBuilder",(function(e){return new $t(e)})),h()(un,"getGroundPosition",(function(e,t){var n=e.pick(e.pointerX,e.pointerY,(function(e){return e===t}));return n.hit?At.Maybe.some(n.pickedPoint):At.Maybe.none()})),h()(un,"pickMesh",(function(e,t){var n=e.pick(e.pointerX,e.pointerY,(function(e){return e!==t&&e.isEnabled()}));return n.hit&&n.pickedMesh.isPickable?At.Maybe.some(n.pickedMesh):At.Maybe.none()})),h()(un,"groundBuilder",(function(e){return new en(e)})),h()(un,"piecewiseCurveDistance",(function(e){for(var t=0,n=0;n<e.length-1;n++){t+=e[n+1].subtract(e[n]).length()}return t})),h()(un,"getCurveOrientations",(function(e){for(var t=[],n=0;n<e.length-1;n++){var r=e[n+1].subtract(e[n]);t.push(Math.atan2(r.y,r.x))}return t.push(t[t.length-1]),t})),h()(un,"getSplineFromCurve",(function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:7,n=!1;return{points:wt.Curve3.CreateCatmullRomSpline(e,t,n).getPoints()}})),h()(un,"splineObj2redis",(function(e){var t=un.getCurveOrientations(e.points);return e.points.map((function(e,n){return[e.x,e.y,t[n]]}))}));var sn=function(){return Math.floor(1e3*Math.random())},ln=un;function fn(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=st()(e);if(t){var o=st()(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return ct()(this,n)}}var hn=-Math.PI/2,dn={position:[0,0,0],scaling:[1,-1,1],quaternion:[Math.cos(hn/2),Math.sin(hn/2),0,0]},pn=function(e){it()(n,e);var t=fn(n);function n(e){var r,o=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return $e()(this,n),r=t.call(this,e,o),h()(rt()(r),"getType",(function(){return n.TYPE})),r}return tt()(n,[{key:"toForm",value:function(){var e=jt()(st()(n.prototype),"toForm",this).call(this);return e.uiSchema.name={"ui:disabled":!0},e}},{key:"getMouseContextActions",value:function(){return[]}}],[{key:"ofDict",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,r=n.getRosOrigin(e),o=ln.referentialBuilder(e).name(n.NAME).isPickable(!0).boxParams({isVisible:!0,size:.25}).build();return o.parent=r,Qt.mapDict2Mesh(t,o),new n(o,At.Maybe.fromNull(t).flatMap((function(e){return At.Maybe.fromNull(e.keyValueMap)})).orUndefined())}},{key:"getRosOrigin",value:function(e){var t=wt.MeshBuilder.CreateBox("ROS_ORIGIN",{size:.001},e);t.isVisible=!1,t.isPickable=!1,t.position=Ft.of(dn.position).toBabylon(),t.scaling=Ft.of(dn.scaling).toBabylon();var n=new wt.Quaternion(dn.quaternion[1],dn.quaternion[2],dn.quaternion[3],dn.quaternion[0]);return t.rotationQuaternion=n.normalize(),t}},{key:"inverseCoordinates",value:function(e){var t=dn.quaternion,n=ln.getRotationMatrix({rotationQuaternion:new wt.Quaternion(t[1],t[2],t[3],t[0])}),r=Ft.of(dn.scaling).map((function(e){return 1/e})),o=Ft.of(dn.position);return r.mul(n.dotVec(Ft.ofBabylon(e).sub(o))).map((function(e){return Math.abs(e)<1e-5?0:e})).toBabylon()}},{key:"forwardCoordinates",value:function(e){var t=dn.quaternion,n=ln.getRotationMatrix({rotationQuaternion:new wt.Quaternion(t[1],t[2],t[3],t[0])}),r=Ft.of(dn.scaling),o=Ft.of(dn.position);return n.prodVec(r.mul(Ft.ofBabylon(e))).add(o).map((function(e){return Math.abs(e)<1e-5?0:e})).toBabylon()}}]),n}(Qt);h()(pn,"TYPE","GlobalRef"),h()(pn,"NAME","Global ref");var mn=pn,vn=n(18),yn=n.n(vn),gn=n(20),bn=n.n(gn),Mn=function(){function e(){$e()(this,e),this.memory={}}return tt()(e,[{key:"action",value:function(e){e.getSceneMemory().forEach((function(e){e.gizmoManager.attachedMesh=null,e.camera.attachControl(e.canvas,!0)})),e.highlightNodeInTree&&e.highlightNodeInTree(),e.highlightNodeInScene&&e.highlightNodeInScene(),e.closeContextDial&&e.closeContextDial(),e.setContextActionIndex&&e.setContextActionIndex()}}]),e}();function xn(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=st()(e);if(t){var o=st()(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return ct()(this,n)}}var En=function(e){it()(n,e);var t=xn(n);function n(e,r){var o,i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};return $e()(this,n),(o=t.call(this,e,i)).assetName=r,o}return tt()(n,[{key:"toDict",value:function(){var e=jt()(st()(n.prototype),"toDict",this).call(this);return e.assetName=this.assetName,e}}]),n}(Qt);function kn(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function wn(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=st()(e);if(t){var o=st()(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return ct()(this,n)}}var Pn=function(e){it()(n,e);var t=wn(n);function n(e,r,o,i){var a;return $e()(this,n),a=t.call(this,e,i),h()(rt()(a),"getType",(function(){return n.TYPE})),a.size=r,a.textureSrc=o,a}return tt()(n,[{key:"dispose",value:function(){jt()(st()(n.prototype),"dispose",this).call(this)}},{key:"toDict",value:function(){var e=jt()(st()(n.prototype),"toDict",this).call(this);return e.size=this.size,e.textureSrc=this.textureSrc,e}},{key:"toForm",value:function(){var e=this.toDict();return{jsonSchema:{type:"object",properties:{oldName:{type:"string"},name:{type:"string",title:"Name"},type:{type:"string",title:"Type"},assetName:{type:"string",title:"Asset Name"}}},uiSchema:{type:{"ui:disabled":!0},assetName:{"ui:disabled":!0},oldName:{"ui:widget":"hidden"}},data:{oldName:e.name,name:e.name,type:e.type,assetName:e.assetName}}}},{key:"ofForm",value:function(e){this.name=e.name,this.mesh.name=e.name,this.keyValueMap=function(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?kn(Object(n),!0).forEach((function(t){h()(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):kn(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}({},e.annotations)}}]),n}(En);h()(Pn,"TYPE","Map");var Cn=Pn,Sn=n(31),On=function e(){$e()(this,e)};h()(On,"createGizmo",(function(e){var t=new wt.RotationGizmo(new wt.UtilityLayerRenderer(e));return t.xGizmo.dragBehavior.detach(),t.xGizmo.scaleRatio=0,t.yGizmo.dragBehavior.detach(),t.yGizmo.scaleRatio=0,t})),h()(On,"createCamera",(function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:function(e){},r=1,o=ln.cameraBuilder(e).sphericalCoordinates(new wt.Vector3(0,0,14)).target(wt.Vector3.Zero()).name("camera").build();return o.attachControl(t,!1),o.inertia=.7,o.collisionRadius=new wt.Vector3(r,r,r),o.panningInertia=.5,o.checkCollisions=!0,o.panningSensibility=0,o.lowerRadiusLimit=2,n(o),o})),h()(On,"createLight",(function(e){return ln.directionalLightBuilder(e).name("light").direction(new wt.Vector3(0,-1,0)).intensity(.35).build()})),h()(On,"createMeshGround",(function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:20,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:20,r=wt.Mesh.CreateGround("groundMesh",t,n,20,e);return r.translate(new wt.Vector3(0,-1,0),.01,wt.Space.WORLD),r.material=new wt.StandardMaterial("wireframe",e),r.material.wireframe=!0,r.isPickable=!1,r.checkCollisions=!0,r})),h()(On,"createScene",(function(e){var t=new wt.Scene(e);return t.clearColor=wt.Color3.Black,t.collisionsEnabled=!0,t._uid=t.getUniqueId(),t})),h()(On,"createMouseLocationText",(function(e){var t=Sn.AdvancedDynamicTexture.CreateFullscreenUI("UI",!0,e),n=new Sn.TextBlock;return n.text="",n.color="white",n.fontSize=17,n.left=-560,n.top=-145,t.addControl(n),n}));var Nn=On;function Rn(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=st()(e);if(t){var o=st()(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return ct()(this,n)}}var Dn=function(e){it()(n,e);var t=Rn(n);function n(){return $e()(this,n),t.call(this)}return tt()(n,[{key:"onPointerDown",value:function(e,t){}},{key:"onPointerMove",value:function(e,t){}},{key:"onPointerUp",value:function(e){}},{key:"onKeyDown",value:function(e,t){var n={Escape:An(Ro.orbit),KeyG:An(Ro.dragObjects),KeyP:An(Ro.drawPath),KeyB:An(Ro.drawBoxRegion),KeyR:An(Ro.drawRegion),KeyK:An(Ro.addKeyPoint),KeyC:An(Ro.drawGraph)};e.code in n&&n[e.code](t)}}]),n}(Mn),An=function(e){return function(t){e.action(t),t.setSelectedAction(e)}},Tn=Dn;function jn(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=st()(e);if(t){var o=st()(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return ct()(this,n)}}var Vn=function(e){it()(n,e);var t=jn(n);function n(){var e,r,i;return $e()(this,n),In?ct()(i,In):(i=t.call(this),h()(rt()(i),"action",(function(t){jt()((e=rt()(i),st()(n.prototype)),"action",e).call(e,t),t.setSelectedAction(rt()(i))})),h()(rt()(i),"onPointerDown",(function(e,t){1!==e.buttons&&2!==e.buttons||t.getSceneMemory().forEach((function(n){var r=n.scene,o=n.ground,a=n.camera,c=n.canvas;i.maybeSelectedMesh=ln.pickMesh(r,o),i.maybeSelectedMesh.forEach((function(n){a.detachControl(c),ln.getGroundPosition(r,o).forEach((function(r){var o=ln.computeLocalCoordinatesFromMesh(n,Ft.ofBabylon(r));i.mousePointInLocal=o,i.clickPointInLocal=o,i.shiftFromCenterOfMass=o.sub(Ft.ofBabylon(n.position)),n.onClick?n.onClick():t.closeContextDial(),i.handleMeshRightClick(e,t,n),t.addGizmo(n.name),t.highlightNodeInTree(n.name),t.highlightMeshInScene([n]),i.setProperties(t,n.name)}))})),i.maybeSelectedMesh.orLazy((function(){return t.getMouseCoordinatesFromRoot().forEach((function(n){return i.handleRightClickWithoutMesh(e,t,n)}))}))}))})),h()(rt()(i),"handleMeshRightClick",(function(e,t,n){2===e.buttons&&n&&n.getMouseContextActions&&t.setMouseContextActions(e,n.getMouseContextActions(t))})),h()(rt()(i),"handleRightClickWithoutMesh",(function(e,t,n){2===e.buttons&&t.setMouseContextActions(e,[{title:"Paste",onClick:i.getPasteOnClick(n,t)}])})),h()(rt()(i),"getPasteOnClick",(function(e,t){return function(){var n=qt.paste();n&&"function"==typeof n&&n(e,t)}})),h()(rt()(i),"onPointerMove",(function(e,t){1===e.buttons&&t.getSceneMemory().forEach((function(e){var t=e.scene,n=e.ground;ln.getGroundPosition(t,n).forEach((function(e){i.maybeSelectedMesh.forEach((function(t){var n=ln.computeLocalCoordinatesFromMesh(t,Ft.ofBabylon(e)),r=n.sub(i.shiftFromCenterOfMass);t.position=new wt.Vector3(r.getX(),r.getY(),t.position.z),i.notifyObservers(t,!1,n.sub(i.mousePointInLocal)),i.mousePointInLocal=n}))}))}))})),h()(rt()(i),"onPointerUp",(function(e){e.getSceneMemory().forEach((function(t){var n=t.camera,r=t.scene,o=t.ground,a=t.canvas;i.maybeSelectedMesh.forEach((function(t){ln.getGroundPosition(r,o).forEach((function(n){var r=ln.computeLocalCoordinatesFromMesh(t,Ft.ofBabylon(n)).sub(i.clickPointInLocal);i.notifyObservers(t,!0,Ft.ZERO),i.setProperties(e,t.name),e.updateNodeInServer(t.name),i.undoManager.addIt(i.getUndoAbleAction(t,r,e))}))})),i.maybeSelectedMesh=At.Maybe.none(),i.shiftFromCenterOfMass=Ft.ZERO,i.mousePointInLocal=Ft.ZERO,n.attachControl(a,!0)}))})),h()(rt()(i),"onKeyDown",(function(e,t){for(var o=[{predicate:function(e){return["Backspace","Delete"].includes(e.code)},action:i.getDeleteButtonAction(t)},{predicate:function(e){return e.ctrlKey&&!e.shiftKey&&"KeyZ"===e.code},action:function(){return i.undoManager.undo()}},{predicate:function(e){return e.ctrlKey&&e.shiftKey&&"KeyZ"===e.code},action:function(){return i.undoManager.redo()}},{predicate:function(e){return e.ctrlKey&&"KeyC"===e.code},action:function(){return At.Maybe.fromNull(t.getHighlightedNodeName()).forEach((function(e){return t.getNodeFromTree(e).forEach((function(e){var n=e.item.mesh;n.getMouseContextActions&&n.getMouseContextActions(t)[0].onClick()}))}))}},{predicate:function(e){return e.ctrlKey&&"KeyV"===e.code},action:function(){t.getMouseCoordinatesFromRoot().forEach((function(e){return i.getPasteOnClick(e,t)()}))}},{predicate:function(e){return!0},action:function(){return jt()((r=rt()(i),st()(n.prototype)),"onKeyDown",r).call(r,e,t)}}],a=0;a<o.length;a++){var c=o[a];if(c.predicate(e)){c.action();break}}})),h()(rt()(i),"setProperties",(function(e,t){return setTimeout((function(){return e.setPropertiesWithName(t)}),100)})),i.key="dragObject",i.name="Grab Objects [G]",i.icon=function(e){return o.a.createElement("i",Q()({className:"fas fa-mouse-pointer"},e))},i.maybeSelectedMesh=At.Maybe.none(),i.shiftFromCenterOfMass=Ft.ZERO,i.mousePointInLocal=Ft.ZERO,i.clickPointInLocal=Ft.ZERO,i.undoManager=new _t.UndoManager,In=rt()(i),i)}return tt()(n,[{key:"getDeleteButtonAction",value:function(e){return function(){return At.Maybe.fromNull(e.getHighlightedNodeName()).forEach((function(t){var n=e.getNodeFromTree(t);n.forEach((function(){return e.onDeleteNode(t)})),n.orElseRun((function(){e.getContextActions()[0].action(e)}))}))}}},{key:"notifyObservers",value:function(e,t,n){At.Maybe.fromNull(e.observers).forEach((function(r){return r.notifyObservers({updatedPointMesh:e,is2updateServer:t,displacement:n.toBabylon()})}))}},{key:"getUndoAbleAction",value:function(e,t,n){var r=this;return _t.UndoManager.actionBuilder().doAction((function(){var o=Ft.ofBabylon(e.position).add(t);e.position=o.toBabylon(),r.notifyObservers(e,!0,t),n.updateNodeInServer(e.name)})).undoAction((function(){var o=t.scale(-1),i=Ft.ofBabylon(e.position).add(o);e.position=i.toBabylon(),r.notifyObservers(e,!0,o),n.updateNodeInServer(e.name)})).build()}}],[{key:"getInstance",value:function(){return new n}}]),n}(Tn),In=null,Bn=Vn;function Fn(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=st()(e);if(t){var o=st()(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return ct()(this,n)}}var _n=function(e){it()(n,e);var t=Fn(n);function n(e,r){var o;return $e()(this,n),o=t.call(this,e,r),h()(rt()(o),"getType",(function(){return n.TYPE})),o}return tt()(n,[{key:"ofDict",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;return n.ofDict(e,t,r)}}],[{key:"ofDict",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,r=At.Maybe.fromNull(t).map((function(e){return e.name})).orSome("KeyPoint".concat(Math.floor(1e3*Math.random()))),o=wt.MeshBuilder.CreatePolyhedron(r,{custom:Ln,size:n.DEFAULT_SIZE},e),i=new wt.StandardMaterial("KeyPointMaterial".concat(r),e);o.material=i,o.convertToFlatShadedMesh();var a=ln.referentialBuilder(e).isPickable(!1).boxParams({isVisible:!1,size:.1*n.DEFAULT_SIZE}).name("".concat(r,"Axis")).build();return a.parent=o,Qt.mapDict2Mesh(t,o),new n(o,t.keyValueMap)}}]),n}(Qt);h()(_n,"TYPE","KeyPoint"),h()(_n,"DEFAULT_SIZE",.25);var Ln={name:"Triangular Antiprism (Octahedron)",category:["Antiprism"],vertex:[[0,0,1.414214],[1.414214,0,0],[0,1.414214,0],[-1.414214,0,0],[0,-1.414214,0],[0,0,-1.414214]],face:[[0,1,2],[0,2,3],[0,3,4],[0,4,1],[1,4,5],[1,5,2],[2,5,3],[3,5,4]]},zn=_n;function Un(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=st()(e);if(t){var o=st()(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return ct()(this,n)}}var qn=null,Gn=function(e){it()(n,e);var t=Un(n);function n(){var e,r;return $e()(this,n),qn?ct()(r,qn):(r=t.call(this),h()(rt()(r),"createKeyPoint",(function(e,t,n,r){var o=!(arguments.length>4&&void 0!==arguments[4])||arguments[4],i=arguments.length>5&&void 0!==arguments[5]?arguments[5]:wt.Color3.Gray(),a=r.getRootNode().item.mesh,c=zn.ofDict(n,{name:t,color:[i.r,i.g,i.b]}),u=c.mesh;u.parent=a;var s=ln.computeLocalCoordinatesFromMesh({parent:a},Ft.ofBabylon(e)).toBabylon();return u.setPositionWithLocalVector(s.add(wt.Axis.Z.scale(zn.DEFAULT_SIZE))),o&&r.addNodeItem2Tree(c,a.name,o),u})),h()(rt()(r),"action",(function(t){jt()((e=rt()(r),st()(n.prototype)),"action",e).call(e,t),t.setSelectedAction(rt()(r))})),h()(rt()(r),"onPointerDown",(function(e,t){0===e.button&&t.getSceneMemory().forEach((function(e){var t=e.scene,n=e.ground,o=e.camera;r.maybeMousePos=ln.getGroundPosition(t,n),r.maybeMousePos.forEach((function(t){o.detachControl(e.canvas)}))}))})),h()(rt()(r),"onPointerMove",(function(e,t){t.getSceneMemory().forEach((function(e){var n=e.scene,o=e.ground;ln.getGroundPosition(n,o).forEach((function(e){r.maybeMousePos.forEach((function(o){r.tempMesh&&r.tempMesh.dispose(),r.tempMesh=r.createKeyPoint(e,"temp_key_point",n,t,!1)}))}))}))})),h()(rt()(r),"onPointerUp",(function(e){e.getSceneMemory().forEach((function(t){var n=t.scene,o=t.camera,i=t.ground;ln.getGroundPosition(n,i).forEach((function(t){r.maybeMousePos.forEach((function(o){r.tempMesh&&r.tempMesh.dispose();var i="KeyPoint".concat(Math.floor(1e3*Math.random()));r.createKeyPoint(t,i,n,e,!0,new wt.Color3(Math.random(),Math.random(),Math.random())),e.setPropertiesWithName(i)}))})),r.maybeMousePos=At.Maybe.none(),o.attachControl(t.canvas,!0)}))})),r.key="addKeyPoint",r.name="Add Key Point [K]",r.maybeMousePos=At.Maybe.none(),r.tempMesh=null,r.icon=function(e){return o.a.createElement("i",Q()({className:"fas fa-map-marker"},e))},qn=rt()(r),r)}return tt()(n,null,[{key:"getInstance",value:function(){return new n}}]),n}(Tn),Kn={RADIUS:.4,POINTS_DENSITY:2,CLOUD_FUNCTION_NAME:"backend.viewer"},Wn=n(60),Yn=n.n(Wn);function Qn(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=st()(e);if(t){var o=st()(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return ct()(this,n)}}var Zn=function(e){it()(n,e);var t=Qn(n);function n(e,r,o){var i,a=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{};return $e()(this,n),i=t.call(this,e,a),h()(rt()(i),"getType",(function(){return n.TYPE})),i.corners=r,i.keyPoints=o,i}return tt()(n,[{key:"toDict",value:function(){var e=jt()(st()(n.prototype),"toDict",this).call(this);return e.corners=this.corners,e}},{key:"toForm",value:function(){var e=jt()(st()(n.prototype),"toForm",this).call(this);e.jsonSchema.properties.dimensions={type:"object",title:"Dimensions",properties:{lower:{type:"object",title:"Lower Corner",properties:{x:{type:"number",title:"x"},y:{type:"number",title:"y"}}},size:{type:"object",title:"Size",properties:{scaleX:{type:"number",title:"scale-X"},scaleY:{type:"number",title:"scale-Y"}}}}},e.uiSchema.dimensions={"ui:widget":"collapse"};var t=this.keyPoints.map((function(e){return ln.getWorldCoordinates(e,e.position)})).map((function(e){return e.toArray()}));return e.data.dimensions={lower:{x:t[0][0],y:t[0][1]},size:{scaleX:this.corners[1][0]-this.corners[0][0],scaleY:this.corners[1][1]-this.corners[0][1]}},e}},{key:"ofForm",value:function(e){var t=this.toForm().data.dimensions;Yn()(t,e.dimensions)?jt()(st()(n.prototype),"ofForm",this).call(this,e):this.ofFormDimensions(e)}},{key:"ofDict",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;return n.ofDict(e,t,r)}},{key:"ofFormDimensions",value:function(e){var t=this,n=wt.Vector3.FromArray([e.dimensions.lower.x,e.dimensions.lower.y,0].map(Number.parseFloat)),r=[e.dimensions.size.scaleX,e.dimensions.size.scaleY].map(Number.parseFloat),o=ln.getLocalCoordinatesFromWorld(this.keyPoints[0],n).toArray(),i=function(e){return t.keyPoints[e].observers.notifyObservers({updatedPointMesh:t.keyPoints[e],is2updateServer:!1})};this.keyPoints[0].position=new wt.Vector3(o[0],o[1],this.keyPoints[0].position.z),i(0),this.keyPoints[1].position=new wt.Vector3(o[0]+r[0],o[1]+r[1],this.keyPoints[1].position.z),i(1)}}],[{key:"ofDict",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;if(!t)throw"null dictionary describing Box region";var o=At.Maybe.fromNull(t.name).orSome("BoxRegion".concat(Math.floor(1e3*Math.random()))),i=Jn(t,o,e),a=new wt.StandardMaterial("BoxRegionMaterial".concat(o),e),c=new wt.Color3(t.color[0],t.color[1],t.color[2]);a.diffuseColor=c,a.emissiveColor=c,a.backFaceCulling=!1,i.material=a,i.visibility=.25,At.Maybe.fromNull(t.quaternion).forEach((function(e){var t=new wt.Quaternion(e[1],e[2],e[3],e[0]);i.rotationQuaternion=t.normalize()}));var u=er(e,t.corners.map((function(e){return Ft.of(e).toBabylon()})),i,r);return new n(i,t.corners,u,t.keyValueMap)}}]),n}(Qt);h()(Zn,"TYPE","BoxRegion");var Hn=Kn.RADIUS,Xn=[[0,1,2],[2,3,0],[4,5,6],[6,7,4],[0,1,5],[5,4,0],[3,2,6],[6,7,3],[1,2,6],[6,5,1],[0,3,7],[7,4,0]];function Jn(e,t,n){var r=e.corners.map((function(e){return Ft.of(e).toBabylon()})),o=r[1].subtract(r[0]),i=Ft.of(e.position).toBabylon(),a=[r[0],r[0].add(wt.Axis.X.scale(o.x)),r[0].add(new wt.Vector3(o.x,o.y,0)),r[0].add(wt.Axis.Y.scale(o.y))],c=new wt.Vector3(0,0,o.z),u={positions:[a[0],a[1],a[2],a[3],a[0].add(c),a[1].add(c),a[2].add(c),a[3].add(c)],faces:Xn},s=ln.meshFromPositionAndFaces(t,n,u.positions,u.faces);return s.position=i,s}var $n=function(e,t){return function(n){var r=n.updatedPointMesh,o=n.is2updateServer;e.getNodeFromTree(r.parent.name).forEach((function(n){var i=r.index,a=n.item,c=a.mesh,u=c.name,s={position:Ft.ofBabylon(c.position).toArray(),corners:a.corners};s.corners[i]=Ft.ofBabylon(r.position).toArray(),function(e,t,n,r){var o=ln.pointAverageVec3(e.corners.map((function(e){return Ft.of(e)})));e.position=o.toArray(),e.corners=e.corners.map((function(e){return Ft.of(e).sub(o).toArray()}));var i=Jn(e,n.name,t);i.position=n.position,i.rotationQuaternion=n.rotationQuaternion,i.locallyTranslate(o.toBabylon()),i.material=n.material,i.visibility=n.visibility,i.parent=n.parent,r.mesh=i,r.corners=e.corners,kt()(n._children).forEach((function(e){n.removeChild(e),e.parent=i})),r.keyPoints.forEach((function(t,n){t.position=Ft.of(e.corners[n]).toBabylon()})),n.dispose()}(s,t,c,a),e.addGizmo(),o&&(e.updateNodeInServer(u),e.getNodeFromTree(u).forEach((function(t){e.setProperties(t.item.toForm())})))}))}},er=function(e,t,n,r){var o=[];return t.forEach((function(t,i){var a=t,c=ln.createSphere(e,new wt.Color3(.25,.25,.25),Hn,"".concat(n.name,"keyPoint").concat(i),!0);c.parent=n,c.position=a,c.index=i,c.observers=new wt.Observable,c.observers.add($n(r,e)),o.push(c)})),o},tr=Zn;function nr(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=st()(e);if(t){var o=st()(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return ct()(this,n)}}var rr=function(e){it()(n,e);var t=nr(n);function n(){var e,r;return $e()(this,n),or?ct()(r,or):(r=t.call(this),h()(rt()(r),"action",(function(t){jt()((e=rt()(r),st()(n.prototype)),"action",e).call(e,t),t.setSelectedAction(rt()(r))})),h()(rt()(r),"onPointerDown",(function(e,t){1===e.buttons&&t.getSceneMemory().forEach((function(e){var t=e.scene,n=e.ground,o=e.camera,i=ln.getGroundPosition(t,n);r.maybeMousePos=i,i.forEach((function(t){o.detachControl(e.canvas)}))}))})),h()(rt()(r),"onPointerMove",(function(e,t){t.getSceneMemory().forEach((function(e){var n=e.scene,o=e.ground;ln.getGroundPosition(n,o).forEach((function(e){r.maybeMousePos.forEach((function(o){r.tempMesh&&r.tempMesh.dispose(),r.tempMesh=r.createBoxRegion([o,e],ir,n,t,!1)}))}))}))})),h()(rt()(r),"onPointerUp",(function(e){e.getSceneMemory().forEach((function(t){var n=t.scene,o=t.camera,i=t.ground;ln.getGroundPosition(n,i).forEach((function(t){r.maybeMousePos.forEach((function(o){r.tempMesh.dispose();var i="BoxRegion".concat(Math.floor(1e3*Math.random()));r.createBoxRegion([o,t],i,n,e,!0),e.setPropertiesWithName(i)}))})),r.maybeMousePos=At.Maybe.none(),o.attachControl(t.canvas,!0),e.renderMenus()}))})),h()(rt()(r),"createBoxRegion",(function(e,t,n,r){var o=!(arguments.length>4&&void 0!==arguments[4])||arguments[4],i=arguments.length>5&&void 0!==arguments[5]?arguments[5]:wt.Color3.Red(),a=arguments.length>6&&void 0!==arguments[6]?arguments[6]:1,c=r.getRootNode().item.mesh,u=e.map((function(e){return ln.computeLocalCoordinatesFromMesh({parent:c},Ft.ofBabylon(e))}));u[1]=u[1].add(Ft.of([0,0,a]));var s=u[0].add(u[1]).scale(.5),l=u.map((function(e){return e.sub(s)})),f=tr.ofDict(n,{name:t,position:s.toArray(),color:[i.r,i.g,i.b],corners:l.map((function(e){return e.toArray()}))},r);return f.mesh.parent=c,o&&r.addNodeItem2Tree(f,c.name,o),f.mesh})),r.key="drawBoxRegion",r.name="Draw Box Region [B]",r.maybeMousePos=At.Maybe.none(),r.tempMesh=null,r.icon=function(e){return o.a.createElement("i",Q()({className:"fas fa-square"},e))},or=rt()(r),r)}return tt()(n,null,[{key:"getInstance",value:function(){return new n}}]),n}(Tn),or=null,ir="temp_box_region",ar=rr;function cr(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function ur(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?cr(Object(n),!0).forEach((function(t){h()(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):cr(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function sr(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=st()(e);if(t){var o=st()(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return ct()(this,n)}}var lr=Kn.RADIUS,fr=function(e){it()(n,e);var t=sr(n);function n(e,r,o,i){var a,c=arguments.length>4&&void 0!==arguments[4]?arguments[4]:{};return $e()(this,n),a=t.call(this,e,c),h()(rt()(a),"getType",(function(){return n.TYPE})),a.localPath=r,a.keyPoints=o,a.splinePath=i,a.selectedKeyPointIndex=-1,a}return tt()(n,[{key:"toDict",value:function(){var e=jt()(st()(n.prototype),"toDict",this).call(this);return e.localPath=this.localPath,e.splinePath=this.splinePath,e}},{key:"toForm",value:function(){var e=jt()(st()(n.prototype),"toForm",this).call(this);if(this.selectedKeyPointIndex>=0){e.jsonSchema.properties.selectedKeyPoint={type:"object",title:"KeyPoint ".concat(this.selectedKeyPointIndex),properties:{x:{type:"number",title:"x"},y:{type:"number",title:"y"},z:{type:"number",title:"z"}}},e.uiSchema.selectedKeyPoint={"ui:widget":"collapse"},e.uiSchema.position={"ui:widget":"hidden"},e.uiSchema.quaternion={"ui:widget":"hidden"},e.uiSchema.color={"ui:widget":"hidden"},e.uiSchema.annotations={"ui:widget":"hidden"};var t=this.keyPoints[this.selectedKeyPointIndex],r=ln.getWorldCoordinates(t,t.position).toArray();return e.data.selectedKeyPoint={x:r[0],y:r[1],z:r[2]},e}return e}},{key:"ofForm",value:function(e){if(jt()(st()(n.prototype),"ofForm",this).call(this,e),this.selectedKeyPointIndex>=0){var t=this.keyPoints[this.selectedKeyPointIndex],r=e.selectedKeyPoint,o=wt.Vector3.FromArray([r.x,r.y,r.z].map(Number.parseFloat)),i=ln.getLocalCoordinatesFromWorld(t,o).toArray();t.position=new wt.Vector3(i[0],i[1],i[2]),t.observers.notifyObservers({updatedPointMesh:t,is2updateServer:!1})}}},{key:"ofDict",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;return n.ofDict(e,t,r)}}],[{key:"ofDict",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;if(!t||!r)throw"null dictionary describing path or null mainView";var o=t.name,i=t.localPath.map((function(e){return Ft.of(e).toBabylon()})),a=ln.getSplineFromCurve(i),c=a.points,u=null;(u=1===c.length?wt.MeshBuilder.CreateLines(o,{points:c,updatable:!0},e):ln.createTubeFromPoints(e,c,wt.Color3.Gray(),lr/8,o)).position=Ft.of(t.position).toBabylon(),u.material=ln.getMaterialFromColor(wt.Color3.FromArray(t.color),e,"PathMaterial".concat(o)),u.rotationQuaternion=At.Maybe.fromNull(t.quaternion).map((function(e){return new wt.Quaternion(e[1],e[2],e[3],e[0]).normalize()})).orSome(wt.Quaternion.Identity());var s=ln.splineObj2redis(a),l=br(e,ur(ur({},t),{},{mesh:u,splinePath:s}),r),f=new n(u,i.map((function(e){return[e.x,e.y,e.z]})),l,s,t.keyValueMap);return u.onClick=dr(r,f),f}}]),n}(Qt);h()(fr,"TYPE","Path");var hr=fr,dr=function(e,t){return function(){e.closeContextDial(),e.getNodeFromTree(t.name).forEach((function(e){return e.item.selectedKeyPointIndex=-1}))}};function pr(e,t,n,r){var o=kt()(n._children),i=r.splinePath.map((function(e){return new wt.Vector3(e[0],e[1],0)}));return o.forEach((function(e){e.parent=r.mesh})),r.keyPoints.map((function(t,o){(t.index=o,t.name="".concat(n.name,"keyPointSpline").concat(o),t.position=Ft.of(r.localPath[o]).toBabylon(),t.rotationQuaternion=wt.Quaternion.Identity(),o>0&&o<r.keyPoints.length-1)&&(t._children.forEach((function(e){return e.dispose()})),Mr(e,t.material.diffuseColor,r.mesh,o,i,t.position)().parent=t);return t}))}function mr(e,t,n,r,o){var i=arguments.length>5&&void 0!==arguments[5]?arguments[5]:pr,a=ln.pointAverage(e);e=e.map((function(e){return e.subtract(a)}));var c=ln.getSplineFromCurve(e),u=ln.createTubeFromPoints(t,c.points,wt.Color3.Gray(),lr/8,n.name);return u.position=n.position,u.rotationQuaternion=n.rotationQuaternion,u.locallyTranslate(a),u.material=n.material,u.visibility=n.visibility,u.parent=n.parent,u.onClick=n.onClick,r.localPath=e.map((function(e){return Ft.ofBabylon(e).toArray()})),r.splinePath=ln.splineObj2redis(c),r.mesh=u,r.keyPoints=i(t,o,n,r),n.dispose(),e}function vr(e,t,n,r){return br(e,r,t)}var yr=function(e,t,n,r){var o=t.index,i=t.parent.name;n.getNodeFromTree(i).forEach((function(t){var a=o+r,c=t.item,u=c.localPath.length,s=c.mesh,l=[],f=c.localPath.map((function(e){return Ft.of(e).toBabylon()}));if(a<0)l=[f[0].scale(3).subtract(f[1]).scale(.5)].concat(f);else if(a>u-1)l=f.concat([f[u-1].scale(3).subtract(f[u-2]).scale(.5)]);else{for(var h=o+Math.max(0,r),d=0;d<h;d++)l.push(f[d]);l.push(f[a].add(f[o]).scale(.5));for(var p=h;p<u;p++)l.push(f[p])}mr(l,e,s,c,n,vr),n.updateNodeInServer(i)}))},gr=function(e,t,n){var r=[];return n.getNodeFromTree(t.parent.name).forEach((function(n){2!==n.item.localPath.length&&r.push({icon:function(e){return o.a.createElement("i",Q()({className:"fas fa-trash"},e))},action:function(n){!function(e,t,n){var r=t.index,o=t.parent.name;n.getNodeFromTree(o).forEach((function(t){var i=t.item,a=i.mesh,c=i.localPath.map((function(e){return Ft.of(e).toBabylon()}));c.splice(r,1),i.keyPoints.splice(r,1)[0].dispose(),mr(c,e,a,i,n,vr),n.updateNodeInServer(o)}))}(e,t,n),n.closeContextDial()},name:"Delete node [DEL]"}),r.push({icon:function(e){return o.a.createElement("i",Q()({className:"fas fa-less-than"},e))},action:function(n){yr(e,t,n,-1),n.closeContextDial()},name:"Add previous"}),r.push({icon:function(e){return o.a.createElement("i",Q()({className:"fas fa-greater-than"},e))},action:function(n){yr(e,t,n,1),n.closeContextDial()},name:"Add next"})})),r},br=function(e,t,n){var r=new wt.Color3(.25,.25,.25),o=[],i=t.localPath.map((function(e){return Ft.of(e).toBabylon()})),a=t.splinePath.map((function(e){return new wt.Vector3(e[0],e[1],0)})),c=t.mesh;return i.forEach((function(t,u){var s,l,f=xr(e,r,c,u),h=0===u||u===i.length-1?f():(s=Mr(e,r,c,u,a,t)(),(l=xr(e,r,c,u)()).visibility=.1,s.parent=l,l);h.parent=c,h.position=t,h.index=u,h.observers=new wt.Observable,o.push(h),h.observers.add(function(e,t){return function(n){var r=n.updatedPointMesh,o=n.is2updateServer;r.parent&&t.getNodeFromTree(r.parent.name).forEach((function(n){var i=r.index,a=n.item,c=a.mesh,u=a.localPath.map((function(e){return Ft.of(e).toBabylon()}));u[i]=r.position,mr(u,e,c,a,t),i>0&&i<u.length-1&&t.highlightMeshInScene([a.keyPoints[i]._children[0]]),o&&(t.updateNodeInServer(c.name),t.getNodeFromTree(c.name).forEach((function(e){e.item.selectedKeyPointIndex=i,t.setProperties(e.item.toForm())})))}))}}(e,n))})),o.forEach((function(t){t.onClick=function(){n.setContextActions(gr(e,t,n))}})),o};function Mr(e,t,n,r,o,i){return function(){var a=o.map((function(e){return i.subtract(e).length()})).reduce((function(e,t,n){return e.value<t?e:{value:t,index:n}}),{value:Number.MAX_VALUE,index:-1}).index,c=o[a+1].subtract(o[a]).normalize().scale(lr);return ln.createOrientedCone(e,c,t,"".concat(n.name,"keyPointCone").concat(r),!1)}}function xr(e,t,n,r){return function(){return ln.createSphere(e,t,lr,"".concat(n.name,"keyPointSpline").concat(r),!0)}}function Er(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=st()(e);if(t){var o=st()(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return ct()(this,n)}}var kr=function(e){it()(n,e);var t=Er(n);function n(){var e,r,i,a;return $e()(this,n),wr?ct()(a,wr):(a=t.call(this),h()(rt()(a),"action",(function(t){jt()((e=rt()(a),st()(n.prototype)),"action",e).call(e,t),t.setSelectedAction(rt()(a))})),h()(rt()(a),"onPointerDown",(function(e,t){1===e.buttons&&t.getSceneMemory().forEach((function(e){var n=e.scene,r=e.ground,o=e.camera,i=e.canvas;ln.getGroundPosition(n,r).forEach((function(e){o.detachControl(i),a.mouseCurve.push(e);var r=1===a.mouseCurve.length?[a.mouseCurve[0],a.mouseCurve[0]]:a.mouseCurve;a.createCurve(r,Pr,n,t,!1),t.setContextActions(a.getDrawPathContextAction(o,i,n))}))}))})),h()(rt()(a),"onPointerMove",(function(e,t){})),h()(rt()(a),"onPointerUp",(function(e){})),h()(rt()(a),"onKeyDown",(function(e,t){t.getSceneMemory().forEach((function(o){var c=o.scene,u=o.camera,s=o.canvas,l=a.getDrawPathContextAction(u,s,c),f={Enter:function(){return l[1].action(t)},Delete:function(){return l[0].action(t)},Backspace:function(){return l[0].action(t)},Escape:function(){0===a.mouseCurve.length&&jt()((r=rt()(a),st()(n.prototype)),"onKeyDown",r).call(r,e,t),l[0].action(t)}};e.code in f?f[e.code]():jt()((i=rt()(a),st()(n.prototype)),"onKeyDown",i).call(i,e,t)}))})),h()(rt()(a),"createCurve",(function(e,t,n,r){var o=!(arguments.length>4&&void 0!==arguments[4])||arguments[4],i=arguments.length>5&&void 0!==arguments[5]?arguments[5]:wt.Color3.Gray(),a=r.getRootNode().item.mesh,c=e.map((function(e){return ln.computeLocalCoordinatesFromMesh({parent:a},Ft.ofBabylon(e)).toBabylon()})),u=ln.pointAverage(c),s=c.map((function(e){return e.subtract(u)})),l=hr.ofDict(n,{name:t,position:Ft.ofBabylon(u).toArray(),color:[i.r,i.g,i.b],localPath:s.map((function(e){return Ft.ofBabylon(e).toArray()}))},r);l.mesh.parent=a,r.addNodeItem2Tree(l,a.name,o)})),h()(rt()(a),"getDrawPathContextAction",(function(e,t,n){var r=[];return r.push({icon:function(e){return o.a.createElement("i",Q()({className:"fas fa-trash"},e))},action:function(n){e.attachControl(t,!0),n.deleteNodeFromTreeUsingName(Pr,!1),a.mouseCurve=[],n.closeContextDial()},name:"Clear Path [ESC | DEL | Backspace]"}),a.mouseCurve.length>1&&r.push({icon:function(e){return o.a.createElement("i",Q()({className:"fas fa-check"},e))},action:function(r){e.attachControl(t,!0),r.deleteNodeFromTreeUsingName(Pr,!1);var o="Path".concat(Math.floor(1e3*Math.random()));a.createCurve(a.mouseCurve,o,n,r,!0),a.mouseCurve=[],r.setPropertiesWithName(o),r.closeContextDial()},name:"Create Path [Enter]"}),r})),a.key="drawPath",a.name="Draw Path [P]",a.mouseCurve=[],a.icon=function(e){return o.a.createElement("i",Q()({className:"fas fa-bezier-curve"},e))},wr=rt()(a),a)}return tt()(n,null,[{key:"getInstance",value:function(){return new n}}]),n}(Tn),wr=null,Pr="temp_curve",Cr=kr;function Sr(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=st()(e);if(t){var o=st()(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return ct()(this,n)}}var Or=Kn.RADIUS,Nr=_t.Utils.mod,Rr=function(e){it()(n,e);var t=Sr(n);function n(e,r,o,i){var a,c=arguments.length>4&&void 0!==arguments[4]?arguments[4]:{};return $e()(this,n),a=t.call(this,e,c),h()(rt()(a),"getType",(function(){return n.TYPE})),a.localPolygon=r,a.height=o,a.keyPoints=i,a}return tt()(n,[{key:"toDict",value:function(){var e=jt()(st()(n.prototype),"toDict",this).call(this);return e.localPolygon=this.localPolygon,e.height=this.height,e}},{key:"ofDict",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;return n.ofDict(e,t,r)}}],[{key:"ofDict",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;if(!t||!r)throw"null dictionary describing polygon or null mainView";var o=t.localPolygon.map((function(e){return Ft.of(e).toBabylon()})),i=Ft.of(t.position).toBabylon(),a=Ar(e,o,t.height,t.name);a.position=i;var c=new wt.StandardMaterial("PolygonMaterial".concat(t.name),e),u=new wt.Color3(t.color[0],t.color[1],t.color[2]);c.diffuseColor=u,c.emissiveColor=u,a.material=c,a.visibility=.5,At.Maybe.fromNull(t.quaternion).forEach((function(e){var t=new wt.Quaternion(e[1],e[2],e[3],e[0]);a.rotationQuaternion=t.normalize()}));var s=_r(e,o,a,r);return new n(a,o.map((function(e){return[e.x,e.y,e.z]})),t.height,s,t.keyValueMap)}}]),n}(Qt);h()(Rr,"TYPE","PolygonRegion");var Dr=function(e){var t=[];return t.push(e[1]),t.push(e[0]),t.push(e[2]),t},Ar=function(e,t,n,r){var o=new wt.Vector3(0,0,n),i={positions:[],faces:[]};i.positions=kt()(t);for(var a=0;a<t.length;a++)i.positions.push(t[a].add(o));var c=t.length,u=ln.triangulatePolygon(t),s=ln.triangulatePolygon(i.positions.slice(c)).map((function(e){return e.map((function(e){return e+c}))})).map(Dr),l=function(e){for(var t=e.length,n=ln.computeOrientation(e),r=[],o=0;o<t;o++){var i=(o+1)%t;r.push([o,t+i,i]),r.push([o,t+o,t+i])}return n>0?r:r.map(Dr)}(t);return i.faces=u.concat(s).concat(l),ln.meshFromPositionAndFaces(r,e,i.positions,i.faces)};function Tr(e,t,n,r){return kt()(n._children).forEach((function(e){n.removeChild(e),e.parent=r.mesh})),r.keyPoints.map((function(o,i){return o.observers=new wt.Observable,o.observers.add(Vr(e,t)),o.index=i,o.name="".concat(n.name,"keyPoint").concat(i),o.position=Ft.of(r.localPolygon[i]).toBabylon(),o}))}function jr(e,t,n,r,o){var i=arguments.length>5&&void 0!==arguments[5]?arguments[5]:Tr,a=ln.pointAverage(e);e=e.map((function(e){return e.subtract(a)}));var c=Ar(t,e,r.height,n.name);return c.position=n.position,c.rotationQuaternion=n.rotationQuaternion,c.locallyTranslate(a),c.material=n.material,c.visibility=n.visibility,c.parent=n.parent,r.localPolygon=e.map((function(e){return Ft.ofBabylon(e).toArray()})),r.mesh=c,r.keyPoints=i(t,o,n,r),n.dispose(),e}var Vr=function(e,t){return function(n){var r=n.updatedPointMesh,o=n.is2updateServer;r.parent&&t.getNodeFromTree(r.parent.name).forEach((function(n){var i=r.index,a=n.item,c=a.mesh,u=c.name,s=a.localPolygon.map((function(e){return Ft.of(e).toBabylon()}));s[i]=r.position,jr(s,e,c,a,t),o&&t.updateNodeInServer(u)}))}};function Ir(e,t,n,r){return _r(e,r.localPolygon.map((function(e){return Ft.of(e).toBabylon()})),r.mesh,t)}var Br=function(e,t,n,r){var o=t.index,i=t.parent.name;n.getNodeFromTree(i).forEach((function(t){for(var i=t.item,a=i.localPolygon.length,c=Nr(o+r,a),u=i.mesh,s=i.localPolygon.map((function(e){return Ft.of(e).toBabylon()})),l=[],f=o+Math.max(0,r),h=0;h<f;h++)l.push(s[h]);l.push(s[c].add(s[o]).scale(.5));for(var d=f;d<a;d++)l.push(s[d]);jr(l,e,u,i,n,Ir)}))},Fr=function(e,t,n){var r=[];return n.getNodeFromTree(t.parent.name).forEach((function(n){n.item.localPolygon.length>3&&r.push({icon:function(e){return o.a.createElement("i",Q()({className:"fas fa-trash"},e))},action:function(n){!function(e,t,n){var r=t.index,o=t.parent.name;n.getNodeFromTree(o).forEach((function(t){var i=t.item,a=i.mesh,c=i.localPolygon.map((function(e){return Ft.of(e).toBabylon()}));c.splice(r,1),i.keyPoints.splice(r,1)[0].dispose(),jr(c,e,a,i,n),n.updateNodeInServer(o)}))}(e,t,n),n.closeContextDial()},name:"Delete node [DEL]"}),r.push({icon:function(e){return o.a.createElement("i",Q()({className:"fas fa-less-than"},e))},action:function(n){Br(e,t,n,-1),n.closeContextDial()},name:"Add previous"}),r.push({icon:function(e){return o.a.createElement("i",Q()({className:"fas fa-greater-than"},e))},action:function(n){Br(e,t,n,1),n.closeContextDial()},name:"Add next"})})),r},_r=function(e,t,n,r){var o=[];return t.forEach((function(t,i){var a=new wt.Color3(.25,.25,.25),c=ln.createSphere(e,a,Or,"".concat(n.name,"keyPointPolygon").concat(i),!0);c.parent=n,c.position=t,c.index=i,c.observers=new wt.Observable,o.push(c),c.observers.add(Vr(e,r))})),o.forEach((function(t){t.onClick=function(){r.setContextActions(Fr(e,t,r))}})),o},Lr=Rr;function zr(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=st()(e);if(t){var o=st()(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return ct()(this,n)}}var Ur=null,qr=function(e){it()(n,e);var t=zr(n);function n(){var e,r,i,a;return $e()(this,n),Ur?ct()(a,Ur):(a=t.call(this),h()(rt()(a),"action",(function(t){jt()((e=rt()(a),st()(n.prototype)),"action",e).call(e,t),t.setSelectedAction(rt()(a))})),h()(rt()(a),"getDrawPolygonContextAction",(function(e,t,n){var r=[];return r.push({icon:function(e){return o.a.createElement("i",Q()({className:"fas fa-trash"},e))},action:function(n){e.attachControl(t,!0),n.deleteNodeFromTreeUsingName("temp_polygon_region",!1),a.mouseCurve=[],n.closeContextDial()},name:"Clear Polygon [ESC | DEL | Backspace]"}),a.mouseCurve.length>2&&r.push({icon:function(e){return o.a.createElement("i",Q()({className:"fas fa-check"},e))},action:function(r){e.attachControl(t,!0),r.deleteNodeFromTreeUsingName("temp_polygon_region",!1);var o="PolygonRegion".concat(Math.floor(1e3*Math.random()));a.createPolygonRegion(a.mouseCurve,o,n,r,!0),a.mouseCurve=[],r.setPropertiesWithName(o),r.closeContextDial()},name:"Create Polygon [Enter]"}),r})),h()(rt()(a),"onPointerDown",(function(e,t){t.getSceneMemory().forEach((function(e){var n=e.scene,r=e.ground,o=e.camera;ln.getGroundPosition(n,r).forEach((function(r){o.detachControl(e.canvas),a.mouseCurve.push(r);var i=1===a.mouseCurve.length?[a.mouseCurve[0],a.mouseCurve[0]]:a.mouseCurve;a.createPolygonRegion(i,"temp_polygon_region",n,t,!1),t.setContextActions(a.getDrawPolygonContextAction(o,e.canvas,n))}))}))})),h()(rt()(a),"onPointerMove",(function(e,t){})),h()(rt()(a),"onPointerUp",(function(e){})),h()(rt()(a),"onKeyDown",(function(e,t){t.getSceneMemory().forEach((function(o){var c=o.scene,u=o.camera,s=a.getDrawPolygonContextAction(u,o.canvas,c),l={Enter:function(){return s[1].action(t)},Delete:function(){return s[0].action(t)},Backspace:function(){return s[0].action(t)},Escape:function(){0===a.mouseCurve.length&&jt()((r=rt()(a),st()(n.prototype)),"onKeyDown",r).call(r,e,t),s[0].action(t)}};e.code in l?l[e.code]():jt()((i=rt()(a),st()(n.prototype)),"onKeyDown",i).call(i,e,t)}))})),h()(rt()(a),"createPolygonRegion",(function(e,t,n,r){var o=!(arguments.length>4&&void 0!==arguments[4])||arguments[4],i=arguments.length>5&&void 0!==arguments[5]?arguments[5]:wt.Color3.Yellow(),a=arguments.length>6&&void 0!==arguments[6]?arguments[6]:1,c=r.getRootNode().item.mesh,u=e.map((function(e){return ln.computeLocalCoordinatesFromMesh({parent:c},Ft.ofBabylon(e))})),s=ln.pointAverageVec3(u),l=u.map((function(e){return e.sub(s)})),f=Lr.ofDict(n,{name:t,position:s.toArray(),color:[i.r,i.g,i.b],localPolygon:l.map((function(e){return e.toArray()})),height:a},r);f.mesh.parent=c,r.addNodeItem2Tree(f,c.name,o)})),a.key="drawPolygonRegion",a.name="Draw Polygon Region [R]",a.mouseCurve=[],a.icon=function(e){return o.a.createElement("i",Q()({className:"fas fa-draw-polygon"},e))},Ur=rt()(a),a)}return tt()(n,null,[{key:"getInstance",value:function(){return new n}}]),n}(Tn);function Gr(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=st()(e);if(t){var o=st()(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return ct()(this,n)}}var Kr=function(e){it()(n,e);var t=Gr(n);function n(){var e,r;return $e()(this,n),Wr?ct()(r,Wr):(r=t.call(this),h()(rt()(r),"action",(function(t){jt()((e=rt()(r),st()(n.prototype)),"action",e).call(e,t),t.setSelectedAction(rt()(r))})),h()(rt()(r),"onPointerDown",(function(e,t){})),h()(rt()(r),"onPointerMove",(function(e,t){})),h()(rt()(r),"onPointerUp",(function(e){})),r.key="orbit",r.name="Orbit [ESC]",r.maybeSelectedMesh=At.Maybe.none(),r.icon=function(e){return o.a.createElement("i",Q()({className:"fas fa-globe"},e))},Wr=rt()(r),r)}return tt()(n,null,[{key:"getInstance",value:function(){return new n}}]),n}(Tn),Wr=null,Yr=Kr,Qr=n(61),Zr=n(28),Hr=n.n(Zr),Xr=n(14),Jr=n.n(Xr),$r=new WeakMap,eo=new WeakMap,to=new WeakMap,no=function(){function e(){$e()(this,e),$r.set(this,{writable:!0,value:{}}),eo.set(this,{writable:!0,value:{}}),to.set(this,{writable:!0,value:{}})}return tt()(e,[{key:"addVertex",value:function(e){e in Jr()(this,eo)||(Jr()(this,eo)[e]={},Jr()(this,$r)[e]={})}},{key:"delVertex",value:function(t){var n=this;t in Jr()(this,eo)&&(delete Jr()(this,eo)[t],Object.keys(Jr()(this,$r)[t]).forEach((function(r){delete Jr()(n,to)[e.edgeKey(t,r)],delete Jr()(n,to)[e.edgeKey(r,t)]})),delete Jr()(this,$r)[t],Object.keys(Jr()(this,$r)).forEach((function(e){t in Jr()(n,$r)[e]&&delete Jr()(n,$r)[e][t]})))}},{key:"addEdge",value:function(t,n){return this.addVertex(t),this.addVertex(n),Jr()(this,to)[e.edgeKey(t,n)]={},Jr()(this,to)[e.edgeKey(n,t)]={},Jr()(this,$r)[t][n]=!0,Jr()(this,$r)[n][t]=!0,this}},{key:"delEdge",value:function(t,n){var r=e.edgeKey(t,n),o=e.edgeKey(n,t);(r in Jr()(this,to)||o in Jr()(this,to))&&(delete Jr()(this,to)[r],delete Jr()(this,to)[o],delete Jr()(this,$r)[t][n],delete Jr()(this,$r)[n][t])}},{key:"hasEdge",value:function(e,t){return this.getEdgeProp(e,t).isSome()}},{key:"getNeighbors",value:function(e){return e in Jr()(this,$r)?Object.keys(Jr()(this,$r)[e]):[]}},{key:"getEdgeProp",value:function(t,n){var r=e.edgeKey(t,n);return r in Jr()(this,to)?At.Maybe.some(Jr()(this,to)[r]):At.Maybe.none()}},{key:"setEdgeProp",value:function(t,n,r){var o=e.edgeKey(t,n);return o in Jr()(this,to)&&(Jr()(this,to)[o]=r),this}},{key:"getVertexProp",value:function(e){return e in Jr()(this,eo)?At.Maybe.some(Jr()(this,eo)[e]):At.Maybe.none()}},{key:"setVertexProp",value:function(e,t){return e in Jr()(this,eo)&&(Jr()(this,eo)[e]=t),this}},{key:"getEdges",value:function(){return Jr()(this,to)}},{key:"getVertices",value:function(){return Jr()(this,eo)}},{key:"getAdjMap",value:function(){return Jr()(this,$r)}},{key:"setAdjacentMap",value:function(e){Hr()(this,$r,e)}},{key:"setVertices",value:function(e){Hr()(this,eo,e)}},{key:"setEdges",value:function(e){Hr()(this,to,e)}}]),e}();h()(no,"edgeKey",(function(e,t){return"".concat(e,"_").concat(t)})),h()(no,"key2Edge",(function(e){return e.split("_")}));var ro=no,oo=n(32),io=n.n(oo);function ao(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=st()(e);if(t){var o=st()(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return ct()(this,n)}}function co(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function uo(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?co(Object(n),!0).forEach((function(t){h()(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):co(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var so=function(){function e(){var t=this;$e()(this,e),h()(this,"getVertexByIndex",(function(n){return t.graph.getVertexProp(n).flatMap((function(t){return At.Maybe.fromNull(t[e.NAMESPACES.vertex])}))})),this.graph=new ro,this.rTreeVertices=new fo,this.rTreeEdges=new po,this.vertexGenerator=0}return tt()(e,[{key:"getAbstractGraph",value:function(){return this.graph}},{key:"getAdjMap",value:function(){return this.graph.getAdjMap()}},{key:"addVertex",value:function(t,n){var r=this,o=arguments.length>2&&void 0!==arguments[2]&&arguments[2],i=this.getVertex(t);i.orElseRun((function(){var i=new lo(t,n||r.vertexGenerator++,o);r.rTreeVertices.insert(i),r.graph.addVertex(i.id),r.graph.setVertexProp(i.id,h()({},e.NAMESPACES.vertex,i))}))}},{key:"delVertex",value:function(e){var t=this;this.getVertex(e).forEach((function(e){var n=e.id;t.rTreeVertices.remove(e),t.graph.delVertex(n)}))}},{key:"addEdge",value:function(t){var n=this,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[],o=C()(t,2),i=o[0],a=o[1],c=C()(r,2),u=c[0],s=c[1];return this.addVertex(i,u),this.addVertex(a,s),this.getVertex(i).forEach((function(t){return n.getVertex(a).forEach((function(r){var o=n.getEdgeByIndex(t.id,r.id).orLazy((function(){return new ho(t,r)})),i=n.getEdgeByIndex(r.id,t.id).orLazy((function(){return new ho(r,t)}));n.rTreeEdges.remove(o,(function(e,t){return e.equals(t)})),n.rTreeEdges.insert(o),n.graph.addEdge(t.id,r.id),n.graph.setEdgeProp(t.id,r.id,h()({},e.NAMESPACES.edge,o)),n.graph.setEdgeProp(r.id,t.id,h()({},e.NAMESPACES.edge,i))}))})),this}},{key:"delEdge",value:function(e,t){var n=this;this.getEdge(e,t).forEach((function(e){var t,r=e.edge.map((function(e){return e.id}));(t=n.graph).delEdge.apply(t,kt()(r)),n.rTreeEdges.remove(e,(function(e,t){return e.equals(t)}))}))}},{key:"hasEdge",value:function(e,t){var n=this;return this.getVertex(e).flatMap((function(e){return n.getVertex(t).map((function(t){return n.graph.hasEdge(e.id,t.id)}))})).orSome(!1)}},{key:"getVertex",value:function(e){var t=this.rTreeVertices.search(lo.of(e).toBBox());return t.length>0?At.Maybe.some(t.length>1?this.getMinDistanceVertex(t,e):t[0]):At.Maybe.none()}},{key:"getNeighbors",value:function(t){var n=this,r=[];return this.getVertex(t).forEach((function(t){n.graph.getNeighbors(t.id).forEach((function(t){n.graph.getVertexProp(t).forEach((function(t){r.push(t[e.NAMESPACES.vertex])}))}))})),r}},{key:"updateVertex",value:function(t,n){var r=this;this.graph.getVertexProp(t).forEach((function(o){var i=o[e.NAMESPACES.vertex];i.position=n,r.rTreeVertices.remove(i),r.rTreeVertices.insert(i),r.graph.getNeighbors(t).forEach((function(n){r.graph.getEdgeProp(t,n).forEach((function(t){var n=t[e.NAMESPACES.edge];r.rTreeEdges.remove(n,(function(e,t){return e.equals(t)})),r.rTreeEdges.insert(n)}))}))}))}},{key:"getEdge",value:function(e,t){var n=t?e.add(t).scale(.5):e,r=this.rTreeEdges.search(lo.of(n).toBBox());return r.length>0?At.Maybe.some(r.length>1?this.getMinDistanceEdge(r,n):r[0]):At.Maybe.none()}},{key:"getEdgeByIndex",value:function(t,n){return this.graph.getEdgeProp(t,n).map((function(t){return t[e.NAMESPACES.edge]}))}},{key:"getMinDistanceEdge",value:function(e,t){var n=Number.MAX_VALUE,r=-1;return e.forEach((function(e,o){var i=e.edge.map((function(e){return e.position})).map(Ft.ofBabylon),a=i[1].sub(i[0]),c=Ft.ofBabylon(t).sub(i[0]),u=a.dot(c)/a.dot(a),s=c.sub(a.scale(u)).length();n>s&&(n=s,r=o)})),e[r]}},{key:"getMinDistanceVertex",value:function(e,t){var n=Number.MAX_VALUE,r=-1;return e.forEach((function(e,o){var i=Ft.ofBabylon(e.position),a=Ft.ofBabylon(t),c=i.sub(a).length();n>c&&(n=c,r=o)})),e[r]}},{key:"getVertices",value:function(){return this.graph.getVertices()}},{key:"getEdges",value:function(){return this.graph.getEdges()}},{key:"importData",value:function(t){var n=this,r=t.adjMap,o=uo({},t.vertices),i=uo({},t.edges);Object.keys(r).forEach((function(t){Object.keys(r[t]).forEach((function(r){var a=o[t],c=o[r],u=i[ro.edgeKey(t,r)];n.graph.getVertexProp(t).forEach((function(t){t[e.NAMESPACES.vertex].keyValueMap=a.keyValueMap})),n.graph.getVertexProp(r).forEach((function(t){t[e.NAMESPACES.vertex].keyValueMap=c.keyValueMap})),n.graph.getEdgeProp(t,r).forEach((function(t){var n=t[e.NAMESPACES.edge];n.keyValueMap=u.keyValueMap,n.weight=u.weight}))}))})),this.vertexGenerator=t.vertexGenerator}}]),e}();h()(so,"NAMESPACES",{vertex:"rVertex",edge:"rEdge"});var lo=function(){function e(t,n,r){var o=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{};$e()(this,e),this.position=t,this.id=n,this.keyValueMap=o,this.isCurve=r}return tt()(e,[{key:"toBBox",value:function(){var e=this.position;return{minX:e.x-Kn.RADIUS/4,minY:e.y-Kn.RADIUS/4,maxX:e.x+Kn.RADIUS/4,maxY:e.y+Kn.RADIUS/4}}}],[{key:"of",value:function(t){return new e(t)}}]),e}(),fo=function(e){it()(n,e);var t=ao(n);function n(){return $e()(this,n),t.apply(this,arguments)}return tt()(n,[{key:"toBBox",value:function(e){return e.toBBox()}},{key:"compareMinX",value:function(e,t){return e.position.x-t.position.x}},{key:"compareMinY",value:function(e,t){return e.position.y-t.position.y}}]),n}(io.a),ho=function(){function e(t,n){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};$e()(this,e),this.edge=[t,n],this.keyValueMap=r,this.weight=1}return tt()(e,[{key:"equals",value:function(t){if(!(t instanceof e))return!1;var n=t.edge.map((function(e){return e.id}));return this.edge.map((function(e){return e.id})).map((function(e){return n.includes(e)})).every((function(e){return e}))}},{key:"toBBox",value:function(){var e=this.edge;return{minX:e.reduce((function(e,t){return Math.min(e,t.position.x-Kn.RADIUS/4)}),Number.MAX_VALUE),minY:e.reduce((function(e,t){return Math.min(e,t.position.y-Kn.RADIUS/4)}),Number.MAX_VALUE),maxX:e.reduce((function(e,t){return Math.max(e,t.position.x+Kn.RADIUS/4)}),Number.MIN_VALUE),maxY:e.reduce((function(e,t){return Math.max(e,t.position.y+Kn.RADIUS/4)}),Number.MIN_VALUE)}}}],[{key:"of",value:function(t,n){return new e(lo.of(t),lo.of(n))}}]),e}(),po=function(e){it()(n,e);var t=ao(n);function n(){return $e()(this,n),t.apply(this,arguments)}return tt()(n,[{key:"toBBox",value:function(e){return e.toBBox()}},{key:"compareMinX",value:function(e,t){return e.toBBox().minX-t.toBBox().minX}},{key:"compareMinY",value:function(e,t){return e.toBBox().minY-t.toBBox().minY}}]),n}(io.a),mo=n(25),vo=n.n(mo);function yo(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function go(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?yo(Object(n),!0).forEach((function(t){h()(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):yo(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function bo(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=st()(e);if(t){var o=st()(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return ct()(this,n)}}var Mo=function(e){it()(n,e);var t=bo(n);function n(e,r){var i,a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:n.NAME,c=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{};$e()(this,n);var u=e.getUniqueId();if(u in xo&&!xo[u].mesh.isDisposed())return ct()(i,xo[u]);var s=Eo(e,a);return s.onClick=function(){return i.graphFormMapper=i.getDefaultFormMapper()},i=t.call(this,s,c),h()(rt()(i),"getType",(function(){return n.TYPE})),h()(rt()(i),"createVertexMesh",(function(e){var t=e.isCurve,r=n.getVertexMesh(i.scene,e.position,t?wt.Color3.Blue():wt.Color3.Gray(),t?2*Kn.RADIUS/3:Kn.RADIUS);r.parent=i.mesh,r.vertexId=e.id,i.addObserver2VertexMesh(r),i.addOnClickVertex(r),i.meshByVertexId[e.id]=r})),h()(rt()(i),"getVertexObs",(function(){return function(e){var t=e.updatedPointMesh,n=e.is2updateServer,r=t.position,o=t.vertexId;i.updateVertexPosition(o,r,n),i.updateCurvedNeighbors([o],n),n&&(i.graphFormMapper=i.getToFormVertex(t),i.mainView.setProperties(i.toForm()))}})),h()(rt()(i),"getEdgeObs",(function(){return function(e){var t=e.updatedPointMesh,n=e.is2updateServer,r=e.displacement,o=t.edgeIndexes,a=o.map((function(e){return i.meshByVertexId[e].position})).map(Ft.ofBabylon),c=Ft.ofBabylon(r);a.forEach((function(e,t){return i.updateVertexPosition(o[t],e.add(c).toBabylon(),n,o)})),i.updateCurvedNeighbors(o,n),n&&(i.graphFormMapper=i.getToFormEdge(t),i.mainView.setProperties(i.toForm()))}})),h()(rt()(i),"getOnClickEdge",(function(e){return function(){var t=[];t.push({icon:function(e){return o.a.createElement("i",Q()({className:"fas fa-trash"},e))},action:function(){i.mainView.getUndoManager().doIt(i.getUndoDeleteEdge(e))},name:"Delete Edge [Del]"}),i.mainView.setContextActions(t)}})),xo[u]=rt()(i),i.graph=new so,i.scene=e,i.mainView=r,i.meshByEdgeId={},i.meshByVertexId={},i.graphFormMapper=i.getDefaultFormMapper(),i}return tt()(n,[{key:"toDict",value:function(){var e=this,t=jt()(st()(n.prototype),"toDict",this).call(this),r=this.graph.getAdjMap(),o=go({},this.graph.getVertices()),i=go({},this.graph.getEdges());return Object.keys(o).forEach((function(t){e.graph.getVertexByIndex(t).forEach((function(e){var n=e.position,r=e.id,i=e.keyValueMap;o[t]={position:Ft.ofBabylon(n).toArray(),id:r,keyValueMap:i}}))})),Object.keys(i).forEach((function(t){var n,r=ro.key2Edge(t);(n=e.graph).getEdgeByIndex.apply(n,kt()(r)).forEach((function(e){var n=e.edge,o=e.keyValueMap,a=e.weight;i[t]={ids:r,positions:n.map((function(e){var t=e.position;return Ft.ofBabylon(t).toArray()})),keyValueMap:o,weight:a,isCurve:n.map((function(e){return e.isCurve}))}}))})),t.adjMap=r,t.vertices=o,t.edges=i,t.vertexGenerator=this.graph.vertexGenerator,t}},{key:"toForm",value:function(){var e=jt()(st()(n.prototype),"toForm",this).call(this);return delete e.jsonSchema.properties.position,delete e.jsonSchema.properties.quaternion,delete e.jsonSchema.properties.color,delete e.uiSchema.position,delete e.uiSchema.quaternion,delete e.uiSchema.color,delete e.data.position,delete e.data.quaternion,delete e.data.color,this.graphFormMapper.toForm(e)}},{key:"ofForm",value:function(e){this.name=e.name,this.mesh.name=e.name,this.graphFormMapper.ofForm(e)}},{key:"getDefaultFormMapper",value:function(){var e=this;return{toForm:function(e){return e},ofForm:function(t){return e.keyValueMap=go({},t.annotations)}}}},{key:"getToFormVertex",value:function(e){var t=this;return{toForm:function(n){return t.graph.getVertex(e.position).map((function(t){return n.jsonSchema.properties.positionVertex={type:"object",title:"Position Vertex ".concat(t.id),properties:{x:{type:"number",title:"x"},y:{type:"number",title:"y"},z:{type:"number",title:"z"}}},n.uiSchema.positionVertex={"ui:widget":"collapse"},n.data.positionVertex={x:e.position.x,y:e.position.y,z:e.position.z},Qt.setAnnotations2Form(n,t.keyValueMap),n.jsonSchema.properties.annotations.title="Annotations Vertex ".concat(t.id),n})).orSome(n)},ofForm:function(n){var r=vo.a.get(n,"positionVertex",e.position);r=[r.x,r.y,r.z].map(Number.parseFloat),t.graph.getVertex(e.position).forEach((function(e){return e.keyValueMap=go({},vo.a.get(n,"annotations",{}))})),t.updateVertexPosition(e.vertexId,wt.Vector3.FromArray(r),!1)}}}},{key:"getToFormEdge",value:function(e){var t=this;return{toForm:function(n){var r=e.edgeIndexes.map((function(e){return At.Maybe.fromNull(t.meshByVertexId[e]).map((function(e){return e.position}))})).filter((function(e){return e.isSome()})).map((function(e){return e.some()}));return console.log("FORM2EDGE",r),0===r.length?n:t.graph.getEdge(r[0],r[1]).map((function(t){n.jsonSchema.properties.positionEdge={type:"object",title:"Position Edge ".concat(e.edgeIndexes),properties:{x:{type:"number",title:"x"},y:{type:"number",title:"y"},z:{type:"number",title:"z"}}},n.jsonSchema.properties.weight={type:"number",title:"Weight"},n.uiSchema.positionEdge={"ui:widget":"collapse"};var o=ln.pointAverage(r);return n.data.positionEdge={x:o.x,y:o.y,z:o.z},n.data.weight=t.weight,Qt.setAnnotations2Form(n,t.keyValueMap),n.jsonSchema.properties.annotations.title="Annotations Edge ".concat(e.edgeIndexes),n})).orSome(n)},ofForm:function(n){var r=e.edgeIndexes,o=r.map((function(e){return t.meshByVertexId[e].position})),i=ln.pointAverage(o),a=vo.a.get(n,"positionEdge",i);a=[a.x,a.y,a.z].map(Number.parseFloat),a=wt.Vector3.FromArray(a),o.forEach((function(e,n){return t.updateVertexPosition(r[n],e.add(a.subtract(i)),!1)}));var c=function(e){e.keyValueMap=go({},vo.a.get(n,"annotations",{})),e.weight=Number.parseFloat(n.weight)};t.graph.getEdgeByIndex(r[0],r[1]).forEach(c),t.graph.getEdgeByIndex(r[1],r[0]).forEach(c)}}}},{key:"addEdge",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[],n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:[!1,!1],r=C()(e,2),o=r[0],i=r[1],a=C()(t,2),c=a[0],u=a[1],s=C()(n,2),l=s[0],f=s[1];if(!this.hasEdge(o,i))return this.buildVertex(o,c,l),this.buildVertex(i,u,f),this.buildEdge(o,i),this}},{key:"addCurveEdge",value:function(e){for(var t=n.getCurveEdgePoints(e,.75),r=0;r<t.length-1;r++){var o=[t[r],t[r+1]];this.addEdge(o,[],[0!==r,r!==t.length-2])}return this}},{key:"delEdge",value:function(e,t){var n=this;this.graph.getEdge(e,t).forEach((function(e){var t,r=e.edge,o=r.map((function(e){return e.id})),i=ro.edgeKey(o[0],o[1]),a=ro.edgeKey(o[1],o[0]);At.Maybe.fromNull(n.meshByEdgeId[i]).forEach((function(e){return e.dispose()})),delete n.meshByEdgeId[i],delete n.meshByEdgeId[a],(t=n.graph).delEdge.apply(t,kt()(r.map((function(e){return e.position}))));var c=n.graph.getAbstractGraph();r.forEach((function(e){var t=e.id,r=e.position;0===c.getNeighbors(t).length&&n.delVertex(r)}))}))}},{key:"delCurveEdge",value:function(e){for(var t=n.getCurveEdgePoints(e,.75),r=0;r<t.length-1;r++){var o=[t[r],t[r+1]],i=o[0],a=o[1];this.delEdge(i,a)}return this}},{key:"hasEdge",value:function(e,t){return this.graph.hasEdge(e,t)}},{key:"buildVertex",value:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]&&arguments[2];this.doesVertexCollideWithEdge(e)&&this.resolveVertexEdgeCollision(e),this.buildSimpleVertex(e,t,n)}},{key:"buildSimpleVertex",value:function(e,t){var n=this,r=arguments.length>2&&void 0!==arguments[2]&&arguments[2],o=this.graph.getVertex(e);o.forEach((function(e){var t=e.isCurve,r=e.id;t&&(n.graph.getAbstractGraph().getNeighbors(r).length>=2&&(e.isCurve=!1,n.meshByVertexId[e.id].dispose(),n.createVertexMesh(e)))})),o.orElseRun((function(){n.graph.addVertex(e,t,r),n.graph.getVertex(e).forEach(n.createVertexMesh)}))}},{key:"addObserver2VertexMesh",value:function(e){e.observers=new wt.Observable,e.observers.add(this.getVertexObs())}},{key:"updateCurvedNeighbors",value:function(e,t){var n=this;this.getCurvedNeighbors(e).map((function(e){var t=e.id,r=e.position;return{id:t,position:n.heatFlow(t,r)}})).forEach((function(e){var r=e.id,o=e.position;return n.updateVertexPosition(r,o,t)}))}},{key:"getCurvedNeighbors",value:function(e){var t=[],n={};e.forEach((function(e){return n[e]=!0}));for(var r=this.graph.getAbstractGraph(),o=e.map((function(e){return r.getNeighbors(e)})).flatMap((function(e){return e})).filter((function(e){return!(e in n)}));o.length>0;){var i=o.pop();n[i]=!0,this.graph.getVertexByIndex(i).forEach((function(e){var i=e.isCurve,a=e.id;i&&(t.push(e),o.push.apply(o,kt()(r.getNeighbors(a).filter((function(e){return!(e in n)})))))}))}return t}},{key:"heatFlow",value:function(e,t){var n=this.graph.getAbstractGraph().getNeighbors(e).map(this.graph.getVertexByIndex).filter((function(e){return e.isSome()})).map((function(e){return e.some()})).map((function(e){return e.position})),r=t,o=r.scale(n.length).subtract(n.reduce((function(e,t){return e.add(t)}),wt.Vector3.Zero()));return r.add(o.scale(-.1))}},{key:"addOnClickVertex",value:function(e){var t=this;e.onClick=function(){var n=[];n.push({icon:function(e){return o.a.createElement("i",Q()({className:"fas fa-trash"},e))},action:function(){t.mainView.getUndoManager().doIt(t.getUndoDeleteVertex(e))},name:"Delete Node [Del]"}),t.mainView.setContextActions(n)}}},{key:"getUndoDeleteVertex",value:function(e){var t=this,n=e.position,r=e.vertexId,o=this.graph.getVertexByIndex(r).some(),i=o.isCurve,a=this.graph.getNeighbors(o.position),c=a.filter((function(e){return!e.isCurve})),u=a.filter((function(e){return e.isCurve})).map((function(e){return t.graph.getCurvedPathFromVertex(e.position)}));return _t.UndoManager.actionBuilder().doAction((function(){i||c.forEach((function(e){t.delEdge(n,e.position)})),u.forEach((function(e){for(var n=0;n<e.length-1;n++)t.delEdge(e[n].position,e[n+1].position)})),t.mainView.closeContextDial(),t.mainView.updateNodeInServer(t.name)})).undoAction((function(){i||c.forEach((function(e){t.addEdge([n,e.position],[r,e.id])})),u.forEach((function(e){for(var n=0;n<e.length-1;n++){var r=[e[n],e[n+1]],o=r.map((function(e){return e.id})),i=r.map((function(e){return e.position})),a=r.map((function(e){return e.isCurve}));t.addEdge(i,o,a)}})),t.mainView.updateNodeInServer(t.name)})).build()}},{key:"highlightCurveEdge",value:function(e){var t=this,n=this.getCurvedNeighbors([e]).map((function(e){var n=e.id;return t.meshByVertexId[n]}));this.mainView.highlightMeshesInScene(n)}},{key:"delVertex",value:function(e){var t=this;this.graph.getVertex(e).forEach((function(n){var r=n.id,o=t.graph.getNeighbors(e);o.forEach((function(n){var r=n.position;return t.delEdge(e,r)})),At.Maybe.fromNull(t.meshByVertexId[r]).forEach((function(e){return e.dispose()})),delete t.meshByVertexId[r],t.graph.delVertex(e),o.filter((function(e){return e.isCurve})).forEach((function(e){var n=e.position;return t.delVertex(n)}))}))}},{key:"updateVertexPosition",value:function(e,t){var n=this,r=!(arguments.length>2&&void 0!==arguments[2])||arguments[2],o=arguments.length>3&&void 0!==arguments[3]?arguments[3]:[];this.meshByVertexId[e].position=t,this.graph.updateVertex(e,t),this.graph.getNeighbors(t).forEach((function(i){var a=e,c=i.id;n.isEdgeInPair(a,c,o)||(n.meshByEdgeId[ro.edgeKey(a,c)].dispose(),n.graph.getEdgeByIndex(a,c).forEach((function(e){n.buildEdge(t,i.position)}))),r&&n.mainView.updateNodeInServer(n.name)}))}},{key:"isEdgeInPair",value:function(e,t,n){return n.length>0&&n.includes(e)&&n.includes(t)}},{key:"doesVertexCollideWithEdge",value:function(e){var t=this,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:Kn.RADIUS/4;return this.graph.getVertex(e).cata((function(){return t.graph.getEdge(e).map((function(t){var r=t.edge.map((function(e){return e.position})).map(Ft.ofBabylon),o=r[1].sub(r[0]),i=Ft.ofBabylon(e).sub(r[0]),a=o.dot(i)/o.dot(o);return!(a<0||a>1)&&i.sub(o.scale(a)).length()<=n}))}),(function(e){return At.Maybe.none()})).orSome(!1)}},{key:"resolveVertexEdgeCollision",value:function(e){var t=this;this.graph.getEdge(e).forEach((function(n){var r=n.edge.map((function(e){return e.position})).map(Ft.ofBabylon),o=n.edge.map((function(e){return e.position})),i=r[1].sub(r[0]).normalize(),a=Ft.ofBabylon(e).sub(r[0]),c=i.scale(a.dot(i)),u=r[0].add(c).toBabylon();t.delEdge(o[0],o[1]),t.addEdge([o[0],u]),t.addEdge([u,o[1]]),t.importFeatures2Edge(n,o[0],u),t.importFeatures2Edge(n,u,o[1]),t.graph.getEdge(o[0],u).forEach((function(e){t.graph.getEdge(u,o[1]).forEach((function(r){t.mainView.getUndoManager().addIt(t.getUndoResolveVertexEdgeCollision(n,e,r))}))}))}))}},{key:"getUndoResolveVertexEdgeCollision",value:function(e,t,n){var r=this,o=e.edge.map((function(e){return e.position})),i=e.edge.map((function(e){return e.id})),a=t.edge.map((function(e){return e.position})),c=t.edge.map((function(e){return e.id})),u=n.edge.map((function(e){return e.position})),s=n.edge.map((function(e){return e.id}));return _t.UndoManager.actionBuilder().doAction((function(){r.delEdge.apply(r,kt()(o)),r.addEdge(a,c),r.addEdge(u,s),r.importFeatures2Edge.apply(r,[e].concat(kt()(a))),r.importFeatures2Edge.apply(r,[e].concat(kt()(u)))})).undoAction((function(){r.delEdge.apply(r,kt()(a)),r.delEdge.apply(r,kt()(u)),r.addEdge(o,i),r.importFeatures2Edge.apply(r,[e].concat(kt()(o)))})).build()}},{key:"importFeatures2Edge",value:function(e,t,n){var r=this;this.graph.getEdge(t,n).forEach((function(t){var n=t.edge.map((function(e){return e.id})),o=C()(n,2),i=o[0],a=o[1];r.graph.getEdgeByIndex(i,a).forEach((function(t){return t.importFeatures(e)})),r.graph.getEdgeByIndex(a,i).forEach((function(t){return t.importFeatures(e)}))}))}},{key:"buildEdge",value:function(e,t){var r=this,o=this.graph;o.addEdge([e,t]),o.getVertex(e).forEach((function(e){return o.getVertex(t).forEach((function(t){var o=n.getEdgeMesh(r.scene,[e.position,t.position]);o.parent=r.mesh;var i=e.id,a=t.id;o.edgeIndexes=[i,a],r.addObserver2EdgeMesh(o),r.addOnClickEdge(o),r.meshByEdgeId[ro.edgeKey(i,a)]=o,r.meshByEdgeId[ro.edgeKey(a,i)]=o}))}))}},{key:"addObserver2EdgeMesh",value:function(e){e.observers=new wt.Observable,e.observers.add(this.getEdgeObs())}},{key:"addOnClickEdge",value:function(e){e.onClick=this.getOnClickEdge(e)}},{key:"getUndoDeleteEdge",value:function(e){var t=this,n=e.edgeIndexes.map((function(e){return t.graph.getVertexByIndex(e)})).map((function(e){return e.some()}));return n.some((function(e){return e.isCurve}))?this.getUndoDelCurveEdge(n):this.getUndoDelLineEdge(n)}},{key:"getUndoDelCurveEdge",value:function(e){var t=this,n=e.filter((function(e){return e.isCurve}))[0].position,r=this.graph.getCurvedPathFromVertex(n);return _t.UndoManager.actionBuilder().doAction((function(){for(var e=0;e<r.length-1;e++)t.delEdge(r[e].position,r[e+1].position);t.mainView.closeContextDial(),t.mainView.updateNodeInServer(t.name)})).undoAction((function(){for(var e=0;e<r.length-1;e++){var n=[r[e],r[e+1]],o=n.map((function(e){return e.id})),i=n.map((function(e){return e.position})),a=n.map((function(e){return e.isCurve}));t.addEdge(i,o,a)}t.mainView.updateNodeInServer(t.name)})).build()}},{key:"getUndoDelLineEdge",value:function(e){var t=this,n=e.map((function(e){return e.id})),r=e.map((function(e){return e.position})),o=e.map((function(e){return e.isCurve}));return _t.UndoManager.actionBuilder().doAction((function(){t.delEdge.apply(t,kt()(r)),t.mainView.closeContextDial(),t.mainView.updateNodeInServer(t.name)})).undoAction((function(){t.addEdge(r,n,o),t.mainView.updateNodeInServer(t.name)})).build()}}],[{key:"ofDict",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null,o=new n(e,r,t.name,t.keyValueMap),i=t.adjMap,a=t.edges;return Object.keys(i).forEach((function(e){Object.keys(i[e]).forEach((function(t){if(e<t){var n=a[ro.edgeKey(e,t)],r=n.positions.map(Ft.of).map((function(e){return e.toBabylon()}));o.addEdge(r,[e,t],n.isCurve)}}))})),o.graph.importData(t),o}},{key:"getEdgeWithVertexMeshes",value:function(e,t){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:wt.Color3.Gray(),o=arguments.length>3&&void 0!==arguments[3]?arguments[3]:Kn.RADIUS,i=t.map((function(t){return n.getVertexMesh(e,t,r,o)}));return i.push(n.getEdgeMesh(e,t,r,o)),i}},{key:"getCurveEdgeWithVertexMeshes",value:function(e,t){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:wt.Color3.Gray(),o=arguments.length>3&&void 0!==arguments[3]?arguments[3]:Kn.RADIUS,i=[],a=t[0],c=t[2];return i.push(n.getVertexMesh(e,a,r,o)),i.push(n.getVertexMesh(e,c,r,o)),i.push(n.getCurveEdgeMesh(e,t,r,o)),i}},{key:"getVertexMesh",value:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:wt.Color3.Gray(),r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:Kn.RADIUS,o=ln.createSphere(e,n,r);return o.position=t,o}},{key:"getEdgeMesh",value:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:wt.Color3.Gray(),r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:Kn.RADIUS;return ln.createTubeFromPoints(e,t,n,r/4)}},{key:"getCurveEdgeMesh",value:function(e,t){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:wt.Color3.Gray(),o=arguments.length>3&&void 0!==arguments[3]?arguments[3]:Kn.RADIUS,i=arguments.length>4&&void 0!==arguments[4]?arguments[4]:.25;return ln.createTubeFromPoints(e,n.getCurveEdgePoints(t,i),r,o/4)}},{key:"getCurveEdgePoints",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:.25,n=C()(e,3),r=n[0],o=n[1],i=n[2],a=r.subtract(o.scale(2)).add(i),c=a.length(),u=c<.001?2:c/Math.max(1e-6,t);return u=Math.floor(u),wt.Curve3.CreateQuadraticBezier(r,o,i,u).getPoints()}}]),n}(Qt);h()(Mo,"TYPE","GraphItem"),h()(Mo,"NAME","Roads");var xo={},Eo=function(e,t){var n=ln.createSphere(e,wt.Color3.Gray(),Number.MIN_VALUE,t,!1);return n.position=wt.Vector3.Zero(),n.scaling=wt.Vector3.One(),n.rotationQuaternion=Qr.Quaternion.Identity(),n.visibility=0,n},ko=Mo;function wo(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=st()(e);if(t){var o=st()(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return ct()(this,n)}}var Po=function(e){it()(n,e);var t=wo(n);function n(){var e,r,i,a;return $e()(this,n),Co?ct()(a,Co):(a=t.call(this),h()(rt()(a),"action",(function(t){jt()((e=rt()(a),st()(n.prototype)),"action",e).call(e,t),t.setSelectedAction(rt()(a));var r=a.getContextActions();t.setContextActions(r),t.setContextActionIndex(r.findIndex((function(e){return e.mode===a.mode})))})),h()(rt()(a),"onPointerDown",(function(e,t){1===e.buttons&&a.mousePosConsumer(t)((function(e,n){var r;(r={},h()(r,So.line,a.onPointerDownLine),h()(r,So.curve,a.onPointerDownCurve),r)[a.mode](e,n,t)}))})),h()(rt()(a),"onPointerMove",(function(e,t){a.mousePosConsumer(t)((function(e,n){var r,o=n.scene,i=n.ground;(ln.pickMesh(o,i).cata((function(){return t.highlightMeshInScene()}),(function(e){return t.highlightMeshInScene([e],wt.Color3.Green())})),0!==a.mouseCurve.length)&&(r={},h()(r,So.line,a.onPointerMoveLine),h()(r,So.curve,a.onPointerMoveCurve),r)[a.mode](e,n,t)}))})),h()(rt()(a),"onPointerUp",(function(e){e.getGraph().forEach((function(t){return e.setPropertiesWithName(t.item.name)}))})),h()(rt()(a),"onKeyDown",(function(e,t){var o={Delete:function(){return a.escapeAction(e,t)},Backspace:function(){return a.escapeAction(e,t)},Escape:function(){return a.escapeAction(e,t)}};e.code in o?o[e.code]():jt()((r=rt()(a),st()(n.prototype)),"onKeyDown",r).call(r,e,t)})),h()(rt()(a),"escapeAction",(function(e,t){a.mouseCurve.length>0?(a.deletePreviewMeshes(),a.mouseCurve=[]):jt()((i=rt()(a),st()(n.prototype)),"onKeyDown",i).call(i,e,t)})),h()(rt()(a),"deletePreviewMeshes",(function(){a.previewMeshes.forEach((function(e){return e.dispose()})),a.previewMeshes=[]})),h()(rt()(a),"mousePosConsumer",(function(e){return function(t){e.getSceneMemory().forEach((function(e){var n=e.scene,r=e.ground;ln.getGroundPosition(n,r).forEach((function(n){return t(n,e)}))}))}})),h()(rt()(a),"createGraphItemIfNone",(function(e,t){return t.getGraph().orElseRun((function(){var n=new ko(e,t);n.mesh.parent=t.getRootNode().item.mesh,t.addNodeItem2Tree(n)}))})),h()(rt()(a),"onPointerDownLine",(function(e,t,n){var r=t.camera,o=t.canvas,i=t.scene;r.detachControl(o),0===a.mouseCurve.length?a.mouseCurve.push(e):(a.createEdge([a.mouseCurve[0],e],i,n,(function(e){return function(t){return e.addEdge(t)}})),a.mouseCurve=[],r.attachControl(o,!0))})),h()(rt()(a),"onPointerMoveLine",(function(e,t,n){var r=t.scene,o=n.getRootNode().item.mesh,i=Oo(n)([a.mouseCurve[0],e]);a.deletePreviewMeshes(),a.previewMeshes=ko.getEdgeWithVertexMeshes(r,i,wt.Color3.Blue(),Kn.RADIUS/2),a.previewMeshes.forEach((function(e){e.visibility=.25,e.parent=o}))})),h()(rt()(a),"onPointerDownCurve",(function(e,t,n){var r=t.camera,o=t.canvas,i=t.scene;r.detachControl(o),a.mouseCurve.length<=1?a.mouseCurve.push(e):(a.createEdge([a.mouseCurve[0],a.mouseCurve[1],e],i,n,(function(e){return function(t){return e.addCurveEdge(t)}})),a.mouseCurve=[],r.attachControl(o,!0))})),h()(rt()(a),"onPointerMoveCurve",(function(e,t,n){if(a.mouseCurve.length<2)a.onPointerMoveLine(e,t,n);else{var r=t.scene,o=n.getRootNode().item.mesh,i=Oo(n)([].concat(kt()(a.mouseCurve),[e]));a.deletePreviewMeshes(),a.previewMeshes=ko.getCurveEdgeWithVertexMeshes(r,i,wt.Color3.Green(),Kn.RADIUS/2).concat(ko.getEdgeWithVertexMeshes(r,[i[0],i[1]],wt.Color3.Blue(),Kn.RADIUS/2)).concat(ko.getEdgeWithVertexMeshes(r,[i[1],i[2]],wt.Color3.Blue(),Kn.RADIUS/2)),a.previewMeshes.forEach((function(e){e.visibility=.25,e.parent=o}))}})),h()(rt()(a),"createEdge",(function(e,t,n,r){var o=Oo(n)(e);a.createGraphItemIfNone(t,n),n.getGraph().forEach((function(e){var t=e.item;r(t)(o),n.updateNodeInServer(t.name)})),a.deletePreviewMeshes()})),a.key="drawGraph",a.name="Draw Graph [C]",a.icon=function(e){return o.a.createElement("i",Q()({className:"fas fa-project-diagram"},e))},a.mouseCurve=[],a.previewMeshes=[],a.mode=So.line,Co=rt()(a),a)}return tt()(n,[{key:"getContextActions",value:function(){var e=this;return[{icon:function(e){return o.a.createElement("i",Q()({className:"fas fa-grip-lines-vertical"},e))},action:function(t){t.setContextActionIndex(0),e.mode=So.line,e.mouseCurve=[],e.previewMeshes.forEach((function(e){return e.dispose()})),e.previewMeshes=[]},name:"Line Mode",mode:So.line},{icon:function(e){return o.a.createElement("i",Q()({className:"fas fa-bezier-curve"},e))},action:function(t){t.setContextActionIndex(1),e.mode=So.curve,e.mouseCurve=[],e.previewMeshes.forEach((function(e){return e.dispose()})),e.previewMeshes=[]},name:"Curve Mode",mode:So.curve}]}}],[{key:"getInstance",value:function(){return new n}}]),n}(Tn),Co=null,So={line:"line",curve:"curve",free:"free"},Oo=function(e){var t=e.getRootNode().item.mesh;return function(e){return e.map((function(e){return ln.computeLocalCoordinatesFromMesh({parent:t},Ft.ofBabylon(e)).toBabylon()}))}},No=Po,Ro={orbit:Yr.getInstance(),dragObjects:Bn.getInstance(),drawPath:Cr.getInstance(),drawBoxRegion:ar.getInstance(),addKeyPoint:Gn.getInstance(),drawRegion:qr.getInstance(),drawGraph:No.getInstance()},Do=function(){function e(t){$e()(this,e),this.yamlSrc=t,this.cachedMap=null}var t,n;return tt()(e,[{key:"load",value:(n=bn()(yn.a.mark((function t(){var n,r,o;return yn.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(!this.cachedMap){t.next=2;break}return t.abrupt("return",this.cachedMap);case 2:return t.next=4,fetch(e.getMapUrl(this.yamlSrc));case 4:return n=t.sent,t.t0=this,t.next=8,n.text();case 8:return t.t1=t.sent,t.next=11,t.t0.parseYaml.call(t.t0,t.t1);case 11:return r=t.sent,o={textureSrc:r.image,resolution:r.resolution,origin:r.origin,imageSize:r.size},this.cachedMap=o,t.abrupt("return",o);case 15:case"end":return t.stop()}}),t,this)}))),function(){return n.apply(this,arguments)})},{key:"parseYaml",value:(t=bn()(yn.a.mark((function t(n){var r,o;return yn.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return r={},o={image:function(t,n){return r[t]=e.getMapUrl(n)},resolution:function(e,t){return r[e]=Number.parseFloat(t)},origin:function(e,t){return r[e]=JSON.parse(t)}},console.log("Yaml text",n),n.split("\n").map((function(e){return e.split(": ")})).filter((function(e){return e.length>=2})).filter((function(e){return e[0]in o})).forEach((function(e){return o[e[0]](e[0],e[1])})),t.next=6,this.getImageSize(r.image);case 6:return r.size=t.sent,t.abrupt("return",r);case 8:case"end":return t.stop()}}),t,this)}))),function(e){return t.apply(this,arguments)})},{key:"getImageSize",value:function(e){return new Promise((function(t,n){var r=new Image;r.src=e,r.onload=function(){return t([r.naturalWidth,r.naturalHeight])}}))}}]),e}();function Ao(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=st()(e);if(t){var o=st()(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return ct()(this,n)}}h()(Do,"getMapUrl",(function(e){return"/static/maps/".concat(e)}));var To=function(e){it()(n,e);var t=Ao(n);function n(e,r){var i;return $e()(this,n),i=t.call(this),h()(rt()(i),"getType",(function(){return n.TYPE})),h()(rt()(i),"deleteAsset",(function(){})),h()(rt()(i),"download",bn()(yn.a.mark((function e(){var t,n,r;return yn.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,i.mapLoader.load();case 2:t=e.sent,n=t.textureSrc,r=i.mapLoader.yamlSrc,o.a.createElement("div",{style:{display:"flex",flexDirection:"column"}},o.a.createElement("div",{style:{display:"flex",flexDirection:"row"}},o.a.createElement("div",{style:{marginRight:"5px"}},"Image:"),o.a.createElement("a",{href:n,download:!0},n)),o.a.createElement("div",{style:{display:"flex",flexDirection:"row"}},o.a.createElement("div",{style:{marginRight:"5px"}},"Yaml:"),o.a.createElement("a",{href:Do.getMapUrl(r),download:!0},r)));case 6:case"end":return e.stop()}}),e)})))),i.name=e,i.key="addMap".concat(e),i.mapLoader=r,i.icon=function(e){return o.a.createElement("i",Q()({},e,{className:"fas fa-map"}))},i}return tt()(n,[{key:"addMap",value:function(e){var t=this,n=At.Maybe.fromNull(e.getRootNode());e.getSceneMemory().forEach(function(){var r=bn()(yn.a.mark((function r(o){var i,a,c,u,s,l,f,h,d,p,m,v,y;return yn.a.wrap((function(r){for(;;)switch(r.prev=r.next){case 0:return i=o.scene,a=o.camera,r.next=4,t.mapLoader.load();case 4:c=r.sent,u=c.textureSrc,s=c.resolution,l=c.origin,f=c.imageSize,h=s*f[0],d=s*f[1],p=ln.groundBuilder(i).name(At.Maybe.fromNull(t.memory.name).orSome(t.name)).width(h).height(d).textureSrc(u).build(),m=Ft.of([-h/2,-d/2,0]).sub(Ft.of(l)),n.forEach((function(e){var t=e.item.mesh.parent;t.position=mn.inverseCoordinates(m.toBabylon()),a.setTarget(new wt.Vector3(t.position.x,t.position.y,t.position.z))})),v=new Cn(p,[h,d],t.textureSrc,At.Maybe.fromNull(t.memory.assetName).orSome(t.name)),y=At.Maybe.fromNull(t.memory.isImport).map((function(e){return!e})).orSome(!0),e.addNodeItem2Tree(v,null,y),o.ground.dispose(),o.ground=Nn.createMeshGround(i,h,d);case 19:case"end":return r.stop()}}),r)})));return function(e){return r.apply(this,arguments)}}())}},{key:"action",value:function(e){var t=this;jt()(st()(n.prototype),"action",this).call(this,e);var r=e.getNodeFromTree(this.name);r.forEach((function(e){})),r.orElseRun((function(){if(e.getObjectTree().length<2)return t.addMap(e)})),e.setSelectedAction(Ro.orbit)}}]),n}(Mn);h()(To,"TYPE","AddMapAction");var jo=To;function Vo(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=st()(e);if(t){var o=st()(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return ct()(this,n)}}var Io=function(e){it()(n,e);var t=Vo(n);function n(e,r){var o,i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};return $e()(this,n),o=t.call(this,e.mesh,r,i),h()(rt()(o),"updateRobot",(function(e,t,n){var r=(new Date).getTime();n(e,.001*(r-t)),o.requestAnimationFrameId=requestAnimationFrame((function(){return o.updateRobot(e,r,n)}))})),h()(rt()(o),"animate",(function(e){o.requestAnimationFrameId=requestAnimationFrame((function(){return o.updateRobot(rt()(o),(new Date).getTime(),e)}))})),h()(rt()(o),"getType",(function(){return n.TYPE})),o.requestAnimationFrameId=null,o.meshTree=e,o}return tt()(n,[{key:"toDict",value:function(){return jt()(st()(n.prototype),"toDict",this).call(this)}},{key:"toForm",value:function(){var e=jt()(st()(n.prototype),"toForm",this).call(this);return e.jsonSchema.properties={oldName:e.jsonSchema.properties.oldName,name:e.jsonSchema.properties.name,type:e.jsonSchema.properties.type,assetName:{type:"string",title:"Asset Name"},position:e.jsonSchema.properties.position,quaternion:e.jsonSchema.properties.quaternion,color:e.jsonSchema.properties.color,annotations:e.jsonSchema.properties.annotations},e.uiSchema.assetName={"ui:disabled":!0},e.data.assetName=this.assetName,e}},{key:"dispose",value:function(){jt()(st()(n.prototype),"dispose",this).call(this),_t.MasterDB.unsubscribe({Scope:"Robot",Name:this.meshTree.id,Parameter:"tf"}),window.cancelAnimationFrame(this.requestAnimationFrameId)}}],[{key:"updateRobotMeshTree",value:function(e,t){t.mesh.position=new wt.Vector3(e.position.x,e.position.y,e.position.z);var n=new wt.Quaternion(e.orientation.x,e.orientation.y,e.orientation.z,e.orientation.w);t.mesh.rotationQuaternion=n.normalize()}},{key:"transformMesh",value:function(e,t){var n=Math.PI/2,r=e.getBoundingInfo().boundingSphere;e.position.set(-r.center.x,-r.center.y,-r.center.z);var o=ln.createSphere(t,new wt.Color3(0,0,0),.5*r.radius,"tfsphere".concat(e.name),!1);o.visibility=.25,o.scaling=Ft.ONES.scale(1/r.radius).toBabylon(),o.addRotation(n,0,0),o.position.set(0,0,.25);var i=ln.createSphere(t,new wt.Color3(0,0,0),1.9,e.name,!0);return i.visibility=.1,e.parent=o,o.parent=i,i}},{key:"createRobotMeshTreeRecursive",value:function(e,t,n,r){var o=this;t||(t=ln.createSphere(r,new wt.Color3(0,0,0),.5,e.name,!1));var i={mesh:t,children:[]},a=new wt.Vector3(e.position.x,e.position.y,e.position.z),c=new wt.Quaternion(e.orientation.x,e.orientation.y,e.orientation.z,e.orientation.w);return t.position=a,t.rotationQuaternion=c,n&&(t.parent=n),i.children=e.child.map((function(e){o.createRobotMeshTreeRecursive(e,ln.referentialBuilder(r).boxParams({isVisible:!1,size:.1}).build(),t,r)})),i}},{key:"createRobotMeshTree",value:function(e,t,r){return n.createRobotMeshTreeRecursive(e,t,null,r)}},{key:"builder",value:function(){return new Bo}}]),n}(En);h()(Io,"ROBOT_MESH_NAME","Tugbot.stl"),h()(Io,"TYPE","Robot"),h()(Io,"getDefaultAnimator",(function(e){return function(t,n){var r=t.mesh,o=ln.getRotationMatrix(r).prodVec(new Ft([3,0,0])).toBabylon();r.position=r.position.add(o.scale(n)),r.rotate(wt.Axis.Z,-Math.PI/2*n,wt.Space.LOCAL),Math.random()<.01&&e.updateNodeInServer(r.name)}})),h()(Io,"getSocketAnimator",(function(e,t){return _t.MasterDB.subscribe({Scope:"Robot",Name:e.meshTree.id,Parameter:"tf"},(function(n){var r=n.key.Robot[e.meshTree.id].Parameter.tf.Value;r&&(console.log("ROBOT TF UPDATE...",r),Io.updateRobotMeshTree(r,e),console.log("Updating robot ",e),Math.random()<.01&&t.updateNodeInServer(e.name))}),(function(n){console.log("ROBOT INIT SUB...",n.value);var r=n.value.Robot[e.meshTree.id].Parameter.tf.Value;Io.updateRobotMeshTree(r,e),console.log("Updating robot ",e),t.updateNodeInServer(e.name)})),function(e,t){}}));var Bo=function(){function e(){$e()(this,e),this._name=null,this._meshTree=null,this._parentMesh=null,this._scene=null,this._isPickable=!0,this._id=null,this._keyValueMap={},this._assetName=null}return tt()(e,[{key:"name",value:function(e){return this._name=e,this}},{key:"meshTree",value:function(e){return this._meshTree=e,this}},{key:"parentMesh",value:function(e){return this._parentMesh=e,this}},{key:"scene",value:function(e){return this._scene=e,this}},{key:"isPickable",value:function(e){return this._isPickable=e,this}},{key:"id",value:function(e){return this._id=e,this}},{key:"keyValueMap",value:function(e){return this._keyValueMap=e,this}},{key:"assetName",value:function(e){return this._assetName=e,this}},{key:"build",value:function(){var e=this;return Object.keys(this).filter((function(e){return"_parentMesh"!==e})).map((function(t){return e[t]})).forEach((function(e){if(null===e)throw"There are missing variables to build a robot, e.g ".concat(e)})),this._meshTree.id=this._id,this._meshTree.name=this._name,this._meshTree.mesh.name=this._name,this._meshTree.mesh.isPickable=this._isPickable,this._meshTree.mesh.parent=this._parentMesh,ln.referentialBuilder(this._scene).isPickable(!1).boxParams({isVisible:!1,size:.1}).name("".concat(this._name,"Axis")).build().parent=this._meshTree.mesh,new Io(this._meshTree,this._assetName,this._keyValueMap)}}]),e}(),Fo=Io;function _o(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=st()(e);if(t){var o=st()(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return ct()(this,n)}}var Lo=_t.Utils.ofNull,zo=function(e){it()(n,e);var t=_o(n);function n(e,r){var o;return $e()(this,n),o=t.call(this,e),h()(rt()(o),"getType",(function(){return n.TYPE})),o.robot=r,o.pointCloudSubscribe(),o}return tt()(n,[{key:"pointCloudSubscribe",value:function(){var e=this;_t.MasterDB.subscribe({Scope:"Robot",Name:this.robot.id,Parameter:"front_lidar"},(function(t){At.Maybe.fromNull(t).flatMap((function(e){return Lo(e.key)})).flatMap((function(t){return Lo(t.Robot[e.robot.id])})).flatMap((function(e){return Lo(e.Parameter)})).flatMap((function(e){return Lo(e.front_lidar)})).flatMap((function(e){return Lo(e.Value)})).flatMap((function(e){return Lo(e.points)})).forEach((function(t){return e.updatePointCloud(t)}))}),(function(t){At.Maybe.fromNull(t.value).flatMap((function(e){return Lo(e.Robot)})).flatMap((function(t){return Lo(t[e.robot.id])})).flatMap((function(e){return Lo(e.Parameter)})).flatMap((function(e){return Lo(e.front_lidar)})).flatMap((function(e){return Lo(e.Value)})).flatMap((function(e){return Lo(e.points)})).forEach((function(t){return e.updatePointCloud(t)}))}))}},{key:"updatePointCloud",value:function(e){var t=new wt.VertexData;t.positions=e.flatMap((function(e){return e}));var n=new Array(4*e.length);t.colors=n.fill(1),t.applyToMesh(this.mesh,!0)}},{key:"dispose",value:function(){jt()(st()(n.prototype),"dispose",this).call(this),_t.MasterDB.unsubscribe({Scope:"Robot",Name:this.robot.id,Parameter:"front_lidar"})}}],[{key:"ofDict",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;if(!t||!r)throw"null dictionary describing point cloud or null mainView";var o=new wt.Mesh("cloudPoint".concat(t.name),e),i=new wt.StandardMaterial("cloudPoint".concat(t.name,"Material"),e);return i.emissiveColor=new wt.Color3(1,1,1),i.disableLighting=!0,i.pointsCloud=!0,i.pointSize=2,o.material=i,new n(o,t)}}]),n}(Qt);h()(zo,"TYPE","PointCloud");var Uo=zo,qo=function(){function e(){if($e()(this,e),Ko)return Ko;Ko=this,this.meshCacheBySceneId={},this.count=0}return tt()(e,[{key:"hasKey",value:function(e,t){var n=t._uid;return At.Maybe.fromNull(this.meshCacheBySceneId[n]).flatMap((function(t){return Go(t[e])})).cata((function(){return!1}),(function(){return!0}))}},{key:"put",value:function(e,t,n){var r=t._uid;return r in this.meshCacheBySceneId||(this.meshCacheBySceneId[r]={}),this.meshCacheBySceneId[r][e]=n,n.setEnabled(!1),this}},{key:"get",value:function(e,t){var n=this,r=t._uid;return At.Maybe.fromNull(this.meshCacheBySceneId[r]).flatMap((function(t){return Go(t[e])})).map((function(t){console.log("#Mesh: Found Mesh in cache, retrieving copy number",n.count);var r=t.clone("".concat(e).concat(n.count++));return console.log("#Mesh:",r),r})).orNull()}},{key:"del",value:function(e){var t=e._uid;t in this.meshCacheBySceneId&&delete this.meshCacheBySceneId[t]}}],[{key:"getInstance",value:function(){return new e}}]),e}(),Go=function(e){return At.Maybe.fromNull(e)},Ko=null,Wo=qo,Yo=(n(71),function(){function e(t){var n=this;$e()(this,e),h()(this,"load",(function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:function(e){return e};return new Promise((function(r,o){var i=Wo.getInstance();if(i.hasKey(e,n.scene))console.log("Found Mesh ".concat(e," in cache for scene ").concat(n.scene)),r(t(i.get(e,n.scene)));else{console.log("Loading mesh....");var a=new wt.AssetsManager(n.scene),c=a.addMeshTask("","",Qo,e);c.onSuccess=function(t){console.log("Load Success",e);var r=t.loadedMeshes[0];r.name=e,i.put(e,n.scene,r)},c.onError=function(e,t,n){return o({message:t,exception:n})},a.onFinish=function(o){console.log("Load finish "),r(t(i.get(e,n.scene)))},a.load()}}))})),this.scene=t}return tt()(e,null,[{key:"of",value:function(t){return new e(t)}}]),e}());h()(Yo,"getMeshUrl",(function(e){return"".concat(Qo).concat(e)}));var Qo="/static/meshes/",Zo=Yo;function Ho(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function Xo(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=st()(e);if(t){var o=st()(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return ct()(this,n)}}var Jo=function(e){it()(n,e);var t=Xo(n);function n(e){var r,i,a=arguments.length>1&&void 0!==arguments[1]?arguments[1]:function(e,t){return Fo.getDefaultAnimator(t)};return $e()(this,n),i=t.call(this),h()(rt()(i),"action",(function(e){jt()((r=rt()(i),st()(n.prototype)),"action",r).call(r,e),e.getNodeFromTree(i.robot.name).orElseRun((function(){return i.addRobot(e)})),e.setSelectedAction(Ro.dragObjects)})),h()(rt()(i),"getRobot",(function(e,t,n){var r=Fo.createRobotMeshTree(i.robot.robotTree,t,e),o=At.Maybe.fromNull(i.memory.nodeItemDict);return Fo.builder().id(i.robot.id).name(At.Maybe.fromNull(i.memory.name).orSome(i.robot.name)).assetName(At.Maybe.fromNull(i.memory.assetName).orSome(i.robot.name)).meshTree(r).parentMesh(n).scene(e).keyValueMap(o.map((function(e){return e.keyValueMap})).orSome({})).build()})),h()(rt()(i),"getCloudPoint",(function(e,t,n){var r=Uo.ofDict(e,{name:i.robot.name,id:i.robot.id},t);return r.mesh.parent=n.mesh,r})),h()(rt()(i),"getParentMesh",(function(e){return At.Maybe.fromNull(i.memory.parentObj).map((function(e){return e.parent})).flatMap((function(t){return e.getNodeFromTree(t)})).map((function(e){return e.item.mesh})).orSome(e.getRootNode().item.mesh)})),h()(rt()(i),"getType",(function(){return n.TYPE})),i.robot=e,i.key="robotAction".concat(e.name),i.name=e.name,i.robotAnimatorFactory=a,i.icon=function(e){return o.a.createElement("i",Q()({className:"fas fa-robot"},e))},i}return tt()(n,[{key:"addRobot",value:function(e){var t=this;e.getSceneMemory().forEach((function(n){var r=n.scene,o=function(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?Ho(Object(n),!0).forEach((function(t){h()(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Ho(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}({},t.memory);Zo.of(r).load(Fo.ROBOT_MESH_NAME,(function(e){return Fo.transformMesh(e,r)})).then((function(n){return t.createRobotFromMesh(n,r,e,o)}))})),this.memory.isImport=!1}},{key:"createRobotFromMesh",value:function(e,t,n,r){var o=this.getParentMesh(n),i=this.getRobot(t,e,o);i.animate(this.robotAnimatorFactory(i,n));var a=At.Maybe.fromNull(r.isImport).orSome(!1);n.addNodeItem2Tree(i,o.name,!a);var c=this.getCloudPoint(t,n,i);n.addNodeItem2Tree(c,i.name,!1),n.renderMenus()}}]),n}(Mn);h()(Jo,"TYPE","RobotAction");var $o=Jo;function ei(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=st()(e);if(t){var o=st()(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return ct()(this,n)}}var ti=function(e){it()(n,e);var t=ei(n);function n(e,r){var o,i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};return $e()(this,n),o=t.call(this,e,r,i),h()(rt()(o),"getType",(function(){return n.TYPE})),o}return tt()(n,[{key:"toDict",value:function(){return jt()(st()(n.prototype),"toDict",this).call(this)}},{key:"toForm",value:function(){var e=jt()(st()(n.prototype),"toForm",this).call(this);return e.jsonSchema.properties={oldName:e.jsonSchema.properties.oldName,name:e.jsonSchema.properties.name,type:e.jsonSchema.properties.type,assetName:{type:"string",title:"Asset Name"},position:e.jsonSchema.properties.position,quaternion:e.jsonSchema.properties.quaternion,color:e.jsonSchema.properties.color,annotations:e.jsonSchema.properties.annotations},e.uiSchema.assetName={"ui:disabled":!0},e.data.assetName=this.assetName,e}},{key:"getMouseContextActions",value:function(e){return jt()(st()(n.prototype),"getMouseContextActions",this).call(this,e).filter((function(e){return"Delete"===e.title}))}}]),n}(En);h()(ti,"TYPE","Mesh");var ni=ti;function ri(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function oi(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=st()(e);if(t){var o=st()(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return ct()(this,n)}}var ii=function(e){it()(n,e);var t=oi(n);function n(e){var r;return $e()(this,n),r=t.call(this),h()(rt()(r),"addMesh",(function(e){e.getSceneMemory().forEach((function(t){var n=t.scene,o=function(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?ri(Object(n),!0).forEach((function(t){h()(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):ri(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}({},r.memory);Zo.of(n).load(r.key).then(r.transformMesh(e,n,o)).then(r.addMesh2Scene(e,n,o))})),r.memory.isImport=!1})),h()(rt()(r),"transformMesh",(function(e,t,n){return function(o){var i=r.getParentMesh(e);o.parent=i,o.createNormals();var a=At.Maybe.fromNull(n.isImport).orSome(!1),c=At.Maybe.fromNull(n.nodeItemDict);o.position=c.flatMap((function(e){return a?At.Maybe.some(e.position):At.Maybe.none()})).map(wt.Vector3.FromArray).orSome(wt.Vector3.Zero()),o.rotationQuaternion=c.flatMap((function(e){return a?At.Maybe.some(e.quaternion):At.Maybe.none()})).map((function(e){return new wt.Quaternion(e[1],e[2],e[3],e[0])})).orSome(wt.Quaternion.Identity());var u=new wt.StandardMaterial("Mesh".concat(o.name),t),s=c.flatMap((function(e){return a?At.Maybe.some(e.color):At.Maybe.none()})).map(wt.Color3.FromArray).orSome(wt.Color3.Gray());return u.diffuseColor=s,u.emissiveColor=s,o.material=u,o}})),h()(rt()(r),"addMesh2Scene",(function(e,t,n){return function(t){var o=r.getParentMesh(e),i=At.Maybe.fromNull(n.isImport).orSome(!1),a=At.Maybe.fromNull(n.nodeItemDict).flatMap((function(e){return i?At.Maybe.some(e.name):At.Maybe.none()})).orSome("".concat(r.name).concat(Math.floor(100*Math.random())));t.name=a;var c=new ni(t,r.name,At.Maybe.fromNull(n.nodeItemDict).flatMap((function(e){return i?At.Maybe.some(e.keyValueMap):At.Maybe.none()})).orSome({}));e.addNodeItem2Tree(c,o.name,!i),e.renderMenus()}})),h()(rt()(r),"getParentMesh",(function(e){return At.Maybe.fromNull(r.memory.parentObj).map((function(e){return e.parent})).flatMap((function(t){return e.getNodeFromTree(t)})).map((function(e){return e.item.mesh})).orSome(e.getRootNode().item.mesh)})),h()(rt()(r),"getType",(function(){return n.TYPE})),h()(rt()(r),"deleteAsset",(function(){})),h()(rt()(r),"download",bn()(yn.a.mark((function e(){return yn.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:o.a.createElement("div",{style:{display:"flex",flexDirection:"column"}},o.a.createElement("div",{style:{display:"flex",flexDirection:"row"}},o.a.createElement("div",{style:{marginRight:"5px"}},"Mesh:"),o.a.createElement("a",{href:Zo.getMeshUrl(r.key),download:!0},r.key)));case 1:case"end":return e.stop()}}),e)})))),r.key=e.id,r.name=e.name,r.icon=function(e){return o.a.createElement("i",Q()({},e,{className:"fas fa-draw-polygon"}))},r}return tt()(n,[{key:"action",value:function(e){jt()(st()(n.prototype),"action",this).call(this,e),console.log("Mesh ".concat(this.key," : ").concat(this.name),this.memory),this.addMesh(e),e.setSelectedAction(Ro.dragObjects)}}]),n}(Mn);h()(ii,"TYPE","AddMeshAction");var ai=ii,ci={Map:"Map",Robot:"Robot",Mesh:"Mesh"},ui={Map:function(e){return new jo(e.name,e.loader)},Robot:function(e){return new $o(e,Fo.getSocketAnimator)},Mesh:function(e){return new ai(e)}};function si(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=st()(e);if(t){var o=st()(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return ct()(this,n)}}var li=function(e){it()(n,e);var t=si(n);function n(e,r,o){var i,a=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{},c=arguments.length>4&&void 0!==arguments[4]?arguments[4]:{};return $e()(this,n),i=t.call(this,e,c),h()(rt()(i),"getType",(function(){return n.TYPE})),i.localWall=r,i.size=o,i.keyPoints=a,i}return tt()(n,[{key:"toDict",value:function(){var e=jt()(st()(n.prototype),"toDict",this).call(this);return e.localWall=this.localWall,e.size=this.size,e}},{key:"ofDict",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;return n.ofDict(e,t,r)}}],[{key:"ofDict",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;if(!t)throw"null dictionary describing wall";var o=At.Maybe.fromNull(t.name).orSome("Wall".concat(Math.floor(1e3*Math.random()))),i=di(t,o,e),a=new wt.StandardMaterial("WallMaterial".concat(o),e),c=new wt.Color3(t.color[0],t.color[1],t.color[2]);a.diffuseColor=c,a.emissiveColor=c,i.material=a,i.position.z+=.001;var u=mi(e,t.localWall.map((function(e){return Ft.of(e).toBabylon()})),i,r);return new n(i,t.localWall,t.size,u,t.keyValueMap)}}]),n}(Qt);h()(li,"TYPE","Wall");var fi=Kn.RADIUS,hi=[[0,1,2],[2,3,0],[4,6,5],[6,4,7],[0,5,1],[5,0,4],[3,2,6],[6,7,3],[1,6,2],[6,1,5],[0,3,7],[7,4,0]];function di(e,t,n){var r=e.localWall.map((function(e){return Ft.of(e).toBabylon()})),o=Ft.of(e.position).toBabylon(),i=r[1].subtract(r[0]).normalize(),a=new wt.Vector3(-i.y,i.x,0),c=[r[0].add(a.scale(e.size.width)),r[0].subtract(a.scale(e.size.width)),r[1].subtract(a.scale(e.size.width)),r[1].add(a.scale(e.size.width))],u=new wt.Vector3(0,0,e.size.height),s={positions:[c[0],c[1],c[2],c[3],c[0].add(u),c[1].add(u),c[2].add(u),c[3].add(u)],faces:hi},l=ln.meshFromPositionAndFaces(t,n,s.positions,s.faces);return l.position=o,l}var pi=function(e,t){return function(n){var r=n.updatedPointMesh,o=n.is2updateServer;e.getNodeFromTree(r.parent.name).forEach((function(n){var i=r.index,a=n.item,c=a.mesh,u={position:Ft.ofBabylon(c.position).toArray(),localWall:a.localWall,size:a.size};u.localWall[i]=Ft.ofBabylon(r.position).toArray(),function(e,t,n,r){var o=ln.pointAverageVec3(e.localWall.map((function(e){return Ft.of(e)})));e.position=o.toArray(),e.localWall=e.localWall.map((function(e){return Ft.of(e).sub(o).toArray()}));var i=di(e,n.name,t);i.position=n.position,i.rotationQuaternion=n.rotationQuaternion,i.locallyTranslate(o.toBabylon()),i.material=n.material,i.visibility=n.visibility,i.parent=n.parent,r.mesh=i,r.localWall=e.localWall,kt()(n._children).forEach((function(e){n.removeChild(e),e.parent=i})),r.keyPoints.forEach((function(t,n){t.position=Ft.of(e.localWall[n]).toBabylon()})),n.dispose()}(u,t,c,a),o&&e.updateNodeInServer(c.name)}))}},mi=function(e,t,n,r){var o=[];return t.forEach((function(t,i){var a=ln.createSphere(e,new wt.Color3(.25,.25,.25),fi,"".concat(n.name,"keyPointWall").concat(i),!0);a.parent=n,a.position=t,a.index=i,a.observers=new wt.Observable,a.observers.add(pi(r,e)),o.push(a)})),o},vi={GlobalRef:mn,Box:cn,KeyPoint:zn,Path:hr,Wall:li,BoxRegion:tr,PolygonRegion:Lr,GraphItem:ko},yi=function(){function e(){$e()(this,e)}return tt()(e,null,[{key:"importScene",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[],n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;console.log("Importing scene...",e,t);var r=[];return t.length>0?Mi(e,t,n,r):xi(e),console.log("End Importing scene"),r}},{key:"importNodeItem",value:function(e,t,n){var r=arguments.length>3&&void 0!==arguments[3]&&arguments[3],o=vi[t.type];o&&e.getSceneMemory().forEach((function(i){var a=i.scene,c=o.ofDict(a,t,e),u=void 0===t.isVisible||t.isVisible;c.mesh.setEnabled(u),e.getNodeFromTree(n).forEach((function(e){c.mesh.parent=e.item.mesh})),e.addNodeItem2Tree(c,n,r,u,!1)}))}}]),e}();function gi(e){return e.type in ci}function bi(e,t,n,r){var o=t.type,i=At.Maybe.fromNull(t.assetName).orSome(t.name),a=e.getAssetsActionMap(),c=At.Maybe.fromNull(a[i]).orLazy((function(){return a[i.split(".")[0]]}));c?(c.memory.parentObj={parent:n},c.memory.nodeItemDict=t,c.memory.assetName=i,c.memory.name=t.name,c.memory.isImport=!0,c.memory.isVisible=void 0===t.isVisible||t.isVisible,c.action(e)):r.push({cause:"Asset of type ".concat(o," with name ").concat(i,", was not found"),solution:"please upload ".concat(o," ").concat(i)})}function Mi(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null,r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:[];if(t){var o=t.sort((function(e,t){return"GlobalRef"===e.item.type||e.name<t.name?-1:e.name>t.name?1:0}));o.forEach((function(t){gi(t.item)?bi(e,t.item,n,r):yi.importNodeItem(e,t.item,n),t.children.length>0&&Mi(e,t.children,t.name,r)}))}}function xi(e){e.getSceneMemory().forEach((function(t){var n=t.scene;e.addNodeItem2Tree(mn.ofDict(n),null,!0)}))}var Ei=yi,ki=function e(){$e()(this,e)};h()(ki,"retrieveScene",(function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:Pi,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:wi("retrieving scene");_t.MasterDB.cloudFunction(Kn.CLOUD_FUNCTION_NAME,"retrieveScene",e,(function(e){return Ci(e,t,n)}))}));var wi=function(e){return function(t){throw""+"Exception caught in ".concat(e,": ").concat(t.error)}},Pi=function(e){},Ci=function(e,t,n){e.success?t(e):n(e)},Si=ki;function Oi(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function Ni(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?Oi(Object(n),!0).forEach((function(t){h()(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Oi(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function Ri(e,t,n){if(e.length===t.length){for(var r=!0,o=0;o<e.length;o++){var i=e[o],a=t[o];if(!n(i,a))return!1;r=r&&Ri(i.children,a.children,n)}return r}return!1}function Di(e){return e.expanded=!0,e}function Ai(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:function(e){return!0};if(!e||0===e.length)return[];var n=[];return e.forEach((function(e){var r=Ni({},e);if(t(r)){var o=Di(r);o.children=Ai(o.children,t),n.push(o)}else if(r.children){var i=Ai(r.children,t);0!==i.length&&(r.children=i,n.push(Di(r)))}})),n}function Ti(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:function(e){return!0};if(!e||0===e.length)return[];var n=[];return e.forEach((function(e){var r=Ni({},e);t(r)&&n.push(r),n=n.concat(Ti(r.children,t))})),n}var ji=function(){function e(t){$e()(this,e),this.tree=t}return tt()(e,[{key:"getNode",value:function(e){return function e(t,n){for(var r=0;r<t.length;r++){var o=t[r];if(n(o))return At.Maybe.some(o);var i=e(o.children,n);if(i.isSome())return i}return At.Maybe.none()}(this.tree,e)}},{key:"getParentNode",value:function(e){return function e(t,n,r){if(t.map((function(e){return n(e)})).reduce((function(e,t){return e||t}),!1))return At.Maybe.fromNull(r);for(var o=0;o<t.length;o++){var i=t[o],a=e(i.children,n,i);if(a.isSome())return a}return At.Maybe.none()}(this.tree,e,null)}},{key:"equals",value:function(t){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:function(e,t){return e===t};return t.constructor===e?Ri(this.tree,t.tree,n):Ri(this.tree,t,n)}},{key:"map",value:function(t){return new e(function e(t,n,r){return t.forEach((function(t){var o=Ni({},t),i=r(o);i.children=e(o.children,[],r),n.push(i)})),n}(this.tree,[],t))}},{key:"filter",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:function(e){return!0};return new e(Ai(this.tree,t))}},{key:"flatten",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:function(e){return!0};return Ti(this.tree,e)}},{key:"forEach",value:function(e){!function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:function(){};t.forEach((function(t){n(t),e(t.children,n)}))}(this.tree,e)}}]),e}(),Vi=function(){function e(t,n,r,o,i){$e()(this,e),this.title=t,this.item=n,this.children=r,this.expanded=o,this.isVisible=i}return tt()(e,null,[{key:"dispose",value:function(t){t.item.dispose(),t.children.forEach((function(t){e.dispose(t)}))}},{key:"toDict",value:function(t){return{name:t.title,item:t.item.toDict(),children:t.children.map((function(t){return e.toDict(t)}))}}},{key:"builder",value:function(){return new Ii}}]),e}(),Ii=function(){function e(){$e()(this,e),this._title=null,this._item={},this._children=[],this._expanded=!0,this._isVisible=!0}return tt()(e,[{key:"title",value:function(e){return this._title=e,this}},{key:"item",value:function(e){return this._item=e,this}},{key:"children",value:function(e){return this._children=e,this}},{key:"expanded",value:function(e){return this._expanded=e,this}},{key:"isVisible",value:function(e){return this._isVisible=e,this}},{key:"build",value:function(){return Object.values(this).forEach((function(e){if(null===e)throw"There are missing variables to build a TreeNode, e.g ".concat(e)})),new Vi(this._title,this._item,this._children,this._expanded,this._isVisible)}}]),e}(),Bi=Vi,Fi=Kn.CLOUD_FUNCTION_NAME,_i=function(){function e(t){var n=this;$e()(this,e),h()(this,"getNodeFromTree",(function(e,t){return new ji(t).getNode((function(t){return e===t.title}))})),h()(this,"getParentFromChild",(function(e,t){return new ji(t).getParentNode((function(t){return e===t.title}))})),h()(this,"deleteNodeFromTreeUsingName",(function(e,t){var r=!(arguments.length>2&&void 0!==arguments[2])||arguments[2];return n.getNodeFromTree(e,t).forEach((function(o){Bi.dispose(o),r&&n.deleteNodeInServer(e),n.getParentFromChild(e,t).forEach((function(t){t.children=t.children.filter((function(t){return t.title!==e}))})),t=t.filter((function(t){return t.title!==e}))})),t})),h()(this,"getNodeFromTreeWithPredicate",(function(e,t){return new ji(t).getNode(e)})),h()(this,"addNodeItem2Tree",(function(e,t){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:mn.NAME,o=!(arguments.length>3&&void 0!==arguments[3])||arguments[3],i=!(arguments.length>4&&void 0!==arguments[4])||arguments[4];n.deleteNodeFromTreeUsingName(t.name,e,o);var a=Bi.builder().title(t.name).item(t).isVisible(i).build();if(r){var c=n.getNodeFromTree(r,e);c.forEach((function(e){o&&n.addNodeItem2Server(a,e.title),e.children.push(a)}))}else e.push(a),o&&n.addNodeItem2Server(a,null);return e})),h()(this,"updateNodeInServer",(function(e,t){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;console.log("updateNodeInServer!",n.sceneName),n.getNodeFromTree(e,t).forEach((function(o){var i=n.getParentFromChild(e,t).map((function(e){return e.title})).orNull();_t.MasterDB.cloudFunction(Fi,"updateNode",[Bi.toDict(o),i,r,n.sceneName],(function(e){console.log("Update node with success?",e.success)}))}))})),h()(this,"addNodeItem2Server",(function(e,t){_t.MasterDB.cloudFunction(Fi,"addNodeItem",[Bi.toDict(e),t,n.sceneName],(function(e){console.log("Add node with success?",e.success)}))})),h()(this,"deleteNodeInServer",(function(e){_t.MasterDB.cloudFunction(Fi,"deleteNodeByName",[e,n.sceneName],(function(e){console.log("Deleted node with success?",e.success)}))})),this.sceneName=t}return tt()(e,null,[{key:"ofScene",value:function(t){return new e(t)}}]),e}(),Li=function(){function e(){var t=this;if($e()(this,e),h()(this,"getAssets",(function(){return t.assets})),h()(this,"getAssetsActionMap",(function(){return t.assetsActionMap})),h()(this,"signalObservers",(function(){return t.observers.forEach((function(e){return e(t)}))})),h()(this,"subs",[function(){return _t.MasterDB.subscribe({Scope:"Robot",Name:"*",RobotName:"*"},t.getRobotNameUpdate(),t.getRobotNameSub())},function(){return _t.MasterDB.subscribe({Scope:"Package",File:"*",Name:"maps",FileLabel:"*"},t.getMapUpdater((function(e){return e.key}),t.signalObservers),t.getMapSubscriber((function(e){return e.value}),(function(){return t.finishSub("Maps")})))},function(){return _t.MasterDB.subscribe({Scope:"Package",File:"*",Name:"meshes",FileLabel:"*"},t.getMeshUpdater(),t.getMeshSubscriber((function(e){return e.value}),(function(){return t.finishSub("Meshes")})))}]),h()(this,"finishSub",(function(e){console.log("FINISH SUB ",e,t.finishInitialSubscribers),++t.finishInitialSubscribers>t.subs.length-1&&t.afterLoad.forEach((function(e){return e(t)}))})),h()(this,"deleteRobot",(function(e){t.delAsset(t.robots[e].name),e in t.robots&&delete t.robots[e]})),h()(this,"getMapSubscriber",(function(e){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:function(){};return function(r){return t.getMapFileData(e,r).forEach((function(e){Object.keys(e).filter((function(e){return e.includes(".yaml")})).forEach(t.addMap),n()}))}})),h()(this,"getMapUpdater",(function(e){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:function(){},r={del:function(r){t.getMapFileData(e,r).forEach((function(e){var n=Object.keys(e)[0];n=n.split(".")[0],delete t.assets[n],delete t.assetsActionMap[n]})),n()},set:t.getMapSubscriber(e,n),subscribe:t.getMapSubscriber(e,n)};return function(e){console.log("MAP UPDATE",e),r[e.event](e)}})),h()(this,"addMap",(function(e){var n={name:e.split(".")[0],loader:new Do(e),type:ci.Map};t.addAsset(n.name,n)})),h()(this,"getMapFileData",(function(e,t){return Ui(e(t)).flatMap(qi("Package")).flatMap(qi("maps")).flatMap(qi("File"))})),h()(this,"getMeshSubscriber",(function(e){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:function(){};return function(r){t.getMeshFileData(e,r).forEach((function(e){return Object.keys(e).forEach((function(n){var r={id:n,name:e[n].FileLabel,type:ci.Mesh};t.addAsset(r.name,r)}))})),n()}})),h()(this,"getMeshUpdater",(function(){var e={del:function(e){t.getMeshFileData((function(e){return e.key}),e).forEach((function(e){var n=Object.keys(e)[0];delete t.assets[n],delete t.assetsActionMap[n]})),t.signalObservers()},set:t.getMeshSubscriber((function(e){return e.key}),t.signalObservers),subscribe:t.getMeshSubscriber((function(e){return e.key}),t.signalObservers)};return function(t){return e[t.event](t)}})),h()(this,"getMeshFileData",(function(e,t){return Ui(e(t)).flatMap(qi("Package")).flatMap(qi("meshes")).flatMap(qi("File"))})),zi)return zi;zi=this,this.assets={},this.assetsActionMap={},this.robots={},this.observers=[],this.afterLoad=[],this.finishInitialSubscribers=0}return tt()(e,[{key:"load",value:function(){return this.retrieveAssetsFromDb(),this}},{key:"addAfterLoad",value:function(e){return this.afterLoad.push(e),this}},{key:"addObserver",value:function(e){return this.observers.push(e),this}},{key:"addAsset",value:function(e,t){try{this.assets[e]=t,this.assetsActionMap[e]=ui[t.type](t)}catch(e){console.log("Caught exception while adding asset",e)}}},{key:"delAsset",value:function(e){e in this.assets&&delete this.assets[e],e in this.assetsActionMap&&delete this.assetsActionMap[e],this.signalObservers()}},{key:"retrieveAssetsFromDb",value:function(){this.subs.forEach((function(e){return e()}))}},{key:"addRobot",value:function(e){var t=this,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;if(e in this.robots||(this.robots[e]={id:e,name:null}),Ui(n).forEach((function(n){return t.robots[e].name=n})),Object.values(this.robots[e]).every((function(e){return null!==e}))){var r=this.robots[e];this.addAsset(r.name,{name:r.name,id:e,type:ci.Robot,robotTree:{name:r.name,position:{x:0,y:0,z:0},orientation:{w:1,x:0,y:0,z:0},child:[]}})}}},{key:"getRobotNameSub",value:function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:function(e){return e.value};return function(n){Ui(t(n)).flatMap(qi("Robot")).forEach((function(t){return Object.keys(t).forEach((function(n){return e.addRobot(n,t[n].RobotName)}))})),e.finishSub("RobotName")}}},{key:"getRobotNameUpdate",value:function(){var e=this,t={del:function(t){return Ui(t.key).flatMap(qi("Robot")).forEach((function(t){return Object.keys(t).forEach(e.deleteRobot)}))},set:this.getRobotNameSub((function(e){return e.key}))};return function(e){console.log("Robot NAME UPDATE",e),t[e.event](e)}}}],[{key:"getInstance",value:function(){return new e}}]),e}(),zi=null,Ui=At.Maybe.fromNull,qi=function(e){return(t=Ui,function(e){return function(n){return t(e(n))}})(function(e){return function(t){return t[e]}}(e));var t},Gi=Li,Ki=function(){function e(t,n,r){$e()(this,e),this.state=t,this.next=n,this.while=r,this.requestAnimeId=null}return tt()(e,[{key:"play",value:function(){var e=this;return this.requestAnimeId=requestAnimationFrame((function(){if(!e.while(e.state))return e.stop();e.state=e.next(e.state),e.play()})),this}},{key:"stop",value:function(){return cancelAnimationFrame(this.requestAnimeId),this}}],[{key:"builder",value:function(){return new Wi}}]),e}(),Wi=function(){function e(){$e()(this,e),this._state=null,this._next=null,this._end=null}return tt()(e,[{key:"initialState",value:function(e){return this._state=e,this}},{key:"nextState",value:function(e){return this._next=e,this}},{key:"while",value:function(e){return this._end=e,this}},{key:"build",value:function(){if([this._state,this._next,this._end].some((function(e){return null==e})))throw"Animator properties are missing";return new Ki(this._state,this._next,this._end)}}]),e}(),Yi=function e(){$e()(this,e)};function Qi(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function Zi(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=st()(e);if(t){var o=st()(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return ct()(this,n)}}h()(Yi,"onPointerDown",(function(e){return function(t){e.mousePosClick=e.getMouseCoordinatesFromRoot().orSome(wt.Vector3.Zero()),e.mousePosMove=e.mousePosClick,e.sceneMemory.forEach((function(e){var n=e.camera,r=e.canvas;(2===t.buttons||4===t.buttons||t.ctrlKey)&&n.detachControl(r)}))}})),h()(Yi,"onPointerUp",(function(e){return function(t){e.sceneMemory.forEach((function(e){var t=e.camera,n=e.canvas;t.attachControl(n,!0)}))}})),h()(Yi,"onPointerMove",(function(e){return function(t){e.sceneMemory.forEach((function(n){var r=n.mouseLocationText,o=n.camera;e.getMouseCoordinatesFromRoot().forEach((function(n){!function(e,t){e.text="x: ".concat(t.x.toFixed(2),", y: ").concat(t.y.toFixed(2))}(r,n);var i=function(){var t=n.subtract(e.mousePosMove),r=ln.getBabylonCoordinates(t).scale(-1);!function(e,t){Ki.builder().initialState({camera:e,time:0,T:(new Date).getTime()}).nextState((function(e){var n=e.camera,r=e.time,o=t.scale(.1);return n.position=n.position.add(o),n.setTarget(n.target.add(o)),{camera:n,time:r+.1,T:(new Date).getTime()}})).while((function(e){return e.time<=1})).build().play()}(o,r),e.mousePosMove=n},a=[{predicate:t.ctrlKey&&1===t.buttons,action:i},{predicate:4===t.buttons,action:i}].filter((function(e){return e.predicate}));a.length>0&&a[0].action()}))}))}}));var Hi=function(e){it()(n,e);var t=Zi(n);function n(e){var r;return $e()(this,n),r=t.call(this,e),h()(rt()(r),"getSceneMemory",(function(){return r.sceneMemory})),h()(rt()(r),"getAssetsActionMap",(function(){return Gi.getInstance().getAssetsActionMap()})),h()(rt()(r),"getRootNode",(function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:kt()(r.objectTree);return e.filter((function(e){return e.title===mn.NAME}))[0]})),h()(rt()(r),"getObjectTree",(function(){return r.objectTree})),h()(rt()(r),"setSelectedAction",(function(){})),h()(rt()(r),"getNodeFromTree",(function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:kt()(r.objectTree);return _i.ofScene(r.sceneName).getNodeFromTree(e,t)})),h()(rt()(r),"deleteNodeFromTreeUsingName",(function(){throw new Error("Delete Node in viewer Exception")})),h()(rt()(r),"updateNodeInServer",(function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;r.props.focusObject.Value===e&&r.setCameraToTarget(),_i.ofScene(r.sceneName).updateNodeInServer(e,kt()(r.objectTree),t)})),h()(rt()(r),"addNodeItem2Tree",(function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:mn.NAME,n=!(arguments.length>2&&void 0!==arguments[2])||arguments[2],o=!(arguments.length>3&&void 0!==arguments[3])||arguments[3],i=_i.ofScene(r.sceneName).addNodeItem2Tree(kt()(r.objectTree),e,t,n,o);r.objectTree=i})),h()(rt()(r),"setCameraToTarget",(function(){r.sceneMemory.forEach((function(e){var t=e.camera,n=r.props.focusObject.Value;r.getNodeFromTree(n).cata((function(){console.log("Set Camera",r.getRootNode().item.mesh._absolutePosition),t.setTarget(r.getRootNode().item.mesh._absolutePosition.clone())}),(function(e){console.log("Set Camera, Found Object",e.item.mesh),t.setTarget(e.item.mesh._absolutePosition.clone())}))}))})),h()(rt()(r),"onPointerDown",(function(e){Yi.onPointerDown(rt()(r))(e)})),h()(rt()(r),"onPointerUp",(function(e){Yi.onPointerUp(rt()(r))(e)})),h()(rt()(r),"onPointerMove",(function(e){Yi.onPointerMove(rt()(r))(e)})),h()(rt()(r),"onResize",(function(e,t){0===e&&0===t||r.getSceneMemory().forEach((function(n){var r=n.mouseLocationText;r.left=-e/2+e/17,r.top=-t/2+t/30}))})),h()(rt()(r),"retrieveSceneFromServer",(function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:function(){};Si.retrieveScene(r.sceneName,(function(t){var n=Ei.importScene(rt()(r),t.result);r.setState({errorList:n}),e()}))})),h()(rt()(r),"loadAssets",(function(){Gi.getInstance().load()})),h()(rt()(r),"loadScene",(function(){r.loadAssets(),r.retrieveSceneFromServer(r.renderScene)})),h()(rt()(r),"renderScene",(function(){r.getSceneMemory().forEach((function(e){var t=e.engine,n=e.scene;return t.runRenderLoop((function(){return n.render()}))})),r.setCameraToTarget()})),h()(rt()(r),"onSceneReady",(function(e){var t=e.getEngine(),n=t.getRenderingCanvas();r.addCanvasEventListeners(n);var o=Nn.createMouseLocationText(e);return r.sceneMemory=At.Maybe.some({engine:t,canvas:n,scene:e,camera:Nn.createCamera(e,n),light:Nn.createLight(e),ground:Nn.createMeshGround(e),gizmoManager:Nn.createGizmo(e),highlightLayer:{hl:new wt.HighlightLayer("hl1",e),lastHlMeshes:[]},mouseLocationText:o}),e})),h()(rt()(r),"renderMenus",(function(){})),h()(rt()(r),"componentDidUpdate",(function(e){[{propVar:function(e){return e.sceneName.Value},action:function(){return r.sceneName=r.props.sceneName.Value}},{propVar:function(e){return e.focusObject.Value},action:r.setCameraToTarget}].forEach((function(t){var n=t.propVar,o=t.action;n(r.props)!==n(e)&&o()}))})),h()(rt()(r),"componentDidMount",(function(){console.log("SceneViewer Did Mount!! "),r.loadScene()})),r.state={errorList:[]},r.sceneName=e.sceneName.Value,r.sceneMemory=At.Maybe.none(),r.objectTree=[],r}return tt()(n,[{key:"getGraph",value:function(){return new ji(this.objectTree).getNode((function(e){return ko.TYPE===e.item.getType()}))}},{key:"addCanvasEventListeners",value:function(e){var t=this;[{name:"pointerdown",function:function(e){return t.onPointerDown(e)}},{name:"pointerup",function:function(e){return t.onPointerUp(e)}},{name:"pointermove",function:function(e){return t.onPointerMove(e)}}].forEach((function(t){return e.addEventListener(t.name,t.function,!1)}))}},{key:"getMouseCoordinatesFromRoot",value:function(){var e=this;return this.sceneMemory.flatMap((function(t){var n=t.scene,r=t.ground;return ln.getGroundPosition(n,r).flatMap((function(t){return At.Maybe.fromNull(e.getRootNode()).map((function(e){return ln.computeLocalCoordinatesFromMesh(e.item.mesh,Ft.ofBabylon(t)).toBabylon()}))}))}))}},{key:"render",value:function(){var e=this,t=this.state.errorList,n=function(){return e.setState({errorList:[]})};return o.a.createElement("div",{style:{display:"flex",flexGrow:1}},o.a.createElement(Dt,{onSceneReady:this.onSceneReady,is2render:!1,sceneFactory:Nn.createScene}),o.a.createElement(M,{onSubmit:n,onCancel:n,open:(null==t?void 0:t.length)>0,title:"Scene Viewer",message:"An error occurred while loading the scene",submitText:"OK",submitColor:"primary",cancelText:"Cancel",cancelColor:"secondary"},function(e){return console.log("SceneViewer: Got errors",e),e?o.a.createElement("ul",null,e.map((function(e,t){var n=e.cause,r=e.solution;return o.a.createElement("li",{key:"error"+t,text:"".concat(n,", ").concat(r)})}))):[]}(t)),o.a.createElement(Ct.a,{handleWidth:!0,handleHeight:!0,onResize:this.onResize}))}}],[{key:"getComponentFactory",value:function(e){return function(t){var r=function(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?Qi(Object(n),!0).forEach((function(t){h()(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Qi(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}({sceneName:e},t);return o.a.createElement(n,r)}}}]),n}(r.Component);h()(Hi,"EXTENSION",".3d"),Hi.propTypes={sceneName:u.a.shape({Value:u.a.string}),focusObject:u.a.shape({Value:u.a.string})},Hi.defaultProps={sceneName:{Value:"Pedro"},focusObject:{Value:""}};var Xi=Hi,Ji=n(62),$i=n.n(Ji),ea=n(63),ta=n.n(ea),na=n(64),ra=n.n(na),oa=Object(B.makeStyles)((function(e){return{formControl:{margin:e.spacing(1),minWidth:120}}})),ia=function(e){var t=oa(),n=o.a.createElement("div",null);return e.noneOption&&(n=o.a.createElement(G.a,{value:""},o.a.createElement("em",null,"None"))),o.a.createElement(ta.a,{variant:e.variant,className:t.formControl,style:e.style,hiddenLabel:void 0===e.label},o.a.createElement($i.a,{id:"movai-react-select"},e.label),o.a.createElement(ra.a,{labelId:"movai-react-select",id:e.id,value:e.value,onChange:e.onChange,inputProps:e.inputProps},n,e.options.map((function(e,t){return o.a.createElement(G.a,{key:t,value:e},e)}))))};ia.propTypes={value:u.a.string,options:u.a.array,noneOption:u.a.bool,label:u.a.string,variant:u.a.string,style:u.a.object,onChange:u.a.func,id:u.a.string,inputProps:u.a.object},ia.defaultProps={value:"option2",options:["option1","option2","option3"],variant:"filled",noneOption:!0,onChange:function(e){return console.log(e.target.value)},id:"movai-react-select"};var aa=ia,ca=n(29),ua=n(65),sa=n.n(ua),la=n(66),fa=n.n(la),ha=n(67),da=function(e){var t=e.path,n=void 0===t?"":t,r=e.style,i=void 0===r?{}:r,a=e.fill,c=void 0===a?"#fff":a,u=e.width,s=void 0===u?"100%":u,l=e.height,f=void 0===l?"100%":l,h=e.className,d=void 0===h?"":h,p=e.viewBox,m=void 0===p?"0 0 24 24":p;return o.a.createElement("svg",{width:s,style:i,height:f,viewBox:m,xmlns:"http://www.w3.org/2000/svg",className:"svg-icon ".concat(d||""),xmlnsXlink:"http://www.w3.org/1999/xlink"},o.a.createElement("path",{fill:c,d:n}))},pa={Close:o.a.createElement(da,{width:24,path:"M19 6.41L17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"}),ErrorOutline:o.a.createElement(da,{width:24,path:"M11 15h2v2h-2zm0-8h2v6h-2zm.99-5C6.47 2 2 6.48 2 12s4.47 10 9.99 10C17.52 22 22 17.52 22 12S17.52 2 11.99 2zM12 20c-4.42 0-8-3.58-8-8s3.58-8 8-8 8 3.58 8 8-3.58 8-8 8z"}),InfoOutlined:o.a.createElement(da,{width:24,path:"M11,9H13V7H11M12,20C7.59,20 4,16.41 4,12C4,7.59 7.59,4 12,4C16.41,4 20,7.59 20, 12C20,16.41 16.41,20 12,20M12,2A10,10 0 0,0 2,12A10,10 0 0,0 12,22A10,10 0 0,0 22,12A10, 10 0 0,0 12,2M11,17H13V11H11V17Z"}),ReportProblemOutlined:o.a.createElement(da,{width:24,path:"M12 5.99L19.53 19H4.47L12 5.99M12 2L1 21h22L12 2zm1 14h-2v2h2v-2zm0-6h-2v4h2v-4z"}),SuccessOutlined:o.a.createElement(da,{width:24,path:"M20,12A8,8 0 0,1 12,20A8,8 0 0,1 4,12A8,8 0 0,1 12,4C12.76,4 13.5,4.11 14.2, 4.31L15.77,2.74C14.61,2.26 13.34,2 12,2A10,10 0 0,0 2,12A10,10 0 0,0 12,22A10,10 0 0, 0 22,12M7.91,10.08L6.5,11.5L11,16L21,6L19.59,4.58L11,13.17L7.91,10.08Z"})},ma={success:pa.SuccessOutlined,warning:pa.ReportProblemOutlined,error:pa.ErrorOutline,info:pa.InfoOutlined},va=function(e){var t=e.action,n=e.children,o=e.classes,i=e.className,a=e.closeText,c=void 0===a?"Close":a,u=e.color,s=e.icon,l=e.iconMapping,f=void 0===l?ma:l,h=e.onClose,d=(e.role,e.severity),p=void 0===d?"success":d,m=e.variant,v=void 0===m?"standard":m,y=(e.theme,Ne()(e,["action","children","classes","className","closeText","color","icon","iconMapping","onClose","role","severity","variant","theme"]));return console.log("action",t),r.createElement("div",Q()({className:sa()(o.root,o["".concat(v).concat(Object(ha.capitalize)(u||p))],i)},y),!1!==s?r.createElement("div",{className:o.icon},s||f[p]||ma[p]):null,r.createElement("div",{className:o.message},n),null!=t?r.createElement("div",{className:o.action},t):null,null==t&&h?r.createElement("div",{className:o.action},r.createElement(fa.a,{size:"small","aria-label":c,title:c,color:"inherit",onClick:h},pa.Close)):null)};va.propTypes={action:u.a.node,children:u.a.node,classes:u.a.object,className:u.a.string,closeText:u.a.string,color:u.a.oneOf(["error","info","success","warning"]),icon:u.a.node,iconMapping:u.a.shape({error:u.a.node,info:u.a.node,success:u.a.node,warning:u.a.node}),onClose:u.a.func,role:u.a.string,severity:u.a.oneOf(["error","info","success","warning"]),variant:u.a.oneOf(["filled","outlined","standard"])};var ya=Object(B.withStyles)((function(){return{root:{backgroundColor:"transparent",display:"flex",padding:"6px 16px"},filledSuccess:{color:"#fff",backgroundColor:"#4caf50"},filledInfo:{color:"#fff",backgroundColor:"#2196f3"},filledWarning:{color:"#fff",backgroundColor:"#ff9800"},filledError:{color:"#fff",backgroundColor:"#f44336"},icon:{marginRight:12,padding:"7px 0",display:"flex",fontSize:22,opacity:.9},message:{padding:"8px 0",display:"flex",flexDirection:"column",justifyContent:"center"},action:{display:"flex",alignItems:"center",marginLeft:"auto",paddingLeft:16,marginRight:-8}}}),{name:"MuiAlert"})(va);n(72);function ga(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=st()(e);if(t){var o=st()(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return ct()(this,n)}}var ba=function(e){it()(n,e);var t=ga(n);function n(){var e;$e()(this,n);for(var r=arguments.length,o=new Array(r),i=0;i<r;i++)o[i]=arguments[i];return e=t.call.apply(t,[this].concat(o)),h()(rt()(e),"autoClose",null),h()(rt()(e),"handleClickButton",(function(t){t.onClick&&t.onClick(),e.close()})),h()(rt()(e),"handleClickOverlay",(function(t){var n=e.props,r=n.closeOnClickOutside,o=n.onClickOutside,i=t.target===e.overlay;r&&i&&(o(),e.close())})),h()(rt()(e),"close",(function(){xa(),Ma()})),h()(rt()(e),"keyboardClose",(function(t){var n=e.props,r=n.closeOnEscape,o=n.onKeypressEscape,i=27===t.keyCode;r&&i&&(o(t),e.close())})),h()(rt()(e),"componentDidMount",(function(){document.addEventListener("keydown",e.keyboardClose,!1),e.autoClose=setTimeout((function(){(document.getElementById("react-confirm-alert")||document.getElementById("react-confirm-alert-body-element"))&&e.close()}),e.props.autoHideDuration)})),h()(rt()(e),"componentWillUnmount",(function(){document.removeEventListener("keydown",e.keyboardClose,!1),clearTimeout(e.autoClose),e.props.willUnmount()})),h()(rt()(e),"renderCustomUI",(function(){var t=e.props,n=t.title,r=t.message;return(0,t.customUI)({title:n,message:r,onClose:e.close})})),e}return tt()(n,[{key:"render",value:function(){var e=this,t=this.props,n=t.message,r=t.customUI,i=t.severity,a=t.closeText,c=t.closable,u=t.theme;return o.a.createElement("div",{className:"react-confirm-alert-overlay",ref:function(t){return e.overlay=t},onClick:this.handleClickOverlay},o.a.createElement("div",{className:"react-confirm-alert"},r?this.renderCustomUI():o.a.createElement("div",{className:"react-confirm-alert-body"},o.a.createElement(ya,{theme:u,elevation:6,variant:"filled",severity:i,closeText:a,action:c?o.a.createElement("div",{className:"icon-container",onClick:function(){return e.close()}},pa.Close):void 0},n))))}}]),n}(r.Component);function Ma(){var e=document.getElementById("react-confirm-alert");Object(ca.unmountComponentAtNode)(e),e.parentNode.removeChild(e)}function xa(){document.body.classList.remove("react-confirm-alert-body-element")}function Ea(e,t){document.body.classList.add("react-confirm-alert-body-element"),function(e,t){var n=document.getElementById("react-confirm-alert");n||(document.body.children[0].classList.add("react-confirm-alert-blur"),(n=document.createElement("div")).id="react-confirm-alert",document.body.appendChild(n)),Object(ca.render)(o.a.createElement(ba,Q()({},e,{theme:t})),n)}(e,t)}h()(ba,"propTypes",{message:u.a.string,customUI:u.a.func,closeOnClickOutside:u.a.bool,closeOnEscape:u.a.bool,willUnmount:u.a.func,onClickOutside:u.a.func,onKeypressEscape:u.a.func,severity:u.a.string,closeText:u.a.string,autoHideDuration:u.a.number,closable:u.a.bool}),h()(ba,"defaultProps",{closeOnClickOutside:!0,closeOnEscape:!0,willUnmount:function(){return null},onClickOutside:function(){return null},onKeypressEscape:function(){return null},severity:"info",closeText:"Close",autoHideDuration:6e3,closable:!0});function ka(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function wa(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?ka(Object(n),!0).forEach((function(t){h()(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):ka(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var Pa=function(e){return wa(wa({},e),{},{typography:{fontFamily:"Roboto",h1:{fontFamily:"Avenir"},h2:{fontFamily:"Avenir"},h3:{fontFamily:"Avenir"},h4:{fontFamily:"Avenir"},h5:{fontFamily:"Avenir"},h6:{fontFamily:"Avenir"},body1:{fontFamily:"Roboto"}}})},Ca={dark:Object(B.createMuiTheme)(Pa({label:"dark",backgroundColor:"linear-gradient(114.01deg, #212121 0%, #050505 100.43%)",bottomNavigation:{background:"#212121"},globalStats:{borderColor:"#474747",subTextColor:"#CDCDCD",upperTextColor:"#E6E6E6"},palette:{type:"dark",primary:{main:"#36b5e6"},secondary:{main:"#CF6679"},green:{main:"#03DAC5"}},overrides:{MuiButton:{outlined:{margin:"8px"},text:{margin:"8px"},contained:{margin:"8px"},containedPrimary:{color:"inherit",margin:"8px"},containedSecondary:{color:"inherit",margin:"8px"}},MuiButtonGroup:{root:{margin:"0"},groupedContainedPrimary:{margin:"0"},groupedOutlined:{margin:"0"},groupedText:{margin:"0"}},MuiIconButton:{root:{color:"#36b5e6"}},MuiListItem:{button:{"&:hover":{backgroundColor:"rgba(54,181,230, 0.15)"}}},MuiFormControlLabel:{label:{color:"rgba(255,255,255,0.8)"}},MuiInputBase:{input:{font:"Roboto"}},MuiFilledInput:{root:{border:"4px"},underline:{"&::before":{borderRadius:"4px"}}}}})),light:Object(B.createMuiTheme)(Pa({label:"light",backgroundColor:"linear-gradient(122.19deg, #FFFFFF 2.58%, #FFFFFF 76.23%)",bottomNavigation:{background:"#c3c3c3"},globalStats:{borderColor:"#E6E6E6",subTextColor:"#717171",upperTextColor:"#474747"},palette:{primary:{main:"#007197"},secondary:{main:"#BE2424"},green:{main:"#03DAC5"}},overrides:{MuiButton:{outlined:{margin:"8px"},text:{margin:"8px"},contained:{margin:"8px"},containedPrimary:{color:"white",margin:"8px"},containedSecondary:{color:"white",margin:"8px"}},MuiButtonGroup:{root:{margin:"0"},groupedContainedPrimary:{margin:"0"},groupedOutlined:{margin:"0"},groupedText:{margin:"0"}},MuiIconButton:{root:{color:"#007197"}},MuiListItem:{button:{"&:hover":{backgroundColor:"rgba(0,113,151, 0.15)"}}},MuiFormControlLabel:{label:{color:"rgba(0,0,0,0.8)"}},MuiInputBase:{input:{font:"Roboto"}},MuiFilledInput:{root:{border:"4px"},underline:{"&::before":{borderRadius:"4px"}}}}})),getTheme:function(){var e=window.localStorage.getItem("movai.theme");return e||"dark"},setTheme:function(e){window.localStorage.setItem("movai.theme",e)}},Sa=Ca,Oa=n(68),Na=n.n(Oa),Ra=n(69);function Da(){var e=Na()(["",""]);return Da=function(){return e},e}var Aa=Object(Ra.createGlobalStyle)(Da(),_t.Style)}])}));