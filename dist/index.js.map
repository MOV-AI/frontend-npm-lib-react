{"version":3,"sources":["webpack://MovaiReact/webpack/universalModuleDefinition","webpack://MovaiReact/webpack/bootstrap","webpack://MovaiReact/external \"react\"","webpack://MovaiReact/external \"@babel/runtime/helpers/esm/defineProperty\"","webpack://MovaiReact/external \"@babylonjs/core\"","webpack://MovaiReact/external \"@babel/runtime/helpers/esm/assertThisInitialized\"","webpack://MovaiReact/external \"prop-types\"","webpack://MovaiReact/./src/Components/Viewer/Math/Vec3.js","webpack://MovaiReact/external \"@babel/runtime/helpers/esm/getPrototypeOf\"","webpack://MovaiReact/external \"@babel/runtime/helpers/esm/classCallCheck\"","webpack://MovaiReact/./src/Components/Viewer/Math/Mat3.js","webpack://MovaiReact/./src/Components/Viewer/Util3d/GizmoManagerBuilder.js","webpack://MovaiReact/./src/Components/Viewer/Util3d/CameraBuilder.js","webpack://MovaiReact/./src/Components/Viewer/Util3d/PositionalLightBuilder.js","webpack://MovaiReact/./src/Components/Viewer/Util3d/ReferentialBuilder.js","webpack://MovaiReact/./src/Components/Viewer/Util3d/GroundBuilder.js","webpack://MovaiReact/./src/Components/Viewer/Util3d/TooltipBuilder.js","webpack://MovaiReact/./src/Components/Viewer/Util3d/DirectionalLightBuilder.js","webpack://MovaiReact/./src/Components/Viewer/Utils/MaterialCache.js","webpack://MovaiReact/./src/Components/Viewer/Util3d/Util3d.js","webpack://MovaiReact/external \"@babel/runtime/helpers/esm/createClass\"","webpack://MovaiReact/external \"monet\"","webpack://MovaiReact/external \"mov-fe-lib-core\"","webpack://MovaiReact/external \"@material-ui/core\"","webpack://MovaiReact/external \"@babel/runtime/helpers/esm/possibleConstructorReturn\"","webpack://MovaiReact/external \"@babel/runtime/helpers/esm/extends\"","webpack://MovaiReact/external \"@babel/runtime/helpers/esm/inherits\"","webpack://MovaiReact/external \"@babel/runtime/helpers/esm/toConsumableArray\"","webpack://MovaiReact/external \"@babel/runtime/helpers/esm/get\"","webpack://MovaiReact/external \"@babel/runtime/helpers/esm/slicedToArray\"","webpack://MovaiReact/external \"@material-ui/core/styles\"","webpack://MovaiReact/./src/Components/Viewer/Utils/Constants.js","webpack://MovaiReact/external \"@babel/runtime/helpers/esm/classPrivateFieldGet\"","webpack://MovaiReact/external \"@babel/runtime/regenerator\"","webpack://MovaiReact/./src/Components/Viewer/NodeItem/Path.js","webpack://MovaiReact/./src/Components/Viewer/NodeItem/GlobalRef.js","webpack://MovaiReact/./src/Components/Viewer/Utils/AnnotationManager.js","webpack://MovaiReact/./src/Components/Viewer/NodeItem/NodeItem.js","webpack://MovaiReact/external \"@babel/runtime/helpers/esm/asyncToGenerator\"","webpack://MovaiReact/./src/Components/Viewer/Math/Vec2.js","webpack://MovaiReact/external \"lodash/get\"","webpack://MovaiReact/./src/Components/Viewer/Graph/Graph.js","webpack://MovaiReact/./src/Components/Viewer/NodeItem/GraphItem.js","webpack://MovaiReact/external \"@material-ui/core/MenuItem\"","webpack://MovaiReact/external \"@babel/runtime/helpers/esm/objectWithoutProperties\"","webpack://MovaiReact/external \"@material-ui/core/Typography\"","webpack://MovaiReact/./src/Components/Viewer/NodeItem/KeyPoint.js","webpack://MovaiReact/external \"@material-ui/core/IconButton\"","webpack://MovaiReact/external \"@material-ui/core/FormControl\"","webpack://MovaiReact/external \"@material-ui/core/Divider\"","webpack://MovaiReact/./src/Components/Viewer/Utils/Clipboard.js","webpack://MovaiReact/external \"@material-ui/icons/Search\"","webpack://MovaiReact/./src/Components/Viewer/TreeObject/TreeObject.js","webpack://MovaiReact/external \"@material-ui/core/Grid\"","webpack://MovaiReact/external \"@material-ui/icons/ChevronRight\"","webpack://MovaiReact/./src/Components/Viewer/NodeItem/NavigationPreviewItem.js","webpack://MovaiReact/external \"react-dom\"","webpack://MovaiReact/external \"@material-ui/core/Input\"","webpack://MovaiReact/external \"@material-ui/core/Menu\"","webpack://MovaiReact/external \"@babylonjs/gui/2D\"","webpack://MovaiReact/external \"@material-ui/core/Select\"","webpack://MovaiReact/external \"@material-ui/core/Avatar\"","webpack://MovaiReact/external \"@babylonjs/gui\"","webpack://MovaiReact/external \"@material-ui/icons/Clear\"","webpack://MovaiReact/external \"@material-ui/core/InputLabel\"","webpack://MovaiReact/external \"clsx\"","webpack://MovaiReact/./src/Components/Viewer/TreeObject/TreeNode.js","webpack://MovaiReact/external \"@material-ui/core/Button\"","webpack://MovaiReact/external \"@material-ui/icons/Close\"","webpack://MovaiReact/external \"lodash/debounce\"","webpack://MovaiReact/external \"@material-ui/icons/ExpandMore\"","webpack://MovaiReact/external \"react-resize-detector\"","webpack://MovaiReact/./src/Components/Viewer/NodeItem/Box.js","webpack://MovaiReact/./src/Components/Viewer/Utils/Animator.js","webpack://MovaiReact/external \"@material-ui/icons/Settings\"","webpack://MovaiReact/external \"lodash/isEqual\"","webpack://MovaiReact/external \"@material-ui/core/CircularProgress\"","webpack://MovaiReact/external \"@material-ui/core/colors\"","webpack://MovaiReact/external \"roslib\"","webpack://MovaiReact/./src/Components/Viewer/Utils/TreeServerUtils.js","webpack://MovaiReact/external \"@material-ui/core/InputAdornment\"","webpack://MovaiReact/external \"@material-ui/core/ListItemText\"","webpack://MovaiReact/external \"@material-ui/core/Checkbox\"","webpack://MovaiReact/external \"@material-ui/pickers\"","webpack://MovaiReact/external \"react-virtualized\"","webpack://MovaiReact/external \"lodash/set\"","webpack://MovaiReact/external \"lodash/cloneDeep\"","webpack://MovaiReact/external \"@material-ui/core/List\"","webpack://MovaiReact/external \"lodash/capitalize\"","webpack://MovaiReact/external \"@material-ui/core/TableCell\"","webpack://MovaiReact/external \"@material-ui/core/FormHelperText\"","webpack://MovaiReact/external \"@material-ui/lab/Alert\"","webpack://MovaiReact/./node_modules/style-loader/dist/runtime/injectStylesIntoStyleTag.js","webpack://MovaiReact/./node_modules/css-loader/dist/runtime/api.js","webpack://MovaiReact/external \"@material-ui/icons/Schedule\"","webpack://MovaiReact/external \"@material-ui/icons/Warning\"","webpack://MovaiReact/external \"@material-ui/icons/ViewModule\"","webpack://MovaiReact/external \"@material-ui/icons/Chat\"","webpack://MovaiReact/external \"@material-ui/core/Drawer\"","webpack://MovaiReact/external \"@material-ui/core/Collapse\"","webpack://MovaiReact/external \"material-table\"","webpack://MovaiReact/external \"@material-ui/icons/AddBox\"","webpack://MovaiReact/external \"@material-ui/icons/ArrowDownward\"","webpack://MovaiReact/external \"@material-ui/icons/Check\"","webpack://MovaiReact/external \"@material-ui/icons/ChevronLeft\"","webpack://MovaiReact/external \"@material-ui/icons/DeleteOutline\"","webpack://MovaiReact/external \"@material-ui/icons/Edit\"","webpack://MovaiReact/external \"@material-ui/icons/FilterList\"","webpack://MovaiReact/external \"@material-ui/icons/FirstPage\"","webpack://MovaiReact/external \"@material-ui/icons/LastPage\"","webpack://MovaiReact/external \"@material-ui/icons/Remove\"","webpack://MovaiReact/external \"@material-ui/icons/SaveAlt\"","webpack://MovaiReact/external \"@material-ui/icons/ViewColumn\"","webpack://MovaiReact/external \"@material-ui/core/Tabs\"","webpack://MovaiReact/external \"@material-ui/core/Tab\"","webpack://MovaiReact/external \"@material-ui/core/TextField\"","webpack://MovaiReact/external \"@material-ui/core/FormControlLabel\"","webpack://MovaiReact/external \"@material-ui/core/Switch\"","webpack://MovaiReact/external \"@material-ui/core/InputBase\"","webpack://MovaiReact/external \"@material-ui/core/Breadcrumbs\"","webpack://MovaiReact/external \"@material-ui/icons/NavigateNext\"","webpack://MovaiReact/./resources/movai_red.svg","webpack://MovaiReact/external \"earcut\"","webpack://MovaiReact/external \"@babylonjs/core/Maths/math\"","webpack://MovaiReact/external \"lodash/uniqBy\"","webpack://MovaiReact/external \"lodash.isequal\"","webpack://MovaiReact/external \"@babel/runtime/helpers/esm/toArray\"","webpack://MovaiReact/external \"@material-ui/core/utils\"","webpack://MovaiReact/external \"@babel/runtime/helpers/esm/taggedTemplateLiteral\"","webpack://MovaiReact/external \"styled-components\"","webpack://MovaiReact/external \"@material-ui/core/styles/colorManipulator\"","webpack://MovaiReact/external \"@material-ui/icons/Label\"","webpack://MovaiReact/external \"@material-ui/core/Chip\"","webpack://MovaiReact/external \"@material-ui/icons/Add\"","webpack://MovaiReact/external \"@material-ui/icons/Today\"","webpack://MovaiReact/external \"@date-io/date-fns\"","webpack://MovaiReact/external \"@babel/runtime/helpers/esm/typeof\"","webpack://MovaiReact/external \"lodash/isEmpty\"","webpack://MovaiReact/./src/Components/LoginForm/movai_red.svg","webpack://MovaiReact/external \"@material-ui/core/Paper\"","webpack://MovaiReact/external \"react-virtualized-tree\"","webpack://MovaiReact/external \"@material-ui/core/Box\"","webpack://MovaiReact/external \"@material-ui/core/Backdrop\"","webpack://MovaiReact/external \"@material-ui/styles\"","webpack://MovaiReact/external \"jwt-decode\"","webpack://MovaiReact/external \"@babylonjs/core/Debug/debugLayer\"","webpack://MovaiReact/external \"@babylonjs/inspector\"","webpack://MovaiReact/external \"@babylonjs/loaders\"","webpack://MovaiReact/./node_modules/timers-browserify/main.js","webpack://MovaiReact/(webpack)/buildin/global.js","webpack://MovaiReact/external \"setimmediate\"","webpack://MovaiReact/./src/Components/Snackbar/Snackbar.css?c276","webpack://MovaiReact/./src/Components/Snackbar/Snackbar.css","webpack://MovaiReact/external \"fontsource-roboto\"","webpack://MovaiReact/external \"fontsource-open-sans\"","webpack://MovaiReact/./src/Components/Logs/Logs.css?4c9f","webpack://MovaiReact/./src/Components/Logs/Logs.css","webpack://MovaiReact/external \"material-icons/css/material-icons.css\"","webpack://MovaiReact/external \"react-virtualized/styles.css\"","webpack://MovaiReact/external \"react-virtualized-tree/lib/main.css\"","webpack://MovaiReact/./src/Components/Button.js","webpack://MovaiReact/./src/Components/Modal/AbstractModal.js","webpack://MovaiReact/./src/Components/Modal/ConfirmAlertModal.js","webpack://MovaiReact/./src/Components/Modal/RobotLogModal.js","webpack://MovaiReact/./src/Components/Drawer.js","webpack://MovaiReact/./src/Components/Collapse.js","webpack://MovaiReact/./src/Components/VerticalBar.js","webpack://MovaiReact/./src/Components/ContextMenu.js","webpack://MovaiReact/./src/Components/Table.js","webpack://MovaiReact/./src/Components/Tabs.js","webpack://MovaiReact/./src/Components/Text.js","webpack://MovaiReact/./src/Components/Toggle.js","webpack://MovaiReact/./src/Components/SearchInput.js","webpack://MovaiReact/./src/Components/Breadcrumb.js","webpack://MovaiReact/./src/Components/Viewer/Utils/LoadingScreen.js","webpack://MovaiReact/./src/Components/Viewer/BaseViewer/BaseViewer.js","webpack://MovaiReact/./src/Components/Viewer/Actions/Action.js","webpack://MovaiReact/./src/Components/Viewer/NodeItem/AssetNodeItem.js","webpack://MovaiReact/./src/Components/Viewer/NodeItem/Map.js","webpack://MovaiReact/./src/Components/Viewer/Utils/DefaultScene.js","webpack://MovaiReact/./src/Components/Viewer/Actions/MouseKeysAction.js","webpack://MovaiReact/./src/Components/Viewer/Utils/Utils.js","webpack://MovaiReact/./src/Components/Viewer/MainView/MeshSelector.js","webpack://MovaiReact/./src/Components/Viewer/Util3d/SelectionPlaceHolder.js","webpack://MovaiReact/./src/Components/Viewer/Actions/DragObjectsAction.js","webpack://MovaiReact/./src/Components/Viewer/Actions/AddKeyPointAction.js","webpack://MovaiReact/./src/Components/Viewer/NodeItem/BoxRegion.js","webpack://MovaiReact/./src/Components/Viewer/Actions/BoxRegionAction.js","webpack://MovaiReact/./src/Components/Viewer/Actions/DrawPathAction.js","webpack://MovaiReact/./src/Components/Viewer/NodeItem/PolygonRegion.js","webpack://MovaiReact/./src/Components/Viewer/Actions/PolygonRegionAction.js","webpack://MovaiReact/./src/Components/Viewer/Actions/OrbitAction.js","webpack://MovaiReact/./src/Components/Viewer/Actions/DrawGraphAction.js","webpack://MovaiReact/./src/Components/Viewer/Actions/MeasureAction.js","webpack://MovaiReact/./src/Components/Viewer/Actions/NavigationPreviewAction.js","webpack://MovaiReact/./src/Components/Viewer/MainView/MainViewActions.js","webpack://MovaiReact/./src/Components/Viewer/AssetsManager/MapLoader.js","webpack://MovaiReact/./resources/alert-error.png","webpack://MovaiReact/./src/Components/Viewer/Utils/Statistics.js","webpack://MovaiReact/./src/Components/Viewer/NodeItem/Robot.js","webpack://MovaiReact/./src/Components/Viewer/AssetsManager/AssetsManager.js","webpack://MovaiReact/./src/Components/Viewer/Actions/AddMapAction.js","webpack://MovaiReact/./src/Components/Viewer/NodeItem/PointCloud.js","webpack://MovaiReact/./src/Components/Viewer/Utils/MeshCache.js","webpack://MovaiReact/./src/Components/Viewer/Utils/MeshLoader.js","webpack://MovaiReact/./src/Components/Viewer/Actions/RobotAction.js","webpack://MovaiReact/./src/Components/Viewer/NodeItem/Mesh.js","webpack://MovaiReact/./src/Components/Viewer/Actions/AddMeshAction.js","webpack://MovaiReact/./src/Components/Viewer/Utils/AssetsTypesFactory.js","webpack://MovaiReact/./src/Components/Viewer/NodeItem/Wall.js","webpack://MovaiReact/./src/Components/Viewer/MainView/NodeItemFactoryMap.js","webpack://MovaiReact/./src/Components/Viewer/MainView/MainViewRetriever.js","webpack://MovaiReact/./src/Components/Viewer/Utils/SceneServerUtils.js","webpack://MovaiReact/./src/Components/Viewer/Utils/DefaultMouseEvents.js","webpack://MovaiReact/./src/Components/Viewer/SceneViewer.js","webpack://MovaiReact/./src/Components/Select.js","webpack://MovaiReact/./src/Components/Snackbar/Alert/svg-icons/CreateSVGIcon.js","webpack://MovaiReact/./src/Components/Snackbar/Alert/svg-icons/svgIcons.js","webpack://MovaiReact/./src/Components/Snackbar/Alert/Alert.js","webpack://MovaiReact/./src/Components/Snackbar/Snackbar.js","webpack://MovaiReact/./src/styles/Themes.js","webpack://MovaiReact/./src/styles/Style.js","webpack://MovaiReact/./src/Components/Logs/LogsFilterBar/FiltersIcon/FiltersIcon.js","webpack://MovaiReact/./src/Components/Logs/LogsFilterBar/LogsFilterBar.js","webpack://MovaiReact/./src/Components/Logs/utils/Utils.js","webpack://MovaiReact/./src/Components/Logs/LogsTable/LogsTable.js","webpack://MovaiReact/./src/Components/Logs/Logs.js","webpack://MovaiReact/./src/Components/LoginForm/LoginForm.js","webpack://MovaiReact/./src/Components/ProfileMenu.js","webpack://MovaiReact/./src/Components/Tree/TreeSearch.js","webpack://MovaiReact/./src/Components/Tree/BasicVirtualizedTree.js","webpack://MovaiReact/./src/Components/Modal/SelectScopeModal.js","webpack://MovaiReact/./src/Components/HOCs/withOfflineValidation.js","webpack://MovaiReact/./src/Components/HOCs/withAuthentication.js"],"names":["root","factory","exports","module","define","amd","window","installedModules","__webpack_require__","moduleId","i","l","modules","call","m","c","d","name","getter","o","Object","defineProperty","enumerable","get","r","Symbol","toStringTag","value","t","mode","__esModule","ns","create","key","bind","n","object","property","prototype","hasOwnProperty","p","s","require","Vec3","array","length","Error","scale","constructor","Array","this","vec3","x","op","a","b","operation","ans","map","f","Math","sqrt","dot","Vector3","Vec2","y","v","index","reduce","e","binary","initialValue","max","Number","MAX_VALUE","min","some","isNaN","isFinite","babylon","z","of","random","u","identityMatrix","e1","e2","e3","pivot","add","normalize","w","sub","Mat3","v1","v2","v3","mat3","prodVec","dotVec","mat","equals","babylonMat","arrayMat","Matrix","GetAsMatrix3x3","GizmoManagerBuilder","scene","_scene","_isPosition","_isRotation","_isBoundingBox","_isScale","_usePointerToAttachGizmos","gizmoManager","GizmoManager","positionGizmoEnabled","rotationGizmoEnabled","boundingBoxGizmoEnabled","scaleGizmoEnabled","usePointerToAttachGizmos","CameraBuilder","_sphericalCoordinates","_target","_name","floor","sphericalCoordinates","target","values","forEach","ArcRotateCamera","PositionalLightBuilder","_position","_intensity","position","intensity","light","PointLight","ReferentialBuilder","_isPickable","_boxParams","isVisible","size","_size","isPickable","boxParams","axisX","Mesh","CreateLines","Zero","color","Color3","axisY","axisZ","localOrigin","MeshBuilder","CreateBox","parent","GroundBuilder","_width","_height","_textureSrc","width","height","textureSrc","ground","CreateGround","translate","Space","WORLD","material","StandardMaterial","ambientTexture","Texture","uScale","vScale","TooltipBuilder","mesh","_mesh","_thickness","_linkOffsetX","_linkOffsetY","_background","_alpha","_scaleX","_scaleY","_cornerRadius","_text","_color","_fontSize","_padding","linkOffsetX","linkOffsetY","background","alpha","scaleX","scaleY","cornerRadius","text","fontSize","padding","builder","advancedTexture","AdvancedDynamicTexture","CreateFullscreenUI","useInvalidateRectOptimization","tooltipBox","Rectangle","addControl","thickness","transformCenterX","transformCenterY","adaptWidthToChildren","adaptHeightToChildren","linkWithMesh","textBlock","TextBlock","textVerticalAlignment","Control","VERTICAL_ALIGNMENT_TOP","textHorizontalAlignment","HORIZONTAL_ALIGNMENT_CENTER","paddingTop","paddingBottom","paddingLeft","paddingRight","resizeToFit","actionManager","ActionManager","scaleXAnimation","Animation","ANIMATIONTYPE_FLOAT","ANIMATIONLOOPMODE_CONSTANT","scaleYAnimation","keys","frame","setKeys","animations","push","registerAction","ExecuteCodeAction","OnPointerOverTrigger","_","beginAnimation","OnPointerOutTrigger","DirectionalLightBuilder","_direction","direction","DirectionalLight","MaterialCache","instance","materialCacheBySceneId","count","sceneId","_uid","Maybe","fromNull","flatMap","materialCache","ofNull","cata","Util3d","localPosition","GlobalRef","NAME","ofBabylon","meshParent","meshParentPos","meshParentRotMat","getRotationMatrix","meshParentScaling","scaling","mul","getGlobalCoordinates","withTranslation","ZERO","childPos","getGlobalCoord","toBabylon","positionInWorld","forwardCoordinates","worldPosition","getLocalCoordFromGlobal","inverseScaling","getLocalCoordFromWorld","localRotationMatrix","maybeQuaternion","rotationQuaternion","quaternion","toRotationMatrix","orElseRun","Quaternion","RotationYawPitchRoll","rotation","ofBabylonMatrix","Red","normals","getVerticesData","VertexBuffer","NormalKind","positions","PositionKind","lines","FromArray","scaleInPlace","normalLines","CreateLineSystem","uArray","subtract","Dot","faces","updatable","vertexData","VertexData","indices","applyToMesh","polygon","triangulation","earcut","len","i3","vec3Poly","orientation","edge","arrayOfPoints","randomDigits","diffuseColor","emissiveColor","camera","Camera","ORTHOGRAPHIC_CAMERA","aspect","getEngine","getAspectRatio","distance","orthoLeft","orthoRight","orthoBottom","orthoTop","PERSPECTIVE_CAMERA","begin","end","radius","arrowTube","createTubeFromPoints","Gray","arrowCone","createOrientedCone","arrowMesh","tooltipText","build","callback","OnPickDownTrigger","unfreeze","White","setTimeout","freeze","parentView","rootMesh","getRootNode","item","arrayOfVector3","transform","isArray","segments","surface","orthogonalBasisFromVector","sign","Cross","theta","PI","cos","sin","zeroIndex","uIndex","meshFromPositionAndFaces","convertToFlatShadedMesh","materialName","MATERIAL_CACHE","orLazy","getMaterialFromColor","put","diameter","sphere","CreateSphere","Box","DEFAULT_SIZE","box","points","CreateTube","path","sideOrientation","DOUBLESIDE","cap","CAP_ALL","pickInfo","pick","pointerX","pointerY","hit","pickedPoint","none","isEnabled","pickedMesh","curve","orientations","atan2","nbPoints","closed","Curve3","CreateCatmullRomSpline","getPoints","splineObj","getCurveOrientations","vertex","VERTEX","frag","FRAG","onBindObservable","SHADER_BIND","preProcessShader","SHADER_PRE","shaderMaterial","ShaderMaterial","vertexSource","fragmentSource","attributes","uniforms","nodeItem","getType","Path","TYPE","time","T","Date","getTime","dt","setFloat","setVector3","activeCamera","lights","backFaceCulling","getInstance","Constants","RADIUS","POINTS_DENSITY","CLOUD_FUNCTION_NAME","NAV_CLOUD_NAME","RAD2DEG","DEG2RAD","DEBUG","SCENE_BACKGROUND","dark","Black","default","localPath","keyPoints","splinePath","mainView","weight","keyValueMap","selectedKeyPointIndex","dict","schema","jsonSchema","properties","type","title","uiSchema","selectedMesh","toArray","data","props","newSchema","oldName","annotations","form","selectedKeyPoint","formPosition","newPosInWorldCoordinates","parseFloat","localPos","observers","notifyObservers","updatedPointMesh","is2updateServer","updatePathEdgeWithForm","getGraph","graphItem","graph","filter","graphVertex","edgeIds","id","getEdge","edgeData","updateNodeInServer","ofDict","isForceUpdate","nameGenerator","mousePosFromRoot","someMainView","copiedPath","pathItem","kp","undefined","every","updateGraph","spline","getSplineFromCurve","orSome","Identity","splineObj2redis","createPlaceHolderKeyPoints","path2return","point","onClick","getMeshOnClick","Observable","getMeshObserver","newPoints","keyPointUpdateFunction","defaultKeyPointUpdate","oldMesh","average","pointAverage","newMesh","rotMat3","scaleVec3","averageInParentCoord","visibility","getMouseContextActions","oldKeyPoints","childrenCopy","_children","getNodeFromTree","isJust","clear","dispose","keyPointMesh","copyPosition","getUndoManager","doIt","getUndoDeleteKeyPoint","UndoManager","actionBuilder","doAction","copyPoints","splice","createNewMeshFromOldUsingNewPoints","onAddNewPointKeyPointUpdate","undoAction","is2UpdateInServer","getUndoAddKeyPointInBetween","nextIndex","numberOfPoints","oldPoints","concat","specialIndex","oldKpMeshes","isTopologyChange","edgeMeshes","firstLastKpNeighborEdges","firstLastOldKp","oldEdge","edges","getNeighbors","doMeshesBelong2SamePath","neigh","vp","delVertexFromMesh","addEdge","importFeatures","neighborEdges","edgeVertexObj","oldNeighEdge","isInteger","left","right","leftPath","rightPath","j","leftPathName","rightPathName","mergeName","leftChildren","rightChildren","leftDict","toDict","rightPointsInLeftCoord","absolutePosition","pointAverageVec3","getSceneMemory","newPath","LOCAL","addNodeItem2Tree","addEdgesInKeyPoints","child","updateNodeItemInTree","newChildPos","deleteNodeFromTreeUsingName","oldPaths","children","keyPointMeshes","GraphItem","createGraphItemIfNone","NodeItem","closeContextDial","node","keypoints","displacement","k","vertexObs","kChild","getConeMesh","pseudoItem","curveMesh","getSphereMesh","keyPoint","highlightMeshesInScene","setProperties","toForm","getKeyPointObserverFunction","setContextActions","actions","pathTreeNode","icon","className","action","deleteKeyPointWithUndo","addKeyPointInBetween","getKeyPointActions","pathName","edgesByCurveBoundary","oldPath","oldCenter","pathParent","splitAtIndex","splitPath","boundary","middlePoint","centeredCurve","colorArray","clone","quaternionArray","numberOfSplits","newKeyPoints","newEdge","splitCurve","oldPathItem","oldPathName","oldPathNameSplit","leftSplit","rightSplit","unSplitCurve","getKpMouseContextActions","onDel","nextSplinePoint","currentSplinePoint","createSphere","THETA","ROS_ORIGIN","rosOrigin","getRosOrigin","globalRefMesh","referentialBuilder","mapDict2Mesh","orUndefined","rotationMatrix","pos","abs","AnnotationManager","observersBySceneId","retrieveAnnotationsFromDb","lambda","MasterDB","subscribe","Scope","Name","console","log","actionMap","del","annotation","delAnnotation","set","addAnnotation","Annotation","event","names2delete","annotationType","names","includes","labels","annotationObj","Type","toLowerCase","label","Label","getAnnotations","Clipboard","copy","getCopyFunction","onDeleteNode","delVertex","q","g","info","euler","toEulerAngles","setAnnotations2Form","angles","deg","FromEulerAngles","old","getUID","rootItem","copyDict","newPosArray","copiedNodeItem","childrenWithDelVertex","childMesh","someDict","babylonQuaternion","babylonColor","_capitalize","scopeList","replace","toString","vec","acc","fromArray","biLambda","fold","initial","vector3","Graph","edgeKey","addVertex","edgeProps","ijKey","jiKey","isSome","split","getUniqueId","graphItemInstances","isDisposed","graphPlaceHolder","getGraphPlaceHolder","graphFormMapper","getDefaultFormMapper","edgeMesh","getUndoDeleteEdgeLineAction","confirmationAlert","message","onConfirm","getUndoDeleteEdge","vLocal","getToFormEdge","isMeshBelong2Path","meshByEdgeId","vertexGenerator","vertices","getVertices","getEdges","getVertex","String","ids","key2Edge","belongsSrcMesh","belongsTrgMesh","belongsSrc","exportBelongToData","belongsTrg","checkInvalidEdges","ofForm","edgeIndexes","lodashGet","delVertexRecursively","iMesh","jMesh","iIndex","jIndex","hasEdge","buildVertex","buildEdge","getVertexIdFromMesh","delEdge","maybeV","orNull","iParentNodeItem","jParentNodeItem","newPosition","iData","jData","isInvalidEdge","nodeTree","vertexMesh","vertexIndex","vId","addObs2VertexMesh","vData","getVertexMeshObs","newPos","updateVertexPosition","sort","iVertexD","jVertexD","EdgeData","getDirectionFromMeshes","getEdgeMesh","edgeInGlobal","Yellow","getEdgeMaterial","speed","getEdgeMouseCtxActions","onDeleteEdgeLine","addObserver2EdgeMesh","addOnClickEdge","getEdgeObs","getOnClickEdge","getUndoDelLineEdge","edgeVertexD","srcMesh","getMeshName","trgMesh","vertexCounter","MIN_VALUE","getMeshesFromEdgeData","dataEdge","vertexPosition","frequency","getShaderMaterial","firstMesh","secondMesh","validateDirection","firstMeshParent","secondMeshParent","validationError","getNodeItemTypeFromMesh","origin","KeyPoint","One","ind","vertexDataI","vertexDataJ","freq","toFixed","CreatePolyhedron","custom","TRIANGULAR_ANTIPRISM","axis","category","face","COPY_PASTE_UID","Clip","write","read","compareTreesRecursive","treeA","treeB","nodeEquality","nodeA","nodeB","expand","expanded","filterTree","tree","predicate","result","nod","flatten","TreeObject","getNodeRecursive","answer","childPredicate","getParentNodeRecursive","nodeMap","mapRecursive","newTree","mappedNode","forEachRecursive","MESSAGES","NavigationPreviewItem","poses","robotConfig","arrowMeshes","createArrowMeshes","navPath","createNavPath","arrow","config","pose","beginPos","endPos","getArrow","getChildren","Green","getArrowObserver","highlightNodesInTree","NavigationPath","play","navPreviewItem","navItem","pathPromise","getPathFromService","then","pathPoses","getNavigationPathMesh","animator","getAnimator","stop","Animator","initialState","nextState","iPrev","iNext","ceil","updateVerticesData","pointCloudMesh","disableLighting","pointsCloud","pointSize","colors","fill","startPose","endPose","ros","Ros","url","BRIDE_CONNECTION","inputMessage","sceneName","robot_config","initial_pose","rosPoseFromPose","final_pose","Promise","res","on","error","getDefaultPath","navigationService","Service","SERVICE_NAME","serviceType","SERVICE_TYPE","request","ServiceRequest","callService","close","msg","resolve","cloudFunction","success","getPathFromPoses","err","showAlert","samples","start","startPos","nextPoint","nextNextPoint","splineCage","polyInterpolation","re","cage","tail","pairs","lerp","TreeNode","isStatic","TreeNodeBuilder","_title","_item","_expanded","_isVisible","_isStatic","maybeDict","boxMesh","createBox","state","next","doWhile","requestAnimeId","requestAnimationFrame","cancelAnimationFrame","AnimatorBuilder","_state","_next","_end","TreeServerUtils","undoManager","alert","objectTree","getNode","childName","getParentNode","is2delInServer","deleteNodeInServer","getParentFromChild","parentNode","parentName","is2addInServer","staticNodeTypes","node2Add","maybeParentNode","addNodeItem2Server","undo","setImmediate","warn","treeNode","_debounce","utils","lostConnection","memo","isOldIE","Boolean","document","all","atob","getTarget","styleTarget","querySelector","HTMLIFrameElement","contentDocument","head","stylesInDom","getIndexByIdentifier","identifier","modulesToDom","list","options","idCountMap","identifiers","base","obj","css","media","sourceMap","references","updater","addStyle","insertStyleElement","style","createElement","nonce","setAttribute","insert","appendChild","textStore","replaceText","replacement","join","applyToSingletonTag","remove","styleSheet","cssText","cssNode","createTextNode","childNodes","removeChild","insertBefore","applyToTag","removeAttribute","btoa","unescape","encodeURIComponent","JSON","stringify","firstChild","singleton","singletonCounter","update","styleIndex","removeStyleElement","newObj","lastIdentifiers","newList","newLastIdentifiers","_i","_index","useSourceMap","content","cssMapping","sourceMapping","base64","sourceURLs","sources","source","sourceRoot","cssWithMappingToString","mediaQuery","dedupe","alreadyImportedModules","self","apply","Function","Timeout","clearFn","_id","_clearFn","scope","arguments","clearTimeout","setInterval","clearInterval","timeout","unref","ref","enroll","msecs","_idleTimeoutId","_idleTimeout","unenroll","_unrefActive","active","_onTimeout","global","clearImmediate","api","locals","___CSS_LOADER_API_IMPORT___","Button","variant","startIcon","disabled","propTypes","PropTypes","func","string","isRequired","element","bool","defaultProps","useStyles","makeStyles","theme","card","margin","overflow","display","flexDirection","maxHeight","closeButton","cursor","textColor","top","AbstractModal","classes","debounceSubmit","onSubmit","submit","cancel","onCancel","onKeyPress","open","onClose","alignItems","justifyContent","minWidth","minHeight","flexGrow","overflowY","component","marginBottom","hasSubmitButton","submitColor","submitText","hasCancelButton","cancelColor","cancelText","ConfirmAlertModal","RobotLogModal","hasButton","alertButton","button","parse","toLocaleTimeString","robot","service","buttonText","buttonAction","getRobotAlertAction","setState","primary","breakWord","maxWidth","renderAlertInfo","Component","withStyles","wordBreak","withTheme","Drawer","anchor","ANCHOR","bottom","Collapse","React","useState","setOpen","useEffect","clickLambda","iconStyle","divided","in","container","backgroundColor","logoArea","textAlign","navigationArea","accountArea","unsetAccountAreaPadding","VerticalBar","upperElement","navigationList","lowerElement","ContextMenu","anchorEl","setAnchorEl","handleClose","cloneElement","evt","currentTarget","keepMounted","menuList","tableIcons","Add","forwardRef","Check","Clear","Delete","DetailPanel","Edit","Export","Filter","FirstPage","LastPage","NextPage","PreviousPage","ResetSearch","Search","SortArrow","ThirdStateCheck","ViewColumn","Table","columns","icons","components","localization","actionsColumnIndex","draggable","grouping","search","toolbar","searchFieldAlignment","paging","TabPanel","selectedTab","other","role","hidden","aria-labelledby","any","tabPanel","Tabs","setSelectedTab","onChange","newSelectedTab","indicatorColor","tabList","tab","a11yProps","scrollable","number","Text","fontFamily","fontStyle","fontWeight","marginLeft","marginRight","colorSwitchBase","grey","green","colorBar","colorChecked","Toggle","control","checked","toggle","onToggle","switchBase","track","labelPlacement","SearchInput","searchInput","enableTimeout","timer","handleSearch","placeholder","searchIcon","setSearchInput","inputRoot","input","inputInput","inputProps","handleChange","borderRadius","shape","fade","palette","common","white","spacing","breakpoints","up","pointerEvents","transition","transitions","marginTop","link","textDecoration","lastLabel","Breadcrumb","separator","aria-label","pathList","function","LoadingScreen","loadingUIText","loadingUIBackgroundColor","displayLoadingUI","getElementById","hideLoadingUI","FLEX_STYLE","loaderContainer","zIndex","loaderImage","BaseViewer","antialias","engineOptions","adaptToDeviceRatio","sceneOptions","onRender","onSceneReady","is2render","sceneFactory","rest","useTheme","reactCanvas","useRef","loaded","setLoaded","setScene","setSize","engine","Engine","current","loadingScreen","nScene","runRenderLoop","render","renderScene","Scene","isReady","onReadyObservable","addOnce","setUpScene","clearColor","src","loader","alt","handleWidth","handleHeight","onResize","resize","preserveDrawingBuffer","stencil","Action","memory","attachedMesh","attachControl","canvas","setContextActionIndex","AssetNodeItem","assetName","Map","DefaultScene","get_browser","tem","ua","navigator","userAgent","M","match","test","version","exec","appName","appVersion","RotationGizmo","UtilityLayerRenderer","xGizmo","dragBehavior","detach","scaleRatio","yGizmo","COLLISION_RADIUS","cameraBuilder","inertia","collisionRadius","panningInertia","checkCollisions","panningSensibility","lowerRadiusLimit","browser","wheelPrecision","directionalLightBuilder","wireframe","collisionsEnabled","debugLayer","show","embedMode","globalRoot","body","overlay","MouseKeysAction","selectOneAction","predicateActionList","defaultAction","predicateAction","MeshSelector","placeHolderInstance","meshSelectionSet","Set","isSubtractive","has","meshes","filteredSet","SelectionPlaceHolder","arrayOfMeshes","angleByMeshName","_uniqBy","getAngleFromMesh","placeHolderPosition","createPlaceHolderIn","getSelPlaceHolderShader","that","addGizmo2Mesh","ofMainView","isSelectionPlaceHolder","HEIGHT","getPlaceHolderObs","placeHolder","filteredMeshes","dTheta","localDisplacement","handleTranslation","baseCoord","toVec2","rV","prod","finalV","finalTheta","handleRotation","handleMotion","obs","DragObjectsAction","setSelectedAction","buttons","ctrlKey","maybeSelectedMesh","pickMesh","currentMesh","dragDownMesh","dragDownWithoutMesh","getGroundPosition","groundPos","dragMoveMesh","dragMoveWithoutMesh","dragUpMesh","dragUpWithoutMesh","destroySelectionDiv","corners","code","getDeleteAction","getCopyAction","getPasteAction","setMouseContextActions","getPasteOnClick","pasteAction","paste","notifyChildrenObserversRecursively","setPropertiesWithName","clickPointInWorld","movePointInWorld","startDivPos","detachControl","addSelectedMesh","handleMeshRightClick","updateMouseVars","selectMeshUpdateUI","meshSelector","selectionPlaceHolder","selectedMeshes","addGizmo2Name","getMouseCoordsFromRoot","mousePosRoot","handleRightClickWithoutMesh","shiftKey","createSelectionDiv","selector","newMousePosInWorld","updateSelectionDiv","selectPlaceHolder","bigDisplacement","isBigDisplacement","isBigDisplaceOrIsEdgeMesh","addIt","getUndoAbleAction","addArray","mergePathsIfAny","selectObjectsInside","groundPosInGlobal","isOne","maybeNode","renderMenus","selectPlaceHolderMesh","copyOne","copyMany","uuid","itemCopyFunctions","maybeCopiedItem","copiedMesh","nodeItems","uuids","copiedItems","itemCopyFunction","toGlobalCoord","maybe","copiedMeshes","copiedNames","forceUpdate","meshesStruct","keypointIndex","sendMesh","finalDisplacement","moveMesh","dir","maybeNodeItem","None","nodeMesh","findMouseInDom","outerDiv","ID","ReactDOM","newMouse","oldMouse","minX","minY","maxX","maxY","clientX","clientY","rayCastCorners","pickPoints","insideBoxDragAbleMeshes","getObjectTree","isItemInsideBox","floorPoint","isMeshInsideBox","planeP","isPointInsideBox","epsilon","vi","vii","acos","isKeyPointMesh","ray","hits","multiPickWithRay","keyPointHits","hitMesh","first","second","areKeyPointsCompatible","firstPath","secondPath","mergePaths","unMergePaths","SelectDiv","border","borderColor","AddKeyPointAction","maybeMousePos","mousePos","oldMousePos","tempMesh","createKeyPoint","TEMP_KEY_POINT_NAME","setPositionWithLocalVector","Axis","Z","BoxRegion","lower","worldCorners","oldDimensions","dimensions","isEqual","ofFormDimensions","newLowerPositionInWorldCoordinates","newLocalDimensions","localLowerPosition","notify","createBoxRegionMesh","VISIBILITY","FACES","boxRegion","X","Y","h","boxRegionMesh","boxRegionTreeNode","newBox","saveZ","createNewMeshFromOldUsingNewBox","corner","BoxRegionAction","createBoxRegion","TEMP_BOX_REGION_NAME","region","localRegion","centeredRegion","boxRegionItem","DrawPathAction","mouseCurve","getUndoAbleEnterAction","spherePlaceHolder","getUndoAbleClickAction","createPointInCurve","kps","finalKps","TEMP_PATH_NAME","createCurve","getDrawPathContextAction","reducedKps","slice","addKeyPointPlaceHolder","contextActions","localCurve","deleteEdgeInKeyPoints","oldPosition","insertPointInCurve","groundPosInWorld","localGround","sortedDistances","minIndex","localPathB","positiveMod","Utils","mod","PolygonRegion","localPolygon","navigationAllowed","newJsonSchema","createExtrudedPolygonMesh","reverseOrientation","triangleIndex","polygonRegionMesh","lowerTriangulation","triangulatePolygon","upperTriangulation","stitchTriangulation","computeOrientation","modi","stitchingBoundaries","polygonTreeNode","getAbsolutePosition","polygonMesh","PolygonRegionAction","TEMP_POLYGON_REGION_NAME","getDrawPolygonContextAction","polygonRegionItem","createPolygonRegion","OrbitAction","DrawGraphAction","setEnabled","mousePosConsumer","maybeMesh","isConnectableMesh","possibleMesh","onPointerDownLine","resetPreview","firstMousePos","onPointerMoveLine","deletePreviewMeshes","firstClickedMesh","previewMeshes","meshI","meshJ","belongsToPath","nameI","nameJ","clickedMesh","belongs2SamePath","getUndoAbleLineEdge","createEdge","deleteEdge","edgeEmbedding","Blue","graphNode","MeasureAction","resetMeasure","currentMousePos","ruler","rulerMesh","createRulerMesh","addTextGUI","calculateDistance","pressure","deltaY","startVec","endVec","removeControl","NavigationPreviewAction","uIInOut","resetData","maybeFirstClickPos","firstClickPos","secondClickPos","previewPoseMesh","createPreviewPose","poseMesh","poseMeshes","createNavPreviewNode","maxLength","finalLength","finalEnd","navName","navPreviewNode","ACTIONS","viewOnly","measure","orbit","robotPreview","reactFactory","drawGraph","drawRegion","addKeyPoint","drawBoxRegion","drawPath","dragObjects","MapLoader","yamlSrc","cachedMap","fetch","getMapUrl","response","parseYaml","image","resolution","imageSize","yamlTxt","actionDict","getImageSize","reject","img","Image","onload","naturalWidth","naturalHeight","Statistics","_count","_mean","_M2","delta","delta2","NaN","sigmas","zScore","mean","variance","Robot","meshTree","oldTimeInMillis","robotAnimator","requestAnimationFrameId","updateRobot","getRobotManager","getRobot","isOnline","numberOfIte","is2UsePos","timeSinceLastUpdate","isSubscribedToLogs","speedStats","loggerSubscription","qSpeed","newOri","alertMesh","buildAlertMesh","robotIP","getIP","onGetIP","startLogger","addClickActionToMesh","onMeshAlertClick","CreateDisc","billboardMode","BILLBOARDMODE_ALL","showRobotAlertModal","ip","stopLogger","unsubscribe","propValue","subscribeToLogs","updateAlertState","is2RemoveAlertMesh","unsubscribeToLogs","logs","level","newRobotTf","lastPosition","lastOrientation","newOrientation","dtInv","vel","SAMPLES","isOutlier","TIME_2_BE_OFFLINE_IN_SEC","toOffline","toOnline","createRobotMeshTreeRecursive","robotTree","robotMesh","RobotBuilder","robotName","robotMeshName","ROBOT_MESH_NAME","randomId","nodeDict","meshName","rotate","updateTF","tf","_get","updateRobotMeshTree","onLoad","onUpdate","robot2Animate","someNaNOrInfinite","setOnOffLine","_meshTree","_parentMesh","_parentView","_keyValueMap","_assetName","parentMesh","AssetsManager","assets","assetsActionMap","retrieveAssetsFromDb","RobotName","getRobotUpdate","getRobotNameSub","addRobots","finishSub","Parameter","getRobotMeshSub","File","FileLabel","getMapUpdater","getMapSubscriber","getMeshUpdater","getMeshSubscriber","place","finishInitialSubscribers","subs","afterLoad","isLoading","robots","delAsset","dataGetter","after","getMapFileData","fileName","addMap","filename","ASSETS_TYPES","addAsset","maybeGet","getMeshFileData","observer","assetKey","asset","AssetsTypesFactory","signalObservers","rej","localRobot","createBaseObject","setRobot","Value","pattern","patterns","deleteRobot","robotId","prop","AddMapAction","mapLoader","firstTimeLoad","load","groundBuilder","xOrigin","yOrigin","yawOrigin","originPos","rootNode","inverseCoordinates","setTarget","is2sendServer","createMeshGround","getUndoAction","oldMapName","newMapName","switchMaps","getAssetsActionMap","PointCloud","pointCloudSubscribe","front_lidar","updatePointCloud","MeshCache","meshCacheBySceneId","meshCache","cloneMesh","MeshLoader","mapFunction","transformMesh","hasKey","assetsManager","meshTask","addMeshTask","MESH_URL","onSuccess","task","loadedMeshes","onError","exception","assetType","onFinish","meshParam","Float32Array","newNormals","numberOfVertices","setVerticesData","RobotAction","robotAnimatorFactory","getDefaultAnimator","errorCallback","addRobot","createRobotMeshTree","cloudPoint","parentObj","actionMemoryClone","loadRobot","createRobotFromMesh","getParentMesh","isImport","animate","getCloudPoint","AddMeshAction","getIsImport","finalName","getFinalNameFromMemory","loadMesh","actionMemory","createNormals","meshItem","addMesh","addMesh2Scene","getSocketAnimator","Wall","localWall","createWallMesh","centeredWall","tangent","normal","wallMesh","wallNode","newWall","locallyTranslate","wall","NODE_ITEM_FACTORY_MAP","MainViewRetriever","serverScene","updateErrorList","errors","importSceneRecursive","importDefaultScene","nodeItemClass","isAsset","importAsset","assetActionMap","retrievedAction","defaultRobot","cause","solution","arrayTree","sortArrayTree","importNodeItem","SceneServerUtils","successCallback","DEFAULT_SUCCESS","failCallback","DEFAULT_FAILURE","successFailIf","failureLocation","DefaultMouseEvents","mousePosClick","mousePosMove","sceneMemory","mouseLocationText","currentLocal","setMouseLocationTxt","panCamera","vBabylon","worldFrameMesh","matrix","getWorldVector","vdt","animateCamera","filterActions","SceneViewer","robotManager","ofScene","newObjectTree","focusObject","isPanned","_absolutePosition","cameraSpeed","targetPos","beta","isRotated","onPointerDown","onPointerUp","onPointerMove","afterLoading","retrieveScene","errorList","importScene","resizeGround","assetManager","getAssets","loadAssets","retrieveSceneFromServer","setCameraToTarget","getRenderingCanvas","addCanvasEventListeners","createMouseLocationText","createCamera","createLight","createGizmo","highlightLayer","layer","HighlightLayer","lastHlMeshes","robotAlertModal","prevProps","propVar","loadScene","RobotManager","createRef","el","addEventListener","defaultSize","getWorldExtends","diff","is2Small","getRobots","clearObserver","resetErrorList","createScene","getErrorSolutionList","masterProps","augmentProps","formControl","Select","noneOption","hiddenLabel","labelId","CreateSVGIcon","viewBox","xmlns","xmlnsXlink","svgIcons","Close","ErrorOutline","InfoOutlined","ReportProblemOutlined","SuccessOutlined","defaultIconMapping","warning","Alert","closeText","iconMapping","severity","clsx","capitalize","oneOf","filledSuccess","filledInfo","filledWarning","filledError","opacity","ReactConfirmAlert","closeOnClickOutside","onClickOutside","isClickOutside","removeBodyClass","removeElementReconfirm","closeOnEscape","onKeypressEscape","isKeyCodeEscape","keyCode","keyboardClose","autoClose","autoHideDuration","removeEventListener","willUnmount","customUI","closable","dom","handleClickOverlay","renderCustomUI","elevation","unmountComponentAtNode","classList","snackbar","divTarget","createElementReconfirm","CONSTANTS","borderBottom","secondary","themeFactory","particular","typography","h1","h2","h3","h4","h5","h6","body1","cursorDefault","cursorPointer","Themes","createMuiTheme","bottomNavigation","globalStats","subTextColor","upperTextColor","main","accent","hoverColor","table","stripColor","verticalBar","iconColor","overrides","MuiTableCell","MuiAppBar","colorDefault","colorInherit","MuiButton","outlined","contained","containedPrimary","containedSecondary","MuiButtonGroup","groupedContainedPrimary","groupedOutlined","groupedText","MuiIconButton","MuiListItem","MuiFormControlLabel","MuiInputBase","font","MuiFilledInput","underline","Roboto","OpenSans","MuiPaper","MuiTableRow","localStorage","getItem","setItem","Style","createGlobalStyle","S","StyledMenu","paper","boxShadow","getContentAnchorEl","anchorOrigin","vertical","horizontal","transformOrigin","autoFocus","FilterIcon","otherFilters","tooltip","Fragment","handleClick","isActive","iconActive","buttonApplyFilters","checkbox","limitText","flex","searchText","addTagText","toggleContainer","tagsContainer","tagsList","chip","filtersButton","columnsFilter","iconButton","LogsFilterBar","isAdvancedMode","tagText","setTagText","handleRobotChange","arrayEvent","selectedId","updateRobotSelection","fillRule","clipRule","multiple","selectedRobots","renderValue","selected","selectedNames","isSelected","MenuProps","robotIndex","messageRegex","handleMessageRegex","InputProps","startAdornment","endAdornment","levels","handleLevels","levelsList","elem","indexOf","advancedMode","FiltersIcon","tags","onKeyUp","handleAddTag","onDelete","handleDeleteTag","selectedFromDate","selectedToDate","DateFnsUtils","ampm","newDate","handleDateChange","format","handleAdvancedMode","limit","handleLimit","InputLabelProps","shrink","handleColumns","columnList","column","PaperProps","ITEM_HEIGHT","arePropsEqual","nextProps","_isEqual","selectToDate","colorCoding","INFO","WARNING","ERROR","CRITICAL","findsUniqueKey","keyName","getRequestLevels","levelsArray","getRequestTags","tagsArray","_isEmpty","tag","getRequestMessage","parsedMessageToUrl","binaryIndexOf","criteria","currentIndex","maxIndex","comparison","filterByFromToDates","logsData","fromDate","toDate","lowerIndex","upperIndex","dateList","flexContainer","boxSizing","flip","tableRow","tableRowHover","tableCell","whiteSpace","textOverflow","flexColumn","noClick","MuiVirtualizedTable","rowHeight","headerHeight","onRowClick","tableProps","getRowClassName","rowData","cellRenderer","cellData","columnIndex","align","numeric","gridStyle","rowClassName","dataKey","headerRenderer","headerProps","LogsTable","rowCount","rowGetter","UI_TAG","Logs","robotsData","setSelectedRobots","findIndex","logsTimeout","getLogs","robotState","robotStates","off","getRobotLogData","dataArrays","prevState","finalArray","dataArray","robotSelected","timeoutHandle","dynamicURL","logModal","divElement","clientHeight","updateSelectedRobots","tagToDelete","filteredTags","keyToChange","simpleLevelsList","advancedLevelsList","tableContainer","timestamp","battery","temp","okay","serverTime","toLocaleDateString","getJustDateFromServer","Time","getJustTimeFromServer","Level","Module","Message","LoginForm","username","password","remember","errorMessage","capsLockOn","Authentication","login","apiResponse","setLoggedIn","capsLock","getModifierState","logo","justify","defaultLogo","gutterBottom","htmlFor","aria-describedby","checkCapsLock","sendCreds","loggedIn","menuItemSpacing","profileMenuFooter","ProfileMenu","aria-controls","aria-haspopup","welcomeLabel","userName","extraItems","darkThemeLabel","handleToggleTheme","isDarkTheme","handleLogout","logoutLabel","TreeSearch","inputRef","focus","trim","isEmpty","resetValue","ListItemsTree","dense","ListItemsTreeWithSearch","onSearch","Children","testArray","BasicVirtualizedTree","selectedGroup","groupsEnabled","searchValue","nodes","searchValueLower","filteredNodes","ch","grandChild","searchFilter","onClickNode","onDoubleClick","onDoubleClickNode","preContainer","inlineFlex","alignContent","handleExpansion","spaceBetween","ellipsis","oneOfType","horizFlex","iconSpace","SelectScopeModal","initialData","setData","selectedWorkspace","setSelectedWorkspace","selectedScopeItem","setSelectedScopeItem","workSpaceList","setWorkSpaceList","setIsLoading","scopeFilteredData","Workspace","getAll","getAllData","filteredData","_cloneDeep","pronoun","workspace","dataToSet","getDocs","sortedScopeItems","scopes","localeCompare","xs","allowArchive","overflowX","mapObj","0","indexToSet","isExpanded","_set","1","parents","versionList","versions","index2ndLevel","2","deepness","requestScopeVersions","showIcons","withOfflineValidation","isConnected","setConnected","showSuccessAlert","setSuccessAlert","validator","setValidator","loading","setLoading","_validator","offlineValidation","onOnline","onOffline","retryConnection","withAuthentication","firstRender","checkLogin","setCheckLogin","now","token","expDelta","jwtDecode","exp","handleLogOut","logout"],"mappings":"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","file":"dist/index.js","sourcesContent":["(function webpackUniversalModuleDefinition(root, factory) {\n\tif(typeof exports === 'object' && typeof module === 'object')\n\t\tmodule.exports = factory();\n\telse if(typeof define === 'function' && define.amd)\n\t\tdefine([], factory);\n\telse if(typeof exports === 'object')\n\t\texports[\"MovaiReact\"] = factory();\n\telse\n\t\troot[\"MovaiReact\"] = factory();\n})(window, function() {\nreturn "," \t// The module cache\n \tvar installedModules = {};\n\n \t// The require function\n \tfunction __webpack_require__(moduleId) {\n\n \t\t// Check if module is in cache\n \t\tif(installedModules[moduleId]) {\n \t\t\treturn installedModules[moduleId].exports;\n \t\t}\n \t\t// Create a new module (and put it into the cache)\n \t\tvar module = installedModules[moduleId] = {\n \t\t\ti: moduleId,\n \t\t\tl: false,\n \t\t\texports: {}\n \t\t};\n\n \t\t// Execute the module function\n \t\tmodules[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n\n \t\t// Flag the module as loaded\n \t\tmodule.l = true;\n\n \t\t// Return the exports of the module\n \t\treturn module.exports;\n \t}\n\n\n \t// expose the modules object (__webpack_modules__)\n \t__webpack_require__.m = modules;\n\n \t// expose the module cache\n \t__webpack_require__.c = installedModules;\n\n \t// define getter function for harmony exports\n \t__webpack_require__.d = function(exports, name, getter) {\n \t\tif(!__webpack_require__.o(exports, name)) {\n \t\t\tObject.defineProperty(exports, name, { enumerable: true, get: getter });\n \t\t}\n \t};\n\n \t// define __esModule on exports\n \t__webpack_require__.r = function(exports) {\n \t\tif(typeof Symbol !== 'undefined' && Symbol.toStringTag) {\n \t\t\tObject.defineProperty(exports, Symbol.toStringTag, { value: 'Module' });\n \t\t}\n \t\tObject.defineProperty(exports, '__esModule', { value: true });\n \t};\n\n \t// create a fake namespace object\n \t// mode & 1: value is a module id, require it\n \t// mode & 2: merge all properties of value into the ns\n \t// mode & 4: return value when already ns object\n \t// mode & 8|1: behave like require\n \t__webpack_require__.t = function(value, mode) {\n \t\tif(mode & 1) value = __webpack_require__(value);\n \t\tif(mode & 8) return value;\n \t\tif((mode & 4) && typeof value === 'object' && value && value.__esModule) return value;\n \t\tvar ns = Object.create(null);\n \t\t__webpack_require__.r(ns);\n \t\tObject.defineProperty(ns, 'default', { enumerable: true, value: value });\n \t\tif(mode & 2 && typeof value != 'string') for(var key in value) __webpack_require__.d(ns, key, function(key) { return value[key]; }.bind(null, key));\n \t\treturn ns;\n \t};\n\n \t// getDefaultExport function for compatibility with non-harmony modules\n \t__webpack_require__.n = function(module) {\n \t\tvar getter = module && module.__esModule ?\n \t\t\tfunction getDefault() { return module['default']; } :\n \t\t\tfunction getModuleExports() { return module; };\n \t\t__webpack_require__.d(getter, 'a', getter);\n \t\treturn getter;\n \t};\n\n \t// Object.prototype.hasOwnProperty.call\n \t__webpack_require__.o = function(object, property) { return Object.prototype.hasOwnProperty.call(object, property); };\n\n \t// __webpack_public_path__\n \t__webpack_require__.p = \"\";\n\n\n \t// Load entry module and return exports\n \treturn __webpack_require__(__webpack_require__.s = 147);\n","module.exports = require(\"react\");","module.exports = require(\"@babel/runtime/helpers/esm/defineProperty\");","module.exports = require(\"@babylonjs/core\");","module.exports = require(\"@babel/runtime/helpers/esm/assertThisInitialized\");","module.exports = require(\"prop-types\");","import { Vector3 } from \"@babylonjs/core\";\nimport Vec2 from \"./Vec2\";\n\n/**\n * Class that describes immutable 3-vectors\n */\nclass Vec3 {\n  //no for's because performance\n  constructor(array) {\n    if (array.constructor !== Array || array.length < 3)\n      throw new Error(`${array} is not a valid 3-vector`);\n    this.vec3 = [...array];\n  }\n\n  get x() {\n    return this.vec3[0];\n  }\n\n  get y() {\n    return this.vec3[1];\n  }\n\n  get z() {\n    return this.vec3[2];\n  }\n\n  add(x) {\n    return this.op(x, (a, b) => a + b);\n  }\n\n  sub(x) {\n    return this.op(x, (a, b) => a - b);\n  }\n\n  mul(x) {\n    return this.op(x, (a, b) => a * b);\n  }\n\n  op(x, operation) {\n    const ans = [];\n    ans[0] = operation(this.vec3[0], x.vec3[0]);\n    ans[1] = operation(this.vec3[1], x.vec3[1]);\n    ans[2] = operation(this.vec3[2], x.vec3[2]);\n    return new Vec3(ans);\n  }\n\n  scale(r) {\n    return this.map(x => x * r);\n  }\n\n  dot(x) {\n    return (\n      this.vec3[0] * x.vec3[0] +\n      this.vec3[1] * x.vec3[1] +\n      this.vec3[2] * x.vec3[2]\n    );\n  }\n\n  map(f) {\n    return new Vec3(this.vec3.map(f));\n  }\n\n  length() {\n    return Math.sqrt(this.dot(this));\n  }\n\n  normalize = () => {\n    const l = this.length();\n    if (l === 0) throw new Error(\"You can't normalize a zero norm vector\");\n    return this.scale(1 / l);\n  };\n\n  toBabylon() {\n    return new Vector3(this.vec3[0], this.vec3[1], this.vec3[2]);\n  }\n\n  toArray() {\n    return this.vec3;\n  }\n\n  toVec2() {\n    return new Vec2(this.x, this.y);\n  }\n\n  equals(v) {\n    if (v.constructor !== this.constructor) return false;\n    return v.vec3\n      .map((x, index) => v.vec3[index] === x)\n      .reduce((e, v) => e && v, true);\n  }\n\n  reduce(binary, initialValue) {\n    return this.vec3.reduce(binary, initialValue);\n  }\n\n  getMax() {\n    return this.reduce((a, b) => Math.max(a, b), -Number.MAX_VALUE);\n  }\n\n  getMin() {\n    return this.reduce((a, b) => Math.min(a, b), Number.MAX_VALUE);\n  }\n\n  someNaNOrInfinite() {\n    return this.vec3.some(x => isNaN(x) || !isFinite(x));\n  }\n\n  static ofBabylon(babylon) {\n    return new Vec3([babylon.x, babylon.y, babylon.z]);\n  }\n\n  static of(array) {\n    return array ? new Vec3(array) : new Vec3([0, 0, 0]);\n  }\n\n  static fromArray(array) {\n    return Vec3.of(array);\n  }\n\n  static random() {\n    return new Vec3([1, 2, 3].map(Math.random()));\n  }\n\n  /**\n   *\n   * @param {*} u: Vec3\n   */\n  static orthogonalBasisFromVector(u) {\n    const identityMatrix = [Vec3.e1, Vec3.e2, Vec3.e3];\n    //choose pivot\n    let pivot = 0;\n    for (let i = 0; i < 3; i++) {\n      if (u.vec3[i] !== 0) {\n        pivot = i;\n        break;\n      }\n    }\n    let v = identityMatrix[(pivot + 1) % 3].add(\n      identityMatrix[pivot].scale(-u.vec3[(pivot + 1) % 3] / u.vec3[pivot])\n    );\n    v = v.normalize();\n    let w = identityMatrix[(pivot + 2) % 3].add(\n      identityMatrix[pivot].scale(-u.vec3[(pivot + 2) % 3] / u.vec3[pivot])\n    );\n    w = w.normalize();\n    w = w.sub(v.scale(v.dot(w)));\n    return { u: u.normalize(), v: v, w: w.normalize() };\n  }\n\n  static ONES = Vec3.of([1, 1, 1]);\n  static ZERO = Vec3.of([0, 0, 0]);\n  static e1 = new Vec3([1, 0, 0]);\n  static e2 = new Vec3([0, 1, 0]);\n  static e3 = new Vec3([0, 0, 1]);\n}\n\nexport default Vec3;\n","module.exports = require(\"@babel/runtime/helpers/esm/getPrototypeOf\");","module.exports = require(\"@babel/runtime/helpers/esm/classCallCheck\");","import Vec3 from \"./Vec3\";\nimport { Matrix } from \"@babylonjs/core\";\n\nclass Mat3 {\n  constructor(v1, v2, v3) {\n    const v = [v1, v2, v3];\n    for (let i = 0; i < v.length; i++) {\n      if (v[i].constructor !== Array || v[i].length < 3)\n        throw Error(\"One of the inputs is not a array\");\n    }\n    this.mat3 = v.map(x => new Vec3(x));\n  }\n\n  /**\n   * Matrix prod with  3-vector\n   * @param {*} v: 3-vector\n   *\n   * returns 3-vector\n   */\n  prodVec(v) {\n    let ans = new Vec3([0, 0, 0]);\n    for (let i = 0; i < this.mat3.length; i++) {\n      ans = ans.add(this.mat3[i].scale(v.vec3[i]));\n    }\n    return ans;\n  }\n\n  /**\n   * Matrix transpose prod with 3-vec\n   * @param {*} v : 3-vector\n   */\n  dotVec(v) {\n    const ans = [0, 0, 0];\n    for (let i = 0; i < this.mat3.length; i++) {\n      ans[i] = this.mat3[i].dot(v);\n    }\n    return new Vec3(ans);\n  }\n\n  prod(m) {\n    const u = this.prodVec(m.mat3[0]);\n    const v = this.prodVec(m.mat3[1]);\n    const w = this.prodVec(m.mat3[2]);\n    return new Mat3(u.vec3, v.vec3, w.vec3);\n  }\n\n  dot(m) {\n    const u = this.dotVec(m.mat3[0]);\n    const v = this.dotVec(m.mat3[1]);\n    const w = this.dotVec(m.mat3[2]);\n    return new Mat3(u.vec3, v.vec3, w.vec3);\n  }\n\n  map(f) {\n    const u = this.mat3[0].map(f);\n    const v = this.mat3[1].map(f);\n    const w = this.mat3[2].map(f);\n    return new Mat3(u.vec3, v.vec3, w.vec3);\n  }\n\n  equals(mat) {\n    if (mat.constructor !== this.constructor) return false;\n    return this.mat3\n      .map((v, index) => v.equals(mat.mat3[index]))\n      .reduce((e, v) => e && v, true);\n  }\n\n  static ofBabylonMatrix(babylonMat) {\n    const arrayMat = Matrix.GetAsMatrix3x3(babylonMat);\n    const u = [arrayMat[0], arrayMat[1], arrayMat[2]];\n    const v = [arrayMat[3], arrayMat[4], arrayMat[5]];\n    const w = [arrayMat[6], arrayMat[7], arrayMat[8]];\n    return new Mat3(u, v, w);\n  }\n\n  static of(v1, v2, v3) {\n    return new Mat3(v1, v2, v3);\n  }\n\n  static eye() {\n    return new Mat3([1, 0, 0], [0, 1, 0], [0, 0, 1]);\n  }\n}\n\nexport default Mat3;\n","import { GizmoManager } from \"@babylonjs/core\";\n\nclass GizmoManagerBuilder {\n  constructor(scene) {\n    this._scene = scene;\n    this._isPosition = false;\n    this._isRotation = false;\n    this._isBoundingBox = false;\n    this._isScale = false;\n    this._usePointerToAttachGizmos = false;\n  }\n\n  isPosition(v) {\n    this._isPosition = v;\n    return this;\n  }\n\n  isRotation(v) {\n    this._isRotation = v;\n    return this;\n  }\n\n  isBoundingBox(v) {\n    this._isBoundingBox = v;\n    return this;\n  }\n\n  isScale(v) {\n    this._isScale = v;\n    return this;\n  }\n\n  usePointerToAttachGizmos(v) {\n    this._usePointerToAttachGizmos = v;\n    return this;\n  }\n\n  build() {\n    const gizmoManager = new GizmoManager(this._scene);\n    gizmoManager.positionGizmoEnabled = this._isPosition;\n    gizmoManager.rotationGizmoEnabled = this._isRotation;\n    gizmoManager.boundingBoxGizmoEnabled = this._isBoundingBox;\n    gizmoManager.scaleGizmoEnabled = this._isScale;\n    gizmoManager.usePointerToAttachGizmos = this._usePointerToAttachGizmos;\n    return gizmoManager;\n  }\n}\n\nexport default GizmoManagerBuilder;\n","import { ArcRotateCamera } from \"@babylonjs/core\";\n\nclass CameraBuilder {\n  constructor(scene) {\n    this._scene = scene;\n    this._sphericalCoordinates = null;\n    this._target = null;\n    this._name = `camera${Math.floor(Math.random() * 1e3)}`;\n  }\n\n  name(name) {\n    this._name = name;\n    return this;\n  }\n\n  sphericalCoordinates(sphericalCoordinates) {\n    this._sphericalCoordinates = sphericalCoordinates;\n    return this;\n  }\n\n  target(target) {\n    this._target = target;\n    return this;\n  }\n\n  build() {\n    const variables = Object.values(this);\n    variables.forEach(x => {\n      if (x === null)\n        throw new Error(\n          `There are missing variables to build a camera, e.g ${x}`\n        );\n    });\n    return new ArcRotateCamera(\n      this._name,\n      this._sphericalCoordinates.x,\n      this._sphericalCoordinates.y,\n      this._sphericalCoordinates.z,\n      this._target,\n      this._scene\n    );\n  }\n}\n\nexport default CameraBuilder;\n","import { PointLight } from \"@babylonjs/core\";\n\nclass PositionalLightBuilder {\n  constructor(scene) {\n    this._scene = scene;\n    this._position = null;\n    this._name = `light${Math.floor(Math.random() * 1e3)}`;\n    this._intensity = 1;\n  }\n\n  position(position) {\n    this._position = position;\n    return this;\n  }\n\n  name(name) {\n    this._name = name;\n    return this;\n  }\n\n  intensity(intensity) {\n    this._intensity = intensity;\n    return this;\n  }\n\n  build() {\n    const variables = Object.values(this);\n    variables.forEach(x => {\n      if (x === null)\n        throw new Error(\n          `There are missing variables to build a light, e.g ${x}`\n        );\n    });\n    const light = new PointLight(this._name, this._position, this._scene);\n    light.intensity = this._intensity;\n    return light;\n  }\n}\n\nexport default PositionalLightBuilder;\n","import { Mesh, Vector3, Color3, MeshBuilder } from \"@babylonjs/core\";\nclass ReferentialBuilder {\n  constructor(scene) {\n    this._scene = scene;\n    this._name = `referential${Math.floor(Math.random() * 1e3)}`;\n    this._isPickable = true;\n    this._boxParams = { isVisible: true, size: 0.25 };\n    this._size = 1;\n  }\n\n  name(name) {\n    this._name = name;\n    return this;\n  }\n\n  isPickable(isPickable) {\n    this._isPickable = isPickable;\n    return this;\n  }\n\n  boxParams(boxParams) {\n    this._boxParams = boxParams;\n    return this;\n  }\n\n  size(size) {\n    this._size = size;\n    return this;\n  }\n\n  build() {\n    const size = this._size;\n    const axisX = Mesh.CreateLines(\n      `axisX${this._name}`,\n      [\n        new Vector3.Zero(),\n        new Vector3(size, 0, 0),\n        new Vector3(size * 0.95, 0.05 * size, 0),\n        new Vector3(size, 0, 0),\n        new Vector3(size * 0.95, -0.05 * size, 0)\n      ],\n      this._scene\n    );\n    axisX.color = new Color3(1, 0, 0);\n    axisX.isPickable = false;\n    const axisY = Mesh.CreateLines(\n      `axisY${this._name}`,\n      [\n        new Vector3.Zero(),\n        new Vector3(0, size, 0),\n        new Vector3(-0.05 * size, size * 0.95, 0),\n        new Vector3(0, size, 0),\n        new Vector3(0.05 * size, size * 0.95, 0)\n      ],\n      this._scene\n    );\n    axisY.color = new Color3(0, 1, 0);\n    axisY.isPickable = false;\n    const axisZ = Mesh.CreateLines(\n      `axisZ${this._name}`,\n      [\n        new Vector3.Zero(),\n        new Vector3(0, 0, size),\n        new Vector3(0, -0.05 * size, size * 0.95),\n        new Vector3(0, 0, size),\n        new Vector3(0, 0.05 * size, size * 0.95)\n      ],\n      this._scene\n    );\n    axisZ.color = new Color3(0, 0, 1);\n    axisZ.isPickable = false;\n\n    const localOrigin = MeshBuilder.CreateBox(\n      this._name,\n      { size: this._boxParams.size },\n      this._scene\n    );\n    localOrigin.isVisible = this._boxParams.isVisible;\n    localOrigin.isPickable = this._isPickable;\n\n    axisX.parent = localOrigin;\n    axisY.parent = localOrigin;\n    axisZ.parent = localOrigin;\n\n    return localOrigin;\n  }\n}\n\nexport default ReferentialBuilder;\n","import {\n  Mesh,\n  Vector3,\n  StandardMaterial,\n  Texture,\n  Space\n} from \"@babylonjs/core\";\n\nclass GroundBuilder {\n  constructor(scene) {\n    this._scene = scene;\n    this._name = `camera${Math.floor(Math.random() * 1e3)}`;\n    this._width = 1;\n    this._height = 1;\n    this._textureSrc = null;\n    this._isPickable = false;\n  }\n\n  name(name) {\n    this._name = name;\n    return this;\n  }\n\n  width(width) {\n    this._width = width;\n    return this;\n  }\n\n  height(height) {\n    this._height = height;\n    return this;\n  }\n\n  textureSrc(textureSrc) {\n    this._textureSrc = textureSrc;\n    return this;\n  }\n\n  isPickable(isPickable) {\n    this._isPickable = isPickable;\n    return this;\n  }\n\n  build() {\n    const ground = Mesh.CreateGround(\n      this._name,\n      this._width,\n      this._height,\n      1,\n      this._scene\n    );\n    ground.translate(new Vector3(0, -1, 0), 1e-1, Space.WORLD);\n    if (this._textureSrc) {\n      ground.material = new StandardMaterial(\n        `Texture${this._name}`,\n        this._scene\n      );\n      ground.material.ambientTexture = new Texture(\n        this._textureSrc,\n        this._scene\n      );\n      ground.material.ambientTexture.uScale = 1;\n      ground.material.ambientTexture.vScale = 1;\n    }\n    ground.isPickable = this._isPickable;\n    return ground;\n  }\n}\n\nexport default GroundBuilder;\n","import { Animation, ActionManager, ExecuteCodeAction } from \"@babylonjs/core\";\nimport {\n  Rectangle,\n  TextBlock,\n  Control,\n  AdvancedDynamicTexture\n} from \"@babylonjs/gui\";\n\nclass TooltipBuilder {\n  constructor(mesh, scene) {\n    this._mesh = mesh;\n    this._scene = scene;\n    this._name = `tooltip${Math.floor(Math.random() * 1e3)}`;\n    // Tooltip box (Rectangle) properties\n    this._width = null;\n    this._height = null;\n    this._thickness = 2;\n    this._linkOffsetX = \"100px\";\n    this._linkOffsetY = \"-50px\";\n    this._background = \"grey\";\n    this._alpha = 0.7;\n    this._scaleX = 0;\n    this._scaleY = 0;\n    this._cornerRadius = 30;\n    // Tooltip text (TextBlock) properties\n    this._text = \"\";\n    this._color = \"White\";\n    this._fontSize = 14;\n    this._padding = \"20px\";\n  }\n\n  name(name) {\n    this._name = name;\n    return this;\n  }\n\n  mesh(mesh) {\n    this._mesh = mesh;\n    return this;\n  }\n\n  // Rectangle properties\n\n  width(width) {\n    this._width = width;\n    return this;\n  }\n\n  height(height) {\n    this._height = height;\n    return this;\n  }\n\n  linkOffsetX(linkOffsetX) {\n    this._linkOffsetX = linkOffsetX;\n    return this;\n  }\n\n  linkOffsetY(linkOffsetY) {\n    this._linkOffsetY = linkOffsetY;\n    return this;\n  }\n\n  background(background) {\n    this._background = background;\n    return this;\n  }\n\n  alpha(alpha) {\n    this._alpha = alpha;\n    return this;\n  }\n\n  scaleX(scaleX) {\n    this._scaleX = scaleX;\n    return this;\n  }\n\n  scaleY(scaleY) {\n    this._scaleY = scaleY;\n    return this;\n  }\n\n  cornerRadius(cornerRadius) {\n    this._cornerRadius = cornerRadius;\n    return this;\n  }\n\n  // Tooltip properties\n\n  text(text) {\n    this._text = text;\n    return this;\n  }\n\n  color(color) {\n    this._color = color;\n    return this;\n  }\n\n  fontSize(fontSize) {\n    this._fontSize = fontSize;\n    return this;\n  }\n\n  padding(padding) {\n    this._padding = padding;\n    return this;\n  }\n\n  build() {\n    // GUI\n    const builder = this;\n    const advancedTexture = AdvancedDynamicTexture.CreateFullscreenUI(\"UI\");\n    advancedTexture.useInvalidateRectOptimization = false;\n    // Set tooltip rectangle box\n    const tooltipBox = new Rectangle(this._name);\n    advancedTexture.addControl(tooltipBox);\n    tooltipBox.thickness = 2;\n    if (this._width) tooltipBox.width = this._width;\n    if (this._height) tooltipBox.height = this._height;\n    tooltipBox.linkOffsetX = this._linkOffsetX;\n    tooltipBox.linkOffsetY = this._linkOffsetY;\n    tooltipBox.transformCenterX = 0;\n    tooltipBox.transformCenterY = 1;\n    tooltipBox.background = this._background;\n    tooltipBox.alpha = this._alpha;\n    tooltipBox.scaleX = this._scaleX;\n    tooltipBox.scaleY = this._scaleY;\n    tooltipBox.cornerRadius = this._cornerRadius;\n    tooltipBox.adaptWidthToChildren = true;\n    tooltipBox.adaptHeightToChildren = true;\n    tooltipBox.linkWithMesh(this._mesh);\n    // Set tooltip text block\n    const textBlock = new TextBlock();\n    textBlock.text = this._text;\n    textBlock.color = this._color;\n    textBlock.fontSize = this._fontSize;\n    textBlock.textVerticalAlignment = Control.VERTICAL_ALIGNMENT_TOP;\n    textBlock.textHorizontalAlignment = Control.HORIZONTAL_ALIGNMENT_CENTER;\n    tooltipBox.addControl(textBlock);\n    textBlock.alpha = 1 / textBlock.parent.alpha;\n    textBlock.paddingTop = this._padding;\n    textBlock.paddingBottom = this._padding;\n    textBlock.paddingLeft = this._padding;\n    textBlock.paddingRight = this._padding;\n    textBlock.resizeToFit = true;\n    // Set mesh action manager\n    const actionManager = new ActionManager(this._scene);\n    this._mesh.actionManager = actionManager;\n    // Animation to show/hide tooltip\n    const scaleXAnimation = new Animation(\n      \"tooltipAnimation\",\n      \"scaleX\",\n      30,\n      Animation.ANIMATIONTYPE_FLOAT,\n      Animation.ANIMATIONLOOPMODE_CONSTANT\n    );\n    const scaleYAnimation = new Animation(\n      \"tooltipAnimation\",\n      \"scaleY\",\n      30,\n      Animation.ANIMATIONTYPE_FLOAT,\n      Animation.ANIMATIONLOOPMODE_CONSTANT\n    );\n    const keys = [\n      {\n        frame: 0,\n        value: 0\n      },\n      {\n        frame: 10,\n        value: 1\n      }\n    ];\n    scaleXAnimation.setKeys(keys);\n    scaleYAnimation.setKeys(keys);\n    tooltipBox.animations = [];\n    tooltipBox.animations.push(scaleXAnimation);\n    tooltipBox.animations.push(scaleYAnimation);\n    // Register actions: OnPointerOverTrigger\n    actionManager.registerAction(\n      new ExecuteCodeAction(ActionManager.OnPointerOverTrigger, function (_) {\n        builder._scene.beginAnimation(tooltipBox, 0, 10, false);\n      })\n    );\n    // Register actions: OnPointerOutTrigger\n    actionManager.registerAction(\n      new ExecuteCodeAction(ActionManager.OnPointerOutTrigger, function (_) {\n        builder._scene.beginAnimation(tooltipBox, 10, 0, false);\n      })\n    );\n    return textBlock;\n  }\n}\n\nexport default TooltipBuilder;\n","import { DirectionalLight } from \"@babylonjs/core\";\n\nclass DirectionalLightBuilder {\n  constructor(scene) {\n    this._scene = scene;\n    this._direction = null;\n    this._name = `Dlight${Math.floor(Math.random() * 1e3)}`;\n    this._intensity = 1;\n  }\n\n  direction(direction) {\n    this._direction = direction;\n    return this;\n  }\n\n  name(name) {\n    this._name = name;\n    return this;\n  }\n\n  intensity(intensity) {\n    this._intensity = intensity;\n    return this;\n  }\n\n  build() {\n    const variables = Object.values(this);\n    variables.forEach(x => {\n      if (x === null)\n        throw new Error(\n          `There are missing variables to build a light, e.g ${x}`\n        );\n    });\n    const light = new DirectionalLight(\n      this._name,\n      this._direction.normalize(),\n      this._scene\n    );\n    light.intensity = this._intensity;\n    return light;\n  }\n}\n\nexport default DirectionalLightBuilder;\n","import { Maybe } from \"monet\";\n/**\n * Material cache for each scene.\n *\n * Each material is associated with a scene therefore we must have a cache per scene.\n *\n * TODO: to similar with mesh cache, therefore there is possibility of abstraction\n *\n */\nclass MaterialCache {\n  constructor() {\n    if (instance) return instance;\n    instance = this;\n    this.materialCacheBySceneId = {};\n    this.count = 0;\n  }\n\n  static getInstance() {\n    return new MaterialCache();\n  }\n\n  hasKey(key, scene) {\n    const sceneId = scene._uid;\n    return Maybe.fromNull(this.materialCacheBySceneId[sceneId])\n      .flatMap(materialCache => ofNull(materialCache[key]))\n      .cata(\n        () => false,\n        () => true\n      );\n  }\n\n  put(key, scene, material) {\n    const sceneId = scene._uid;\n    if (!(sceneId in this.materialCacheBySceneId)) {\n      this.materialCacheBySceneId[sceneId] = {};\n    }\n    this.materialCacheBySceneId[sceneId][key] = material;\n    return this;\n  }\n\n  get(key, scene) {\n    const sceneId = scene._uid;\n    return Maybe.fromNull(this.materialCacheBySceneId[sceneId])\n      .flatMap(materialCache => ofNull(materialCache[key]))\n      .map(material => {\n        this.count++;\n        return material;\n      });\n  }\n\n  del(scene) {\n    const sceneId = scene._uid;\n    if (sceneId in this.materialCacheBySceneId) {\n      delete this.materialCacheBySceneId[sceneId];\n    }\n  }\n}\n\nconst ofNull = x => Maybe.fromNull(x);\n// private instance\nlet instance = null;\nexport default MaterialCache;\n","import Vec3 from \"../Math/Vec3\";\nimport Mat3 from \"../Math/Mat3\";\nimport { Maybe } from \"monet\";\nimport GizmoManagerBuilder from \"./GizmoManagerBuilder.js\";\nimport CameraBuilder from \"./CameraBuilder\";\nimport PositionalLightBuilder from \"./PositionalLightBuilder\";\nimport ReferentialBuilder from \"./ReferentialBuilder\";\nimport GroundBuilder from \"./GroundBuilder\";\nimport TooltipBuilder from \"./TooltipBuilder\";\nimport DirectionalLightBuilder from \"./DirectionalLightBuilder\";\nimport earcut from \"earcut\";\nimport {\n  Vector3,\n  Color3,\n  Quaternion,\n  StandardMaterial,\n  VertexData,\n  Mesh,\n  Matrix,\n  MeshBuilder,\n  VertexBuffer,\n  Curve3,\n  ActionManager,\n  ExecuteCodeAction,\n  ShaderMaterial,\n  Camera\n} from \"@babylonjs/core\";\nimport GlobalRef from \"../NodeItem/GlobalRef\";\nimport Box from \"../NodeItem/Box\";\nimport Path from \"../NodeItem/Path\";\nimport MaterialCache from \"../Utils/MaterialCache\";\n\nclass Util3d {\n  /**\n   *\n   * @param {*} mesh\n   * @param {*} localPosition: Vector3\n   * @returns Vec3\n   */\n  static getGlobalCoordinates(mesh, localPosition) {\n    if (\n      (mesh.parent && mesh.parent.name === GlobalRef.NAME) ||\n      mesh.name === GlobalRef.NAME\n    ) {\n      return Vec3.ofBabylon(localPosition);\n    }\n    const meshParent = mesh.parent;\n    const meshParentPos = Vec3.ofBabylon(meshParent.position);\n    const meshParentRotMat = Util3d.getRotationMatrix(meshParent);\n    const meshParentScaling = Vec3.ofBabylon(meshParent.scaling);\n    return meshParentRotMat\n      .prodVec(\n        meshParentScaling.mul(\n          Util3d.getGlobalCoordinates(mesh.parent, localPosition)\n        )\n      )\n      .add(meshParentPos);\n  }\n\n  /**\n   *\n   * @param {*} mesh\n   * @param {*} localPosition : Vec3\n   * @returns\n   */\n  static getParentCoord(mesh, localPosition, withTranslation = true) {\n    const meshParent = mesh.parent;\n    const meshParentPos = withTranslation\n      ? Vec3.ofBabylon(meshParent.position)\n      : Vec3.ZERO;\n    const meshParentRotMat = Util3d.getRotationMatrix(meshParent);\n    const meshParentScaling = Vec3.ofBabylon(meshParent.scaling);\n    return meshParentRotMat\n      .prodVec(meshParentScaling.mul(localPosition))\n      .add(meshParentPos);\n  }\n\n  /**\n   *\n   * @param {*} mesh\n   * @param {*} x: Vector3 in mesh local coord\n   * @returns Vector3\n   */\n  static getGlobalCoord(mesh, x) {\n    if (\n      (mesh.parent && mesh.parent.name === GlobalRef.NAME) ||\n      mesh.name === GlobalRef.NAME\n    ) {\n      return x;\n    }\n    const meshParent = mesh.parent;\n    const meshParentPos = Vec3.ofBabylon(meshParent.position);\n    const meshParentRotMat = Util3d.getRotationMatrix(meshParent);\n    const meshParentScaling = Vec3.ofBabylon(meshParent.scaling);\n    const childPos = meshParentRotMat\n      .prodVec(meshParentScaling.mul(Vec3.ofBabylon(x)))\n      .add(meshParentPos);\n    return Util3d.getGlobalCoord(meshParent, childPos.toBabylon());\n  }\n\n  static getBabylonCoordinates(positionInWorld) {\n    return GlobalRef.forwardCoordinates(positionInWorld);\n  }\n\n  /**\n   *\n   * @param {*} mesh\n   * @param {*} worldPosition: Vector3 from GlobalRef coordinate frame\n   */\n  static getLocalCoordFromGlobal(mesh, worldPosition, withTranslation = true) {\n    if (\n      (mesh.parent && mesh.parent.name === GlobalRef.NAME) ||\n      mesh.name === GlobalRef.NAME\n    )\n      return Vec3.ofBabylon(worldPosition);\n    const meshParent = mesh.parent;\n    const meshParentPos = withTranslation\n      ? Vec3.ofBabylon(meshParent.position)\n      : Vec3.ZERO;\n    const meshParentRotMat = Util3d.getRotationMatrix(meshParent);\n    const meshParentScaling = Vec3.ofBabylon(meshParent.scaling);\n    return meshParentScaling\n      .map(z => 1 / z)\n      .mul(\n        meshParentRotMat.dotVec(\n          Util3d.getLocalCoordFromGlobal(\n            meshParent,\n            worldPosition,\n            withTranslation\n          ).sub(meshParentPos)\n        )\n      );\n  }\n\n  /**\n   *\n   * @param {*} mesh\n   * @param {*} worldPosition: Vec3 from World(Babylon) coordinate frame\n   *\n   * @returns localPosition: Vec3\n   */\n  static getLocalCoordFromWorld(mesh, worldPosition, withTranslation = true) {\n    /// WARNING: very similar with getLocalCoordFromGlobal\n    if (!mesh.parent) {\n      return worldPosition;\n    }\n    const meshParent = mesh.parent;\n    const meshParentPos = withTranslation\n      ? Vec3.ofBabylon(meshParent.position)\n      : Vec3.ZERO;\n    const meshParentRotMat = Util3d.getRotationMatrix(meshParent);\n    const meshParentScaling = Vec3.ofBabylon(meshParent.scaling);\n    // assume scaling != 0\n    const inverseScaling = meshParentScaling.map(x => 1.0 / x);\n\n    return inverseScaling.mul(\n      meshParentRotMat.dotVec(\n        Util3d.getLocalCoordFromWorld(\n          meshParent,\n          worldPosition,\n          withTranslation\n        ).sub(meshParentPos)\n      )\n    );\n  }\n\n  /**\n   * World to Global coords\n   * @param {*} parentView: MainView\n   */\n  static toGlobalCoord = parentView => {\n    const rootMesh = parentView.getRootNode().item.mesh;\n    return arrayOfVector3 => {\n      const transform = p =>\n        Util3d.getLocalCoordFromWorld(\n          { parent: rootMesh },\n          Vec3.ofBabylon(p)\n        ).toBabylon();\n      if (Array.isArray(arrayOfVector3)) {\n        return arrayOfVector3.map(transform);\n      }\n      return transform(arrayOfVector3);\n    };\n  };\n\n  static getRotationMatrix(mesh) {\n    const localRotationMatrix = new Matrix();\n    const maybeQuaternion = Maybe.fromNull(mesh?.rotationQuaternion);\n    maybeQuaternion.forEach(quaternion =>\n      quaternion.toRotationMatrix(localRotationMatrix)\n    );\n    maybeQuaternion.orElseRun(() => {\n      const quaternion = Quaternion.RotationYawPitchRoll(\n        mesh.rotation.y,\n        mesh.rotation.x,\n        mesh.rotation.z\n      );\n      quaternion.toRotationMatrix(localRotationMatrix);\n    });\n    return Mat3.ofBabylonMatrix(localRotationMatrix);\n  }\n\n  static showNormals(scene, mesh, size = 1, color = Color3.Red()) {\n    const normals = mesh.getVerticesData(VertexBuffer.NormalKind);\n    const positions = mesh.getVerticesData(VertexBuffer.PositionKind);\n    const lines = [];\n    for (let i = 0; i < normals.length; i += 3) {\n      const v1 = Vector3.FromArray(positions, i);\n      const v2 = v1.add(Vector3.FromArray(normals, i).scaleInPlace(size));\n      lines.push([v1.add(mesh.position), v2.add(mesh.position)]);\n    }\n    const normalLines = MeshBuilder.CreateLineSystem(\n      \"normalLines\",\n      { lines: lines },\n      scene\n    );\n    normalLines.color = color;\n    normalLines.parent = mesh;\n    return normalLines;\n  }\n\n  static orthogonalBasisFromVector(u) {\n    const identityMatrix = [\n      new Vector3(1, 0, 0),\n      new Vector3(0, 1, 0),\n      new Vector3(0, 0, 1)\n    ];\n    const uArray = [u.x, u.y, u.z];\n    // choose pivot\n    let pivot = 0;\n    for (let i = 0; i < 3; i++) {\n      if (uArray[i] !== 0) {\n        pivot = i;\n        break;\n      }\n    }\n    let v = identityMatrix[(pivot + 1) % 3].add(\n      identityMatrix[pivot].scale(-uArray[(pivot + 1) % 3] / uArray[pivot])\n    );\n    v = v.normalize();\n    let w = identityMatrix[(pivot + 2) % 3].add(\n      identityMatrix[pivot].scale(-uArray[(pivot + 2) % 3] / uArray[pivot])\n    );\n    w = w.normalize();\n    w = w.subtract(v.scale(Vector3.Dot(v, w)));\n    return { u: Vector3.FromArray(uArray).normalize(), v: v, w: w.normalize() };\n  }\n\n  static createOrientedCone = (\n    scene,\n    u = new Vector3(1, 0, 0),\n    color = Color3.Gray(),\n    name = `OrientedCone${randomDigits()}`,\n    isPickable = true,\n    segments = 16\n  ) => {\n    const surface = {\n      positions: [],\n      faces: []\n    };\n    const d = u.length() / 3;\n    const mat3 = Util3d.orthogonalBasisFromVector(u);\n    const v = mat3.v;\n    const w = mat3.w;\n\n    const orientation = Math.sign(Vector3.Dot(Vector3.Cross(v, w), u));\n    // positions\n    for (let i = 0; i < segments; i++) {\n      const theta = orientation * ((2 * Math.PI) / segments) * i;\n      surface.positions.push(\n        v.scale(d * Math.cos(theta)).add(w.scale(d * Math.sin(theta)))\n      );\n    }\n\n    surface.positions.push(Vector3.Zero());\n    surface.positions.push(u);\n\n    const zeroIndex = surface.positions.length - 1;\n    const uIndex = surface.positions.length - 2;\n\n    for (let i = 0; i < segments; i++) {\n      // bottom faces\n      surface.faces.push([zeroIndex, (i + 1) % segments, i]);\n      // cone faces\n      surface.faces.push([uIndex, i, (i + 1) % segments]);\n    }\n\n    // mesh\n    const mesh = Util3d.meshFromPositionAndFaces(\n      name,\n      scene,\n      surface.positions,\n      surface.faces\n    );\n    mesh.convertToFlatShadedMesh();\n\n    const materialName = `OrientedConeMaterial${name}`;\n    mesh.material = MATERIAL_CACHE.get(materialName, scene).orLazy(() => {\n      const material = Util3d.getMaterialFromColor(color, scene, materialName);\n      MATERIAL_CACHE.put(materialName, scene, material);\n      return material;\n    });\n    mesh.isPickable = isPickable;\n    return mesh;\n  };\n\n  static createSphere = (\n    scene,\n    color = Color3.Gray(),\n    diameter = 1,\n    name = `Sphere${randomDigits()}`,\n    isPickable = true\n  ) => {\n    const sphere = Mesh.CreateSphere(name, 16, diameter, scene);\n    const material = Util3d.getMaterialFromColor(\n      color,\n      scene,\n      `SphereMaterial${name}`\n    );\n    sphere.material = material;\n    sphere.isPickable = isPickable;\n    return sphere;\n  };\n\n  static createBox = (\n    scene,\n    color = Color3.Gray(),\n    size = Box.DEFAULT_SIZE,\n    name = `Box${randomDigits()}`,\n    isPickable = true\n  ) => {\n    const box = Mesh.CreateBox(name, size, scene);\n    const material = new StandardMaterial(`BoxMaterial${name}`, scene);\n    material.diffuseColor = color;\n    material.emissiveColor = color;\n    box.material = material;\n    box.isPickable = isPickable;\n    return box;\n  };\n\n  static createTubeFromPoints = (\n    scene,\n    points,\n    color = Color3.Gray(),\n    radius = 1,\n    name = `Tube${randomDigits()}`,\n    isPickable = true\n  ) => {\n    const mesh = MeshBuilder.CreateTube(\n      name,\n      {\n        path: points,\n        radius: radius,\n        sideOrientation: Mesh.DOUBLESIDE,\n        updatable: true,\n        cap: Mesh.CAP_ALL\n      },\n      scene\n    );\n    const materialName = `Material${name}`;\n    mesh.material = MATERIAL_CACHE.get(materialName, scene).orLazy(() => {\n      const material = Util3d.getMaterialFromColor(color, scene, materialName);\n      MATERIAL_CACHE.put(materialName, scene, material);\n      return material;\n    });\n    mesh.isPickable = isPickable;\n    return mesh;\n  };\n\n  static positionalLightBuilder = scene => {\n    return new PositionalLightBuilder(scene);\n  };\n\n  static directionalLightBuilder = scene => {\n    return new DirectionalLightBuilder(scene);\n  };\n\n  static cameraBuilder(scene) {\n    return new CameraBuilder(scene);\n  }\n\n  static gizmoManagerBuilder(scene) {\n    return new GizmoManagerBuilder(scene);\n  }\n\n  static referentialBuilder = scene => {\n    return new ReferentialBuilder(scene);\n  };\n\n  /**\n   * Return a maybe position of intersection of the mouse and a ground mesh\n   *\n   * @param {Scene} scene Babylon scene\n   * @param {Ground} ground a Babylon mesh that represents the ground\n   * @returns {Maybe} a maybe Vector3 representing the mouse ground intersection\n   */\n  static getGroundPosition = function (scene, ground) {\n    // Use a predicate to get position on the ground\n    const pickInfo = scene.pick(\n      scene.pointerX,\n      scene.pointerY,\n      mesh => mesh === ground\n    );\n    if (pickInfo.hit) return Maybe.some(pickInfo.pickedPoint);\n    return Maybe.none();\n  };\n\n  static pickMesh = (scene, ground) => {\n    const pickInfo = scene.pick(\n      scene.pointerX,\n      scene.pointerY,\n      mesh => mesh !== ground && mesh.isEnabled()\n    );\n    if (pickInfo.hit && pickInfo.pickedMesh.isPickable) {\n      return Maybe.some(pickInfo.pickedMesh);\n    }\n    return Maybe.none();\n  };\n\n  static groundBuilder = scene => {\n    return new GroundBuilder(scene);\n  };\n\n  static meshFromPositionAndFaces(\n    name,\n    scene,\n    positions,\n    faces,\n    updatable = true\n  ) {\n    const vertexData = new VertexData();\n\n    vertexData.positions = positions.flatMap(z => [z.x, z.y, z.z]);\n    vertexData.indices = faces.flatMap(z => z);\n\n    let mesh = new Mesh(name, scene);\n    vertexData.applyToMesh(mesh, updatable);\n    // mesh.createNormals();\n    return mesh;\n  }\n\n  /**\n   *\n   * @param {*} polygon: Array of babylonjs vector3, representing a boundary of a polygon\n   */\n  static triangulatePolygon(polygon) {\n    const triangulation = earcut(\n      polygon.map(x => [x.x, x.y, x.z]).flatMap(x => x),\n      null,\n      3\n    );\n    const len = triangulation.length / 3;\n    const ans = [];\n    for (let i = 0; i < len; i++) {\n      const i3 = 3 * i;\n      ans.push([\n        triangulation[i3],\n        triangulation[i3 + 1],\n        triangulation[i3 + 2]\n      ]);\n    }\n    return ans;\n  }\n\n  /**\n   *\n   * @param {*} polygon: Array of babylonjs vector3, representing a boundary of a polygon\n   * Returns a real number representing the orientation of the curve, if positive represents a counterclockwise orientation, clockwise otherwise.\n   */\n  static computeOrientation(polygon) {\n    const n = polygon.length;\n    const vec3Poly = polygon.map(x => Vec3.ofBabylon(x));\n    let orientation = 0;\n    vec3Poly.forEach((a, i) => {\n      const modi = (i + 1) % n;\n      const edge = vec3Poly[modi].sub(vec3Poly[i]);\n      orientation += Vec3.of([-a.y, a.x, a.z]).dot(edge);\n    });\n    return orientation / 2;\n  }\n\n  /**\n   * @param {*} arrayOfPoints: array of babylon vec3\n   * Returns the average\n   */\n  static pointAverage(arrayOfPoints) {\n    if (!arrayOfPoints || arrayOfPoints.length === 0) return Vector3.Zero();\n    return arrayOfPoints\n      .reduce((e, x) => e.add(x), Vector3.Zero())\n      .scale(1 / arrayOfPoints.length);\n  }\n\n  static pointAverageVec3(arrayOfPoints) {\n    if (!arrayOfPoints || arrayOfPoints.length === 0) return Vec3.ZERO;\n    return arrayOfPoints\n      .reduce((e, x) => e.add(x), Vec3.ZERO)\n      .scale(1 / arrayOfPoints.length);\n  }\n\n  static randomVector3(a, b) {\n    return new Vector3.FromArray(\n      [0, 0, 0].map(x => a + (b - a) * Math.random())\n    );\n  }\n\n  static getMaterialFromColor(\n    color,\n    scene,\n    name = `MaterialFromColor${randomDigits()}`\n  ) {\n    const material = new StandardMaterial(name, scene);\n    material.diffuseColor = color;\n    material.emissiveColor = color;\n    return material;\n  }\n\n  static piecewiseCurveDistance = curve => {\n    let distance = 0;\n    for (let i = 0; i < curve.length - 1; i++) {\n      const v = curve[i + 1].subtract(curve[i]);\n      distance += v.length();\n    }\n    return distance;\n  };\n\n  static getCurveOrientations = curve => {\n    const orientations = [];\n    for (let i = 0; i < curve.length - 1; i++) {\n      const v = curve[i + 1].subtract(curve[i]);\n      orientations.push(Math.atan2(v.y, v.x));\n    }\n    orientations.push(orientations[orientations.length - 1]);\n    return orientations;\n  };\n\n  static getSplineFromCurve = (curve, nbPoints = 7) => {\n    const closed = false;\n    return {\n      points: Curve3.CreateCatmullRomSpline(curve, nbPoints, closed).getPoints()\n    };\n  };\n\n  static splineObj2redis = splineObj => {\n    const orientations = Util3d.getCurveOrientations(splineObj.points);\n    return splineObj.points.map((x, i) => {\n      return [x.x, x.y, orientations[i]];\n    });\n  };\n\n  static getShaderMaterial =\n    ({\n      name = `CustomShader${randomDigits()}`,\n      vertex = VERTEX,\n      frag = FRAG,\n      onBindObservable = SHADER_BIND,\n      preProcessShader = SHADER_PRE\n    }) =>\n    scene => {\n      /**\n       * Check this for shader re-usage, if a problem appears\n       * https://playground.babylonjs.com/#KJ3BVA#4\n       * */\n      const shaderMaterial = new ShaderMaterial(\n        name,\n        scene,\n        { vertexSource: vertex, fragmentSource: frag },\n        {\n          attributes: [\"position\", \"normal\", \"uv\"],\n          uniforms: [\n            \"world\",\n            \"worldView\",\n            \"worldViewProjection\",\n            \"view\",\n            \"projection\"\n          ]\n        }\n      );\n      preProcessShader(scene, shaderMaterial);\n      shaderMaterial.onBindObservable.add(() => {\n        onBindObservable(scene, shaderMaterial);\n      });\n      return shaderMaterial;\n    };\n\n  static setOrthoView(camera, scene) {\n    camera.mode = Camera.ORTHOGRAPHIC_CAMERA;\n    const aspect = scene.getEngine().getAspectRatio(camera);\n    const distance = camera.position.length();\n    camera.orthoLeft = -distance / 2;\n    camera.orthoRight = distance / 2;\n    camera.orthoBottom = camera.orthoLeft * aspect;\n    camera.orthoTop = camera.orthoRight * aspect;\n  }\n\n  static setPerspectiveView(camera, scene) {\n    camera.mode = Camera.PERSPECTIVE_CAMERA;\n  }\n\n  /**\n   *\n   * @param {*} scene: Babylonjs Scene\n   * @param {*} name: String\n   * @param {*} begin: Vector3\n   * @param {*} end: Vector3\n   */\n  static getArrow(scene, name, begin, end, radius = 1) {\n    const arrowTube = Util3d.createTubeFromPoints(\n      scene,\n      [begin, end],\n      Color3.Gray(),\n      radius,\n      name + \"tube\"\n    );\n    const arrowCone = Util3d.createOrientedCone(\n      scene,\n      end\n        .subtract(begin)\n        .normalize()\n        .scale(radius * 7),\n      Color3.Gray(),\n      name + \"cone\"\n    );\n    arrowCone.position = end;\n    const arrowMesh = new Mesh(name, scene);\n    arrowTube.parent = arrowMesh;\n    arrowCone.parent = arrowMesh;\n    return arrowMesh;\n  }\n\n  /*\n   * Show tooltip on mesh on mouse over\n   *\n   * @param {Mesh} mesh: Mesh to add the tooltip\n   * @param {Scene} scene: Scene\n   * @param {String} tooltipText: Text to be added to the tooltip\n   *\n   * @returns {TextBlock} TextBlock instance to allow dynamic changes\n   *  on the tooltip content by: textBlock.text = \"new text\"\n   */\n  static addTooltipToMesh(mesh, scene, tooltipText = \"\") {\n    return new TooltipBuilder(mesh, scene).text(tooltipText).build();\n  }\n\n  /**\n   * Add click action to mesh in scene\n   * @param {Mesh} mesh : Mesh to add click action\n   * @param {Scene} scene : Scene object\n   * @param {Function} callback : Function to be called on click\n   */\n  static addClickActionToMesh(mesh, scene, callback) {\n    // Set mesh action manager\n    const actionManager = new ActionManager(scene);\n    mesh.actionManager = actionManager;\n    // Register actions: OnPickDownTrigger (click action)\n    actionManager.registerAction(\n      new ExecuteCodeAction(ActionManager.OnPickDownTrigger, function (_) {\n        callback();\n      })\n    );\n    // Register actions: OnPointerOverTrigger (hover effect)\n    actionManager.registerAction(\n      new ExecuteCodeAction(ActionManager.OnPointerOverTrigger, function (_) {\n        mesh.material.unfreeze();\n        mesh.material.emissiveColor = Color3.Gray();\n      })\n    );\n    // Register actions: OnPointerOutTrigger (clear hover effect)\n    actionManager.registerAction(\n      new ExecuteCodeAction(ActionManager.OnPointerOutTrigger, function (_) {\n        mesh.material.emissiveColor = Color3.White();\n        setTimeout(() => mesh.material.freeze(), 10);\n      })\n    );\n  }\n\n  /**\n   * Get node item type from mesh\n   * @param {Mesh} mesh : Node Item mesh\n   * @returns {String} NodeItem type\n   */\n  static getNodeItemTypeFromMesh = mesh => {\n    const isMeshFromPath = mesh.parent?.nodeItem.getType() === Path.TYPE;\n    return isMeshFromPath\n      ? mesh.parent?.nodeItem.getType()\n      : mesh.nodeItem.getType();\n  };\n}\n\nconst randomDigits = () => {\n  return Math.floor(Math.random() * 1e3);\n};\n\nconst VERTEX = `precision highp float;\n\n// Attributes\nattribute vec3 position;\nattribute vec3 normal;\nattribute vec2 uv;\n\n// Uniforms\nuniform mat4 worldViewProjection;\n\n// Varying\nvarying vec3 vPosition;\nvarying vec3 vNormal;\nvarying vec2 vUV;\n\nvoid main(void) {\n    vec4 outPosition = worldViewProjection * vec4(position, 1.0);\n    gl_Position = outPosition;\n\n    vUV = uv;\n    vPosition = position;\n    vNormal = normal;\n}`;\nconst FRAG = `\nprecision highp float;\n\n// Varying\nvarying vec3 vPosition;\nvarying vec3 vNormal;\nvarying vec2 vUV;\n\n// Uniforms\nuniform mat4 world;\n\n// Refs\nuniform vec3 cameraPosition;\nuniform vec3 lightPosition;\nuniform float time;\n\nvoid main(void) {\n    vec3 vLightPosition = lightPosition;\n\n    // World values\n    vec3 vPositionW = vec3(world * vec4(vPosition, 1.0));\n    vec3 vNormalW = normalize(vec3(world * vec4(vNormal, 0.0)));\n    vec3 viewDirectionW = normalize(cameraPosition - vPositionW);\n\n    // Light\n    vec3 lightVectorW = normalize(vLightPosition - vPositionW);\n    vec3 color = vec3(0.5,0.,1.);\n\n    // diffuse\n    float ndl = max(0., dot(vNormalW, lightVectorW));\n\n    // Specular\n    vec3 angleW = normalize(viewDirectionW + lightVectorW);\n    float specComp = max(0., dot(vNormalW, angleW));\n    specComp = pow(specComp, max(1., 64.)) * 2.;\n\n    gl_FragColor = vec4(color * ndl + vec3(specComp), 1.);\n}\n`;\n\nconst SHADER_BIND = (() => {\n  let time = 0;\n  let T = new Date().getTime();\n  return (scene, shaderMaterial) => {\n    const dt = (new Date().getTime() - T) / 1000;\n    shaderMaterial.setFloat(\"time\", time);\n    shaderMaterial.setVector3(\"cameraPosition\", scene.activeCamera.position);\n    if (scene.lights.length > 0) {\n      shaderMaterial.setVector3(\"lightPosition\", scene.lights[0].position);\n    }\n    time = time + dt;\n    T = new Date().getTime();\n  };\n})();\n\nconst SHADER_PRE = (scene, shaderMaterial) => {\n  shaderMaterial.backFaceCulling = false;\n  shaderMaterial.setFloat(\"time\", 0);\n  shaderMaterial.setVector3(\"cameraPosition\", scene.activeCamera.position);\n  shaderMaterial.setVector3(\"lightPosition\", new Vector3(0, 20, 10));\n};\n\nconst MATERIAL_CACHE = MaterialCache.getInstance();\n\nexport default Util3d;\n","module.exports = require(\"@babel/runtime/helpers/esm/createClass\");","module.exports = require(\"monet\");","module.exports = require(\"mov-fe-lib-core\");","module.exports = require(\"@material-ui/core\");","module.exports = require(\"@babel/runtime/helpers/esm/possibleConstructorReturn\");","module.exports = require(\"@babel/runtime/helpers/esm/extends\");","module.exports = require(\"@babel/runtime/helpers/esm/inherits\");","module.exports = require(\"@babel/runtime/helpers/esm/toConsumableArray\");","module.exports = require(\"@babel/runtime/helpers/esm/get\");","module.exports = require(\"@babel/runtime/helpers/esm/slicedToArray\");","module.exports = require(\"@material-ui/core/styles\");","import { Color3 } from \"@babylonjs/core\";\n\nconst Constants = {\n  RADIUS: 0.25,\n  POINTS_DENSITY: 2,\n  CLOUD_FUNCTION_NAME: \"backend.viewer\",\n  NAV_CLOUD_NAME: \"backend.generate_path\",\n  RAD2DEG: 180 / Math.PI,\n  DEG2RAD: Math.PI / 180,\n  DEBUG: false\n};\n\nexport const LOGGER_STATUS = {\n  init: 0,\n  running: 1,\n  paused: 2,\n  terminated: 3\n};\n\nexport const SCENE_BACKGROUND = {\n  dark: Color3.Black(),\n  light: Color3.Gray(),\n  default: Color3.Black()\n};\n\nexport default Constants;\n","module.exports = require(\"@babel/runtime/helpers/esm/classPrivateFieldGet\");","module.exports = require(\"@babel/runtime/regenerator\");","import NodeItem from \"./NodeItem\";\nimport Vec3 from \"../Math/Vec3\";\nimport Util3d from \"../Util3d/Util3d\";\nimport React from \"react\";\nimport { Maybe } from \"monet\";\nimport Constants from \"../Utils/Constants\";\nimport {\n  Observable,\n  Color3,\n  MeshBuilder,\n  Quaternion,\n  Vector3,\n  Space\n} from \"@babylonjs/core\";\nimport { UndoManager } from \"mov-fe-lib-core\";\nimport GraphItem from \"./GraphItem\";\n\nconst RADIUS = Constants.RADIUS;\n\nclass Path extends NodeItem {\n  /**\n   * @param {*} mesh\n   * @param {*} localPath: is an array of 3-arrays of numbers of the local coordinates in relation to mesh.position and quaternion\n   * @param {*} keyPoints: are the keyPoints meshes array\n   * @param {*} splinePath: is an array of 3-arrays of numbers of the local coordinates in relation to mesh.position and quaternion\n   * @param {*} mainView: MainView\n   * @param {*} keyValueMap: annotations\n   */\n  constructor(\n    mesh,\n    localPath,\n    keyPoints,\n    splinePath,\n    mainView,\n    weight = 1,\n    keyValueMap = {}\n  ) {\n    super(mesh, keyValueMap);\n    // Array<Vector3> points in relation to its mean\n    this.localPath = localPath;\n    // Array<Meshes> representing key points of the curve\n    this.keyPoints = keyPoints;\n    // spline points from local path\n    this.splinePath = splinePath;\n    this.selectedKeyPointIndex = -1;\n    this.mainView = mainView;\n    this.weight = weight;\n  }\n\n  toDict() {\n    const dict = super.toDict();\n    dict.localPath = this.localPath;\n    dict.splinePath = this.splinePath;\n    dict.weight = this.weight;\n    return dict;\n  }\n\n  toForm() {\n    const schema = super.toForm();\n    if (this.selectedKeyPointIndex >= 0) {\n      schema.jsonSchema.properties[\"selectedKeyPoint\"] = {\n        type: \"object\",\n        title: `KeyPoint ${this.selectedKeyPointIndex}`,\n        properties: {\n          x: {\n            type: \"number\",\n            title: \"x\"\n          },\n          y: {\n            type: \"number\",\n            title: \"y\"\n          },\n          z: {\n            type: \"number\",\n            title: \"z\"\n          }\n        }\n      };\n      schema.uiSchema[\"selectedKeyPoint\"] = {\n        \"ui:widget\": \"collapse\"\n      };\n      schema.uiSchema[\"position\"] = { \"ui:widget\": \"hidden\" };\n      schema.uiSchema[\"rotation\"] = { \"ui:widget\": \"hidden\" };\n      schema.uiSchema[\"color\"] = { \"ui:widget\": \"hidden\" };\n      schema.uiSchema[\"annotations\"] = { \"ui:widget\": \"hidden\" };\n      const selectedMesh = this.keyPoints[this.selectedKeyPointIndex];\n      const position = Util3d.getGlobalCoordinates(\n        selectedMesh,\n        selectedMesh.position\n      ).toArray();\n      schema.data[\"selectedKeyPoint\"] = {\n        x: position[0],\n        y: position[1],\n        z: position[2]\n      };\n\n      return schema;\n    }\n    // re-order attributes\n    const props = { ...schema.jsonSchema.properties };\n    const newSchema = {\n      type: \"object\",\n      properties: {\n        oldName: props.oldName,\n        name: props.name,\n        type: props.type,\n        weight: {\n          type: \"number\",\n          title: \"Weight\"\n        },\n        position: props.position,\n        rotation: props.rotation,\n        color: props.color,\n        annotations: props.annotations\n      }\n    };\n    schema.jsonSchema = newSchema;\n    schema.data[\"weight\"] = this.weight;\n    return schema;\n  }\n\n  ofForm(form) {\n    super.ofForm(form);\n    if (this.selectedKeyPointIndex >= 0) {\n      const selectedKeyPoint = this.keyPoints[this.selectedKeyPointIndex];\n      const formPosition = form.selectedKeyPoint;\n      const newPosInWorldCoordinates = Vector3.FromArray(\n        [formPosition.x, formPosition.y, formPosition.z].map(Number.parseFloat)\n      );\n      const localPos = Util3d.getLocalCoordFromGlobal(\n        selectedKeyPoint,\n        newPosInWorldCoordinates\n      ).toArray();\n      selectedKeyPoint.position = new Vector3(\n        localPos[0],\n        localPos[1],\n        localPos[2]\n      );\n      selectedKeyPoint.observers.notifyObservers({\n        updatedPointMesh: selectedKeyPoint,\n        is2updateServer: false\n      });\n      return;\n    }\n    this.weight = Number(form.weight);\n    this.updatePathEdgeWithForm(this.weight, this.keyValueMap);\n  }\n\n  updatePathEdgeWithForm(weight, annotations) {\n    this.mainView.getGraph().forEach(({ item: graphItem }) => {\n      const { graph } = graphItem;\n      const first = this.keyPoints[0];\n      const last = this.keyPoints[this.keyPoints.length - 1];\n      const edge = [first, last]\n        .filter(v => !!v?.graphVertex?.vertex)\n        .map(v => v.graphVertex.vertex);\n      if (edge.length < 2) return;\n      const edgeIds = edge.map(v => v.id);\n      graph.getEdge(...edgeIds).forEach(({ data: edgeData }) => {\n        edgeData.weight = weight;\n        edgeData.keyValueMap = annotations;\n      });\n      this.mainView.updateNodeInServer(graphItem.name);\n    });\n  }\n\n  ofDict(scene, dict = null, mainView = null) {\n    return Path.ofDict(scene, dict, mainView);\n  }\n\n  getCopyFunction(isForceUpdate, nameGenerator) {\n    // mousePosFromRoot : Vector3\n    return (mousePosFromRoot, someMainView) => {\n      return super\n        .getCopyFunction(isForceUpdate, nameGenerator)(\n          mousePosFromRoot,\n          someMainView\n        )\n        .map(copiedPath => {\n          const kp = copiedPath?.keyPoints;\n          if (kp !== undefined && isPathOnGraph(this)) {\n            Path.updateGraph(someMainView, kp, copiedPath, true);\n          }\n          return copiedPath;\n        });\n    };\n  }\n\n  getType = () => Path.TYPE;\n\n  /**\n   * Import path features\n   * @param {*} pathItem\n   */\n  importFeatures(pathItem = new Path({}, {}, {}, {}, {})) {\n    this.keyValueMap = pathItem.keyValueMap;\n    this.weight = pathItem.weight;\n  }\n\n  static TYPE = \"Path\";\n\n  static ofDict(scene, dict = null, mainView = null) {\n    if (!dict || !mainView)\n      throw new Error(\"null dictionary describing path or null mainView\");\n\n    const name = dict.name;\n    const curve = dict.localPath.map(z => Vec3.of(z).toBabylon());\n    const spline = Util3d.getSplineFromCurve(curve);\n    const { points } = spline;\n    let mesh = null;\n    //hack for creating 1 point curves\n    if (points.length === 1) {\n      mesh = MeshBuilder.CreateLines(\n        name,\n        { points: points, updatable: true },\n        scene\n      );\n    } else {\n      mesh = Util3d.createTubeFromPoints(\n        scene,\n        points,\n        Color3.Gray(),\n        RADIUS / 8,\n        name\n      );\n    }\n    mesh.position = Vec3.of(dict.position).toBabylon();\n    mesh.material = Util3d.getMaterialFromColor(\n      Color3.FromArray(dict.color),\n      scene,\n      `PathMaterial${name}`\n    );\n    mesh.rotationQuaternion = Maybe.fromNull(dict.quaternion)\n      .map(quaternion =>\n        new Quaternion(\n          quaternion[1],\n          quaternion[2],\n          quaternion[3],\n          quaternion[0]\n        ).normalize()\n      )\n      .orSome(Quaternion.Identity());\n    const splinePath = Util3d.splineObj2redis(spline);\n    const keyPoints = createPlaceHolderKeyPoints(\n      scene,\n      { ...dict, mesh, splinePath },\n      mainView\n    );\n    const path2return = new Path(\n      mesh,\n      curve.map(point => [point.x, point.y, point.z]),\n      keyPoints,\n      splinePath,\n      mainView,\n      dict.weight,\n      dict.keyValueMap\n    );\n    mesh.onClick = getMeshOnClick(mainView, path2return);\n    mesh.observers = new Observable();\n    mesh.observers.add(getMeshObserver(keyPoints));\n    return path2return;\n  }\n\n  /**\n   * Create new mesh from old, has side effects\n   *\n   * @param {*} newPoints: Vector3\n   * @param {*} scene: Scene\n   * @param {*} item: PathItem\n   * @param {*} mainView: MainView\n   * @param {*} keyPointUpdateFunction: (scene, mainView, mesh, item) => Array<Mesh>\n   */\n  static createNewMeshFromOldUsingNewPoints(\n    newPoints,\n    scene,\n    item,\n    mainView,\n    keyPointUpdateFunction = defaultKeyPointUpdate\n  ) {\n    const { mesh: oldMesh } = item;\n    const average = Util3d.pointAverage(newPoints);\n    newPoints = newPoints.map(x => x.subtract(average));\n\n    const spline = Util3d.getSplineFromCurve(newPoints);\n    const newMesh = Util3d.createTubeFromPoints(\n      scene,\n      spline.points,\n      Color3.Gray(),\n      RADIUS / 8,\n      oldMesh.name\n    );\n\n    // average in parent coord\n    const rotMat3 = Util3d.getRotationMatrix(oldMesh);\n    const scaleVec3 = Vec3.ofBabylon(oldMesh.scaling);\n    const averageInParentCoord = rotMat3\n      .prodVec(Vec3.ofBabylon(average).mul(scaleVec3))\n      .toBabylon();\n\n    newMesh.parent = oldMesh.parent;\n    newMesh.rotationQuaternion = oldMesh.rotationQuaternion;\n    newMesh.position = averageInParentCoord.add(oldMesh.position);\n\n    newMesh.material = oldMesh.material;\n    newMesh.visibility = oldMesh.visibility;\n    newMesh.onClick = oldMesh.onClick;\n    newMesh.getMouseContextActions = oldMesh.getMouseContextActions;\n    newMesh.nodeItem = oldMesh.nodeItem;\n    newMesh.observers = oldMesh.observers;\n    item.localPath = newPoints.map(x => Vec3.ofBabylon(x).toArray());\n    item.splinePath = Util3d.splineObj2redis(spline);\n    item.mesh = newMesh;\n    const oldKeyPoints = [...item.keyPoints];\n    item.keyPoints = keyPointUpdateFunction(scene, mainView, oldMesh, item);\n    // update children\n    const childrenCopy = [...oldMesh._children];\n    childrenCopy\n      .filter(c => mainView.getNodeFromTree(c.name).isJust())\n      .forEach(c => {\n        c.parent = item.mesh;\n      });\n    // update observer that triggers keypoints observers\n    item.mesh.observers.clear();\n    item.mesh.observers.add(getMeshObserver(item.keyPoints));\n\n    Path.updateGraph(\n      mainView,\n      oldKeyPoints,\n      item,\n      oldKeyPoints.length !== item.keyPoints.length\n    );\n    oldMesh.dispose();\n    return item;\n  }\n\n  static deleteKeyPointWithUndo(scene, keyPointMesh, mainView) {\n    const index = keyPointMesh.index;\n    const name = keyPointMesh.parent.name;\n    mainView.getNodeFromTree(name).forEach(({ item }) => {\n      const { mesh } = item;\n      const copyPosition = { ...mesh.position };\n      let newPoints = item.localPath.map(x => Vec3.of(x).toBabylon());\n      if (newPoints.length === 2) return;\n      mainView\n        .getUndoManager()\n        .doIt(\n          Path.getUndoDeleteKeyPoint(\n            name,\n            index,\n            copyPosition,\n            newPoints,\n            scene,\n            item,\n            mainView\n          )\n        );\n    });\n  }\n\n  static getUndoDeleteKeyPoint(\n    name,\n    index,\n    copyPosition,\n    newPoints,\n    scene,\n    item,\n    mainView\n  ) {\n    return UndoManager.actionBuilder()\n      .doAction(() => {\n        const copyPoints = [...newPoints];\n        copyPoints.splice(index, 1);\n        Path.createNewMeshFromOldUsingNewPoints(\n          copyPoints,\n          scene,\n          item,\n          mainView,\n          Path.onAddNewPointKeyPointUpdate\n        );\n        mainView.updateNodeInServer(name);\n      })\n      .undoAction(({ is2UpdateInServer = true }) => {\n        const copyPoints = [...newPoints];\n        item.mesh.position = copyPosition;\n        Path.createNewMeshFromOldUsingNewPoints(\n          copyPoints,\n          scene,\n          item,\n          mainView,\n          Path.onAddNewPointKeyPointUpdate\n        );\n        if (is2UpdateInServer) mainView.updateNodeInServer(name);\n      })\n      .build();\n  }\n\n  static onAddNewPointKeyPointUpdate(scene, mainView, oldMesh, item) {\n    // used when new keypoint is added\n    const keypoints = createPlaceHolderKeyPoints(scene, item, mainView);\n    return keypoints;\n  }\n\n  /**\n   *\n   * @param {*} scene\n   * @param {*} keyPointMesh\n   * @param {*} curveMesh\n   * @param {*} mainView\n   * @param {*} orientation: it belongs to the set {-1,1}, represents orientation\n   */\n  static addKeyPointInBetween(scene, keyPointMesh, mainView, orientation) {\n    const index = keyPointMesh.index;\n    const name = keyPointMesh.parent.name;\n    mainView.getNodeFromTree(name).forEach(({ item }) => {\n      const points = item.localPath.map(x => Vec3.of(x).toBabylon());\n      const copyPosition = { ...item.mesh.position };\n      mainView\n        .getUndoManager()\n        .doIt(\n          Path.getUndoAddKeyPointInBetween(\n            name,\n            index,\n            orientation,\n            item,\n            points,\n            copyPosition,\n            scene,\n            mainView\n          )\n        );\n    });\n  }\n\n  static getUndoAddKeyPointInBetween(\n    name,\n    index,\n    orientation,\n    item,\n    points,\n    copyPosition,\n    scene,\n    mainView\n  ) {\n    return UndoManager.actionBuilder()\n      .doAction(() => {\n        const nextIndex = index + orientation;\n        const numberOfPoints = item.localPath.length;\n        let newPoints = [];\n        const oldPoints = [...points];\n        if (nextIndex < 0) {\n          newPoints = [\n            oldPoints[0].scale(3).subtract(oldPoints[1]).scale(0.5)\n          ].concat(oldPoints);\n        } else if (nextIndex > numberOfPoints - 1) {\n          newPoints = oldPoints.concat([\n            oldPoints[numberOfPoints - 1]\n              .scale(3)\n              .subtract(oldPoints[numberOfPoints - 2])\n              .scale(0.5)\n          ]);\n        } else {\n          // TODO: consider doing using slice\n          const specialIndex = index + Math.max(0, orientation);\n          for (let i = 0; i < specialIndex; i++) {\n            newPoints.push(oldPoints[i]);\n          }\n          newPoints.push(oldPoints[nextIndex].add(oldPoints[index]).scale(0.5));\n          for (let i = specialIndex; i < numberOfPoints; i++) {\n            newPoints.push(oldPoints[i]);\n          }\n        }\n\n        Path.createNewMeshFromOldUsingNewPoints(\n          newPoints,\n          scene,\n          item,\n          mainView,\n          Path.onAddNewPointKeyPointUpdate\n        );\n\n        mainView.updateNodeInServer(name);\n      })\n      .undoAction(({ is2UpdateInServer = true }) => {\n        const copyPoints = [...points];\n        item.mesh.position = copyPosition;\n        Path.createNewMeshFromOldUsingNewPoints(\n          copyPoints,\n          scene,\n          item,\n          mainView,\n          Path.onAddNewPointKeyPointUpdate\n        );\n        if (is2UpdateInServer) mainView.updateNodeInServer(name);\n      })\n      .build();\n  }\n\n  /**\n   *\n   * @param {*} mainView: MainView\n   * @param {*} oldKpMeshes: Mesh\n   * @param {*} pathItem: PathItem\n   * @param {*} isTopologyChange: boolean, vertex added or deleted from curve\n   */\n  static updateGraph(mainView, oldKpMeshes, pathItem, isTopologyChange) {\n    if (!isTopologyChange) return;\n    mainView.getGraph().forEach(({ item: graph }) => {\n      const keyPoints = pathItem.keyPoints;\n      const edgeMeshes = [keyPoints[0], keyPoints[keyPoints.length - 1]];\n      const firstLastKpNeighborEdges = [];\n      const firstLastOldKp = [\n        oldKpMeshes[0],\n        oldKpMeshes[oldKpMeshes.length - 1]\n      ];\n      graph.getEdge(...firstLastOldKp).forEach(oldEdge => {\n        // get keypoint neighbors edges, besides the edge of the path itself\n        firstLastOldKp.forEach(kp => {\n          const edges = [];\n          graph\n            .getNeighbors(kp)\n            .filter(v => !graph.doMeshesBelong2SamePath(kp, v.mesh))\n            .forEach(neigh => {\n              edges.push({\n                edge: graph.getEdge(kp, neigh.mesh),\n                vertex: neigh\n              });\n            });\n          firstLastKpNeighborEdges.push(edges);\n        });\n        // remove old path vertices\n        firstLastOldKp.forEach(vp => graph.delVertexFromMesh(vp));\n        // add new path edge\n        graph.addEdge(...edgeMeshes);\n        graph.getEdge(...edgeMeshes).forEach(edge => {\n          edge.importFeatures(oldEdge);\n        });\n        // add old neighbors to path endpoints\n        firstLastKpNeighborEdges.forEach((neighborEdges, i) => {\n          neighborEdges.forEach(edgeVertexObj => {\n            graph.addEdge(edgeMeshes[i], edgeVertexObj.vertex.mesh);\n            graph\n              .getEdge(edgeMeshes[i], edgeVertexObj.vertex.mesh)\n              .forEach(edge =>\n                edgeVertexObj.edge.forEach(oldNeighEdge => {\n                  edge.importFeatures(oldNeighEdge);\n                })\n              );\n          });\n        });\n        mainView.updateNodeInServer(graph.name);\n      });\n    });\n  }\n\n  static isKeyPointMesh(mesh, mainView) {\n    return (\n      Number.isInteger(mesh.index) &&\n      mainView\n        .getNodeFromTree(mesh.parent.name)\n        .filter(({ item }) => item.getType() === Path.TYPE)\n        .orSome(false)\n    );\n  }\n\n  /**\n   *\n   * @param {*} left: keypoint mesh\n   * @param {*} right: keypoint mesh\n   * @param {*} mainView\n   */\n  static areKeyPointsCompatible(left, right, mainView) {\n    return mainView\n      .getNodeFromTree(left.parent.name)\n      .flatMap(({ item: leftPath }) =>\n        mainView\n          .getNodeFromTree(right.parent.name)\n          .map(({ item: rightPath }) => {\n            let i = left.index;\n            let j = right.index;\n            const n = leftPath.localPath.length;\n            const m = rightPath.localPath.length;\n            // keypoint must be a boundary\n            if (!((i === 0 || i === n - 1) && (j === 0 || j === m - 1)))\n              return false;\n            i = i === 0 ? 1 : -1;\n            j = j === 0 ? 1 : -1;\n            // must preserve orientation\n            if (i * j > 0) return false;\n            return true;\n          })\n      )\n      .orSome(false);\n  }\n  /**\n   * Merge simple paths, function\n   * Not commutative action\n   * @param {*} leftPath\n   * @param {*} rightPath\n   * @param {*} mergeName\n   * @param {*} mainView\n   */\n  static mergePaths(leftPathName, rightPathName, mergeName, mainView) {\n    mainView.getNodeFromTree(leftPathName).forEach(({ item: leftPath }) => {\n      mainView.getNodeFromTree(rightPathName).forEach(({ item: rightPath }) => {\n        const parent = leftPath.mesh.parent;\n        const leftChildren = leftPath.mesh._children.filter(\n          kp => kp.index === undefined\n        );\n        const rightChildren = rightPath.mesh._children.filter(\n          kp => kp.index === undefined\n        );\n        const leftDict = leftPath.toDict();\n        const rightPointsInLeftCoord = rightPath.keyPoints\n          .splice(1)\n          .map(kp =>\n            Util3d.getLocalCoordFromWorld(\n              { parent: leftPath.mesh },\n              Vec3.ofBabylon(kp.absolutePosition)\n            )\n          );\n        leftDict.name = mergeName;\n        // concat new path\n        leftDict.localPath = leftDict.localPath.concat(\n          rightPointsInLeftCoord.map(kp => kp.toArray())\n        );\n        const average = Util3d.pointAverageVec3(\n          leftDict.localPath.map(x => Vec3.of(x))\n        );\n\n        // center curve\n        leftDict.localPath = leftDict.localPath.map(x =>\n          Vec3.of(x).sub(average).toArray()\n        );\n        mainView.getSceneMemory().forEach(({ scene }) => {\n          const newPath = Path.ofDict(scene, leftDict, mainView);\n          newPath.mesh.parent = parent;\n          newPath.mesh.translate(average.toBabylon(), 1, Space.LOCAL);\n          //import default features\n          newPath.importFeatures();\n          mainView.addNodeItem2Tree(newPath, parent.name);\n          Path.addEdgesInKeyPoints(newPath.keyPoints, scene, mainView);\n          leftChildren.forEach(child => {\n            mainView.getNodeFromTree(child.name).forEach(({ item }) => {\n              mainView.updateNodeItemInTree(item, newPath.name);\n              const newChildPos = Util3d.getLocalCoordFromWorld(\n                { parent: newPath.mesh },\n                Vec3.ofBabylon(child.absolutePosition)\n              );\n              child.position = newChildPos.toBabylon();\n              child.parent = newPath.mesh;\n            });\n          });\n          rightChildren.forEach(child => {\n            mainView.getNodeFromTree(child.name).forEach(({ item }) => {\n              mainView.updateNodeItemInTree(item, newPath.name);\n              const newChildPos = Util3d.getLocalCoordFromWorld(\n                { parent: newPath.mesh },\n                Vec3.ofBabylon(child.absolutePosition)\n              );\n              child.position = newChildPos.toBabylon();\n              child.parent = newPath.mesh;\n            });\n          });\n          mainView.deleteNodeFromTreeUsingName(leftPath.name);\n          mainView.deleteNodeFromTreeUsingName(rightPath.name);\n        });\n      });\n    });\n  }\n\n  static unMergePaths(oldPaths, mergeName, mainView, is2UpdateInServer = true) {\n    oldPaths.forEach(path => {\n      mainView.getSceneMemory().forEach(({ scene }) => {\n        const pathItem = Path.ofDict(scene, path.dict, mainView);\n        pathItem.mesh.parent = path.parent;\n        mainView.addNodeItem2Tree(\n          pathItem,\n          path.parent.name,\n          is2UpdateInServer\n        );\n        Path.addEdgesInKeyPoints(\n          pathItem.keyPoints,\n          scene,\n          mainView,\n          is2UpdateInServer\n        );\n        path.children.forEach(child => {\n          mainView.getNodeFromTree(child.name).forEach(({ item }) => {\n            mainView.updateNodeItemInTree(\n              item,\n              pathItem.name,\n              is2UpdateInServer\n            );\n            const newChildPos = Util3d.getLocalCoordFromWorld(\n              { parent: pathItem.mesh },\n              Vec3.ofBabylon(child.absolutePosition)\n            );\n            child.position = newChildPos.toBabylon();\n            child.parent = pathItem.mesh;\n          });\n        });\n      });\n    });\n    mainView.deleteNodeFromTreeUsingName(mergeName, is2UpdateInServer);\n  }\n\n  static addEdgesInKeyPoints(\n    keyPointMeshes,\n    scene,\n    mainView,\n    is2UpdateInServer = true\n  ) {\n    GraphItem.createGraphItemIfNone(scene, mainView);\n    mainView.getGraph().forEach(({ item: graph }) => {\n      const edgeMeshes = [\n        keyPointMeshes[0],\n        keyPointMeshes[keyPointMeshes.length - 1]\n      ];\n      graph.addEdge(...edgeMeshes);\n      if (is2UpdateInServer) mainView.updateNodeInServer(graph.name);\n    });\n  }\n}\n\nexport default Path;\n\nconst getMeshOnClick = (mainView, nodeItem) => () => {\n  mainView.closeContextDial();\n  mainView\n    .getNodeFromTree(nodeItem.name)\n    .forEach(node => (node.item.selectedKeyPointIndex = -1));\n};\n\nconst getMeshObserver =\n  keypoints =>\n  ({ updatedPointMesh, is2updateServer, displacement }) => {\n    keypoints.forEach(k => {\n      if (!!k.graphVertex) {\n        k.graphVertex.vertexObs({\n          updatedPointMesh: k,\n          is2updateServer,\n          displacement\n        });\n      }\n    });\n  };\n\nfunction defaultKeyPointUpdate(scene, mainView, oldMesh, item) {\n  // used when key point is updated\n  const childrenCopy = [...oldMesh._children];\n  const spline = item.splinePath.map(z => new Vector3(z[0], z[1], 0));\n  childrenCopy.forEach(c => {\n    c.parent = item.mesh;\n  });\n  return item.keyPoints.map((k, i) => {\n    k.index = i;\n    k.name = `${oldMesh.name}keyPointSpline${i}`;\n    k.position = Vec3.of(item.localPath[i]).toBabylon();\n    k.rotationQuaternion = Quaternion.Identity();\n    if (!!oldMesh.graphVertex) k.graphVertex = oldMesh.graphVertex;\n    if (i > 0 && i < item.keyPoints.length - 1) {\n      k._children.forEach(kChild => kChild.dispose());\n      const c = getConeMesh(\n        scene,\n        k.material.diffuseColor,\n        item.mesh,\n        i,\n        spline,\n        k.position\n      )();\n      c.parent = k;\n    }\n    return k;\n  });\n}\n\nconst getKeyPointObserverFunction = (scene, mainView) => {\n  return ({ updatedPointMesh, is2updateServer, displacement }) => {\n    if (!updatedPointMesh.parent) return;\n    mainView\n      .getNodeFromTree(updatedPointMesh.parent.name)\n      .forEach(({ item }) => {\n        const { index } = updatedPointMesh;\n        const { mesh } = item;\n        let newPoints = item.localPath.map(x => Vec3.of(x).toBabylon());\n        newPoints[index] = updatedPointMesh.position;\n        Path.createNewMeshFromOldUsingNewPoints(\n          newPoints,\n          scene,\n          item,\n          mainView\n        );\n        if (index > 0 && index < newPoints.length - 1) {\n          // we know by construction that this keyPoint has children\n          mainView.highlightMeshesInScene([item.keyPoints[index]._children[0]]);\n        }\n        if (is2updateServer) {\n          mainView.updateNodeInServer(mesh.name);\n          mainView.setProperties(item.toForm());\n        }\n      });\n  };\n};\n\nconst getKeyPointActions = (scene, keyPointMesh, mainView) => {\n  const actions = [];\n\n  mainView.getNodeFromTree(keyPointMesh.parent.name).forEach(pathTreeNode => {\n    const item = pathTreeNode.item;\n    const curve = item.localPath;\n\n    if (curve.length !== 2) {\n      actions.push({\n        icon: props => <i className=\"fas fa-trash\" {...props}></i>,\n        action: parentView => {\n          Path.deleteKeyPointWithUndo(scene, keyPointMesh, parentView);\n          parentView.closeContextDial();\n        },\n        name: \"Delete node [DEL]\"\n      });\n    }\n\n    actions.push({\n      icon: props => <i className=\"fas fa-less-than\" {...props}></i>,\n      action: parentView => {\n        Path.addKeyPointInBetween(scene, keyPointMesh, parentView, -1);\n        parentView.closeContextDial();\n      },\n      name: \"Add previous\"\n    });\n\n    actions.push({\n      icon: props => <i className=\"fas fa-greater-than\" {...props}></i>,\n      action: parentView => {\n        Path.addKeyPointInBetween(scene, keyPointMesh, parentView, 1);\n        parentView.closeContextDial();\n      },\n      name: \"Add next\"\n    });\n  });\n\n  return actions;\n};\n\nconst createPlaceHolderKeyPoints = (scene, pseudoItem, mainView) => {\n  const color = new Color3(0.25, 0.25, 0.25);\n  const keyPoints = [];\n  const curve = pseudoItem.localPath.map(z => Vec3.of(z).toBabylon());\n  const spline = pseudoItem.splinePath.map(z => new Vector3(z[0], z[1], 0));\n  const curveMesh = pseudoItem.mesh;\n  curve.forEach((p, i) => {\n    const sphere = getSphereMesh(scene, color, curveMesh, i);\n    const cone = () => {\n      const c = getConeMesh(scene, color, curveMesh, i, spline, p)();\n      const s = getSphereMesh(scene, color, curveMesh, i)();\n      s.visibility = 0.1;\n      c.parent = s;\n      return s;\n    };\n\n    const keyPoint = i === 0 || i === curve.length - 1 ? sphere() : cone();\n    keyPoint.parent = curveMesh;\n    keyPoint.position = p;\n    keyPoint.index = i;\n    keyPoint.observers = new Observable();\n    keyPoints.push(keyPoint);\n    keyPoint.observers.add(getKeyPointObserverFunction(scene, mainView));\n  });\n\n  keyPoints.forEach(kp => {\n    kp.onClick = () => {\n      mainView.setContextActions(getKeyPointActions(scene, kp, mainView));\n      mainView.getNodeFromTree(kp.parent.name).forEach(node => {\n        node.item.selectedKeyPointIndex = kp.index;\n        mainView.setProperties(node.item.toForm());\n      });\n    };\n    kp.getMouseContextActions = getKpMouseContextActions(\n      scene,\n      kp,\n      pseudoItem.name\n    );\n    kp.onDel = () => Path.deleteKeyPointWithUndo(scene, kp, mainView);\n  });\n  return keyPoints;\n};\n\nfunction getKpMouseContextActions(scene, kp, pathName) {\n  return mainView => {\n    const actions = [];\n    mainView.getNodeFromTree(pathName).forEach(({ item: pathItem }) => {\n      const n = pathItem.localPath.length;\n      if (n <= 2) {\n        return;\n      }\n      if (kp.index > 0 && kp.index < n - 1) {\n        actions.push({\n          title: \"Split curve\",\n          onClick: () => {\n            mainView.getUndoManager().doIt(\n              UndoManager.actionBuilder()\n                .doAction(() => {\n                  splitCurve(mainView, scene, kp, pathItem.name);\n                })\n                .undoAction(({ is2UpdateInServer = true }) => {\n                  unSplitCurve(mainView, scene, pathItem, is2UpdateInServer);\n                })\n                .build()\n            );\n          }\n        });\n      }\n    });\n    actions.push({\n      title: \"Delete point\",\n      onClick: () => {\n        Path.deleteKeyPointWithUndo(scene, kp, mainView);\n      }\n    });\n    return actions;\n  };\n}\n\nfunction splitCurve(mainView, scene, kp, pathName) {\n  // TODO: very similar to unSplitCurve\n  mainView.getGraph().forEach(({ item: graph }) => {\n    mainView.getNodeFromTree(pathName).forEach(({ item }) => {\n      const edgesByCurveBoundary = [[], []];\n      const oldPath = item.localPath;\n      const oldCenter = Vec3.ofBabylon(item.mesh.position);\n      const pathParent = item?.mesh.parent;\n      // creating split path positions\n      const splitAtIndex = kp.index;\n      const splitPath = [[], []];\n      oldPath.forEach((point, i) => {\n        if (i <= splitAtIndex) {\n          splitPath[0].push(point);\n        } else {\n          if (i === splitAtIndex + 1) splitPath[1].push(oldPath[splitAtIndex]);\n          splitPath[1].push(point);\n        }\n      });\n      // retrieve edges from path boundary\n      const keyPoints = item.keyPoints;\n      const boundary = [keyPoints[0], keyPoints[keyPoints.length - 1]];\n      boundary.forEach((keyPoint, i) => {\n        graph\n          .getNeighbors(keyPoint)\n          .filter(v => !graph.doMeshesBelong2SamePath(keyPoint, v.mesh))\n          .forEach(neigh => {\n            edgesByCurveBoundary[i].push({\n              edge: graph.getEdge(keyPoint, neigh.mesh),\n              vertex: neigh\n            });\n          });\n      });\n      // delete boundary vertex from graph\n      boundary.forEach(keyPoint => {\n        graph.delVertexFromMesh(keyPoint);\n      });\n      // remove old path\n      mainView.deleteNodeFromTreeUsingName(pathName);\n      // create new paths\n      splitPath.forEach((localPath, i) => {\n        // set props of new paths from old path\n        const middlePoint = Util3d.pointAverage(\n          localPath.map(p => Vec3.of(p).toBabylon())\n        );\n        const centeredCurve = localPath.map(v =>\n          Vec3.of(v).sub(Vec3.ofBabylon(middlePoint)).toBabylon()\n        );\n        // set colorArray\n        const colorArray = [];\n        item.mesh.material.diffuseColor.toArray(colorArray);\n        // set quaternion\n        const quaternion =\n          item.mesh.rotationQuaternion.clone() || Quaternion.Identity();\n        const quaternionArray = [\n          quaternion.w,\n          quaternion.x,\n          quaternion.y,\n          quaternion.z\n        ];\n        const newPath = Path.ofDict(\n          scene,\n          {\n            name: i === 0 ? pathName : `${pathName}_split${numberOfSplits++}`,\n            position: oldCenter.toArray(),\n            quaternion: quaternionArray,\n            color: colorArray,\n            localPath: centeredCurve.map(z => Vec3.ofBabylon(z).toArray())\n          },\n          mainView\n        );\n        newPath.mesh.translate(middlePoint, 1, Space.LOCAL);\n        newPath.mesh.parent = pathParent;\n        newPath.importFeatures(item);\n        mainView.addNodeItem2Tree(newPath, pathParent.name);\n        // add edge of new path\n        const newKeyPoints = newPath.keyPoints;\n        const newEdge = [\n          newKeyPoints[0],\n          newKeyPoints[newKeyPoints.length - 1]\n        ];\n        graph.addEdge(...newEdge);\n        graph.getEdge(...newEdge).forEach(edge => {\n          edge.importFeatures(newPath);\n        });\n        // add old edges to the new paths\n        edgesByCurveBoundary[i].forEach(edgeVertexObj => {\n          graph.addEdge(newEdge[i], edgeVertexObj.vertex.mesh);\n          graph.getEdge(newEdge[i], edgeVertexObj.vertex.mesh).forEach(edge => {\n            edgeVertexObj.edge.forEach(oldNeighEdge => {\n              edge.importFeatures(oldNeighEdge);\n            });\n          });\n        });\n      });\n      mainView.updateNodeInServer(graph.name);\n    });\n  });\n}\n\nfunction unSplitCurve(mainView, scene, oldPathItem, is2UpdateInServer = true) {\n  mainView.getGraph().forEach(({ item: graph }) => {\n    const oldPathName = oldPathItem.name;\n    const oldPathNameSplit = `${oldPathName}_split${--numberOfSplits}`;\n    mainView.getNodeFromTree(oldPathName).forEach(({ item: leftSplit }) => {\n      mainView\n        .getNodeFromTree(oldPathNameSplit)\n        .forEach(({ item: rightSplit }) => {\n          const pathParent = leftSplit.mesh.parent;\n          const edgesByCurveBoundary = [[], []];\n          // retrieve edges from split paths\n          const boundary = [\n            leftSplit.keyPoints[0],\n            rightSplit.keyPoints[rightSplit.keyPoints.length - 1]\n          ];\n          boundary.forEach((keyPoint, i) => {\n            graph\n              .getNeighbors(keyPoint)\n              .filter(v => !graph.doMeshesBelong2SamePath(keyPoint, v.mesh))\n              .forEach(neigh => {\n                edgesByCurveBoundary[i].push({\n                  edge: graph.getEdge(keyPoint, neigh.mesh),\n                  vertex: neigh\n                });\n              });\n          });\n          // delete graph vertices from split path\n          // delete boundary vertex from graph\n          boundary.forEach(keyPoint => {\n            graph.delVertexFromMesh(keyPoint);\n          });\n          // remove split paths\n          mainView.deleteNodeFromTreeUsingName(oldPathName, is2UpdateInServer);\n          mainView.deleteNodeFromTreeUsingName(\n            oldPathNameSplit,\n            is2UpdateInServer\n          );\n          // create oldPathItem\n          // set colorArray\n          const colorArray = [];\n          oldPathItem.mesh.material.diffuseColor.toArray(colorArray);\n          const newPath = Path.ofDict(\n            scene,\n            {\n              name: oldPathName,\n              position: Vec3.ofBabylon(oldPathItem.mesh.position).toArray(),\n              color: colorArray,\n              localPath: oldPathItem.localPath\n            },\n            mainView\n          );\n          newPath.mesh.parent = pathParent;\n          newPath.importFeatures(oldPathItem);\n          mainView.addNodeItem2Tree(\n            newPath,\n            pathParent.name,\n            is2UpdateInServer\n          );\n          // add oldPathItem path edge\n          const newKeyPoints = newPath.keyPoints;\n          const newEdge = [\n            newKeyPoints[0],\n            newKeyPoints[newKeyPoints.length - 1]\n          ];\n          graph.addEdge(...newEdge);\n          graph.getEdge(...newEdge).forEach(edge => {\n            edge.importFeatures(newPath);\n          });\n          // add boundary edges of the split\n          edgesByCurveBoundary.forEach((edges, i) => {\n            edges.forEach(edgeVertexObj => {\n              graph.addEdge(newEdge[i], edgeVertexObj.vertex.mesh);\n              graph\n                .getEdge(newEdge[i], edgeVertexObj.vertex.mesh)\n                .forEach(edge => {\n                  edgeVertexObj.edge.forEach(oldNeighEdge => {\n                    edge.importFeatures(oldNeighEdge);\n                  });\n                });\n            });\n          });\n          if (is2UpdateInServer) mainView.updateNodeInServer(graph.name);\n        });\n    });\n  });\n}\n\nfunction getConeMesh(scene, color, curveMesh, i, spline, p) {\n  return () => {\n    const index = spline\n      .map(z => p.subtract(z).length())\n      .reduce((e, x, i) => (e.value < x ? e : { value: x, index: i }), {\n        value: Number.MAX_VALUE,\n        index: -1\n      }).index;\n    const nextSplinePoint = spline[index + 1]\n      ? spline[index + 1]\n      : spline[index];\n    const currentSplinePoint = spline[index];\n    const u = nextSplinePoint\n      .subtract(currentSplinePoint)\n      .normalize()\n      .scale(RADIUS);\n    const c = Util3d.createOrientedCone(\n      scene,\n      u,\n      color,\n      `${curveMesh.name}keyPointCone${i}`,\n      false\n    );\n    return c;\n  };\n}\n\nfunction getSphereMesh(scene, color, curveMesh, i) {\n  return () =>\n    Util3d.createSphere(\n      scene,\n      color,\n      RADIUS,\n      `${curveMesh.name}keyPointSpline${i}`,\n      true\n    );\n}\n\nfunction isPathOnGraph(pathItem) {\n  return [\n    pathItem.keyPoints[0]?.graphVertex,\n    pathItem.keyPoints[pathItem.keyPoints.length - 1]?.graphVertex\n  ].every(v => !!v);\n}\n\nlet numberOfSplits = 0;\n","import NodeItem from \"./NodeItem\";\nimport Vec3 from \"../Math/Vec3\";\nimport Util3d from \"../Util3d/Util3d\";\nimport { Maybe } from \"monet\";\nimport { Quaternion, MeshBuilder } from \"@babylonjs/core\";\n\n// ROS/RVIZ default referential\nconst THETA = -Math.PI / 2;\nexport const ROS_ORIGIN = {\n  position: [0, 0, 0],\n  scaling: [1, -1, 1],\n  quaternion: [Math.cos(THETA / 2), Math.sin(THETA / 2), 0, 0]\n};\n\nclass GlobalRef extends NodeItem {\n  constructor(mesh, keyValueMap = {}) {\n    super(mesh, keyValueMap);\n  }\n\n  toForm() {\n    const form = super.toForm();\n    form.uiSchema.name = {\n      \"ui:disabled\": true\n    };\n    return form;\n  }\n\n  getMouseContextActions() {\n    return [];\n  }\n\n  getType = () => GlobalRef.TYPE;\n\n  static TYPE = \"GlobalRef\";\n\n  static NAME = \"Global ref\";\n\n  static ofDict(scene, dict = null, mainView = null) {\n    const rosOrigin = GlobalRef.getRosOrigin(scene);\n\n    const globalRefMesh = Util3d.referentialBuilder(scene)\n      .name(GlobalRef.NAME)\n      .isPickable(true)\n      .boxParams({ isVisible: true, size: 0.25 })\n      .build();\n\n    globalRefMesh.parent = rosOrigin;\n\n    NodeItem.mapDict2Mesh(dict, globalRefMesh);\n\n    return new GlobalRef(\n      globalRefMesh,\n      Maybe.fromNull(dict)\n        .flatMap(d => Maybe.fromNull(d.keyValueMap))\n        .orUndefined()\n    );\n  }\n\n  static getRosOrigin(scene) {\n    const rosOrigin = MeshBuilder.CreateBox(\n      \"ROS_ORIGIN\",\n      { size: 1e-3 },\n      scene\n    );\n    rosOrigin.isVisible = false;\n    rosOrigin.isPickable = false;\n    rosOrigin.position = Vec3.of(ROS_ORIGIN.position).toBabylon();\n    rosOrigin.scaling = Vec3.of(ROS_ORIGIN.scaling).toBabylon();\n    const quaternion = new Quaternion(\n      ROS_ORIGIN.quaternion[1],\n      ROS_ORIGIN.quaternion[2],\n      ROS_ORIGIN.quaternion[3],\n      ROS_ORIGIN.quaternion[0]\n    );\n    rosOrigin.rotationQuaternion = quaternion.normalize();\n    return rosOrigin;\n  }\n\n  /**\n   *\n   * @param {*} x: Babylon Vector3 in World coordinates\n   *\n   * returns Babylon Vector3 vector in ROS coordinates\n   */\n  static inverseCoordinates(x) {\n    /**\n     * Solves RS\\eta + p = x\n     *\n     * \\eta = S^(1)R^T(x-p)\n     */\n    const quaternion = ROS_ORIGIN.quaternion;\n    const rotationMatrix = Util3d.getRotationMatrix({\n      rotationQuaternion: new Quaternion(\n        quaternion[1],\n        quaternion[2],\n        quaternion[3],\n        quaternion[0]\n      )\n    });\n    const scaling = Vec3.of(ROS_ORIGIN.scaling).map(z => 1 / z);\n    const pos = Vec3.of(ROS_ORIGIN.position);\n    const result = scaling.mul(\n      rotationMatrix.dotVec(Vec3.ofBabylon(x).sub(pos))\n    );\n    return result.map(z => (Math.abs(z) < 1e-5 ? 0 : z)).toBabylon();\n  }\n\n  /**\n   *\n   * @param {*} x: Babylon Vector3 in ROS coordinates\n   *\n   * returns Babylon Vector3 vector in World coordinates\n   */\n  static forwardCoordinates(x) {\n    /**\n     * computes RS\\eta + p = x\n     */\n    const quaternion = ROS_ORIGIN.quaternion;\n    const rotationMatrix = Util3d.getRotationMatrix({\n      rotationQuaternion: new Quaternion(\n        quaternion[1],\n        quaternion[2],\n        quaternion[3],\n        quaternion[0]\n      )\n    });\n    const scaling = Vec3.of(ROS_ORIGIN.scaling);\n    const pos = Vec3.of(ROS_ORIGIN.position);\n    const result = rotationMatrix\n      .prodVec(scaling.mul(Vec3.ofBabylon(x)))\n      .add(pos);\n    return result.map(z => (Math.abs(z) < 1e-5 ? 0 : z)).toBabylon();\n  }\n}\n\nexport default GlobalRef;\n","import { MasterDB } from \"mov-fe-lib-core\";\n\nclass AnnotationManager {\n  constructor() {\n    if (instance) return instance;\n    instance = this;\n    this.annotations = {};\n    this.observersBySceneId = {};\n  }\n\n  //========================================================================================\n  /*                                                                                      *\n   *                                   Getters & Setters                                  *\n   *                                                                                      */\n  //========================================================================================\n\n  getAnnotations = () => this.annotations;\n\n  load() {\n    this.retrieveAnnotationsFromDb();\n    return this;\n  }\n  /**\n   *\n   * @param {*} scene: Scene\n   * @param {*} lambda: AnnotationManager -> {}\n   */\n  pushObserver(scene, lambda) {\n    const sceneId = scene._uid;\n\n    if (!(sceneId in this.observersBySceneId)) {\n      this.observersBySceneId[sceneId] = [];\n    }\n    this.observersBySceneId[sceneId].push(lambda);\n    return this;\n  }\n\n  clearObserver(scene) {\n    const sceneId = scene._uid;\n    if (sceneId in this.observersBySceneId) {\n      delete this.observersBySceneId[sceneId];\n    }\n  }\n\n  //========================================================================================\n  /*                                                                                      *\n   *                                         Utils                                        *\n   *                                                                                      */\n  //========================================================================================\n\n  retrieveAnnotationsFromDb() {\n    MasterDB.subscribe(\n      { Scope: \"Annotation\", Name: \"*\" },\n      data => {\n        console.log(\"Annotation update\", data);\n        const actionMap = {\n          del: annotation => this.delAnnotation(annotation),\n          set: annotation => this.addAnnotation(annotation)\n        };\n        const annotation = data.key.Annotation;\n        if (data.event in actionMap) {\n          actionMap[data.event](annotation);\n          Object.keys(this.observersBySceneId).forEach(k =>\n            this.observersBySceneId[k].forEach(f => f(this))\n          );\n        }\n      },\n      data => {\n        console.log(\"Annotation start\", data);\n        const annotation = data.value.Annotation;\n        this.addAnnotation(annotation);\n      }\n    );\n  }\n\n  delAnnotation(annotation) {\n    if (!annotation) return;\n    const names2delete = Object.keys(annotation).reduce((e, x) => {\n      e.push(x);\n      return e;\n    }, []);\n    Object.keys(this.annotations).forEach(annotationType => {\n      const value = this.annotations[annotationType];\n      value.names = value.names.filter(x => !names2delete.includes(x));\n      value.labels = value.labels.filter(x => !names2delete.includes(x));\n    });\n  }\n\n  addAnnotation(annotation) {\n    if (!annotation) return;\n    Object.keys(annotation).forEach(name => {\n      const annotationObj = annotation[name];\n      if (!annotationObj.Type) return;\n      const type = annotationObj.Type.toLowerCase();\n      const label = annotationObj.Label;\n      if (!(type in this.annotations)) {\n        this.annotations[type] = { names: [], labels: [] };\n      }\n      this.annotations[type].names.push(name);\n      this.annotations[type].labels.push(label ? label : name);\n    });\n  }\n\n  //========================================================================================\n  /*                                                                                      *\n   *                                        Static                                        *\n   *                                                                                      */\n  //========================================================================================\n\n  static getInstance() {\n    return new AnnotationManager();\n  }\n\n  static getAnnotations() {\n    return AnnotationManager.getInstance().getAnnotations();\n  }\n}\nlet instance = null;\nexport default AnnotationManager;\n","import Clipboard from \"../Utils/Clipboard\";\nimport Vec3 from \"../Math/Vec3\";\nimport { Maybe } from \"monet\";\nimport _capitalize from \"lodash/capitalize\";\nimport { Quaternion, Color3, Vector3 } from \"@babylonjs/core\";\nimport AnnotationManager from \"../Utils/AnnotationManager\";\nimport GlobalRef from \"./GlobalRef\";\nimport Constants from \"../Utils/Constants\";\n\nclass NodeItem {\n  constructor(mesh, keyValueMap = {}) {\n    this.name = mesh.name;\n    this.mesh = mesh;\n    this.mesh.getMouseContextActions = this.getMouseContextActions;\n    this.mesh.nodeItem = this;\n    this.keyValueMap = keyValueMap;\n  }\n\n  dispose() {\n    this.delVertex();\n    this.mesh.dispose();\n  }\n\n  toDict() {\n    return {\n      name: this.name,\n      type: this.getType(),\n      position: Vec3.ofBabylon(this.mesh?.position).toArray(),\n      quaternion: Maybe.fromNull(this.mesh?.rotationQuaternion)\n        .map(x => [x.w, x.x, x.y, x.z])\n        .orLazy(() => {\n          const q = Quaternion.RotationYawPitchRoll(\n            this.mesh.rotation.y,\n            this.mesh.rotation.x,\n            this.mesh.rotation.z\n          );\n          return [q.w, q.x, q.y, q.z];\n        }),\n      color: Maybe.fromNull(this.mesh?.material)\n        .flatMap(x =>\n          Maybe.fromNull(x.diffuseColor).map(z => [\n            z.r,\n            z.g,\n            z.b,\n            this.mesh.visibility\n          ])\n        )\n        .orSome([0, 0, 0, 1]),\n      keyValueMap: this.keyValueMap,\n      isVisible: this.mesh.isEnabled()\n    };\n  }\n\n  /**\n   * Generates json based on https://github.com/rjsf-team/react-jsonschema-form\n   */\n  toForm() {\n    const info = this.toDict();\n    const color = new Color3(info.color[0], info.color[1], info.color[2]);\n    const q = new Quaternion(\n      info.quaternion[1],\n      info.quaternion[2],\n      info.quaternion[3],\n      info.quaternion[0]\n    );\n    const euler = q.toEulerAngles();\n\n    const schema = {\n      jsonSchema: {\n        type: \"object\",\n        properties: {\n          oldName: {\n            type: \"string\"\n          },\n          name: {\n            type: \"string\",\n            title: \"Name\"\n          },\n          type: {\n            type: \"string\",\n            title: \"Type\"\n          },\n          position: {\n            type: \"object\",\n            title: \"Position\",\n            properties: {\n              x: {\n                type: \"number\",\n                title: \"x\"\n              },\n              y: {\n                type: \"number\",\n                title: \"y\"\n              },\n              z: {\n                type: \"number\",\n                title: \"z\"\n              }\n            }\n          },\n          rotation: {\n            type: \"object\",\n            title: \"Rotation\",\n            properties: {\n              x: {\n                type: \"number\",\n                title: \"x\"\n              },\n              y: {\n                type: \"number\",\n                title: \"y\"\n              },\n              z: {\n                type: \"number\",\n                title: \"z\"\n              }\n            }\n          },\n          color: {\n            type: \"object\",\n            title: \"Color\",\n            properties: {\n              r: {\n                type: \"number\"\n              },\n              g: {\n                type: \"number\"\n              },\n              b: {\n                type: \"number\"\n              },\n              a: {\n                type: \"number\"\n              }\n            }\n          }\n        }\n      },\n      uiSchema: {\n        type: {\n          \"ui:disabled\": true\n        },\n        color: {\n          \"ui:widget\": \"color\"\n        },\n        oldName: {\n          \"ui:widget\": \"hidden\"\n        },\n        position: {\n          \"ui:widget\": \"collapse\"\n        },\n        rotation: {\n          \"ui:widget\": \"collapse\"\n        }\n      },\n      data: {\n        oldName: info.name,\n        name: info.name,\n        type: info.type,\n        position: {\n          x: info.position[0],\n          y: info.position[1],\n          z: info.position[2]\n        },\n        rotation: {\n          x: euler.x * Constants.RAD2DEG,\n          y: euler.y * Constants.RAD2DEG,\n          z: euler.z * Constants.RAD2DEG\n        },\n        color: {\n          r: color.r,\n          g: color.g,\n          b: color.b,\n          a: this.mesh.visibility\n        }\n      }\n    };\n\n    NodeItem.setAnnotations2Form(schema, this.keyValueMap);\n    return schema;\n  }\n\n  /**\n   * Changes NodeItem based on a form\n   *\n   * Warning: side effect function\n   * @param {*} form\n   */\n  ofForm(form) {\n    this.name = form.name;\n    this.mesh.name = form.name;\n\n    Maybe.fromNull(form?.position).forEach(position => {\n      const pos = [position.x, position.y, position.z].map(Number.parseFloat);\n      this.mesh.position = Vector3.FromArray(pos);\n    });\n    Maybe.fromNull(form?.rotation).forEach(euler => {\n      const angles = [euler.x, euler.y, euler.z]\n        .map(Number.parseFloat)\n        .map(deg => deg * Constants.DEG2RAD);\n      this.mesh.rotationQuaternion = Quaternion.FromEulerAngles(...angles);\n    });\n    if (this.mesh.material) {\n      const color = new Color3(form.color.r, form.color.g, form.color.b);\n      this.mesh.material.diffuseColor = color;\n      this.mesh.material.emissiveColor = color;\n      this.mesh.visibility = form.color.a;\n    }\n    this.keyValueMap = { ...form.annotations };\n  }\n\n  getType = () => NodeItem.TYPE;\n\n  getMouseContextActions = mainView => {\n    return [\n      {\n        title: \"Copy\",\n        onClick: () => Clipboard.copy(this.getCopyFunction())\n      },\n      {\n        title: \"Delete\",\n        onClick: () =>\n          mainView\n            .getNodeFromTree(this.name)\n            .forEach(node => mainView.onDeleteNode(node, false))\n      }\n    ];\n  };\n\n  getCopyFunction(\n    isForceUpdate = true,\n    nameGenerator = old => old + \"_copy\" + Clipboard.getUID()\n  ) {\n    // mousePosFromRoot : Vector3\n    return (mousePosFromRoot, someMainView) =>\n      someMainView.getSceneMemory().map(({ scene }) => {\n        const { item: rootItem } = someMainView.getRootNode();\n        const copyDict = this.toDict();\n        copyDict.name = nameGenerator(copyDict.name);\n        const newPosArray = Vec3.ofBabylon(mousePosFromRoot).toArray();\n        // preserves z-coordinate\n        newPosArray[2] = copyDict.position[2];\n        copyDict.position = newPosArray;\n        const copiedNodeItem = this.ofDict(scene, copyDict, someMainView);\n        const { mesh: copiedMesh } = copiedNodeItem;\n        copiedMesh.parent = rootItem.mesh;\n        someMainView.addNodeItem2Tree(\n          copiedNodeItem,\n          GlobalRef.NAME,\n          true,\n          true,\n          isForceUpdate\n        );\n        return copiedNodeItem;\n      });\n  }\n\n  delVertex() {\n    let delVertex = this.mesh.graphVertex?.delVertex;\n    if (!delVertex) {\n      const childrenWithDelVertex = (this.mesh?._children || [])\n        .filter(childMesh => !!childMesh.graphVertex)\n        .map(childMesh => childMesh.graphVertex.delVertex);\n      delVertex = () => childrenWithDelVertex.forEach(del => del());\n    }\n    delVertex();\n  }\n\n  //========================================================================================\n  /*                                                                                      *\n   *                           Static attributes/methods                                  *\n   *                                                                                      */\n  //========================================================================================\n\n  static TYPE = \"NodeItem\";\n\n  // side-effect function\n  static mapDict2Mesh(dict, mesh) {\n    if (!mesh) throw new Error(\"can't map a null mesh\");\n    Maybe.fromNull(dict).forEach(someDict => {\n      Maybe.fromNull(dict.name).forEach(name => (mesh.name = name));\n      Maybe.fromNull(someDict.position).forEach(\n        position => (mesh.position = Vec3.of(position).toBabylon())\n      );\n      Maybe.fromNull(someDict.quaternion).forEach(quaternion => {\n        const babylonQuaternion = new Quaternion(\n          quaternion[1],\n          quaternion[2],\n          quaternion[3],\n          quaternion[0]\n        );\n        mesh.rotationQuaternion = babylonQuaternion.normalize();\n      });\n      Maybe.fromNull(someDict.color).forEach(color => {\n        const babylonColor = new Color3(color[0], color[1], color[2]);\n        Maybe.fromNull(mesh.material).forEach(material => {\n          Maybe.fromNull(material.diffuseColor).forEach(\n            z => (mesh.material.diffuseColor = babylonColor)\n          );\n          Maybe.fromNull(material.emissiveColor).forEach(\n            z => (mesh.material.emissiveColor = babylonColor)\n          );\n        });\n      });\n    });\n    return mesh;\n  }\n\n  // side effect function\n  static setAnnotations2Form(schema, keyValueMap = {}) {\n    schema.jsonSchema.properties.annotations = {\n      title: \"Annotations\",\n      type: \"object\",\n      properties: {}\n    };\n    schema.uiSchema.annotations = {\n      \"ui:widget\": \"collapse\"\n    };\n    schema.data[\"annotations\"] = { ...keyValueMap };\n    const annotations = AnnotationManager.getAnnotations();\n\n    [\"safety\", \"behaviour\", \"localization\", \"navigation\"].forEach(\n      annotation => {\n        // if (annotations[annotation].labels.length > 0) {\n        schema.jsonSchema.properties.annotations.properties[annotation] = {\n          title: _capitalize(annotation),\n          type: \"string\"\n        };\n        schema.uiSchema.annotations[annotation] = {\n          \"ui:widget\": \"selectScopeModal\",\n          \"ui:options\": {\n            scopeList: \"Annotation\",\n            name: _capitalize(annotation),\n            filter: e => {\n              return (\n                annotations[annotation] &&\n                annotations[annotation].names.includes(e.name)\n              );\n            }\n          }\n        };\n        // }\n      }\n    );\n  }\n\n  static randomId() {\n    return \"xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx\".replace(/[xy]/g, function (c) {\n      // eslint-disable-next-line no-mixed-operators\n      var r = (Math.random() * 16) | 0,\n        v = c === \"x\" ? r : (r & 0x3) | 0x8;\n      return v.toString(16);\n    });\n  }\n}\n\nexport default NodeItem;\n","module.exports = require(\"@babel/runtime/helpers/esm/asyncToGenerator\");","//immutable class, not managing exceptions\nclass Vec2 {\n  constructor(x, y) {\n    this.vec = [x, y].map(z => (z ? z : 0));\n  }\n\n  get x() {\n    return this.vec[0];\n  }\n\n  get y() {\n    return this.vec[1];\n  }\n\n  toArray() {\n    return this.vec;\n  }\n\n  add(y) {\n    return this.op(y, (a, b) => a + b);\n  }\n\n  sub(y) {\n    return this.op(y, (a, b) => a - b);\n  }\n\n  mul(y) {\n    return this.op(y, (a, b) => a * b);\n  }\n\n  div(y) {\n    return this.op(y, (a, b) => a / b);\n  }\n\n  dot(y) {\n    return this.vec.reduce((acc, v, i) => acc + v * y.vec[i], 0);\n  }\n\n  prod(y) {\n    return new Vec2(this.x * y.x - this.y * y.y, this.x * y.y + this.y * y.x);\n  }\n\n  length() {\n    return Math.sqrt(this.dot(this));\n  }\n\n  normalize() {\n    return this.scale(1 / this.length());\n  }\n\n  dual() {\n    return new Vec2(-this.y, this.x);\n  }\n\n  sym() {\n    return this.scale(-1);\n  }\n\n  conj() {\n    return new Vec2(this.x, -this.y);\n  }\n\n  scale(r) {\n    return this.map(z => z * r);\n  }\n\n  map(lambda) {\n    return Vec2.fromArray(this.vec.map(lambda));\n  }\n\n  /**\n   * Returns a vec2 from the operation function bilambda\n   * @param {*} y\n   * @param {*} biLambda\n   */\n  op(y, biLambda) {\n    return Vec2.fromArray(this.vec.map((v, i) => biLambda(v, y.vec[i])));\n  }\n\n  reduce(fold, initial) {\n    return this.vec.reduce(fold, initial);\n  }\n\n  toObject() {\n    return { x: this.x, y: this.y };\n  }\n\n  toString() {\n    return `{x: ${this.x}, y:${this.y}}`;\n  }\n\n  static fromArray(array) {\n    if (array.length < 2) throw new Error(\"array must have size > 2\");\n    return new Vec2(array[0], array[1]);\n  }\n\n  static of(x, y) {\n    return new Vec2(x, y);\n  }\n\n  static ofBabylon(vector3) {\n    return new Vec2(vector3.x, vector3.y);\n  }\n\n  static ZERO = new Vec2(0, 0);\n  static e1 = new Vec2(1, 0);\n  static e2 = new Vec2(0, 1);\n}\n\nexport default Vec2;\n","module.exports = require(\"lodash/get\");","import { Maybe } from \"monet\";\n\n/**\n * Undirected Graph data structure\n */\nclass Graph {\n  #adjMap = {};\n  #vertices = {};\n  #edges = {};\n\n  //========================================================================================\n  /*                                                                                      *\n   *                                      Public API                                      *\n   *                                                                                      */\n  //========================================================================================\n\n  addVertex(i) {\n    if (!(i in this.#vertices)) {\n      this.#vertices[i] = {};\n      this.#adjMap[i] = {};\n    }\n  }\n\n  delVertex(i) {\n    if (i in this.#vertices) {\n      delete this.#vertices[i];\n      // delete neighbors edge properties\n      Object.keys(this.#adjMap[i]).forEach(j => {\n        delete this.#edges[Graph.edgeKey(i, j)];\n        delete this.#edges[Graph.edgeKey(j, i)];\n      });\n      delete this.#adjMap[i];\n      Object.keys(this.#adjMap).forEach(j => {\n        if (i in this.#adjMap[j]) {\n          delete this.#adjMap[j][i];\n        }\n      });\n    }\n  }\n\n  /**\n   *\n   * If edge already exists, this function overwrites previous edge\n   *\n   * @param {*} i: vertex id\n   * @param {*} j: vertex id\n   */\n  addEdge(i, j) {\n    this.addVertex(i);\n    this.addVertex(j);\n    const edgeProps = this.getEdge(i, j).orSome({});\n    this.#edges[Graph.edgeKey(i, j)] = edgeProps;\n    this.#edges[Graph.edgeKey(j, i)] = edgeProps;\n    this.#adjMap[i][j] = true;\n    this.#adjMap[j][i] = true;\n    return this;\n  }\n\n  delEdge(i, j) {\n    const ijKey = Graph.edgeKey(i, j);\n    const jiKey = Graph.edgeKey(j, i);\n    if (ijKey in this.#edges || jiKey in this.#edges) {\n      delete this.#edges[ijKey];\n      delete this.#edges[jiKey];\n      delete this.#adjMap[i][j];\n      delete this.#adjMap[j][i];\n    }\n    // remove vertex if have no neighbors\n    [i, j].forEach(id => {\n      const neighbors = this.getNeighbors(id);\n      if (neighbors.length === 0) {\n        this.delVertex(id);\n      }\n    });\n  }\n\n  hasEdge(i, j) {\n    return this.getEdge(i, j).isSome();\n  }\n\n  getNeighbors(i) {\n    if (i in this.#adjMap) return Object.keys(this.#adjMap[i]);\n    return [];\n  }\n\n  getEdge(i, j) {\n    const edgeKey = Graph.edgeKey(i, j);\n    if (edgeKey in this.#edges) {\n      return Maybe.some(this.#edges[edgeKey]);\n    }\n    return Maybe.none();\n  }\n\n  getVertex(i) {\n    if (i in this.#vertices) {\n      return Maybe.some(this.#vertices[i]);\n    }\n    return Maybe.none();\n  }\n\n  getEdges() {\n    return this.#edges;\n  }\n\n  getVertices() {\n    return this.#vertices;\n  }\n\n  getAdjMap() {\n    return this.#adjMap;\n  }\n\n  static edgeKey = (i, j) => `${i}_${j}`;\n  static key2Edge = key => key.split(\"_\");\n}\n\nexport default Graph;\n","import NodeItem from \"./NodeItem\";\nimport Util3d from \"../Util3d/Util3d\";\nimport { Color3, Vector3, Observable } from \"@babylonjs/core\";\nimport Constants from \"../Utils/Constants\";\nimport { Quaternion } from \"@babylonjs/core/Maths/math\";\nimport Graph from \"../Graph/Graph\";\nimport Vec3 from \"../Math/Vec3\";\nimport { Maybe } from \"monet\";\nimport React from \"react\";\nimport lodashGet from \"lodash/get\";\nimport { UndoManager } from \"mov-fe-lib-core\";\nimport Path from \"./Path\";\nimport KeyPoint from \"./KeyPoint\";\n\n/**\n * One graph per scene\n */\nclass GraphItem extends NodeItem {\n  constructor(scene, mainView, name = GraphItem.NAME, keyValueMap = {}) {\n    const sceneId = scene.getUniqueId();\n    // super() must be called before using _this_.\n    if (\n      sceneId in graphItemInstances &&\n      !graphItemInstances[sceneId].mesh.isDisposed()\n    ) {\n      return graphItemInstances[sceneId];\n    }\n\n    const graphPlaceHolder = getGraphPlaceHolder(scene, name);\n    graphPlaceHolder.onClick = () =>\n      (this.graphFormMapper = this.getDefaultFormMapper());\n\n    super(graphPlaceHolder, keyValueMap);\n    graphItemInstances[sceneId] = this;\n\n    // object properties\n    this.graph = new Graph();\n    this.scene = scene;\n    this.mainView = mainView;\n    this.meshByEdgeId = {};\n    this.graphFormMapper = this.getDefaultFormMapper();\n    this.vertexGenerator = 0;\n  }\n\n  getType = () => GraphItem.TYPE;\n\n  toDict() {\n    const dict = super.toDict();\n    const { graph } = this;\n    const vertices = { ...graph.getVertices() };\n    const edges = { ...graph.getEdges() };\n    Object.keys(vertices).forEach(k => {\n      graph.getVertex(k).forEach(({ data: vertexData }) => {\n        vertices[k] = {\n          position: Vec3.ofBabylon(vertexData.position).toArray(),\n          id: String(k)\n        };\n      });\n    });\n    // export directed graph\n    Object.keys(edges).forEach(k => {\n      const ids = Graph.key2Edge(k);\n      graph.getEdge(...ids).forEach(({ data: edgeData }) => {\n        const [i, j] = ids.map(x => Number(x));\n        const edgeMesh = edgeData.edge.map(({ mesh }) => mesh);\n        const [belongsSrcMesh, belongsTrgMesh] = edgeMesh;\n        edges[k] = {\n          ids: ids,\n          keyValueMap: edgeData.keyValueMap,\n          weight: edgeData.weight,\n          belongsSrc:\n            i < j\n              ? this.exportBelongToData(belongsSrcMesh)\n              : this.exportBelongToData(belongsTrgMesh),\n          belongsTrg:\n            i < j\n              ? this.exportBelongToData(belongsTrgMesh)\n              : this.exportBelongToData(belongsSrcMesh)\n        };\n        if (this.doMeshesBelong2SamePath(...edgeMesh)) {\n          if (i > j) {\n            // remove edge if belongs to same path and i > j\n            delete edges[k];\n          }\n        } else {\n          if (this.checkInvalidEdges(...edgeMesh, edges[k])) {\n            // remove edge if is invalid edge\n            delete edges[k];\n          }\n        }\n      });\n    });\n    dict[\"vertices\"] = vertices;\n    dict[\"edges\"] = edges;\n    return dict;\n  }\n\n  toForm() {\n    const form = super.toForm();\n    delete form.jsonSchema.properties.position;\n    delete form.jsonSchema.properties.rotation;\n    delete form.jsonSchema.properties.color;\n    delete form.uiSchema.position;\n    delete form.uiSchema.rotation;\n    delete form.uiSchema.color;\n    delete form.data.position;\n    delete form.data.rotation;\n    delete form.data.color;\n    return this.graphFormMapper.toForm(form);\n  }\n\n  ofForm(form) {\n    this.name = form.name;\n    this.mesh.name = form.name;\n    this.graphFormMapper.ofForm(form);\n  }\n\n  getDefaultFormMapper() {\n    return {\n      toForm: form => form,\n      ofForm: form => (this.keyValueMap = { ...form.annotations })\n    };\n  }\n\n  getToFormEdge(edgeMesh) {\n    const { graph } = this;\n    return {\n      toForm: form => {\n        return graph\n          .getEdge(...edgeMesh.edgeIndexes)\n          .map(({ data: edgeData }) => {\n            form.jsonSchema.properties[\"weight\"] = {\n              type: \"number\",\n              title: \"Weight\"\n            };\n            form.data[\"weight\"] = edgeData.weight;\n            NodeItem.setAnnotations2Form(form, edgeData.keyValueMap);\n            form.jsonSchema.properties[\n              \"annotations\"\n            ].title = `Annotations Edge ${edgeMesh.edgeIndexes}`;\n            return form;\n          })\n          .orSome(form);\n      },\n      ofForm: form => {\n        const { edgeIndexes } = edgeMesh;\n        graph.getEdge(...edgeIndexes).forEach(({ data: edgeData }) => {\n          edgeData.keyValueMap = { ...lodashGet(form, \"annotations\", {}) };\n          edgeData.weight = Number.parseFloat(form.weight);\n        });\n      }\n    };\n  }\n\n  /**\n   * @override nodeItem delVertex()\n   * Delete all vertex from tree nodes\n   */\n  delVertex() {\n    // Iterate though all nodes under the root node and delete its vertexes\n    const root = this.mainView.getRootNode();\n    this.delVertexRecursively(root?.children);\n  }\n\n  //========================================================================================\n  /*                                                                                      *\n   *                                   Graph Operations                                   *\n   *                                                                                      */\n  //========================================================================================\n\n  /**\n   *\n   * @param {*} iMesh: Mesh vertex\n   * @param {*} jMesh: Mesh vertex\n   * @param {*} edgeIndexes: Array<Integer>\n   */\n  addEdge(iMesh, jMesh, edgeIndexes = []) {\n    const [iIndex, jIndex] = edgeIndexes;\n    if (this.hasEdge(iMesh, jMesh)) return;\n    this.buildVertex(iMesh, iIndex);\n    this.buildVertex(jMesh, jIndex);\n    this.buildEdge(iMesh, jMesh);\n    return this;\n  }\n\n  getEdge(iMesh, jMesh) {\n    const { graph } = this;\n    const [i, j] = [iMesh, jMesh].map(this.getVertexIdFromMesh);\n    // if it has an edge\n    return graph.getEdge(i, j).map(({ data }) => data);\n  }\n\n  delEdge(iMesh, jMesh) {\n    const { graph } = this;\n    const [i, j] = [iMesh, jMesh].map(this.getVertexIdFromMesh);\n    // if it has an edge\n    graph.getEdge(i, j).forEach(({ data: edgeData }) => {\n      const ijKey = Graph.edgeKey(i, j);\n      const jiKey = Graph.edgeKey(j, i);\n      Maybe.fromNull(this.meshByEdgeId[ijKey]).forEach(mesh => {\n        mesh.dispose();\n        delete this.meshByEdgeId[ijKey];\n        delete this.meshByEdgeId[jiKey];\n      });\n      graph.delEdge(i, j);\n    });\n    // Reset right menu to display scene details\n    this.mainView.setProperties();\n  }\n\n  /**\n   *\n   * @param {*} iMesh: Mesh\n   * @param {*} jMesh: Mesh\n   */\n  hasEdge(iMesh, jMesh) {\n    const [i, j] = [iMesh, jMesh].map(this.getVertexIdFromMesh);\n    return this.graph.hasEdge(i, j);\n  }\n\n  delVertexFromMesh(iMesh, is2updateServer = true) {\n    const { graph } = this;\n    const i = this.getVertexIdFromMesh(iMesh);\n    graph.getVertex(i).forEach(_ => {\n      // if vertex found delete neighbors\n      const neighbors = graph.getNeighbors(i);\n      neighbors\n        .map(j => graph.getVertex(j))\n        .forEach(maybeV =>\n          maybeV.forEach(({ data: vertexData }) => {\n            const { mesh: jMesh } = vertexData;\n            this.delEdge(iMesh, jMesh);\n          })\n        );\n      // delete itself\n      graph.delVertex(i);\n      iMesh.graphVertex = undefined;\n      if (is2updateServer) this.mainView.updateNodeInServer(this.name);\n    });\n  }\n  /**\n   *\n   * @param {*} iMesh\n   * @returns {*} Maybe<Vertex>\n   */\n  getVertex(iMesh) {\n    const { graph } = this;\n    const i = this.getVertexIdFromMesh(iMesh);\n    return graph.getVertex(i).map(({ data }) => data);\n  }\n\n  /**\n   *\n   * @param {*} iMesh\n   * @returns {*} Array<Vertex>\n   */\n  getNeighbors(iMesh) {\n    const { graph } = this;\n    const i = this.getVertexIdFromMesh(iMesh);\n    return graph\n      .getNeighbors(i)\n      .map(id => graph.getVertex(id).orNull())\n      .map(({ data }) => data)\n      .filter(x => !!x);\n  }\n\n  doMeshesBelong2SamePath(iMesh, jMesh) {\n    const iParentNodeItem = iMesh?.parent?.nodeItem;\n    const jParentNodeItem = jMesh?.parent?.nodeItem;\n    return (\n      !!iParentNodeItem &&\n      !!jParentNodeItem &&\n      iParentNodeItem.name === jParentNodeItem.name &&\n      iParentNodeItem.getType() === Path.TYPE &&\n      jParentNodeItem.getType() === Path.TYPE\n    );\n  }\n\n  //========================================================================================\n  /*                                                                                      *\n   *                                    Private Methods                                   *\n   *                                                                                      */\n  //========================================================================================\n  /**\n   *\n   * @param {*} id: vertex to be updated id\n   * @param {*} newPosition: Vector3, new vertex position\n   * @param {*} is2updateServer: is to update in server boolean var\n   * @param {*} protectEdge: Pair<Int> with vertex indices\n   */\n  updateVertexPosition(id, newPosition, is2updateServer = true) {\n    const { graph } = this;\n    graph.getVertex(id).forEach(({ data: vertexData }) => {\n      vertexData.position = newPosition;\n    });\n    graph.getNeighbors(id).forEach(j => {\n      const i = id;\n      const edgeKey = Graph.edgeKey(i, j);\n      this.meshByEdgeId[edgeKey] && this.meshByEdgeId[edgeKey].dispose();\n      graph.getEdge(i, j).forEach(({ data: edgeData }) => {\n        const [iData, jData] = edgeData.edge;\n        this.buildEdge(iData.mesh, jData.mesh);\n      });\n      if (is2updateServer) this.mainView.updateNodeInServer(this.name);\n    });\n  }\n\n  /**\n   * Get edge directions from meshes\n   * @param {Array} ids : Array with vertexes ids\n   * @returns {Integer} should return always one of the following\n   *  +1  -> if target id is greater than source\n   *  0   -> if ids is not provided\n   *  -1  -> if source id is greater than target\n   */\n  getDirectionFromMeshes(iMesh, jMesh) {\n    if (GraphItem.isInvalidEdge(iMesh, jMesh, true)) return 0;\n    const vertexI = this.getVertexIdFromMesh(iMesh);\n    const vertexJ = this.getVertexIdFromMesh(jMesh);\n    const [i, j] = [vertexI, vertexJ].map(x => Number(x));\n    return (j - i) / Math.abs(j - i);\n  }\n\n  //========================================================================================\n  /*                                                                                      *\n   *                                    Private Methods                                   *\n   *                                                                                      */\n  //========================================================================================\n\n  /**\n   * Delete vertex from nodeTree children\n   * @param {*} nodeTree: List of nodes (initially root.children)\n   */\n  delVertexRecursively(nodeTree = []) {\n    nodeTree.forEach(node => {\n      if (node.item.getType() !== GraphItem.TYPE) {\n        node.item.delVertex();\n        this.delVertexRecursively(node.children);\n      }\n    });\n  }\n\n  /**\n   *\n   * @param {*} mesh: Mesh\n   * @returns Integer| Undefined\n   */\n  getVertexIdFromMesh(mesh) {\n    return mesh?.graphVertex?.vertex?.id;\n  }\n\n  /**\n   *\n   * @param {*} vertexMesh: Mesh\n   * @param {*} vertexIndex: integer representing index of vertex (can be undefined)\n   *\n   */\n  buildVertex(vertexMesh, vertexIndex) {\n    // test if vertexMesh already exists in the graph\n    const vId = this.getVertexIdFromMesh(vertexMesh);\n    const maybeVertex = this.graph.getVertex(vId);\n    maybeVertex.orElseRun(() => {\n      // if vertex doesn't exist\n      const id = vertexIndex ? vertexIndex : this.vertexGenerator++;\n      this.graph.addVertex(id);\n      this.graph.getVertex(id).forEach(vertex => {\n        vertex.data = VertexData.builder()(id, vertexMesh);\n        this.addObs2VertexMesh(vertex.data);\n      });\n    });\n  }\n\n  /**\n   *\n   * @param {*} vData: VertexData\n   */\n  addObs2VertexMesh(vData) {\n    const { mesh } = vData;\n    if (mesh !== undefined) {\n      mesh.graphVertex = {\n        vertex: vData,\n        delVertex: () => this.delVertexFromMesh(mesh),\n        vertexObs: this.getVertexMeshObs(vData)\n      };\n    }\n  }\n\n  /**\n   *\n   * @param {*} vertexData: VertexData\n   */\n  getVertexMeshObs(vertexData) {\n    return ({ updatedPointMesh, is2updateServer, _ }) => {\n      if (updatedPointMesh.isDisposed()) return;\n      const newPos = Util3d.getGlobalCoordinates(\n        updatedPointMesh,\n        updatedPointMesh.position\n      ).toBabylon();\n      this.updateVertexPosition(vertexData.id, newPos, is2updateServer);\n    };\n  }\n\n  /**\n   *\n   * @param {*} iMesh: Mesh\n   * @param {*} jMesh: Mesh\n   * @param {*} edgeMeshes: Array<Mesh>\n   */\n  buildEdge(iMesh, jMesh) {\n    const { graph } = this;\n    // need to sort edge numbers because is undirected graph\n    const [i, j] = [iMesh, jMesh]\n      .map(this.getVertexIdFromMesh)\n      .sort((a, b) => a - b); // reason here: https://stackoverflow.com/questions/15084070/is-this-a-bug-in-array-sort\n    graph.addEdge(i, j);\n    graph.getVertex(i).forEach(({ data: iVertexD }) =>\n      graph.getVertex(j).forEach(({ data: jVertexD }) => {\n        graph.getEdge(i, j).forEach(edge => {\n          if (!edge.data) {\n            edge.data = new EdgeData(iVertexD, jVertexD);\n          } else {\n            edge.data.edge = [iVertexD, jVertexD];\n          }\n        });\n        // if vertices belong to same path don't build mesh\n        if (!this.doMeshesBelong2SamePath(iMesh, jMesh)) {\n          // Get edge forward/backward directions\n          const forwardDirection = this.getDirectionFromMeshes(iMesh, jMesh);\n          const backwardDirection = this.getDirectionFromMeshes(jMesh, iMesh);\n          const direction = forwardDirection + backwardDirection;\n          const edgeMesh = this.getEdgeMesh(iVertexD, jVertexD, direction);\n          this.meshByEdgeId[Graph.edgeKey(i, j)] = edgeMesh;\n          this.meshByEdgeId[Graph.edgeKey(j, i)] = edgeMesh;\n        }\n      })\n    );\n  }\n\n  getEdgeMesh(iVertexD, jVertexD, direction = 0) {\n    const edgeInGlobal = [iVertexD, jVertexD].map(({ mesh }) =>\n      Util3d.getGlobalCoord(mesh, mesh.position)\n    );\n    const edgeMesh = GraphItem.getEdgeMesh(\n      this.scene,\n      edgeInGlobal,\n      `edgeMesh${iVertexD.id}_${jVertexD.id}`,\n      Color3.Yellow()\n    );\n    edgeMesh.visibility = 0.99;\n    edgeMesh.material = GraphItem.getEdgeMaterial(this.scene, {\n      speed: 8 * direction\n    });\n    edgeMesh.parent = this.mesh;\n    edgeMesh.edgeIndexes = [iVertexD, jVertexD].map(({ id }) => id);\n    edgeMesh.getMouseContextActions = this.getEdgeMouseCtxActions(edgeMesh);\n    edgeMesh.onDel = this.onDeleteEdgeLine(edgeMesh);\n    this.addObserver2EdgeMesh(edgeMesh);\n    this.addOnClickEdge(edgeMesh);\n    return edgeMesh;\n  }\n\n  /**\n   *\n   * @param {*} edgeMesh: Mesh\n   * @returns: () => Array<{title: String, onClick: () => {}}>\n   */\n  getEdgeMouseCtxActions = edgeMesh => () => {\n    return [\n      {\n        title: \"Delete\",\n        onClick: this.getUndoDeleteEdgeLineAction(edgeMesh)\n      }\n    ];\n  };\n\n  /**\n   * Prompt confirmation to delete edge line\n   * @param {Mesh} edgeMesh : Edge line mesh to delete\n   * @returns Function to prompt confirmation to delete edge line\n   */\n  onDeleteEdgeLine = edgeMesh => () => {\n    this.mainView.confirmationAlert({\n      title: \"Confirm to delete\",\n      message: \"Are you sure you want to delete this edge?\",\n      onConfirm: this.getUndoDeleteEdgeLineAction(edgeMesh)\n    });\n  };\n\n  /**\n   * Use undoManager to delete edge line\n   * @param {Mesh} edgeMesh : Edge line mesh to delete\n   * @returns Function to delete edge line using undoManager\n   */\n  getUndoDeleteEdgeLineAction = edgeMesh => () =>\n    this.mainView.getUndoManager().doIt(this.getUndoDeleteEdge(edgeMesh));\n\n  /**\n   *\n   * @param {*} edgeMesh: Mesh\n   */\n  addObserver2EdgeMesh(edgeMesh) {\n    edgeMesh.observers = new Observable();\n    edgeMesh.observers.add(this.getEdgeObs());\n  }\n\n  /**\n   * @returns ({updatedPointMesh: Mesh, is2updateServer: Boolean, displacement: Vector3}) => {}\n   */\n  getEdgeObs =\n    () =>\n    ({ updatedPointMesh, is2updateServer, displacement }) => {\n      const v = Vec3.ofBabylon(displacement);\n      const vLocal = Util3d.getLocalCoordFromWorld(this.mesh, v, false);\n      updatedPointMesh.position = updatedPointMesh.position.add(\n        vLocal.scale(-1).toBabylon()\n      );\n      if (is2updateServer) {\n        this.graphFormMapper = this.getToFormEdge(updatedPointMesh);\n        this.mainView.setProperties(this.toForm());\n      }\n    };\n\n  /**\n   *\n   * @param {*} edgeMesh: Mesh\n   */\n  addOnClickEdge(edgeMesh) {\n    edgeMesh.onClick = this.getOnClickEdge(edgeMesh);\n  }\n\n  getOnClickEdge = edgeMesh => () => {\n    const actions = [];\n    actions.push({\n      icon: props => <i className=\"fas fa-trash\" {...props}></i>,\n      action: () => {\n        this.mainView.getUndoManager().doIt(this.getUndoDeleteEdge(edgeMesh));\n      },\n      name: \"Delete Edge [Del]\"\n    });\n    this.mainView.setContextActions(actions);\n  };\n\n  getUndoDeleteEdge(edgeMesh) {\n    const { graph } = this;\n    const { edgeIndexes } = edgeMesh;\n    const [iVertexD, jVertexD] = edgeIndexes\n      .map(i => graph.getVertex(i))\n      .map(maybeV => maybeV.some())\n      .map(({ data }) => data);\n    return this.getUndoDelLineEdge(iVertexD, jVertexD);\n  }\n\n  getUndoDelLineEdge(iVertexD, jVertexD) {\n    const { graph } = this;\n    const edgeVertexD = [iVertexD, jVertexD];\n    const [i, j] = edgeVertexD.map(({ id }) => id);\n    const edgeMeshes = edgeVertexD.map(({ mesh }) => mesh);\n    let edgeProps = { keyValueMap: {}, weight: 1, edge: {} };\n    graph.getEdge(i, j).forEach(({ data: edgeData }) => {\n      edgeProps.keyValueMap = edgeData.keyValueMap;\n      edgeProps.weight = edgeData.weight;\n      edgeProps.edge = edgeData.edge;\n    });\n    return UndoManager.actionBuilder()\n      .doAction(() => {\n        this.delEdge(...edgeMeshes);\n        this.mainView.closeContextDial();\n        this.mainView.updateNodeInServer(this.name);\n      })\n      .undoAction(({ is2UpdateInServer = true }) => {\n        this.addEdge(...edgeMeshes, [i, j]);\n        graph.getEdge(i, j).forEach(({ data: edgeData }) => {\n          edgeData.keyValueMap = edgeProps.keyValueMap;\n          edgeData.weight = edgeProps.weight;\n          edgeData.edge = edgeProps.edge;\n        });\n        if (is2UpdateInServer) this.mainView.updateNodeInServer(this.name);\n      })\n      .build();\n  }\n\n  isMeshBelong2Path = ({ parent }) => {\n    return this.mainView\n      .getNodeFromTree(parent?.name)\n      .filter(({ item }) => item.getType() === Path.TYPE)\n      .orSome(false);\n  };\n\n  /**\n   * Get item name from mesh\n   * @param {Mesh} mesh : Mesh to retrieve name\n   * @returns {String}\n   *  If mesh is a key point belonging to a path, returns parent name\n   *  and returns the mesh name otherwise\n   */\n  getMeshName = mesh => {\n    return this.isMeshBelong2Path(mesh) ? mesh.parent.name : mesh.name;\n  };\n\n  /**\n   * Check if edgeData linking Mesh1 and Mesh2 is valid\n   * @param {Mesh} iMesh : Mesh 1\n   * @param {Mesh} jMesh : Mesh 2\n   * @param {*} edgeData : Edge to be evaluated\n   * @returns {Boolean} True if is invalid and False otherwise\n   */\n  checkInvalidEdges(iMesh, jMesh, edgeData) {\n    // Check if at least one of the meshes is Path\n    //  returns false if any of the meshes is Path\n    const edgeMeshesContainsPath = [iMesh, jMesh]\n      .map(this.isMeshBelong2Path)\n      .some(x => x);\n    if (!edgeMeshesContainsPath) return false;\n    // Identify source and target meshes\n    const srcMesh = [iMesh, jMesh].filter(\n      mesh => this.getMeshName(mesh) === edgeData.belongsSrc.name\n    )[0];\n    const trgMesh = [iMesh, jMesh].filter(\n      mesh => this.getMeshName(mesh) === edgeData.belongsTrg.name\n    )[0];\n    // Call GraphItem.isInvalidEdge function to validate\n    return srcMesh && trgMesh\n      ? GraphItem.isInvalidEdge(srcMesh, trgMesh, true)\n      : false;\n  }\n\n  exportBelongToData = mesh => {\n    const { index, name } = mesh;\n    if (index === null || index === undefined) {\n      return { name };\n    }\n    // if mesh has index, then it must be a path or polygon\n    return this.mainView\n      .getNodeFromTree(mesh?.parent?.name)\n      .map(({ item }) => ({\n        name: item.name,\n        index: index > 0 ? -1 : index\n      }))\n      .orUndefined();\n  };\n  //========================================================================================\n  /*                                                                                      *\n   *                             Static Methods and Variables                             *\n   *                                                                                      */\n  //========================================================================================\n\n  static TYPE = \"GraphItem\";\n\n  static NAME = \"LogicGraph\";\n\n  static ofDict(scene, dict = null, mainView = null) {\n    if (!dict || !mainView)\n      throw new Error(\"null dictionary describing graphItem or null mainView\");\n    const graphItem = new GraphItem(\n      scene,\n      mainView,\n      dict.name,\n      dict.keyValueMap\n    );\n    const { edges } = dict;\n    let vertexCounter = Number.MIN_VALUE;\n    // create mesh of graph using addEdge\n    // map directed graph -> undirected graph\n    Object.values(edges).forEach(({ ids, belongsSrc, belongsTrg }) => {\n      const [i, j] = ids.map(x => Number(x));\n      // update vertex counter\n      vertexCounter = Math.max(vertexCounter, Math.max(i, j));\n      const edgeMeshes = getMeshesFromEdgeData(mainView, {\n        belongsSrc,\n        belongsTrg\n      });\n      const foundMeshes = edgeMeshes.reduce(\n        (e, x) => e && x !== null && x !== undefined,\n        true\n      );\n      if (foundMeshes) {\n        graphItem.addEdge(...edgeMeshes, [i, j]);\n        // add additional data\n        graphItem.graph.getEdge(i, j).forEach(({ data: edgeData }) => {\n          const dataEdge = edges[Graph.edgeKey(i, j)];\n          edgeData.importFeatures(dataEdge);\n        });\n      }\n    });\n    graphItem.vertexGenerator = vertexCounter + 1;\n    return graphItem;\n  }\n\n  static getVertexMesh(\n    scene,\n    vertexPosition,\n    color = Color3.Gray(),\n    radius = Constants.RADIUS\n  ) {\n    const sphere = Util3d.createSphere(scene, color, radius);\n    sphere.position = vertexPosition;\n    return sphere;\n  }\n\n  /**\n   *\n   * @param {*} scene: Scene\n   * @param {*} edge: Array<Vector3>\n   * @param {*} color: Color3\n   * @param {*} radius: Number\n   */\n  static getEdgeMesh(\n    scene,\n    edge,\n    name,\n    color = Color3.Gray(),\n    radius = Constants.RADIUS / 4\n  ) {\n    return Util3d.createTubeFromPoints(scene, edge, color, radius, name);\n  }\n\n  static getEdgeMaterial(\n    scene,\n    { color = Color3.Yellow(), frequency = 8, speed = 0 }\n  ) {\n    return Util3d.getShaderMaterial({\n      vertex: VERTEX,\n      frag: FRAG(frequency, speed, [color.r, color.g, color.b])\n    })(scene);\n  }\n\n  static createGraphItemIfNone = (scene, parentView) =>\n    parentView.getGraph().orElseRun(() => {\n      const graphItem = new GraphItem(scene, parentView);\n      graphItem.mesh.parent = parentView.getRootNode().item.mesh;\n      parentView.addNodeItem2Tree(graphItem);\n    });\n\n  /**\n   * Check if edge being draw is invalid\n   *    Invalid Edge 1   : validate direction\n   *    Invalid Edge 1.1 : not possible link from start to end, only end to start\n   *    Invalid Edge 1.2 : not possible link from start of a path to a keyPoint, only keyPoint to start of path\n   *    Invalid Edge 1.3 : not possible link from keyPoint to end of a path, only end of path to keyPoint\n   *    Invalid Edge 2   : from the end of a path to the end of another path\n   *    Invalid Edge 3   : from the start of a path to the start of another path\n   *    Invalid Edge 4   : firstMesh and secondMesh has same name (impossible to link mesh to itself)\n   *\n   * @param {Mesh} firstMesh: origin/source edge mesh\n   * @param {Mesh} secondMesh: destination/target edge mesh\n   * @param {Boolean} validateDirection : Flag to inform if function should validate direction (false by default)\n   * @returns {Boolean} True if has any validation error and False otherwise\n   */\n  static isInvalidEdge = (firstMesh, secondMesh, validateDirection = false) => {\n    const firstMeshParent = firstMesh.parent?.nodeItem;\n    const secondMeshParent = secondMesh.parent?.nodeItem;\n    const validationError = [];\n    // Validate invalid edges between paths\n    if (\n      Util3d.getNodeItemTypeFromMesh(firstMesh) === Path.TYPE &&\n      Util3d.getNodeItemTypeFromMesh(secondMesh) === Path.TYPE\n    ) {\n      const origin = firstMesh.index / (firstMeshParent.keyPoints.length - 1);\n      const target = secondMesh.index / (secondMeshParent.keyPoints.length - 1);\n      // Validate direction\n      if (validateDirection) {\n        // Invalid Edge 1.1 validation\n        if (origin === 0 && target === 1) validationError.push(1.1);\n      }\n      // Invalid Edge 2 validation\n      if (origin === 1 && target === 1) validationError.push(2);\n      // Invalid Edge 3 validation\n      if (origin === 0 && target === 0) validationError.push(3);\n    }\n    // Validate direction\n    if (validateDirection) {\n      // Invalid Edge 1.2 validation\n      if (\n        Util3d.getNodeItemTypeFromMesh(firstMesh) === Path.TYPE &&\n        Util3d.getNodeItemTypeFromMesh(secondMesh) === KeyPoint.TYPE\n      ) {\n        if (firstMesh.index / (firstMeshParent.keyPoints.length - 1) === 0)\n          validationError.push(1.2);\n      }\n      // Invalid Edge 1.3 validation\n      if (\n        Util3d.getNodeItemTypeFromMesh(firstMesh) === KeyPoint.TYPE &&\n        Util3d.getNodeItemTypeFromMesh(secondMesh) === Path.TYPE\n      ) {\n        if (secondMesh.index / (secondMeshParent.keyPoints.length - 1) === 1)\n          validationError.push(1.3);\n      }\n    }\n    // Invalid Edge 4 validation\n    if (firstMesh.name === secondMesh.name) validationError.push(4);\n    // Return if there's any validation error\n    return validationError.length > 0;\n  };\n}\n\nconst graphItemInstances = {};\nconst getGraphPlaceHolder = (scene, name) => {\n  const graphPlaceHolder = Util3d.createSphere(\n    scene,\n    Color3.Gray(),\n    Number.MIN_VALUE,\n    name,\n    false\n  );\n  graphPlaceHolder.position = Vector3.Zero();\n  graphPlaceHolder.scaling = Vector3.One();\n  graphPlaceHolder.rotationQuaternion = Quaternion.Identity();\n  graphPlaceHolder.visibility = 0.0;\n  return graphPlaceHolder;\n};\n\nconst getMeshesFromEdgeData = (mainView, edgeProps) => {\n  const { belongsSrc, belongsTrg } = edgeProps;\n  const edgeMesh = [belongsSrc, belongsTrg].map(({ name, index }) => {\n    return mainView\n      .getNodeFromTree(name)\n      .map(({ item }) => {\n        if (index === null || index === undefined) return item.mesh;\n        // if has index, then it must be a path or polygon\n        const ind = index < 0 ? item.keyPoints.length - 1 : index;\n        return item.keyPoints[ind];\n      })\n      .orUndefined();\n  });\n  return edgeMesh;\n};\n\nclass VertexData {\n  /**\n   *\n   * @param {*} id: Integer\n   * @param {*} mesh: Mesh\n   * @param {*} position:\n   */\n  constructor(id, mesh, position) {\n    this.id = id;\n    this.mesh = mesh;\n    this.position = position;\n  }\n\n  static builder() {\n    return (id, mesh) => {\n      const globalPos = Util3d.getGlobalCoordinates(\n        mesh,\n        mesh.position\n      ).toBabylon();\n      return new VertexData(id, mesh, globalPos);\n    };\n  }\n}\n\nclass EdgeData {\n  constructor(vertexDataI, vertexDataJ, keyValueMap = {}) {\n    this.edge = [vertexDataI, vertexDataJ];\n    this.keyValueMap = keyValueMap;\n    this.weight = 1.0;\n  }\n\n  importFeatures({ keyValueMap, weight }) {\n    this.keyValueMap = keyValueMap;\n    this.weight = weight;\n  }\n}\n\nconst VERTEX = `\nprecision highp float;\n// Attributes\nattribute vec3 position;\nattribute vec3 normal;\nattribute vec2 uv;\n\n// Uniforms\nuniform mat4 worldViewProjection;\n\n// Varying\nvarying vec3 vPosition;\nvarying vec3 vNormal;\nvarying vec2 vUV;\n\nvoid main(void) {\n    vec4 outPosition = worldViewProjection * vec4(position, 1.0);\n    gl_Position = outPosition;\n\n    vUV = uv;\n    vPosition = position;\n    vNormal = normal;\n}`;\n\nconst FRAG = (freq = 8, speed = 2, color) => `\n#define PI 3.1415926538\nprecision highp float;\n\n// Varying\nvarying vec3 vPosition;\nvarying vec3 vNormal;\nvarying vec2 vUV;\n\n// Refs\nuniform float time;\n\nvoid main(void) {\n    vec3 color = vec3(${color[0]}, ${color[1]}, ${color[2]});\n    float frequency = ${Number(freq).toFixed(1)};\n    float speed = ${Number(speed).toFixed(1)};\n    gl_FragColor = vec4(color, max(0.,sin(2. * PI * vUV.y * frequency - speed * time)));\n}`;\n\nexport default GraphItem;\n","module.exports = require(\"@material-ui/core/MenuItem\");","module.exports = require(\"@babel/runtime/helpers/esm/objectWithoutProperties\");","module.exports = require(\"@material-ui/core/Typography\");","import NodeItem from \"./NodeItem\";\nimport Util3d from \"../Util3d/Util3d\";\nimport { Maybe } from \"monet\";\nimport { MeshBuilder, Quaternion, StandardMaterial } from \"@babylonjs/core\";\n\nclass KeyPoint extends NodeItem {\n  ofDict(scene, dict = null, mainView = null) {\n    return KeyPoint.ofDict(scene, dict, mainView);\n  }\n\n  getType = () => KeyPoint.TYPE;\n\n  static TYPE = \"KeyPoint\";\n\n  static ofDict(scene, dict = null, mainView = null) {\n    const name = Maybe.fromNull(dict)\n      .map(x => x.name)\n      .orSome(`KeyPoint${Math.floor(Math.random() * 1e3)}`);\n\n    const mesh = MeshBuilder.CreatePolyhedron(\n      name,\n      { custom: TRIANGULAR_ANTIPRISM, size: KeyPoint.DEFAULT_SIZE },\n      scene\n    );\n    const material = new StandardMaterial(`KeyPointMaterial${name}`, scene);\n    mesh.material = material;\n    mesh.convertToFlatShadedMesh();\n    mesh.rotationQuaternion = Quaternion.Identity();\n\n    const axis = Util3d.referentialBuilder(scene)\n      .isPickable(false)\n      .boxParams({ isVisible: false, size: 0.1 * KeyPoint.DEFAULT_SIZE })\n      .name(`${name}Axis`)\n      .build();\n    axis.parent = mesh;\n\n    NodeItem.mapDict2Mesh(dict, mesh);\n    return new KeyPoint(mesh, dict.keyValueMap);\n  }\n\n  static DEFAULT_SIZE = 0.25;\n}\n\nconst TRIANGULAR_ANTIPRISM = {\n  name: \"Triangular Antiprism (Octahedron)\",\n  category: [\"Antiprism\"],\n  vertex: [\n    [0, 0, 1.414214],\n    [1.414214, 0, 0],\n    [0, 1.414214, 0],\n    [-1.414214, 0, 0],\n    [0, -1.414214, 0],\n    [0, 0, -1.414214]\n  ],\n  face: [\n    [0, 1, 2],\n    [0, 2, 3],\n    [0, 3, 4],\n    [0, 4, 1],\n    [1, 4, 5],\n    [1, 5, 2],\n    [2, 5, 3],\n    [3, 5, 4]\n  ]\n};\n\nexport default KeyPoint;\n","module.exports = require(\"@material-ui/core/IconButton\");","module.exports = require(\"@material-ui/core/FormControl\");","module.exports = require(\"@material-ui/core/Divider\");","import { Clipboard as Clip } from \"mov-fe-lib-core\";\n\nconst SCENE_CONTEXT = \"scene\";\nlet COPY_PASTE_UID = 0;\n\nexport default class Clipboard {\n  static copy(value) {\n    Clip.write(SCENE_CONTEXT, value);\n  }\n  static paste() {\n    return Clip.read(SCENE_CONTEXT);\n  }\n\n  static getUID() {\n    return COPY_PASTE_UID++;\n  }\n}\n","module.exports = require(\"@material-ui/icons/Search\");","import { Maybe } from \"monet\";\n\nfunction getNodeRecursive(tree, predicate) {\n  for (let i = 0; i < tree.length; i++) {\n    const node = tree[i];\n    if (predicate(node)) return Maybe.some(node);\n    const answer = getNodeRecursive(node.children, predicate);\n    if (answer.isSome()) return answer;\n  }\n  return Maybe.none();\n}\n\nfunction getParentNodeRecursive(tree, predicate, parent) {\n  const foundChild = tree\n    .map(x => predicate(x))\n    .reduce((e, x) => e || x, false);\n  if (foundChild) return Maybe.fromNull(parent);\n  for (let i = 0; i < tree.length; i++) {\n    const node = tree[i];\n    const answer = getParentNodeRecursive(node.children, predicate, node);\n    if (answer.isSome()) return answer;\n  }\n  return Maybe.none();\n}\n\nfunction compareTreesRecursive(treeA, treeB, nodeEquality) {\n  if (treeA.length === treeB.length) {\n    let ans = true;\n    for (let i = 0; i < treeA.length; i++) {\n      const nodeA = treeA[i];\n      const nodeB = treeB[i];\n      if (nodeEquality(nodeA, nodeB)) {\n        ans =\n          ans &&\n          compareTreesRecursive(nodeA.children, nodeB.children, nodeEquality);\n      } else {\n        return false;\n      }\n    }\n    return ans;\n  }\n  return false;\n}\n\nfunction mapRecursive(tree, newTree, map) {\n  tree.forEach(nod => {\n    const node = { ...nod };\n    const mappedNode = map(node);\n    mappedNode.children = mapRecursive(node.children, [], map);\n    newTree.push(mappedNode);\n  });\n  return newTree;\n}\n\nfunction forEachRecursive(tree = [], forEach = () => {}) {\n  tree.forEach(node => {\n    forEach(node);\n    forEachRecursive(node.children, forEach);\n  });\n}\n\nfunction expand(node) {\n  node.expanded = true;\n  return node;\n}\n\nfunction filterTree(tree = [], predicate = node => true) {\n  if (!tree || tree.length === 0) return [];\n  let result = [];\n  tree.forEach(nod => {\n    const node = { ...nod };\n    if (predicate(node)) {\n      const expanded = expand(node);\n      expanded.children = filterTree(expanded.children, predicate);\n      result.push(expanded);\n    } else if (node.children) {\n      const children = filterTree(node.children, predicate);\n      if (children.length !== 0) {\n        node.children = children;\n        result.push(expand(node));\n      }\n    }\n  });\n  return result;\n}\n\nfunction flatten(tree = [], predicate = node => true) {\n  if (!tree || tree.length === 0) return [];\n  let result = [];\n  tree.forEach(nod => {\n    const node = { ...nod };\n    if (predicate(node)) result.push(node);\n    result = result.concat(flatten(node.children, predicate));\n  });\n  return result;\n}\n\n/**\n * General purpose tree\n *\n * It just need a basic structure as input:\n *  Tree: Array<Node>\n *  Node: {children: Array<Node>}\n */\nclass TreeObject {\n  constructor(tree) {\n    this.tree = tree;\n  }\n  /**\n   * Return maybe node based on predicate\n   * @param {*} predicate\n   */\n  getNode(predicate) {\n    return getNodeRecursive(this.tree, predicate);\n  }\n\n  /**\n   * return maybe parent node based on the child predicate\n   * @param {*} childPredicate\n   */\n  getParentNode(childPredicate) {\n    return getParentNodeRecursive(this.tree, childPredicate, null);\n  }\n\n  equals(tree, nodeEquality = (a, b) => a === b) {\n    if (tree.constructor === TreeObject) {\n      return compareTreesRecursive(this.tree, tree.tree, nodeEquality);\n    }\n    return compareTreesRecursive(this.tree, tree, nodeEquality);\n  }\n\n  map(nodeMap) {\n    return new TreeObject(mapRecursive(this.tree, [], nodeMap));\n  }\n\n  filter(predicate = node => true) {\n    return new TreeObject(filterTree(this.tree, predicate));\n  }\n\n  /**\n   *\n   * @param {*} predicate: node => Boolean\n   * @returns Array with flattened tree while filtering values with predicate\n   */\n  flatten(predicate = node => true) {\n    return flatten(this.tree, predicate);\n  }\n\n  forEach(map) {\n    forEachRecursive(this.tree, map);\n  }\n}\n\nexport default TreeObject;\n","module.exports = require(\"@material-ui/core/Grid\");","module.exports = require(\"@material-ui/icons/ChevronRight\");","import NodeItem from \"./NodeItem\";\nimport Util3d from \"../Util3d/Util3d\";\nimport { Maybe } from \"monet\";\nimport {\n  Color3,\n  Mesh,\n  Observable,\n  Quaternion,\n  StandardMaterial,\n  Vector3,\n  VertexBuffer,\n  VertexData\n} from \"@babylonjs/core\";\nimport Vec3 from \"../Math/Vec3\";\nimport Constants from \"../Utils/Constants\";\nimport { Animator } from \"../Utils/Animator\";\nimport { Service, ServiceRequest, Ros } from \"roslib\";\nimport { MasterDB } from \"mov-fe-lib-core\";\n\nconst MESSAGES = {\n  failGenerateCurve: \"Fail to generate navigation preview.\"\n};\n\nclass NavigationPreviewItem extends NodeItem {\n  /**\n   *\n   * @param {*} mesh: Mesh\n   * @param {*} poses\n   * @param {*} robotConfig\n   * @param {*} scene\n   * @param {*} mainView\n   */\n  constructor(mesh, poses, robotConfig, scene, mainView) {\n    super(mesh, {});\n    this.poses = poses;\n    this.robotConfig = robotConfig;\n    this.scene = scene;\n    this.mainView = mainView;\n    this.arrowMeshes = this.createArrowMeshes();\n    this.navPath = this.createNavPath();\n  }\n\n  ofDict(scene, dict = null, mainView = null) {\n    return NavigationPreviewItem.ofDict(scene, dict, mainView);\n  }\n\n  dispose() {\n    this.navPath && this.navPath.dispose();\n    this.arrowMeshes.forEach(arrow => arrow.dispose());\n  }\n\n  toDict() {\n    const dict = super.toDict();\n    dict.poses = this.poses;\n    dict.robotConfig = this.robotConfig;\n    return dict;\n  }\n\n  toForm() {\n    const form = super.toForm();\n    delete form.jsonSchema.properties.position;\n    delete form.jsonSchema.properties.rotation;\n    delete form.jsonSchema.properties.color;\n    delete form.jsonSchema.properties.annotations;\n    delete form.uiSchema.position;\n    delete form.uiSchema.rotation;\n    delete form.uiSchema.color;\n    delete form.data.position;\n    delete form.data.rotation;\n    delete form.data.color;\n    delete form.data.annotations;\n    form.jsonSchema.properties.config = {\n      type: \"string\",\n      title: \"Robot Configuration\"\n    };\n    form.uiSchema.config = {\n      \"ui:widget\": \"selectScopeModal\",\n      \"ui:options\": {\n        scopeList: \"Configuration\",\n        name: \"Robot Config\",\n        filter: e => true\n      }\n    };\n    form.data.config = this.robotConfig;\n    return form;\n  }\n\n  ofForm(form) {\n    this.name = form.name;\n    this.mesh.name = form.name;\n    this.robotConfig = form.config;\n  }\n\n  createArrowMeshes() {\n    return this.poses.map((pose, i) => {\n      const beginPos = Vec3.of(pose.position).toBabylon();\n      const theta = 2 * Math.atan2(pose.orientation[3], pose.orientation[0]);\n      const endPos = new Vector3(Math.cos(theta), Math.sin(theta), 0).add(\n        beginPos\n      );\n      const arrowMesh = Util3d.getArrow(\n        this.scene,\n        `${this.name}Pose${i}`,\n        beginPos,\n        endPos,\n        Constants.RADIUS / 6\n      );\n      arrowMesh.parent = this.mesh;\n      arrowMesh.getChildren().forEach(m => {\n        m.material = Util3d.getMaterialFromColor(\n          i % 2 === 0 ? Color3.Red() : Color3.Green()\n        );\n        m.material.freeze();\n        m.observers = new Observable();\n        m.observers.add(this.getArrowObserver(this.mainView));\n        m.onClick = () => {\n          this.mainView.highlightNodesInTree([this.name]);\n          this.mainView.setProperties(this.toForm());\n          setTimeout(() => {\n            this.mainView.highlightMeshesInScene(\n              this.arrowMeshes.flatMap(m => m.getChildren())\n            );\n          });\n        };\n        m.onDel = () => this.mainView.deleteNodeFromTreeUsingName(this.name);\n      });\n      return arrowMesh;\n    });\n  }\n\n  createNavPath() {\n    const navPath = new NavigationPath(this);\n    navPath.play();\n    return navPath;\n  }\n\n  getType = () => NavigationPreviewItem.TYPE;\n\n  static TYPE = \"NavigationPreviewItem\";\n\n  static ofDict(scene, dict = null, mainView = null) {\n    const name = Maybe.fromNull(dict)\n      .map(x => x.name)\n      .orSome(`NavPreview${Math.floor(Math.random() * 1e3)}`);\n\n    const mesh = new Mesh(name, scene);\n    mesh.position = Vector3.Zero();\n    mesh.scaling = Vector3.One();\n    mesh.rotationQuaternion = Quaternion.Identity();\n    mesh.isPickable = false;\n    const navPreviewItem = new NavigationPreviewItem(\n      mesh,\n      dict.poses,\n      dict.robotConfig,\n      scene,\n      mainView\n    );\n    return navPreviewItem;\n  }\n\n  getArrowObserver(mainView) {\n    return ({ updatedPointMesh, is2updateServer, displacement }) => {\n      const v = Vec3.ofBabylon(displacement);\n      const vLocal = Util3d.getLocalCoordFromWorld(this.mesh, v, false);\n      updatedPointMesh.position = updatedPointMesh.position.add(\n        vLocal.scale(-1).toBabylon()\n      );\n      if (is2updateServer) {\n        mainView.setProperties(this.toForm());\n      }\n    };\n  }\n}\n\nclass NavigationPath {\n  constructor(navItem) {\n    this.navItem = navItem;\n    this.scene = navItem.scene;\n    this.mainView = navItem.mainView;\n    this.pathPromise = this.getPathFromService(\n      this.navItem.poses,\n      this.navItem.robotConfig\n    );\n    this.pathPromise.then(({ path }) => {\n      this.pathPoses = path.poses.map(x => x.pose);\n      this.mesh = this.getNavigationPathMesh(this.pathPoses);\n      this.animator = this.getAnimator();\n    });\n  }\n\n  play() {\n    this.pathPromise.then(() => {\n      this.animator.play();\n    });\n  }\n\n  stop() {\n    this.pathPromise.then(() => {\n      this.animator.stop();\n    });\n  }\n\n  dispose() {\n    this.mesh && this.mesh.dispose();\n    this.stop();\n  }\n\n  getAnimator() {\n    const n = this.pathPoses.length;\n    return Animator.builder()\n      .initialState({\n        time: 0,\n        T: new Date().getTime(),\n        indices: [...Array(n)].map((_, i) => i)\n      })\n      .nextState(s => {\n        const { time, T, indices } = s;\n        const indexSpeed = 3;\n        const dt = (new Date().getTime() - T) / 1000;\n        const positions = [...Array(n)];\n        // with circle topology, check modular arithmetic below\n        indices.forEach(\n          (index, i) => (indices[i] = (index + indexSpeed * dt) % n)\n        );\n        positions.forEach((_, i) => {\n          let iPrev = Math.floor(indices[i]);\n          let iNext = Math.ceil(indices[i]);\n          const t = (indices[i] - iPrev) / (iNext - iPrev);\n          if (indices[i] > n - 1) {\n            iPrev = 0;\n            iNext = 1;\n          }\n          positions[i] = Vec3.of([\n            this.pathPoses[iPrev].position.x,\n            this.pathPoses[iPrev].position.y,\n            this.pathPoses[iPrev].position.z\n          ])\n            .scale(1 - t)\n            .add(\n              Vec3.of([\n                this.pathPoses[iNext].position.x,\n                this.pathPoses[iNext].position.y,\n                this.pathPoses[iNext].position.z\n              ]).scale(t)\n            )\n            .toArray();\n        });\n        this.mesh.updateVerticesData(\n          VertexBuffer.PositionKind,\n          positions.flatMap(x => x)\n        );\n        return {\n          time: time + dt,\n          T: new Date().getTime(),\n          indices\n        };\n      })\n      .while(_ => !this.scene.isDisposed)\n      .build();\n  }\n\n  getNavigationPathMesh(pathPoses) {\n    const pointCloudMesh = new Mesh(\n      `cloudPoint${this.navItem.name}`,\n      this.scene\n    );\n    const mat = new StandardMaterial(\n      `cloudPoint${this.navItem.name}Material`,\n      this.scene\n    );\n    mat.emissiveColor = new Color3(1, 1, 1);\n    mat.disableLighting = true;\n    mat.pointsCloud = true;\n    mat.pointSize = 5;\n    pointCloudMesh.material = mat;\n    pointCloudMesh.isPickable = false;\n\n    const vertexData = new VertexData();\n    const points = pathPoses.map(({ position }) => [\n      position.x,\n      position.y,\n      position.z\n    ]);\n    //Assign positions\n    vertexData.positions = points.flatMap(x => x);\n    const colors = new Array(4 * points.length);\n    vertexData.colors = colors.fill(1.0);\n    //Apply vertexData to custom mesh\n    vertexData.applyToMesh(pointCloudMesh, true);\n    pointCloudMesh.parent = this.navItem.mesh;\n    return pointCloudMesh;\n  }\n\n  getPathFromService([startPose, endPose], robotConfig) {\n    const ros = new Ros({\n      url: BRIDE_CONNECTION\n    });\n    const inputMessage = {\n      scene: this.mainView.sceneName,\n      robot_config: this.navItem.robotConfig,\n      initial_pose: rosPoseFromPose(startPose),\n      final_pose: rosPoseFromPose(endPose)\n    };\n\n    return new Promise(res => {\n      // If there is an error on the backend, an 'error' emit will be emitted.\n      ros.on(\"error\", error => {\n        console.log(\"Navigation Service \", error);\n        // fall back to default\n        this.getDefaultPath(inputMessage, res);\n      });\n      // Find out exactly when we made a connection.\n      ros.on(\"connection\", () => {\n        console.log(\"Navigation Service Connection made!\");\n      });\n\n      ros.on(\"close\", () => {\n        console.log(\"Navigation Service Connection closed.\");\n      });\n\n      const navigationService = new Service({\n        ros: ros,\n        name: SERVICE_NAME,\n        serviceType: SERVICE_TYPE\n      });\n      const request = new ServiceRequest(inputMessage);\n      navigationService.callService(\n        request,\n        result => {\n          ros.close();\n          res(result);\n        },\n        error => {\n          // fall back to default\n          this.getDefaultPath(inputMessage, res);\n        }\n      );\n    });\n  }\n\n  getDefaultPath(msg, resolve) {\n    MasterDB.cloudFunction(\n      Constants.NAV_CLOUD_NAME,\n      \"generate_path\",\n      [msg.scene, msg.initial_pose, msg.final_pose, msg.robot_config],\n      data => {\n        console.log(\"Got default path\", data.success);\n        if (data.success) {\n          resolve({ path: data.result });\n        } else {\n          console.log(\"Caught exception in default path\", data.error);\n          this.getPathFromPoses(this.navItem.poses)\n            .then(path => resolve({ path }))\n            .catch(err => {\n              console.log(\"Caught error in getPathFromPoses\", err);\n              this.mainView.showAlert(MESSAGES.failGenerateCurve, \"error\");\n            });\n        }\n      }\n    ).catch(error => {\n      console.log(\"debug couldn't execute default generate path\", error);\n      this.getPathFromPoses(this.navItem.poses)\n        .then(path => resolve({ path }))\n        .catch(err => {\n          console.log(\"Caught error in getPathFromPoses\", err);\n          this.mainView.showAlert(MESSAGES.failGenerateCurve, \"error\");\n        });\n    });\n  }\n\n  getPathFromPoses(poses, samples = 25) {\n    const [start, end] = poses;\n    const startPos = Vec3.of(start.position);\n    const endPos = Vec3.of(end.position);\n    const v = endPos.sub(startPos);\n    const nextPoint = startPos\n      .add(v.scale(0.5))\n      .add(Vec3.of([start.orientation[0], start.orientation[3], 0]).scale(2));\n    const nextNextPoint = endPos\n      .add(v.scale(-0.5))\n      .add(Vec3.of([end.orientation[0], end.orientation[3], 0]).scale(2));\n    const splineCage = [startPos, nextPoint, nextNextPoint, endPos];\n    const path = [...Array(samples)];\n    for (let i = 0; i < samples; i++) {\n      path[i] = polyInterpolation(splineCage, i / (samples - 1)).toArray();\n    }\n    return new Promise(re =>\n      re({\n        poses: path.map(point => ({\n          pose: {\n            position: { x: point[0], y: point[1], z: point[2] },\n            orientation: { x: 0, y: 0, z: 0, w: 1 }\n          }\n        }))\n      })\n    );\n  }\n}\n\n/**\n *\n * @param {*} cage: Array<Vec3>\n * @param {*} t: [0,1] real\n * @returns\n */\nfunction polyInterpolation(cage, t) {\n  if (cage.length === 1) return cage[0];\n  const [, ...tail] = cage;\n  let pairs = zip(cage, tail);\n  pairs.splice(-1, 1);\n  const newCage = pairs.map(([x, y]) => {\n    return lerp(x, y)(t);\n  });\n  return polyInterpolation(newCage, t);\n}\n/**\n *\n * @param {*} x: Vec3\n * @param {*} y: Vec3\n * @returns t: [0,1] real => Vec3\n */\nfunction lerp(x, y) {\n  return t => {\n    return x.scale(1 - t).add(y.scale(t));\n  };\n}\n/**\n *\n * @param {*} a: Array\n * @param {*} b: Array\n * @returns\n */\nfunction zip(a, b) {\n  return a.map((x, i) => [x, b[i]]);\n}\n\nfunction rosPoseFromPose({ position, orientation }) {\n  return {\n    position: {\n      x: position[0],\n      y: position[1],\n      z: position[2]\n    },\n    orientation: {\n      w: orientation[0],\n      x: orientation[1],\n      y: orientation[2],\n      z: orientation[3]\n    }\n  };\n}\n\nconst SERVICE_NAME = \"/generate_path/path_points/in\";\nconst SERVICE_TYPE = \"movai_common/GeneratePath\";\nconst BRIDE_CONNECTION = \"ws://localhost:9090\";\n\nexport default NavigationPreviewItem;\n","module.exports = require(\"react-dom\");","module.exports = require(\"@material-ui/core/Input\");","module.exports = require(\"@material-ui/core/Menu\");","module.exports = require(\"@babylonjs/gui/2D\");","module.exports = require(\"@material-ui/core/Select\");","module.exports = require(\"@material-ui/core/Avatar\");","module.exports = require(\"@babylonjs/gui\");","module.exports = require(\"@material-ui/icons/Clear\");","module.exports = require(\"@material-ui/core/InputLabel\");","module.exports = require(\"clsx\");","class TreeNode {\n  constructor(title, item, children, expanded, isVisible, isStatic = false) {\n    this.title = title;\n    this.item = item;\n    this.children = children;\n    this.expanded = expanded;\n    this.isVisible = isVisible;\n    this.isStatic = isStatic;\n  }\n\n  static dispose(node) {\n    /*\n     * function must be defined here, otherwise it wouldn't work on the UI Tree change method\n     */\n    node.item.dispose();\n    node.children.forEach(child => {\n      TreeNode.dispose(child);\n    });\n  }\n\n  /**\n   *\n   * @param {*} node\n   */\n  static toDict(node) {\n    /*\n     * function must be defined here, otherwise it wouldn't work on the UI Tree change method\n     */\n    return {\n      name: node.title,\n      item: node.item.toDict(),\n      children: node.children.map(child => TreeNode.toDict(child))\n    };\n  }\n\n  static builder() {\n    return new TreeNodeBuilder();\n  }\n}\n\nclass TreeNodeBuilder {\n  constructor() {\n    this._title = null;\n    this._item = {};\n    this._children = [];\n    this._expanded = false;\n    this._isVisible = true;\n    this._isStatic = false;\n  }\n\n  /**\n   * Node title shown on the tree\n   * @param {*} title : Node name displayed on the tree\n  */\n  title(title) {\n    this._title = title;\n    return this;\n  }\n\n  /**\n   * Represents the node item - an instance of the NodeItem class\n   * @param {*} item : Node item\n  */\n  item(item) {\n    this._item = item;\n    return this;\n  }\n\n  /**\n   * List of nodes children under the object\n   * @param {*} children : Children list\n  */\n  children(children) {\n    this._children = children;\n    return this;\n  }\n\n  /**\n   * Indicate the node expansion state, if true means the node is expanded in the scene\n   * @param {*} expanded : expansion state\n  */\n  expanded(expanded) {\n    this._expanded = expanded;\n    return this;\n  }\n\n  /**\n   * Indicate the node visibility state, if true means the node is visible in the scene\n   * @param {*} isVisible : visibility state\n  */\n  isVisible(isVisible) {\n    this._isVisible = isVisible;\n    return this;\n  }\n\n  /**\n   * A static node can't have any children in the object tree and its parent must be of type GlobalRef\n   * @param {*} isStatic : static state\n  */\n  isStatic(isStatic) {\n    this._isStatic = isStatic;\n    return this;\n  }\n\n  /**\n   * Build the TreeNode object\n  */\n  build() {\n    Object.values(this).forEach(value => {\n      if (value === null)\n        throw new Error(\n          `There are missing variables to build a TreeNode, e.g ${value}`\n        );\n    });\n    return new TreeNode(\n      this._title,\n      this._item,\n      this._children,\n      this._expanded,\n      this._isVisible,\n      this._isStatic,\n    );\n  }\n}\n\nexport default TreeNode;\n","module.exports = require(\"@material-ui/core/Button\");","module.exports = require(\"@material-ui/icons/Close\");","module.exports = require(\"lodash/debounce\");","module.exports = require(\"@material-ui/icons/ExpandMore\");","module.exports = require(\"react-resize-detector\");","import NodeItem from \"./NodeItem\";\nimport { Maybe } from \"monet\";\nimport Util3d from \"../Util3d/Util3d\";\nimport { Color3 } from \"@babylonjs/core\";\n\nclass Box extends NodeItem {\n  static DEFAULT_SIZE = 0.5;\n\n  constructor(mesh, size = Box.DEFAULT_SIZE, keyValueMap = {}) {\n    super(mesh, keyValueMap);\n    this.size = size;\n  }\n\n  toDict() {\n    const dict = super.toDict();\n    dict.size = this.size;\n    return dict;\n  }\n\n  ofDict(scene, dict = null, mainView = null) {\n    return Box.ofDict(scene, dict, mainView);\n  }\n\n  getType = () => Box.TYPE;\n\n  static TYPE = \"Box\";\n\n  static ofDict(scene, dict = null, mainView = null) {\n    const maybeDict = Maybe.fromNull(dict);\n    const size = maybeDict\n      .flatMap(z => Maybe.fromNull(z.size))\n      .orSome(Box.DEFAULT_SIZE);\n    const name = maybeDict\n      .flatMap(z => Maybe.fromNull(z.name))\n      .orSome(`Box${Math.floor(Math.random() * 1e3)}`);\n    const keyValueMap = maybeDict\n      .flatMap(d => Maybe.fromNull(d.keyValueMap))\n      .orUndefined();\n\n    const boxMesh = Util3d.createBox(\n      scene,\n      new Color3(Math.random(), Math.random(), Math.random()),\n      size,\n      name\n    );\n    NodeItem.mapDict2Mesh(dict, boxMesh);\n    return new Box(boxMesh, size, keyValueMap);\n  }\n}\n\nexport default Box;\n","export class Animator {\n  constructor(state, next, doWhile) {\n    this.state = state;\n    this.next = next;\n    this.while = doWhile;\n    this.requestAnimeId = null;\n  }\n\n  play() {\n    this.requestAnimeId = requestAnimationFrame(() => {\n      if (!this.while(this.state)) return this.stop();\n      this.state = this.next(this.state);\n      this.play();\n    });\n    return this;\n  }\n\n  stop() {\n    cancelAnimationFrame(this.requestAnimeId);\n    return this;\n  }\n\n  static builder() {\n    return new AnimatorBuilder();\n  }\n}\n\nclass AnimatorBuilder {\n  constructor() {\n    this._state = null;\n    this._next = null;\n    this._end = null;\n  }\n\n  initialState(state) {\n    this._state = state;\n    return this;\n  }\n\n  nextState(next) {\n    this._next = next;\n    return this;\n  }\n\n  while(end) {\n    this._end = end;\n    return this;\n  }\n\n  build() {\n    const someAreEmpty = [this._state, this._next, this._end].some(\n      x => x === null || x === undefined\n    );\n    if (someAreEmpty) throw new Error(\"Animator properties are missing\");\n    return new Animator(this._state, this._next, this._end);\n  }\n}\n","module.exports = require(\"@material-ui/icons/Settings\");","module.exports = require(\"lodash/isEqual\");","module.exports = require(\"@material-ui/core/CircularProgress\");","module.exports = require(\"@material-ui/core/colors\");","module.exports = require(\"roslib\");","import TreeObject from \"../TreeObject/TreeObject\";\nimport TreeNode from \"../TreeObject/TreeNode\";\nimport GlobalRef from \"../NodeItem/GlobalRef\";\nimport { MasterDB } from \"mov-fe-lib-core\";\nimport Constants from \"./Constants\";\nimport GraphItem from \"../NodeItem/GraphItem\";\nimport NavigationPreviewItem from \"../NodeItem/NavigationPreviewItem\";\nimport _debounce from \"lodash/debounce\";\n\nconst CLOUD_FUNCTION_NAME = Constants.CLOUD_FUNCTION_NAME;\n\nclass TreeServerUtils {\n  constructor(sceneName, undoManager, alert = window.alert) {\n    this.sceneName = sceneName;\n    this.undoManager = undoManager;\n    this.alert = (msg, type) => alert(msg, type);\n    this.staticNodeTypes = [GraphItem.TYPE, NavigationPreviewItem.TYPE];\n  }\n\n  static ofScene(sceneName, undoManager, alert) {\n    return new TreeServerUtils(sceneName, undoManager, alert);\n  }\n\n  static undoAction = _debounce(utils => utils.lostConnection(), 500);\n\n  //========================================================================================\n  /*                                                                                      *\n   *                                    Util functions                                    *\n   *                                                                                      */\n  //========================================================================================\n\n  getNodeFromTree = (name, objectTree) => {\n    return new TreeObject(objectTree).getNode(x => name === x.title);\n  };\n\n  getParentFromChild = (childName, objectTree) => {\n    return new TreeObject(objectTree).getParentNode(x => childName === x.title);\n  };\n\n  deleteNodeFromTreeUsingName = (name, objectTree, is2delInServer = true) => {\n    this.getNodeFromTree(name, objectTree).forEach(node => {\n      // destroy treeNode\n      TreeNode.dispose(node);\n\n      if (is2delInServer) {\n        this.deleteNodeInServer(name);\n      }\n\n      const maybeParent = this.getParentFromChild(name, objectTree);\n      maybeParent.forEach(parentNode => {\n        parentNode.children = parentNode.children.filter(x => x.title !== name);\n      });\n\n      objectTree = objectTree.filter(x => x.title !== name);\n    });\n    return objectTree;\n  };\n\n  getNodeFromTreeWithPredicate = (predicate, objectTree) => {\n    return new TreeObject(objectTree).getNode(predicate);\n  };\n\n  addNodeItem2Tree = (\n    objectTree,\n    nodeItem,\n    parentName = GlobalRef.NAME,\n    is2addInServer = true,\n    isVisible = true\n  ) => {\n    // delete if already exist\n    this.deleteNodeFromTreeUsingName(nodeItem.name, objectTree, is2addInServer);\n    const isStatic = this.staticNodeTypes.includes(nodeItem.getType());\n\n    const node2Add = TreeNode.builder()\n      .title(nodeItem.name)\n      .item(nodeItem)\n      .isVisible(isVisible)\n      .isStatic(isStatic)\n      .build();\n\n    if (parentName) {\n      const maybeParentNode = this.getNodeFromTree(parentName, objectTree);\n      maybeParentNode.forEach(parentNode => {\n        if (is2addInServer) this.addNodeItem2Server(node2Add, parentNode.title);\n        parentNode.children.push(node2Add);\n      });\n    } else {\n      objectTree.push(node2Add);\n      if (is2addInServer) this.addNodeItem2Server(node2Add, null);\n    }\n    return objectTree;\n  };\n\n  lostConnection = () => {\n    this.undoManager.undo({ is2UpdateInServer: false });\n    setImmediate(() => {\n      this.alert(\n        \"Sorry, work not saved. Please check internet connection\",\n        \"error\"\n      );\n    });\n  };\n\n  //========================================================================================\n  /*                                                                                      *\n   *                                   Server functions                                   *\n   *                                                                                      */\n  //========================================================================================\n\n  updateNodeInServer = (name, objectTree, oldName = null) => {\n    console.log(\"updateNodeInServer!\", name, this.sceneName);\n    this.getNodeFromTree(name, objectTree).forEach(node => {\n      const parentName = this.getParentFromChild(name, objectTree)\n        .map(x => x.title)\n        .orNull();\n      MasterDB.cloudFunction(\n        CLOUD_FUNCTION_NAME,\n        \"updateNode\",\n        [TreeNode.toDict(node), parentName, oldName, this.sceneName],\n        data => {\n          console.log(\"Update node with success?\", data.success, data.error);\n        }\n      ).catch(err => {\n        console.warn(\"Update node error\", name, err);\n        TreeServerUtils.undoAction(this);\n      });\n    });\n  };\n\n  addNodeItem2Server = (treeNode, parentName) => {\n    MasterDB.cloudFunction(\n      CLOUD_FUNCTION_NAME,\n      \"addNodeItem\",\n      [TreeNode.toDict(treeNode), parentName, this.sceneName],\n      data => {\n        console.log(\"Add node with success?\", data.success);\n      }\n    ).catch(err => {\n      console.warn(\"Add node error\", treeNode.title, err);\n      TreeServerUtils.undoAction(this);\n    });\n  };\n\n  deleteNodeInServer = name => {\n    MasterDB.cloudFunction(\n      CLOUD_FUNCTION_NAME,\n      \"deleteNodeByName\",\n      [name, this.sceneName],\n      data => {\n        console.log(\"Deleted node with success?\", data.success);\n      }\n    ).catch(err => {\n      console.warn(\"Deleted node error\", name, err);\n      TreeServerUtils.undoAction(this);\n    });\n  };\n}\n\nexport default TreeServerUtils;\n","module.exports = require(\"@material-ui/core/InputAdornment\");","module.exports = require(\"@material-ui/core/ListItemText\");","module.exports = require(\"@material-ui/core/Checkbox\");","module.exports = require(\"@material-ui/pickers\");","module.exports = require(\"react-virtualized\");","module.exports = require(\"lodash/set\");","module.exports = require(\"lodash/cloneDeep\");","module.exports = require(\"@material-ui/core/List\");","module.exports = require(\"lodash/capitalize\");","module.exports = require(\"@material-ui/core/TableCell\");","module.exports = require(\"@material-ui/core/FormHelperText\");","module.exports = require(\"@material-ui/lab/Alert\");","\"use strict\";\n\nvar isOldIE = function isOldIE() {\n  var memo;\n  return function memorize() {\n    if (typeof memo === 'undefined') {\n      // Test for IE <= 9 as proposed by Browserhacks\n      // @see http://browserhacks.com/#hack-e71d8692f65334173fee715c222cb805\n      // Tests for existence of standard globals is to allow style-loader\n      // to operate correctly into non-standard environments\n      // @see https://github.com/webpack-contrib/style-loader/issues/177\n      memo = Boolean(window && document && document.all && !window.atob);\n    }\n\n    return memo;\n  };\n}();\n\nvar getTarget = function getTarget() {\n  var memo = {};\n  return function memorize(target) {\n    if (typeof memo[target] === 'undefined') {\n      var styleTarget = document.querySelector(target); // Special case to return head of iframe instead of iframe itself\n\n      if (window.HTMLIFrameElement && styleTarget instanceof window.HTMLIFrameElement) {\n        try {\n          // This will throw an exception if access to iframe is blocked\n          // due to cross-origin restrictions\n          styleTarget = styleTarget.contentDocument.head;\n        } catch (e) {\n          // istanbul ignore next\n          styleTarget = null;\n        }\n      }\n\n      memo[target] = styleTarget;\n    }\n\n    return memo[target];\n  };\n}();\n\nvar stylesInDom = [];\n\nfunction getIndexByIdentifier(identifier) {\n  var result = -1;\n\n  for (var i = 0; i < stylesInDom.length; i++) {\n    if (stylesInDom[i].identifier === identifier) {\n      result = i;\n      break;\n    }\n  }\n\n  return result;\n}\n\nfunction modulesToDom(list, options) {\n  var idCountMap = {};\n  var identifiers = [];\n\n  for (var i = 0; i < list.length; i++) {\n    var item = list[i];\n    var id = options.base ? item[0] + options.base : item[0];\n    var count = idCountMap[id] || 0;\n    var identifier = \"\".concat(id, \" \").concat(count);\n    idCountMap[id] = count + 1;\n    var index = getIndexByIdentifier(identifier);\n    var obj = {\n      css: item[1],\n      media: item[2],\n      sourceMap: item[3]\n    };\n\n    if (index !== -1) {\n      stylesInDom[index].references++;\n      stylesInDom[index].updater(obj);\n    } else {\n      stylesInDom.push({\n        identifier: identifier,\n        updater: addStyle(obj, options),\n        references: 1\n      });\n    }\n\n    identifiers.push(identifier);\n  }\n\n  return identifiers;\n}\n\nfunction insertStyleElement(options) {\n  var style = document.createElement('style');\n  var attributes = options.attributes || {};\n\n  if (typeof attributes.nonce === 'undefined') {\n    var nonce = typeof __webpack_nonce__ !== 'undefined' ? __webpack_nonce__ : null;\n\n    if (nonce) {\n      attributes.nonce = nonce;\n    }\n  }\n\n  Object.keys(attributes).forEach(function (key) {\n    style.setAttribute(key, attributes[key]);\n  });\n\n  if (typeof options.insert === 'function') {\n    options.insert(style);\n  } else {\n    var target = getTarget(options.insert || 'head');\n\n    if (!target) {\n      throw new Error(\"Couldn't find a style target. This probably means that the value for the 'insert' parameter is invalid.\");\n    }\n\n    target.appendChild(style);\n  }\n\n  return style;\n}\n\nfunction removeStyleElement(style) {\n  // istanbul ignore if\n  if (style.parentNode === null) {\n    return false;\n  }\n\n  style.parentNode.removeChild(style);\n}\n/* istanbul ignore next  */\n\n\nvar replaceText = function replaceText() {\n  var textStore = [];\n  return function replace(index, replacement) {\n    textStore[index] = replacement;\n    return textStore.filter(Boolean).join('\\n');\n  };\n}();\n\nfunction applyToSingletonTag(style, index, remove, obj) {\n  var css = remove ? '' : obj.media ? \"@media \".concat(obj.media, \" {\").concat(obj.css, \"}\") : obj.css; // For old IE\n\n  /* istanbul ignore if  */\n\n  if (style.styleSheet) {\n    style.styleSheet.cssText = replaceText(index, css);\n  } else {\n    var cssNode = document.createTextNode(css);\n    var childNodes = style.childNodes;\n\n    if (childNodes[index]) {\n      style.removeChild(childNodes[index]);\n    }\n\n    if (childNodes.length) {\n      style.insertBefore(cssNode, childNodes[index]);\n    } else {\n      style.appendChild(cssNode);\n    }\n  }\n}\n\nfunction applyToTag(style, options, obj) {\n  var css = obj.css;\n  var media = obj.media;\n  var sourceMap = obj.sourceMap;\n\n  if (media) {\n    style.setAttribute('media', media);\n  } else {\n    style.removeAttribute('media');\n  }\n\n  if (sourceMap && typeof btoa !== 'undefined') {\n    css += \"\\n/*# sourceMappingURL=data:application/json;base64,\".concat(btoa(unescape(encodeURIComponent(JSON.stringify(sourceMap)))), \" */\");\n  } // For old IE\n\n  /* istanbul ignore if  */\n\n\n  if (style.styleSheet) {\n    style.styleSheet.cssText = css;\n  } else {\n    while (style.firstChild) {\n      style.removeChild(style.firstChild);\n    }\n\n    style.appendChild(document.createTextNode(css));\n  }\n}\n\nvar singleton = null;\nvar singletonCounter = 0;\n\nfunction addStyle(obj, options) {\n  var style;\n  var update;\n  var remove;\n\n  if (options.singleton) {\n    var styleIndex = singletonCounter++;\n    style = singleton || (singleton = insertStyleElement(options));\n    update = applyToSingletonTag.bind(null, style, styleIndex, false);\n    remove = applyToSingletonTag.bind(null, style, styleIndex, true);\n  } else {\n    style = insertStyleElement(options);\n    update = applyToTag.bind(null, style, options);\n\n    remove = function remove() {\n      removeStyleElement(style);\n    };\n  }\n\n  update(obj);\n  return function updateStyle(newObj) {\n    if (newObj) {\n      if (newObj.css === obj.css && newObj.media === obj.media && newObj.sourceMap === obj.sourceMap) {\n        return;\n      }\n\n      update(obj = newObj);\n    } else {\n      remove();\n    }\n  };\n}\n\nmodule.exports = function (list, options) {\n  options = options || {}; // Force single-tag solution on IE6-9, which has a hard limit on the # of <style>\n  // tags it will allow on a page\n\n  if (!options.singleton && typeof options.singleton !== 'boolean') {\n    options.singleton = isOldIE();\n  }\n\n  list = list || [];\n  var lastIdentifiers = modulesToDom(list, options);\n  return function update(newList) {\n    newList = newList || [];\n\n    if (Object.prototype.toString.call(newList) !== '[object Array]') {\n      return;\n    }\n\n    for (var i = 0; i < lastIdentifiers.length; i++) {\n      var identifier = lastIdentifiers[i];\n      var index = getIndexByIdentifier(identifier);\n      stylesInDom[index].references--;\n    }\n\n    var newLastIdentifiers = modulesToDom(newList, options);\n\n    for (var _i = 0; _i < lastIdentifiers.length; _i++) {\n      var _identifier = lastIdentifiers[_i];\n\n      var _index = getIndexByIdentifier(_identifier);\n\n      if (stylesInDom[_index].references === 0) {\n        stylesInDom[_index].updater();\n\n        stylesInDom.splice(_index, 1);\n      }\n    }\n\n    lastIdentifiers = newLastIdentifiers;\n  };\n};","\"use strict\";\n\n/*\n  MIT License http://www.opensource.org/licenses/mit-license.php\n  Author Tobias Koppers @sokra\n*/\n// css base code, injected by the css-loader\n// eslint-disable-next-line func-names\nmodule.exports = function (useSourceMap) {\n  var list = []; // return the list of modules as css string\n\n  list.toString = function toString() {\n    return this.map(function (item) {\n      var content = cssWithMappingToString(item, useSourceMap);\n\n      if (item[2]) {\n        return \"@media \".concat(item[2], \" {\").concat(content, \"}\");\n      }\n\n      return content;\n    }).join('');\n  }; // import a list of modules into the list\n  // eslint-disable-next-line func-names\n\n\n  list.i = function (modules, mediaQuery, dedupe) {\n    if (typeof modules === 'string') {\n      // eslint-disable-next-line no-param-reassign\n      modules = [[null, modules, '']];\n    }\n\n    var alreadyImportedModules = {};\n\n    if (dedupe) {\n      for (var i = 0; i < this.length; i++) {\n        // eslint-disable-next-line prefer-destructuring\n        var id = this[i][0];\n\n        if (id != null) {\n          alreadyImportedModules[id] = true;\n        }\n      }\n    }\n\n    for (var _i = 0; _i < modules.length; _i++) {\n      var item = [].concat(modules[_i]);\n\n      if (dedupe && alreadyImportedModules[item[0]]) {\n        // eslint-disable-next-line no-continue\n        continue;\n      }\n\n      if (mediaQuery) {\n        if (!item[2]) {\n          item[2] = mediaQuery;\n        } else {\n          item[2] = \"\".concat(mediaQuery, \" and \").concat(item[2]);\n        }\n      }\n\n      list.push(item);\n    }\n  };\n\n  return list;\n};\n\nfunction cssWithMappingToString(item, useSourceMap) {\n  var content = item[1] || ''; // eslint-disable-next-line prefer-destructuring\n\n  var cssMapping = item[3];\n\n  if (!cssMapping) {\n    return content;\n  }\n\n  if (useSourceMap && typeof btoa === 'function') {\n    var sourceMapping = toComment(cssMapping);\n    var sourceURLs = cssMapping.sources.map(function (source) {\n      return \"/*# sourceURL=\".concat(cssMapping.sourceRoot || '').concat(source, \" */\");\n    });\n    return [content].concat(sourceURLs).concat([sourceMapping]).join('\\n');\n  }\n\n  return [content].join('\\n');\n} // Adapted from convert-source-map (MIT)\n\n\nfunction toComment(sourceMap) {\n  // eslint-disable-next-line no-undef\n  var base64 = btoa(unescape(encodeURIComponent(JSON.stringify(sourceMap))));\n  var data = \"sourceMappingURL=data:application/json;charset=utf-8;base64,\".concat(base64);\n  return \"/*# \".concat(data, \" */\");\n}","module.exports = require(\"@material-ui/icons/Schedule\");","module.exports = require(\"@material-ui/icons/Warning\");","module.exports = require(\"@material-ui/icons/ViewModule\");","module.exports = require(\"@material-ui/icons/Chat\");","module.exports = require(\"@material-ui/core/Drawer\");","module.exports = require(\"@material-ui/core/Collapse\");","module.exports = require(\"material-table\");","module.exports = require(\"@material-ui/icons/AddBox\");","module.exports = require(\"@material-ui/icons/ArrowDownward\");","module.exports = require(\"@material-ui/icons/Check\");","module.exports = require(\"@material-ui/icons/ChevronLeft\");","module.exports = require(\"@material-ui/icons/DeleteOutline\");","module.exports = require(\"@material-ui/icons/Edit\");","module.exports = require(\"@material-ui/icons/FilterList\");","module.exports = require(\"@material-ui/icons/FirstPage\");","module.exports = require(\"@material-ui/icons/LastPage\");","module.exports = require(\"@material-ui/icons/Remove\");","module.exports = require(\"@material-ui/icons/SaveAlt\");","module.exports = require(\"@material-ui/icons/ViewColumn\");","module.exports = require(\"@material-ui/core/Tabs\");","module.exports = require(\"@material-ui/core/Tab\");","module.exports = require(\"@material-ui/core/TextField\");","module.exports = require(\"@material-ui/core/FormControlLabel\");","module.exports = require(\"@material-ui/core/Switch\");","module.exports = require(\"@material-ui/core/InputBase\");","module.exports = require(\"@material-ui/core/Breadcrumbs\");","module.exports = require(\"@material-ui/icons/NavigateNext\");","module.exports = \"data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' version='1.0' width='400.000000' height='400.000000' preserveAspectRatio='xMidYMid meet'%3E%3Crect id='backgroundrect' width='100%25' height='100%25' x='0' y='0' fill='none' stroke='none'/%3E %3Cg class='currentLayer' style=''%3E%3Ctitle%3ELayer 1%3C/title%3E%3Cg transform='translate(0,400) scale(0.10000000149011612,-0.10000000149011612) ' fill='%23d31b1b' stroke='none' id='svg_1' class='' fill-opacity='1'%3E %3Cpath d='M1770 3990 c-682 -83 -1271 -501 -1570 -1115 -103 -211 -167 -437 -191 -673 -14 -129 -6 -404 14 -522 85 -495 339 -929 729 -1242 232 -187 539 -332 836 -393 957 -199 1909 314 2272 1224 204 512 180 1116 -64 1606 -115 232 -229 387 -412 565 -296 286 -639 460 -1059 536 -106 19 -443 27 -555 14z m-998 -1105 c3 -3 -23 -48 -57 -99 -113 -172 -182 -338 -226 -546 -32 -149 -33 -448 -1 -593 31 -145 70 -258 134 -387 65 -132 64 -140 -28 -140 -66 0 -100 13 -143 53 -74 70 -71 38 -71 748 0 555 2 642 16 690 43 144 129 236 248 265 54 13 119 18 128 9z m2621 -21 c99 -34 192 -157 216 -288 14 -78 15 -1256 1 -1307 -13 -48 -82 -125 -124 -139 -55 -18 -166 -12 -166 9 0 4 25 57 55 118 195 391 215 839 55 1247 -41 105 -117 247 -176 327 -18 25 -30 49 -26 54 10 11 109 -2 165 -21z m-251 -61 c128 -170 217 -370 265 -594 13 -63 18 -129 18 -264 0 -199 -13 -285 -66 -448 -33 -101 -114 -277 -128 -277 -26 0 -31 80 -32 549 0 267 -4 495 -8 505 -6 16 -20 4 -87 -77 -43 -53 -81 -96 -84 -96 -3 -1 -16 41 -29 92 -27 106 -74 215 -132 304 -32 48 -38 66 -31 80 34 61 243 273 271 273 4 0 23 -21 43 -47z m-2206 15 c52 -39 95 -82 171 -170 l74 -88 -42 -61 c-23 -34 -54 -89 -69 -123 -35 -76 -80 -219 -80 -252 0 -13 -4 -24 -8 -24 -4 0 -43 43 -87 95 -43 52 -83 95 -87 95 -4 0 -8 -224 -9 -497 0 -492 -5 -565 -34 -565 -16 0 -94 166 -130 279 -52 159 -69 294 -62 493 8 230 47 384 147 585 56 112 154 255 174 255 7 0 26 -10 42 -22z m458 -511 l133 -157 -20 -58 c-13 -39 -19 -85 -19 -147 -1 -150 44 -260 151 -365 107 -105 214 -150 361 -150 241 0 443 162 500 399 16 69 8 222 -15 278 l-17 43 132 157 c73 87 136 159 140 161 24 9 119 -186 148 -303 11 -44 22 -104 25 -134 l4 -54 -329 -388 c-343 -405 -362 -424 -466 -455 -101 -31 -258 -12 -341 41 -48 29 -83 69 -607 691 -52 62 -94 121 -94 131 0 52 33 202 60 271 33 86 99 204 112 200 5 -2 68 -74 142 -161z m376 -444 c85 -102 167 -194 182 -204 62 -45 81 -30 292 224 76 92 142 165 146 162 13 -8 20 -110 10 -167 -27 -170 -153 -299 -324 -334 -130 -27 -257 9 -356 102 -61 57 -116 162 -125 239 -8 57 1 165 13 164 4 0 77 -84 162 -186z' id='svg_2' fill='%23d31b1b' fill-opacity='1'/%3E %3C/g%3E%3C/g%3E%3C/svg%3E\"","module.exports = require(\"earcut\");","module.exports = require(\"@babylonjs/core/Maths/math\");","module.exports = require(\"lodash/uniqBy\");","module.exports = require(\"lodash.isequal\");","module.exports = require(\"@babel/runtime/helpers/esm/toArray\");","module.exports = require(\"@material-ui/core/utils\");","module.exports = require(\"@babel/runtime/helpers/esm/taggedTemplateLiteral\");","module.exports = require(\"styled-components\");","module.exports = require(\"@material-ui/core/styles/colorManipulator\");","module.exports = require(\"@material-ui/icons/Label\");","module.exports = require(\"@material-ui/core/Chip\");","module.exports = require(\"@material-ui/icons/Add\");","module.exports = require(\"@material-ui/icons/Today\");","module.exports = require(\"@date-io/date-fns\");","module.exports = require(\"@babel/runtime/helpers/esm/typeof\");","module.exports = require(\"lodash/isEmpty\");","module.exports = \"data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' version='1.0' width='400.000000' height='400.000000' preserveAspectRatio='xMidYMid meet'%3E%3Crect id='backgroundrect' width='100%25' height='100%25' x='0' y='0' fill='none' stroke='none'/%3E %3Cg class='currentLayer' style=''%3E%3Ctitle%3ELayer 1%3C/title%3E%3Cg transform='translate(0,400) scale(0.10000000149011612,-0.10000000149011612) ' fill='%23d31b1b' stroke='none' id='svg_1' class='' fill-opacity='1'%3E %3Cpath d='M1770 3990 c-682 -83 -1271 -501 -1570 -1115 -103 -211 -167 -437 -191 -673 -14 -129 -6 -404 14 -522 85 -495 339 -929 729 -1242 232 -187 539 -332 836 -393 957 -199 1909 314 2272 1224 204 512 180 1116 -64 1606 -115 232 -229 387 -412 565 -296 286 -639 460 -1059 536 -106 19 -443 27 -555 14z m-998 -1105 c3 -3 -23 -48 -57 -99 -113 -172 -182 -338 -226 -546 -32 -149 -33 -448 -1 -593 31 -145 70 -258 134 -387 65 -132 64 -140 -28 -140 -66 0 -100 13 -143 53 -74 70 -71 38 -71 748 0 555 2 642 16 690 43 144 129 236 248 265 54 13 119 18 128 9z m2621 -21 c99 -34 192 -157 216 -288 14 -78 15 -1256 1 -1307 -13 -48 -82 -125 -124 -139 -55 -18 -166 -12 -166 9 0 4 25 57 55 118 195 391 215 839 55 1247 -41 105 -117 247 -176 327 -18 25 -30 49 -26 54 10 11 109 -2 165 -21z m-251 -61 c128 -170 217 -370 265 -594 13 -63 18 -129 18 -264 0 -199 -13 -285 -66 -448 -33 -101 -114 -277 -128 -277 -26 0 -31 80 -32 549 0 267 -4 495 -8 505 -6 16 -20 4 -87 -77 -43 -53 -81 -96 -84 -96 -3 -1 -16 41 -29 92 -27 106 -74 215 -132 304 -32 48 -38 66 -31 80 34 61 243 273 271 273 4 0 23 -21 43 -47z m-2206 15 c52 -39 95 -82 171 -170 l74 -88 -42 -61 c-23 -34 -54 -89 -69 -123 -35 -76 -80 -219 -80 -252 0 -13 -4 -24 -8 -24 -4 0 -43 43 -87 95 -43 52 -83 95 -87 95 -4 0 -8 -224 -9 -497 0 -492 -5 -565 -34 -565 -16 0 -94 166 -130 279 -52 159 -69 294 -62 493 8 230 47 384 147 585 56 112 154 255 174 255 7 0 26 -10 42 -22z m458 -511 l133 -157 -20 -58 c-13 -39 -19 -85 -19 -147 -1 -150 44 -260 151 -365 107 -105 214 -150 361 -150 241 0 443 162 500 399 16 69 8 222 -15 278 l-17 43 132 157 c73 87 136 159 140 161 24 9 119 -186 148 -303 11 -44 22 -104 25 -134 l4 -54 -329 -388 c-343 -405 -362 -424 -466 -455 -101 -31 -258 -12 -341 41 -48 29 -83 69 -607 691 -52 62 -94 121 -94 131 0 52 33 202 60 271 33 86 99 204 112 200 5 -2 68 -74 142 -161z m376 -444 c85 -102 167 -194 182 -204 62 -45 81 -30 292 224 76 92 142 165 146 162 13 -8 20 -110 10 -167 -27 -170 -153 -299 -324 -334 -130 -27 -257 9 -356 102 -61 57 -116 162 -125 239 -8 57 1 165 13 164 4 0 77 -84 162 -186z' id='svg_2' fill='%23d31b1b' fill-opacity='1'/%3E %3C/g%3E%3C/g%3E%3C/svg%3E\"","module.exports = require(\"@material-ui/core/Paper\");","module.exports = require(\"react-virtualized-tree\");","module.exports = require(\"@material-ui/core/Box\");","module.exports = require(\"@material-ui/core/Backdrop\");","module.exports = require(\"@material-ui/styles\");","module.exports = require(\"jwt-decode\");","module.exports = require(\"@babylonjs/core/Debug/debugLayer\");","module.exports = require(\"@babylonjs/inspector\");","module.exports = require(\"@babylonjs/loaders\");","var scope = (typeof global !== \"undefined\" && global) ||\n            (typeof self !== \"undefined\" && self) ||\n            window;\nvar apply = Function.prototype.apply;\n\n// DOM APIs, for completeness\n\nexports.setTimeout = function() {\n  return new Timeout(apply.call(setTimeout, scope, arguments), clearTimeout);\n};\nexports.setInterval = function() {\n  return new Timeout(apply.call(setInterval, scope, arguments), clearInterval);\n};\nexports.clearTimeout =\nexports.clearInterval = function(timeout) {\n  if (timeout) {\n    timeout.close();\n  }\n};\n\nfunction Timeout(id, clearFn) {\n  this._id = id;\n  this._clearFn = clearFn;\n}\nTimeout.prototype.unref = Timeout.prototype.ref = function() {};\nTimeout.prototype.close = function() {\n  this._clearFn.call(scope, this._id);\n};\n\n// Does not start the time, just sets up the members needed.\nexports.enroll = function(item, msecs) {\n  clearTimeout(item._idleTimeoutId);\n  item._idleTimeout = msecs;\n};\n\nexports.unenroll = function(item) {\n  clearTimeout(item._idleTimeoutId);\n  item._idleTimeout = -1;\n};\n\nexports._unrefActive = exports.active = function(item) {\n  clearTimeout(item._idleTimeoutId);\n\n  var msecs = item._idleTimeout;\n  if (msecs >= 0) {\n    item._idleTimeoutId = setTimeout(function onTimeout() {\n      if (item._onTimeout)\n        item._onTimeout();\n    }, msecs);\n  }\n};\n\n// setimmediate attaches itself to the global object\nrequire(\"setimmediate\");\n// On some exotic environments, it's not clear which object `setimmediate` was\n// able to install onto.  Search each possibility in the same order as the\n// `setimmediate` library.\nexports.setImmediate = (typeof self !== \"undefined\" && self.setImmediate) ||\n                       (typeof global !== \"undefined\" && global.setImmediate) ||\n                       (this && this.setImmediate);\nexports.clearImmediate = (typeof self !== \"undefined\" && self.clearImmediate) ||\n                         (typeof global !== \"undefined\" && global.clearImmediate) ||\n                         (this && this.clearImmediate);\n","var g;\n\n// This works in non-strict mode\ng = (function() {\n\treturn this;\n})();\n\ntry {\n\t// This works if eval is allowed (see CSP)\n\tg = g || new Function(\"return this\")();\n} catch (e) {\n\t// This works if the window reference is available\n\tif (typeof window === \"object\") g = window;\n}\n\n// g can still be undefined, but nothing to do about it...\n// We return undefined, instead of nothing here, so it's\n// easier to handle this case. if(!global) { ...}\n\nmodule.exports = g;\n","module.exports = require(\"setimmediate\");","var api = require(\"!../../../node_modules/style-loader/dist/runtime/injectStylesIntoStyleTag.js\");\n            var content = require(\"!!../../../node_modules/css-loader/dist/cjs.js!./Snackbar.css\");\n\n            content = content.__esModule ? content.default : content;\n\n            if (typeof content === 'string') {\n              content = [[module.id, content, '']];\n            }\n\nvar options = {};\n\noptions.insert = \"head\";\noptions.singleton = false;\n\nvar update = api(content, options);\n\n\n\nmodule.exports = content.locals || {};","// Imports\nvar ___CSS_LOADER_API_IMPORT___ = require(\"../../../node_modules/css-loader/dist/runtime/api.js\");\nexports = ___CSS_LOADER_API_IMPORT___(false);\n// Module\nexports.push([module.id, \"body.react-confirm-alert-body-element {\\n  overflow: hidden;\\n}\\n\\n.react-confirm-alert-blur {\\n  filter: url(#gaussian-blur);\\n  filter: blur(2px);\\n  -webkit-filter: blur(2px);\\n}\\n\\n.react-confirm-alert-overlay {\\n  position: fixed;\\n  top: calc(100vh - 300px);\\n  left: 0;\\n  right: 0;\\n  bottom: 0;\\n  z-index: 99;\\n  display: -webkit-flex;\\n  display: -moz-flex;\\n  display: -ms-flex;\\n  display: -o-flex;\\n  display: flex;\\n  justify-content: flex-start;\\n  -ms-align-items: center;\\n  align-items: flex-end;\\n  opacity: 1;\\n}\\n\\n.react-confirm-alert-body {\\n  width: 400px;\\n  padding: 30px;\\n}\\n\\n.react-confirm-alert-svg {\\n  position: absolute;\\n  top: 0;\\n  left: 0;\\n}\\n\\n.react-confirm-alert-body > h1 {\\n  margin-top: 0;\\n}\\n\\n.react-confirm-alert-body > h3 {\\n  margin: 0;\\n  font-size: 16px;\\n}\\n\\n.react-confirm-alert-button-group {\\n  display: -webkit-flex;\\n  display: -moz-flex;\\n  display: -ms-flex;\\n  display: -o-flex;\\n  display: flex;\\n  justify-content: flex-start;\\n  margin-top: 20px;\\n}\\n\\n.react-confirm-alert-button-group > button {\\n  outline: none;\\n  background: #333;\\n  border: none;\\n  display: inline-block;\\n  padding: 6px 18px;\\n  color: #eee;\\n  margin-right: 10px;\\n  border-radius: 5px;\\n  font-size: 12px;\\n  cursor: pointer;\\n}\\n\\n.icon-container {\\n  display: flex;\\n  justify-content: center;\\n  align-items: center;\\n}\\n\\n.icon-container:hover {\\n  cursor: pointer;\\n}\\n\", \"\"]);\n// Exports\nmodule.exports = exports;\n","module.exports = require(\"fontsource-roboto\");","module.exports = require(\"fontsource-open-sans\");","var api = require(\"!../../../node_modules/style-loader/dist/runtime/injectStylesIntoStyleTag.js\");\n            var content = require(\"!!../../../node_modules/css-loader/dist/cjs.js!./Logs.css\");\n\n            content = content.__esModule ? content.default : content;\n\n            if (typeof content === 'string') {\n              content = [[module.id, content, '']];\n            }\n\nvar options = {};\n\noptions.insert = \"head\";\noptions.singleton = false;\n\nvar update = api(content, options);\n\n\n\nmodule.exports = content.locals || {};","// Imports\nvar ___CSS_LOADER_API_IMPORT___ = require(\"../../../node_modules/css-loader/dist/runtime/api.js\");\nexports = ___CSS_LOADER_API_IMPORT___(false);\n// Module\nexports.push([module.id, \".flow-action {\\n  display: flex;\\n  background: transparent;\\n  width: 35px;\\n  height: 35px;\\n  margin: 6px;\\n  border-radius: 50%;\\n  justify-content: center;\\n  align-items: center;\\n  transition: background-color 0.5s;\\n}\\n\\n.flow-action:hover {\\n  background: rgba(11, 106, 138, 0.2);\\n  cursor: pointer;\\n}\\n\\n.robot-logs-container {\\n  display: flex;\\n  flex-direction: column;\\n  height: 1px;\\n  flex-grow: 1;\\n}\\n\\n.tree-grow-overflow {\\n  flex-grow: 0.5;\\n  overflow-y: auto;\\n  min-height: 0;\\n  height: 100%;\\n}\\n\\n.logs-grow-overflow {\\n  flex-grow: 1;\\n  overflow-y: auto;\\n  min-height: 0;\\n  height: 100%;\\n}\\n\\n.saving {\\n  /* font-size: 40px; */\\n  margin: 0;\\n}\\n\\n.saving span {\\n  font-size: 15px;\\n  animation-name: blink;\\n  animation-duration: 1.4s;\\n  animation-iteration-count: infinite;\\n  animation-fill-mode: both;\\n}\\n\\n.saving span:nth-child(2) {\\n  animation-delay: 0.2s;\\n}\\n\\n.saving span:nth-child(3) {\\n  animation-delay: 0.4s;\\n}\\n\\n@keyframes blink {\\n  0% {\\n    opacity: 0.2;\\n  }\\n  20% {\\n    opacity: 1;\\n  }\\n  100% {\\n    opacity: 0.2;\\n  }\\n}\\n\\n.MuiPickersToolbarButton-toolbarBtn {\\n  padding: 0 !important;\\n  min-width: 16px !important;\\n  margin: 0 !important;\\n  text-transform: none !important;\\n}\\n\", \"\"]);\n// Exports\nmodule.exports = exports;\n","module.exports = require(\"material-icons/css/material-icons.css\");","module.exports = require(\"react-virtualized/styles.css\");","module.exports = require(\"react-virtualized-tree/lib/main.css\");","import React from \"react\";\nimport MaterialButton from \"@material-ui/core/Button\";\nimport PropTypes from \"prop-types\";\n\nconst Button = props => {\n  return (\n    <MaterialButton\n      className={props.className}\n      style={props.style}\n      onClick={props.onClick}\n      color={props.color}\n      variant={props.variant}\n      size={props.size}\n      startIcon={props.startIcon}\n      disabled={props.disabled}\n    >\n      {props.children}\n    </MaterialButton>\n  );\n};\n\nButton.propTypes = {\n  style: PropTypes.object,\n  onClick: PropTypes.func,\n  color: PropTypes.string,\n  variant: PropTypes.string.isRequired,\n  size: PropTypes.string,\n  startIcon: PropTypes.element,\n  children: PropTypes.node.isRequired,\n  disabled: PropTypes.bool\n};\nButton.defaultProps = {\n  style: {},\n  onClick: () => console.log(\"Click MOV.AI button\"),\n  color: \"default\", // default, inherit, primary or secondary\n  variant: \"contained\", // text, outlined, contained\n  size: \"medium\", // small, medium, large\n  startIcon: undefined,\n  children: <div></div>,\n  disabled: false\n};\n\nexport default Button;\n","import React from \"react\";\nimport PropTypes from \"prop-types\";\nimport CloseIcon from \"@material-ui/icons/Close\";\nimport { makeStyles } from \"@material-ui/core/styles\";\nimport _debounce from \"lodash/debounce\";\nimport {\n  Card,\n  Typography,\n  CardContent,\n  Divider,\n  Button,\n  CardActions,\n  Modal\n} from \"@material-ui/core\";\n\nconst useStyles = makeStyles(theme => {\n  return {\n    card: {\n      margin: \"auto\",\n      position: \"absolute\",\n      overflow: \"auto\",\n      display: \"flex\",\n      flexDirection: \"column\",\n      maxHeight: \"98%\"\n    },\n    closeButton: {\n      cursor: \"pointer\",\n      position: \"absolute\",\n      color: theme.textColor,\n      top: 15,\n      right: 15,\n      \"&:hover\": {\n        color: \"gray\"\n      }\n    }\n  };\n});\n\nconst AbstractModal = props => {\n  const classes = useStyles();\n\n  const debounceSubmit = _debounce(() => {\n    props.onSubmit();\n  }, 50);\n\n  const onKeyPress = e => {\n    if (e.key === \"Enter\") {\n      submit();\n    }\n  };\n\n  const submit = () => {\n    debounceSubmit();\n  };\n\n  const cancel = () => {\n    props.onCancel();\n  };\n\n  return (\n    <Modal\n      onKeyPress={onKeyPress}\n      open={props.open}\n      onClose={cancel}\n      style={{\n        display: \"flex\",\n        alignItems: \"center\",\n        justifyContent: \"center\"\n      }}\n    >\n      <Card\n        className={classes.card}\n        style={{\n          ...props.style,\n          minWidth: props.width,\n          minHeight: props.height\n        }}\n      >\n        <CardContent\n          style={{\n            flexGrow: 1,\n            maxHeight: \"calc(100% - 70px)\",\n            overflowY: \"auto\"\n          }}\n        >\n          <Typography variant=\"h5\">{props.title}</Typography>\n          <Typography\n            component=\"div\"\n            className={classes.closeButton}\n            onClick={() => props.onCancel()}\n          >\n            <CloseIcon></CloseIcon>\n          </Typography>\n          <Divider style={{ marginBottom: \"12px\" }} />\n          <div\n            style={{\n              maxHeight: \"calc(100% - 35px)\",\n              overflowY: \"auto\",\n              paddingTop: 5\n            }}\n          >\n            {props.children}\n          </div>\n        </CardContent>\n        <Divider />\n        <CardActions>\n          {props.hasSubmitButton && (\n            <Button color={props.submitColor} onClick={submit}>\n              {props.submitText}\n            </Button>\n          )}\n          {props.hasCancelButton && (\n            <Button onClick={cancel} color={props.cancelColor}>\n              {props.cancelText}\n            </Button>\n          )}\n        </CardActions>\n      </Card>\n    </Modal>\n  );\n};\n\nAbstractModal.propTypes = {\n  onSubmit: PropTypes.func,\n  onCancel: PropTypes.func,\n  open: PropTypes.bool,\n  title: PropTypes.string,\n  submitText: PropTypes.string,\n  submitColor: PropTypes.string,\n  cancelText: PropTypes.string,\n  cancelColor: PropTypes.string,\n  width: PropTypes.string,\n  height: PropTypes.string,\n  style: PropTypes.object,\n  hasSubmitButton: PropTypes.bool,\n  hasCancelButton: PropTypes.bool\n};\n\nAbstractModal.defaultProps = {\n  onSubmit: () => {},\n  onCancel: () => {},\n  open: false,\n  title: \"New\",\n  submitText: \"Confirm\",\n  submitColor: \"primary\",\n  cancelText: \"Cancel\",\n  cancelColor: \"secondary\",\n  width: \"25%\",\n  height: \"25%\",\n  style: {},\n  hasSubmitButton: true,\n  hasCancelButton: true\n};\n\nexport default AbstractModal;\n","import React from \"react\";\nimport PropTypes from \"prop-types\";\nimport AbstractModal from \"./AbstractModal\";\n\nconst ConfirmAlertModal = props => {\n  return (\n    <AbstractModal\n      onSubmit={props.onSubmit}\n      onCancel={props.onCancel}\n      open={props.open}\n      title={props.title}\n      submitText={props.submitText}\n      submitColor={props.submitColor}\n      cancelText={props.cancelText}\n      cancelColor={props.cancelColor}\n    >\n      <div>{props.message}</div>\n      <div>{props.children}</div>\n    </AbstractModal>\n  );\n};\n\nConfirmAlertModal.propTypes = {\n  title: PropTypes.string,\n  message: PropTypes.string,\n  onSubmit: PropTypes.func,\n  onCancel: PropTypes.func,\n  open: PropTypes.bool,\n  submitText: PropTypes.string,\n  submitColor: PropTypes.string,\n  cancelText: PropTypes.string,\n  cancelColor: PropTypes.string\n};\n\nConfirmAlertModal.defaultProps = {\n  title: \"Insert Text here\",\n  message: \"Are you sure?\",\n  onSubmit: () => {},\n  onCancel: () => {},\n  open: false,\n  submitText: \"Delete\",\n  submitColor: \"secondary\",\n  cancelText: \"Cancel\",\n  cancelColor: \"primary\"\n};\n\nexport default ConfirmAlertModal;\n","import React, { Component } from \"react\";\nimport PropTypes from \"prop-types\";\nimport List from \"@material-ui/core/List\";\nimport Avatar from \"@material-ui/core/Avatar\";\nimport Divider from \"@material-ui/core/Divider\";\nimport Typography from \"@material-ui/core/Typography\";\nimport { ListItem, ListItemAvatar, ListItemText } from \"@material-ui/core\";\nimport { withStyles } from \"@material-ui/core/styles\";\nimport ScheduleIcon from \"@material-ui/icons/Schedule\";\nimport WarningIcon from \"@material-ui/icons/Warning\";\nimport ViewModuleIcon from \"@material-ui/icons/ViewModule\";\nimport ChatIcon from \"@material-ui/icons/Chat\";\nimport { MasterDB } from \"mov-fe-lib-core\";\nimport AbstractModal from \"./AbstractModal\";\n\nconst styles = theme => ({\n  breakWord: {\n    wordBreak: \"break-all\"\n  }\n});\n\nclass RobotLogModal extends Component {\n  state = {\n    data: {},\n    open: false,\n    hasButton: false\n  };\n\n  open = alert => {\n    const { data } = this.state;\n    // Format time\n    const time = new Date(alert.time * 1000);\n    const alertButton = alert.button\n      ? JSON.parse(alert.button.replace(/'/g, '\"'))\n      : null;\n    data.time = `${time.toLocaleTimeString(\"pt\")}`;\n    data.action = alert.action;\n    data.message = alert.message;\n    data.robot = alert.robot;\n    data.service = alert.service;\n    data.module = alert.module;\n    if (alertButton) {\n      data.buttonText = alertButton.label;\n      data.buttonAction = this.getRobotAlertAction(alertButton);\n    }\n    // Update state variables\n    this.setState({\n      data,\n      open: true,\n      hasButton: !!alertButton\n    });\n  };\n\n  getRobotAlertAction = ({ callback, data }) => {\n    // Trigger callback to clear log\n    if (callback) {\n      return () => {\n        MasterDB.cloudFunction(callback, \"\", data, res => {\n          this.setState({ open: false });\n        });\n      };\n    }\n    // Default case (just close modal)\n    else {\n      return () => this.setState({ open: false });\n    }\n  };\n\n  renderAlertInfo = () => {\n    const { data } = this.state;\n    const { props, classes } = this.props;\n    return (\n      <Typography component=\"div\">\n        <List style={{ width: \"100%\" }}>\n          <ListItem>\n            <ListItemAvatar>\n              <Avatar>\n                <i className=\"fas fa-robot\"></i>\n              </Avatar>\n            </ListItemAvatar>\n            <ListItemText primary={data.robot} />\n          </ListItem>\n          <Divider variant=\"inset\" component=\"li\" />\n          <ListItem>\n            <ListItemAvatar>\n              <Avatar>\n                <ScheduleIcon />\n              </Avatar>\n            </ListItemAvatar>\n            <ListItemText primary={data.time} />\n          </ListItem>\n          <Divider variant=\"inset\" component=\"li\" />\n          {props.includes(\"service\") && (\n            <div>\n              <ListItem>\n                <ListItemAvatar>\n                  <Avatar>\n                    <WarningIcon />\n                  </Avatar>\n                </ListItemAvatar>\n                <ListItemText\n                  primary={data.service}\n                  className={classes.breakWord}\n                />\n              </ListItem>\n              <Divider variant=\"inset\" component=\"li\" />\n            </div>\n          )}\n          {props.includes(\"module\") && (\n            <div>\n              <ListItem>\n                <ListItemAvatar>\n                  <Avatar>\n                    <ViewModuleIcon />\n                  </Avatar>\n                </ListItemAvatar>\n                <ListItemText\n                  primary={data.module}\n                  className={classes.breakWord}\n                />\n              </ListItem>\n              <Divider variant=\"inset\" component=\"li\" />\n            </div>\n          )}\n          <ListItem>\n            <ListItemAvatar>\n              <Avatar>\n                <ChatIcon />\n              </Avatar>\n            </ListItemAvatar>\n            <ListItemText\n              primary={data.message}\n              className={classes.breakWord}\n            />\n          </ListItem>\n        </List>\n        {data.action && (\n          <div>\n            <Divider />\n            <List style={{ width: \"100%\" }}>\n              <ListItem>\n                <ListItemText\n                  primary={data.action}\n                  className={classes.breakWord}\n                />\n              </ListItem>\n            </List>\n          </div>\n        )}\n      </Typography>\n    );\n  };\n\n  render() {\n    const { data, open, hasButton } = this.state;\n    const { title } = this.props;\n    return (\n      <AbstractModal\n        open={open}\n        title={title}\n        style={{ maxWidth: 500 }}\n        onCancel={() => this.setState({ open: false })}\n        onSubmit={data.buttonAction}\n        submitText={data.buttonText}\n        submitColor={\"primary\"}\n        hasSubmitButton={hasButton}\n        hasCancelButton={false}\n      >\n        {this.renderAlertInfo()}\n      </AbstractModal>\n    );\n  }\n}\n\nRobotLogModal.propTypes = {\n  title: PropTypes.string,\n  props: PropTypes.array\n};\n\nRobotLogModal.defaultProps = {\n  title: \"Log Details\",\n  props: []\n};\n\nexport default withStyles(styles, { withTheme: true })(RobotLogModal);\n","import React from \"react\";\nimport PropTypes from \"prop-types\";\nimport MaterialDrawer from \"@material-ui/core/Drawer\";\n\nconst Drawer = props => {\n  return (\n    <MaterialDrawer\n      style={props.style}\n      anchor={props.anchor}\n      open={props.open}\n      onClose={props.onClose}\n    >\n      {props.children}\n    </MaterialDrawer>\n  );\n};\n\nDrawer.propTypes = {\n  style: PropTypes.object,\n  anchor: PropTypes.string,\n  open: PropTypes.bool,\n  children: PropTypes.object\n};\n\nDrawer.defaultProps = {\n  style: {},\n  anchor: \"left\",\n  open: false,\n  children: <div></div>\n};\n\nDrawer.ANCHOR = { left: \"left\", right: \"right\", top: \"top\", bottom: \"bottom\" };\n\nexport default Drawer;\n","import React from \"react\";\nimport ChevronRightIcon from \"@material-ui/icons/ChevronRight\";\nimport ExpandMore from \"@material-ui/icons/ExpandMore\";\nimport PropTypes from \"prop-types\";\nimport MaterialCollapse from \"@material-ui/core/Collapse\";\nimport { Divider, ListItem, List } from \"@material-ui/core\";\n\nconst Collapse = props => {\n  const [open, setOpen] = React.useState(props.open);\n\n  React.useEffect(() => {\n    if (props.open !== open) {\n      setOpen(props.open);\n    }\n  }, [props.open]);\n\n  const handleClickFactory = clickLambda => () => {\n    setOpen(!open);\n    clickLambda();\n  };\n\n  return (\n    <List>\n      <ListItem button onClick={handleClickFactory(props.onClick)}>\n        {open ? (\n          <ExpandMore style={{ ...props.iconStyle }} />\n        ) : (\n          <ChevronRightIcon style={{ ...props.iconStyle }} />\n        )}\n        <div style={{ width: \"100%\" }}>{props.item}</div>\n      </ListItem>\n      {props.divided ? <Divider /> : []}\n      <MaterialCollapse\n        className={props.className}\n        style={props.style}\n        in={open}\n      >\n        {props.children}\n      </MaterialCollapse>\n    </List>\n  );\n};\n\nCollapse.propTypes = {\n  item: PropTypes.object,\n  onClick: PropTypes.func,\n  open: PropTypes.bool,\n  divided: PropTypes.bool,\n  iconStyle: PropTypes.object\n};\n\nCollapse.defaultProps = {\n  item: <div></div>,\n  onClick: () => {},\n  open: false,\n  divided: false,\n  style: {},\n  iconStyle: {}\n};\n\nexport default Collapse;\n","import React from \"react\";\nimport { makeStyles } from \"@material-ui/core/styles\";\nimport PropTypes from \"prop-types\";\n\nconst useStyles = makeStyles(theme => ({\n  container: {\n    width: 65,\n    height: \"100%\",\n    display: \"flex\",\n    flexDirection: \"column\",\n    backgroundColor: props => props.backgroundColor\n  },\n  logoArea: {\n    padding: \"17px\",\n    textAlign: \"center\",\n    alignItems: \"center\",\n    justifyContent: \"center\"\n  },\n  navigationArea: {\n    flexGrow: 1,\n    display: \"flex\",\n    flexDirection: \"column\",\n    alignItems: \"center\"\n  },\n  accountArea: {\n    padding: props => (props.unsetAccountAreaPadding ? \"unset\" : \"17px\"),\n    textAlign: \"center\",\n    alignItems: \"center\",\n    justifyContent: \"center\"\n  }\n}));\n\nconst VerticalBar = props => {\n  const classes = useStyles(props);\n  return (\n    <div className={classes.container}>\n      <div className={classes.logoArea}>{props.upperElement}</div>\n      <div className={classes.navigationArea}>\n        {props.navigationList.map((element, index) => {\n          return (\n            <div key={index} style={{ padding: \"15px 0px\" }}>\n              {element}\n            </div>\n          );\n        })}\n      </div>\n      <div className={classes.accountArea}>{props.lowerElement}</div>\n    </div>\n  );\n};\n\nVerticalBar.propTypes = {\n  upperElement: PropTypes.node,\n  navigationList: PropTypes.array,\n  lowerElement: PropTypes.node.isRequired,\n  backgroundColor: PropTypes.string,\n  unsetAccountAreaPadding: PropTypes.bool\n};\nVerticalBar.defaultProps = {\n  upperElement: <div></div>,\n  navigationList: [<div></div>],\n  lowerElement: <div></div>,\n  backgroundColor: \"#424242\",\n  unsetAccountAreaPadding: false\n};\n\nexport default VerticalBar;\n","import React from \"react\";\nimport PropTypes from \"prop-types\";\nimport Menu from \"@material-ui/core/Menu\";\nimport MenuItem from \"@material-ui/core/MenuItem\";\n\nconst ContextMenu = props => {\n  const { style } = props;\n  const [anchorEl, setAnchorEl] = React.useState(null);\n\n  const handleClick = event => {\n    setAnchorEl(event.currentTarget);\n  };\n\n  const handleClose = () => {\n    setAnchorEl(null);\n  };\n\n  return (\n    <div style={style}>\n      {React.cloneElement(props.element, {\n        onClick: evt => {\n          if (props.element.props.onClick !== undefined) {\n            props.element.props.onClick(); // If user defined a onClick\n          }\n          handleClick(evt); // opens the contextMenu\n        }\n      })}\n      <Menu\n        id=\"simple-menu\"\n        anchorEl={anchorEl}\n        keepMounted\n        open={Boolean(anchorEl)}\n        onClose={handleClose}\n      >\n        {props.menuList.reduce((result, item, index) => {\n          if (item && typeof item !== \"function\") {\n            result.push(\n              <MenuItem\n                onClick={() => {\n                  item.onClick();\n                  if (item.onClose || item.onClose === undefined) {\n                    handleClose();\n                  }\n                }}\n                key={index}\n              >\n                {item.element}\n              </MenuItem>\n            );\n          }\n          return result;\n        }, [])}\n      </Menu>\n    </div>\n  );\n};\n\nContextMenu.propTypes = {\n  element: PropTypes.node.isRequired,\n  navigationList: PropTypes.array,\n  lowerElement: PropTypes.node.isRequired,\n  width: PropTypes.string,\n  backgroundColor: PropTypes.string\n};\nContextMenu.defaultProps = {\n  element: <div>Ahaha</div>,\n  menuList: [\n    {\n      onClick: () => console.log(\"clicked 1\"),\n      element: \"Profile\",\n      onClose: true\n    }\n  ],\n  lowerElement: <div></div>,\n  width: \"68px\",\n  backgroundColor: \"#424242\",\n  style: {}\n};\n\nexport default ContextMenu;\n","import React from \"react\";\nimport PropTypes from \"prop-types\";\nimport MaterialTable from \"material-table\";\n\nimport { forwardRef } from \"react\";\n\nimport AddBox from \"@material-ui/icons/AddBox\";\nimport ArrowDownward from \"@material-ui/icons/ArrowDownward\";\nimport Check from \"@material-ui/icons/Check\";\nimport ChevronLeft from \"@material-ui/icons/ChevronLeft\";\nimport ChevronRight from \"@material-ui/icons/ChevronRight\";\nimport Clear from \"@material-ui/icons/Clear\";\nimport DeleteOutline from \"@material-ui/icons/DeleteOutline\";\nimport Edit from \"@material-ui/icons/Edit\";\nimport FilterList from \"@material-ui/icons/FilterList\";\nimport FirstPage from \"@material-ui/icons/FirstPage\";\nimport LastPage from \"@material-ui/icons/LastPage\";\nimport Remove from \"@material-ui/icons/Remove\";\nimport SaveAlt from \"@material-ui/icons/SaveAlt\";\nimport Search from \"@material-ui/icons/Search\";\nimport ViewColumn from \"@material-ui/icons/ViewColumn\";\n\nconst tableIcons = {\n  Add: forwardRef((props, ref) => <AddBox {...props} ref={ref} />),\n  Check: forwardRef((props, ref) => <Check {...props} ref={ref} />),\n  Clear: forwardRef((props, ref) => <Clear {...props} ref={ref} />),\n  Delete: forwardRef((props, ref) => <DeleteOutline {...props} ref={ref} />),\n  DetailPanel: forwardRef((props, ref) => (\n    <ChevronRight {...props} ref={ref} />\n  )),\n  Edit: forwardRef((props, ref) => <Edit {...props} ref={ref} />),\n  Export: forwardRef((props, ref) => <SaveAlt {...props} ref={ref} />),\n  Filter: forwardRef((props, ref) => <FilterList {...props} ref={ref} />),\n  FirstPage: forwardRef((props, ref) => <FirstPage {...props} ref={ref} />),\n  LastPage: forwardRef((props, ref) => <LastPage {...props} ref={ref} />),\n  NextPage: forwardRef((props, ref) => <ChevronRight {...props} ref={ref} />),\n  PreviousPage: forwardRef((props, ref) => (\n    <ChevronLeft {...props} ref={ref} />\n  )),\n  ResetSearch: forwardRef((props, ref) => <Clear {...props} ref={ref} />),\n  Search: forwardRef((props, ref) => <Search {...props} ref={ref} />),\n  SortArrow: forwardRef((props, ref) => <ArrowDownward {...props} ref={ref} />),\n  ThirdStateCheck: forwardRef((props, ref) => <Remove {...props} ref={ref} />),\n  ViewColumn: forwardRef((props, ref) => <ViewColumn {...props} ref={ref} />),\n};\n\n// More information in: https://material-table.com/#/docs/all-props\n\nconst Table = (props) => {\n  return (\n    <MaterialTable\n      style={props.style}\n      title={props.title}\n      columns={props.columns}\n      data={props.data}\n      icons={tableIcons}\n      actions={props.actions}\n      options={props.options}\n      components={props.components}\n      localization={props.localization}\n    />\n  );\n};\n\nTable.propTypes = {\n  style: PropTypes.object,\n  title: PropTypes.string,\n  columns: PropTypes.array,\n  data: PropTypes.array,\n  actions: PropTypes.array,\n  options: PropTypes.object,\n  components: PropTypes.object,\n  localization: PropTypes.object,\n};\nTable.defaultProps = {\n  style: {},\n  title: \"\",\n  columns: [],\n  data: [],\n  actions: [],\n  options: {\n    actionsColumnIndex: -1,\n    draggable: false,\n    grouping: false,\n    search: false,\n    toolbar: false,\n    searchFieldAlignment: \"left\",\n    paging: false,\n  },\n  components: {},\n};\n\nexport default Table;\n","import React from \"react\";\nimport PropTypes from \"prop-types\";\nimport { makeStyles } from \"@material-ui/core/styles\";\nimport MaterialTabs from \"@material-ui/core/Tabs\";\nimport Tab from \"@material-ui/core/Tab\";\nimport Typography from \"@material-ui/core/Typography\";\n\nfunction TabPanel(props) {\n  const { children, selectedTab, index, ...other } = props;\n\n  return (\n    <Typography\n      component=\"div\"\n      role=\"tabpanel\"\n      hidden={selectedTab !== index}\n      id={`tabpanel-${index}`}\n      aria-labelledby={`tab-${index}`}\n      {...other}\n    >\n      {selectedTab === index && children}\n    </Typography>\n  );\n}\n\nTabPanel.propTypes = {\n  children: PropTypes.node,\n  index: PropTypes.any.isRequired,\n  selectedTab: PropTypes.any.isRequired\n};\n\nfunction a11yProps(index) {\n  return {\n    id: `tab-${index}`,\n    \"aria-controls\": `tabpanel-${index}`\n  };\n}\n\nconst useStyles = makeStyles(theme => ({\n  root: {\n    flexGrow: 1,\n    height: \"100%\"\n  },\n  tabPanel: {\n    flexGrow: 1,\n    minHeight: 0,\n    height: \"calc(100% - 48px)\",\n    overflowY: \"auto\"\n  }\n}));\n\nexport default function Tabs(props) {\n  const classes = useStyles();\n  const [selectedTab, setSelectedTab] = React.useState(props.selectedTab);\n\n  React.useEffect(() => {\n    if (props.selectedTab !== selectedTab) {\n      setSelectedTab(props.selectedTab);\n    }\n  }, [props.selectedTab]);\n\n  const handleChange = (event, newSelectedTab) => {\n    setSelectedTab(newSelectedTab);\n  };\n\n  return (\n    <div className={classes.root}>\n      <MaterialTabs\n        value={selectedTab}\n        onChange={handleChange}\n        indicatorColor=\"primary\"\n        textColor=\"primary\"\n      >\n        {props.tabList.map((tab, index) => (\n          <Tab key={index} label={tab.label} {...a11yProps(index)} />\n        ))}\n      </MaterialTabs>\n      {props.tabList.map((tab, index) => (\n        <TabPanel\n          key={index}\n          selectedTab={selectedTab}\n          index={index}\n          className={props.scrollable ? classes.tabPanel : undefined}\n        >\n          {tab.component}\n        </TabPanel>\n      ))}\n    </div>\n  );\n}\n\nTabs.propTypes = {\n  tabList: PropTypes.array,\n  selectedTab: PropTypes.number,\n  scrollable: PropTypes.bool\n};\n\nTabs.defaultProps = {\n  tabList: [\n    { label: \"Tab 1\", component: <div>Component 1</div> },\n    {\n      label: \"Tab 2\",\n      component: (\n        <div>\n          Lorem Ipsum is simply dummy text of the printing and typesetting\n          industry. Lorem Ipsum has been the industry standard dummy text ever\n          since the 1500s, when an unknown printer took a galley of type and\n          scrambled it to make a type specimen book. It has survived not only\n          five centuries, but also the leap into electronic typesetting,\n          remaining essentially unchanged. It was popularised in the 1960s with\n          the release of Letraset sheets containing Lorem Ipsum passages, and\n          more recently with desktop publishing software like Aldus PageMaker\n          including versions of Lorem Ipsum.\n        </div>\n      )\n    },\n    { label: \"Tab 3\", component: <div>Component 3</div> }\n  ],\n  selectedTab: 0,\n  scrollable: true\n};\n","import React from \"react\";\nimport TextField from \"@material-ui/core/TextField\";\nimport PropTypes from \"prop-types\";\n\nconst Text = props => {\n  return <TextField {...props}></TextField>;\n};\n\nText.propTypes = {};\nText.defaultProps = {};\n\nexport default Text;\n","import React from \"react\";\nimport FormControlLabel from \"@material-ui/core/FormControlLabel\";\nimport Switch from \"@material-ui/core/Switch\";\nimport { makeStyles } from \"@material-ui/core/styles\";\nimport { green, grey } from \"@material-ui/core/colors\";\nimport PropTypes from \"prop-types\";\n\nconst useStyles = makeStyles(theme => ({\n  label: {\n    fontFamily: \"Roboto\",\n    fontStyle: \"normal\",\n    fontWeight: \"normal\",\n    fontSize: \"14px\",\n    marginLeft: 0,\n    marginRight: 0,\n    marginBottom: 0\n  },\n  colorSwitchBase: {\n    color: grey[300],\n    \"&$colorChecked\": {\n      color: green[500],\n      \"& + $colorBar\": {\n        backgroundColor: green[500]\n      }\n    }\n  },\n  colorBar: {},\n  colorChecked: {}\n}));\n\nconst Toggle = props => {\n  const classes = useStyles();\n  return (\n    <FormControlLabel\n      control={\n        <Switch\n          checked={props.toggle}\n          onChange={props.onToggle}\n          color={props.color}\n          disabled={props.disabled}\n          hidden={props.hidden}\n          size={props.size}\n          classes={{\n            switchBase: classes.colorSwitchBase,\n            checked: classes.colorChecked,\n            track: classes.colorBar\n          }}\n        />\n      }\n      labelPlacement={props.labelPlacement}\n      label={props.label}\n      classes={{ label: classes.label }}\n      style={{ ...props.style, marginLeft: 0, marginRight: 0, marginBottom: 0 }}\n    />\n  );\n};\n\nToggle.propTypes = {\n  toggle: PropTypes.bool,\n  onToggle: PropTypes.func,\n  label: PropTypes.string,\n  color: PropTypes.string,\n  labelPlacement: PropTypes.string, // 'end', 'start', 'top', 'bottom'\n  style: PropTypes.object\n};\nToggle.defaultProps = {\n  color: \"primary\" // or secondary\n};\n\nexport default Toggle;\n","import React, { Component } from \"react\";\nimport { fade, withStyles } from \"@material-ui/core/styles\";\nimport InputBase from \"@material-ui/core/InputBase\";\nimport SearchIcon from \"@material-ui/icons/Search\";\nimport PropTypes from \"prop-types\";\n\nconst styles = theme => ({\n  search: {\n    position: \"relative\",\n    borderRadius: theme.shape.borderRadius,\n    backgroundColor: fade(theme.palette.common.white, 0.15),\n    \"&:hover\": {\n      backgroundColor: fade(theme.palette.common.white, 0.25)\n    },\n    marginRight: theme.spacing(2),\n    marginLeft: 0,\n    width: \"100%\",\n    [theme.breakpoints.up(\"sm\")]: {\n      marginLeft: theme.spacing(3),\n      width: \"auto\"\n    }\n  },\n  searchIcon: {\n    width: theme.spacing(7),\n    height: \"100%\",\n    position: \"absolute\",\n    pointerEvents: \"none\",\n    display: \"flex\",\n    alignItems: \"center\",\n    justifyContent: \"center\"\n  },\n  inputRoot: {\n    color: \"inherit\"\n  },\n  inputInput: {\n    padding: theme.spacing(1, 1, 1, 7),\n    transition: theme.transitions.create(\"width\"),\n    width: \"100%\",\n    [theme.breakpoints.up(\"md\")]: {\n      width: 200\n    }\n  }\n});\n\nclass SearchInput extends Component {\n  searchInput = undefined;\n  timer = undefined;\n\n  handleChange = evt => {\n    this.searchInput = evt.target.value;\n    if (this.props.enableTimeout) {\n      if (this.timer) {\n        clearTimeout(this.timer);\n      }\n      this.timer = setTimeout(this.handleSearch, this.props.time);\n    } else {\n      this.handleSearch();\n    }\n  };\n\n  handleSearch = () => {\n    if (this.searchInput !== undefined) this.props.onChange(this.searchInput);\n  };\n\n  render() {\n    const { classes, style, placeholder } = this.props;\n    return (\n      <div className={classes.search} style={style}>\n        <div className={classes.searchIcon}>\n          <SearchIcon />\n        </div>\n        <InputBase\n          ref={this.setSearchInput}\n          placeholder={placeholder}\n          classes={{\n            root: classes.inputRoot,\n            input: classes.inputInput\n          }}\n          inputProps={{ \"aria-label\": \"search\" }}\n          onChange={this.handleChange}\n        />\n      </div>\n    );\n  }\n}\n\nSearchInput.propTypes = {\n  placeholder: PropTypes.string,\n  onChange: PropTypes.func,\n  time: PropTypes.number,\n  enableTimeout: PropTypes.bool,\n  style: PropTypes.object\n};\n\nSearchInput.defaultProps = {\n  placeholder: \"Search...\",\n  onChange: input => {\n    console.log(input);\n  },\n  time: 250,\n  enableTimeout: true,\n  style: {}\n};\n\nexport default withStyles(styles, { withTheme: true })(SearchInput);\n","import React from \"react\";\nimport { makeStyles } from \"@material-ui/core/styles\";\nimport Breadcrumbs from \"@material-ui/core/Breadcrumbs\";\nimport NavigateNextIcon from \"@material-ui/icons/NavigateNext\";\nimport Typography from \"@material-ui/core/Typography\";\nimport PropTypes from \"prop-types\";\n\nconst useStyles = makeStyles(theme => ({\n  root: {\n    \"& > * + *\": {\n      marginTop: theme.spacing(2)\n    }\n  },\n  link: {\n    fontSize: \"24px\",\n    fontWeight: 800,\n    fontFamily: \"Open Sans\",\n    \"&:hover\": {\n      cursor: \"pointer\",\n      textDecoration: \"underline\"\n    }\n  },\n  lastLabel: {\n    fontSize: \"24px\",\n    fontWeight: 800,\n    fontFamily: \"Open Sans\"\n  }\n}));\n\nconst Breadcrumb = props => {\n  const classes = useStyles();\n  return (\n    <div className={classes.root}>\n      <Breadcrumbs\n        separator={<NavigateNextIcon fontSize=\"small\" />}\n        aria-label=\"breadcrumb\"\n        style={props.style}\n      >\n        {props.pathList.map((element, index) => {\n          if (props.pathList.length - 1 !== index) {\n            return (\n              <Typography\n                key={index}\n                color=\"primary\"\n                variant=\"inherit\"\n                className={classes.link}\n                onClick={element.function}\n              >\n                {element.label}\n              </Typography>\n            );\n          }\n        })}\n        <Typography color=\"textPrimary\" className={classes.lastLabel}>\n          {props.pathList[props.pathList.length - 1].label}\n        </Typography>\n      </Breadcrumbs>\n    </div>\n  );\n};\n\nBreadcrumb.propTypes = {\n  pathList: PropTypes.array\n};\n\nBreadcrumb.defaultProps = {\n  pathList: [\n    { label: \"Mov.ai\", function: () => console.log(\"pth1/\") },\n    { label: \"User\", function: () => console.log(\"path1/path2\") },\n    { label: \"John Doe\" }\n  ]\n};\n\nexport default Breadcrumb;\n","/**\n * Class implementing ILoadingScreen interface from Babylon\n *  https://doc.babylonjs.com/typedoc/interfaces/babylon.iloadingscreen\n *\n * @param {String} text : Sets the text to display while loading\n * @param {String} backgroundColor : Sets the color to use for the background\n */\nfunction LoadingScreen(text = \"Loading...\", backgroundColor = \"black\") {\n  // init the loader\n  this.loadingUIText = text;\n  this.loadingUIBackgroundColor = backgroundColor;\n}\n\n/**\n * Function called to display the loading screen\n */\nLoadingScreen.prototype.displayLoadingUI = function () {\n  document.getElementById(\"loading-scene\").style.display = \"block\";\n};\n\n/**\n * Function called to hide the loading screen\n */\nLoadingScreen.prototype.hideLoadingUI = function () {\n  document.getElementById(\"loading-scene\").style.display = \"none\";\n};\n\nexport default LoadingScreen;\n","//========================================================================================\n/*                                                                                      *\n *         Based from https://doc.babylonjs.com/resources/babylonjs_and_reactjs         *\n *                                                                                      */\n//========================================================================================\n\nimport { Engine, Scene } from \"@babylonjs/core\";\nimport React, { useEffect, useRef, useState } from \"react\";\nimport { useTheme, makeStyles } from \"@material-ui/core/styles\";\nimport ReactResizeDetector from \"react-resize-detector\";\nimport PropTypes from \"prop-types\";\nimport { SCENE_BACKGROUND } from \"../Utils/Constants\";\nimport LoadingScreen from \"../Utils/LoadingScreen\";\nimport loader from \"../../../../resources/movai_red.svg\";\nimport { LinearProgress } from \"@material-ui/core\";\n\nconst useStyles = makeStyles(theme => {\n  return {\n    root: {\n      ...FLEX_STYLE,\n      maxHeight: \"100%\",\n      position: \"relative\"\n    },\n    loaderContainer: {\n      // backgroundColor: theme.palette.background.secondary,\n      backgroundColor: \"black\",\n      display: \"none\",\n      height: \"100%\",\n      position: \"absolute\",\n      textAlign: \"center\",\n      top: 0,\n      left: 0,\n      width: \"100%\",\n      zIndex: 1051 // Must be greater than 1050 to be on top of floating buttons\n    },\n    loaderImage: {\n      position: \"absolute\",\n      left: \"50%\",\n      top: \"50%\",\n      transform: \"translate(-50%, -50%)\"\n    }\n  };\n});\nconst FLEX_STYLE = {\n  display: \"flex\",\n  flexDirection: \"column\",\n  flexGrow: 1\n};\n\nconst BaseViewer = props => {\n  const {\n    antialias,\n    engineOptions,\n    adaptToDeviceRatio,\n    sceneOptions,\n    onRender,\n    onSceneReady,\n    is2render,\n    sceneFactory,\n    ...rest\n  } = props;\n  const theme = useTheme();\n  const classes = useStyles();\n  const reactCanvas = useRef(null);\n  const [loaded, setLoaded] = useState(false);\n  const [scene, setScene] = useState(null);\n  const [size, setSize] = useState({ width: 100, height: 100 });\n\n  const setUpScene = engine => {\n    const scene = sceneFactory\n      ? sceneFactory(engine)\n      : new Scene(engine, sceneOptions);\n    setScene(scene);\n    if (scene.isReady()) {\n      onSceneReady(scene);\n    } else {\n      scene.onReadyObservable.addOnce(scene => onSceneReady(scene));\n    }\n    return scene;\n  };\n\n  const onResize = (width, height) => {\n    setSize({\n      width,\n      height\n    });\n    scene && scene.getEngine().resize();\n  };\n\n  const renderScene = (engine, nScene) => {\n    if (!is2render) return;\n    engine.runRenderLoop(() => {\n      if (typeof onRender === \"function\") {\n        onRender(nScene);\n      }\n      nScene && nScene.render();\n    });\n  };\n\n  /* eslint-disable react-hooks/exhaustive-deps */\n  useEffect(() => {\n    if (!loaded) {\n      setLoaded(true);\n      const engine = new Engine(\n        reactCanvas.current,\n        antialias,\n        engineOptions,\n        adaptToDeviceRatio\n      );\n      // Set custom loading screen and display loading\n      const loadingScreen = new LoadingScreen();\n      engine.loadingScreen = loadingScreen;\n      // Setup and render scene\n      const newScene = setUpScene(engine);\n      renderScene(engine, newScene);\n    }\n\n    return () => {\n      console.log(\"Disposing engine and scene\");\n      scene && scene.dispose();\n      scene && scene.getEngine() && scene.getEngine().dispose();\n    };\n  }, [reactCanvas, loaded, scene]);\n  /* eslint-enable react-hooks/exhaustive-deps */\n  // loaded && reactCanvas.current.focus();\n\n  // On toggle theme update scene background color\n  useEffect(() => {\n    if (!scene) return;\n    scene.clearColor = SCENE_BACKGROUND[theme?.label || \"default\"];\n  }, [classes, theme.label, scene]);\n\n  return (\n    <div className={classes.root}>\n      <div id=\"loading-scene\" className={classes.loaderContainer}>\n        <div className={classes.loaderImage}>\n          <img src={loader} alt=\"loading\" width={200}></img>\n          <LinearProgress color=\"secondary\" style={{ marginTop: 50 }} />\n        </div>\n      </div>\n      <canvas\n        ref={reactCanvas}\n        width={size.width}\n        height={size.height}\n        {...rest}\n      />\n      <ReactResizeDetector handleWidth handleHeight onResize={onResize} />\n    </div>\n  );\n};\n\nBaseViewer.propTypes = {\n  antialias: PropTypes.bool,\n  engineOptions: PropTypes.object,\n  adaptToDeviceRatio: PropTypes.bool,\n  sceneOptions: PropTypes.object,\n  onSceneReady: PropTypes.func,\n  onRender: PropTypes.func,\n  is2render: PropTypes.bool,\n  sceneFactory: PropTypes.func\n};\n\nBaseViewer.defaultProps = {\n  antialias: true,\n  onSceneReady: scene => {},\n  is2render: true,\n  engineOptions: { preserveDrawingBuffer: true, stencil: true }\n};\n\nexport default BaseViewer;\n","class Action {\n  constructor() {\n    this.memory = {};\n  }\n\n  action(parentView) {\n    parentView.getSceneMemory().forEach(memory => {\n      memory.gizmoManager.attachedMesh = null;\n      memory.camera.attachControl(memory.canvas, true);\n    });\n    parentView.closeContextDial && parentView.closeContextDial();\n    parentView.setContextActionIndex && parentView.setContextActionIndex();\n  }\n\n  onChange(parentView) {\n    // to be overwritten by children\n  }\n}\n\nexport default Action;\n","import NodeItem from \"./NodeItem\";\n\nclass AssetNodeItem extends NodeItem {\n  constructor(mesh, assetName, keyValueMap = {}) {\n    super(mesh, keyValueMap);\n    this.assetName = assetName;\n  }\n\n  toDict() {\n    const ans = super.toDict();\n    ans.assetName = this.assetName;\n    return ans;\n  }\n\n  getCopyFunction = () => {\n    return (mousePosFromRoot, someMainView) => {};\n  };\n}\n\nexport default AssetNodeItem;\n","import AssetNodeItem from \"./AssetNodeItem\";\n\nclass Map extends AssetNodeItem {\n  constructor(mesh, size, textureSrc, assetName) {\n    super(mesh, assetName);\n    this.size = size;\n    this.textureSrc = textureSrc;\n  }\n\n  dispose() {\n    super.dispose();\n  }\n\n  toDict() {\n    const dict = super.toDict();\n    dict[\"size\"] = this.size;\n    dict[\"textureSrc\"] = this.textureSrc;\n    return dict;\n  }\n\n  toForm() {\n    const info = this.toDict();\n    const schema = {\n      jsonSchema: {\n        type: \"object\",\n        properties: {\n          oldName: {\n            type: \"string\"\n          },\n          name: {\n            type: \"string\",\n            title: \"Name\"\n          },\n          type: {\n            type: \"string\",\n            title: \"Type\"\n          },\n          assetName: {\n            type: \"string\",\n            title: \"Asset Name\"\n          }\n        }\n      },\n      uiSchema: {\n        type: {\n          \"ui:disabled\": true\n        },\n        assetName: {\n          \"ui:disabled\": true\n        },\n        oldName: {\n          \"ui:widget\": \"hidden\"\n        }\n      },\n      data: {\n        oldName: info.name,\n        name: info.name,\n        type: info.type,\n        assetName: info.assetName\n      }\n    };\n    return schema;\n  }\n\n  ofForm(form) {\n    this.name = form.name;\n    this.mesh.name = form.name;\n    this.keyValueMap = { ...form.annotations };\n  }\n\n  getType = () => Map.TYPE;\n\n  static TYPE = \"Map\";\n}\n\nexport default Map;\n","import {\n  Scene,\n  RotationGizmo,\n  UtilityLayerRenderer,\n  Vector3,\n  StandardMaterial,\n  Mesh,\n  Space\n} from \"@babylonjs/core\";\nimport { TextBlock, AdvancedDynamicTexture } from \"@babylonjs/gui/2D\";\nimport Util3d from \"../Util3d/Util3d\";\nimport \"@babylonjs/core/Debug/debugLayer\";\nimport \"@babylonjs/inspector\";\nimport Constants from \"./Constants\";\n\nclass DefaultScene {\n  static createGizmo = scene => {\n    const gizmoManager = new RotationGizmo(new UtilityLayerRenderer(scene));\n    gizmoManager.xGizmo.dragBehavior.detach();\n    gizmoManager.xGizmo.scaleRatio = 0.0;\n    gizmoManager.yGizmo.dragBehavior.detach();\n    gizmoManager.yGizmo.scaleRatio = 0.0;\n    return gizmoManager;\n  };\n\n  static createCamera = (scene, canvas, forEach = camera => {}) => {\n    const COLLISION_RADIUS = 1;\n    const camera = Util3d.cameraBuilder(scene)\n      .sphericalCoordinates(new Vector3(0, 0, 14))\n      .target(Vector3.Zero())\n      .name(\"camera\")\n      .build();\n    camera.attachControl(canvas, false);\n    camera.inertia = 0.7;\n    camera.collisionRadius = new Vector3(\n      COLLISION_RADIUS,\n      COLLISION_RADIUS,\n      COLLISION_RADIUS\n    );\n    camera.panningInertia = 0.5;\n    camera.checkCollisions = true;\n    camera.panningSensibility = 0;\n    camera.lowerRadiusLimit = 2;\n    const browser = get_browser();\n    if (browser.name === \"Firefox\" && browser.version <= 89) {\n      camera.wheelPrecision = 100;\n    }\n    forEach(camera);\n    return camera;\n  };\n\n  static createLight = scene => {\n    return Util3d.directionalLightBuilder(scene)\n      .name(\"light\")\n      .direction(new Vector3(0, -1, 0))\n      .intensity(0.35)\n      .build();\n  };\n\n  static createMeshGround = (scene, width = 20, height = 20) => {\n    const ground = Mesh.CreateGround(\"groundMesh\", width, height, 20, scene);\n    ground.translate(new Vector3(0, -1, 0), 1e-2, Space.WORLD);\n    ground.material = new StandardMaterial(\"wireframe\", scene);\n    ground.material.wireframe = true;\n    ground.isPickable = false;\n    ground.checkCollisions = true;\n    return ground;\n  };\n\n  static createScene = engine => {\n    const scene = new Scene(engine);\n    scene.collisionsEnabled = true;\n    scene._uid = scene.getUniqueId();\n    if (Constants.DEBUG) {\n      scene.debugLayer.show({\n        embedMode: true,\n        globalRoot: document.body,\n        overlay: true\n      });\n    }\n    return scene;\n  };\n\n  static createMouseLocationText = scene => {\n    const advancedTexture = AdvancedDynamicTexture.CreateFullscreenUI(\n      \"UI\",\n      true,\n      scene\n    );\n    const text = new TextBlock();\n    text.text = \"\";\n    text.color = \"white\";\n    text.fontSize = 17;\n    text.left = -560;\n    text.top = -145;\n    advancedTexture.addControl(text);\n    return text;\n  };\n}\n\n/**\n * From https://stackoverflow.com/questions/5916900/how-can-you-detect-the-version-of-a-browser\n */\nfunction get_browser() {\n  var ua = navigator.userAgent,\n    tem,\n    M =\n      ua.match(\n        /(opera|chrome|safari|firefox|msie|trident(?=\\/))\\/?\\s*(\\d+)/i\n      ) || [];\n  if (/trident/i.test(M[1])) {\n    tem = /\\brv[ :]+(\\d+)/g.exec(ua) || [];\n    return { name: \"IE\", version: tem[1] || \"\" };\n  }\n  if (M[1] === \"Chrome\") {\n    tem = ua.match(/\\bOPR|Edge\\/(\\d+)/);\n    if (tem != null) {\n      return { name: \"Opera\", version: tem[1] };\n    }\n  }\n  M = M[2] ? [M[1], M[2]] : [navigator.appName, navigator.appVersion, \"-?\"];\n  if ((tem = ua.match(/version\\/(\\d+)/i)) != null) {\n    M.splice(1, 1, tem[1]);\n  }\n  return {\n    name: M[0],\n    version: M[1]\n  };\n}\n\nexport default DefaultScene;\n","import Action from \"./Action\";\n\nclass MouseKeysAction extends Action {\n  onPointerDown(evt, parentView) {\n    // to be implemented on sub classes\n  }\n\n  onPointerMove(evt, parentView) {\n    // to be implemented on sub classes\n  }\n\n  onPointerUp(evt, parentView) {\n    // to be implemented on sub classes\n  }\n\n  onKeyUp(evt, parentView) {\n    // to be implemented on sub classes\n  }\n\n  onWheel(evt, parentView) {\n    // to be implemented on sub classes\n  }\n}\n\nexport default MouseKeysAction;\n","export function selectOneAction(predicateActionList, defaultAction = () => {}) {\n  return input => {\n    predicateActionList.push({ predicate: e => true, action: defaultAction });\n    for (let i = 0; i < predicateActionList.length; i++) {\n      const predicateAction = predicateActionList[i];\n      if (predicateAction.predicate(input)) {\n        predicateAction.action();\n        break;\n      }\n    }\n  };\n}\n","export default class MeshSelector {\n  constructor(mainView) {\n    return mainView\n      .getSceneMemory()\n      .map(({ scene }) => {\n        const sceneId = scene._uid;\n        if (sceneId in placeHolderInstance) {\n          return placeHolderInstance[sceneId];\n        }\n        this.scene = scene;\n        this.mainView = mainView;\n        this.meshSelectionSet = new Set();\n        placeHolderInstance[sceneId] = this;\n        return this;\n      })\n      .orSome(this);\n  }\n\n  /**\n   * Add mesh 2 selected meshes\n   * @param {*} mesh\n   * @param {*} isSubtractive: if true, repeated addition of meshes will be removed from selected meshes set.\n   */\n  add(mesh, isSubtractive = true) {\n    if (this.meshSelectionSet.has(mesh)) {\n      isSubtractive && this.meshSelectionSet.delete(mesh);\n    } else {\n      this.meshSelectionSet.add(mesh);\n    }\n    return this;\n  }\n\n  addArray(meshes, isSubtractive = true) {\n    meshes.forEach(mesh => this.add(mesh, isSubtractive));\n    return this;\n  }\n\n  clear() {\n    this.meshSelectionSet = new Set();\n    return this;\n  }\n\n  meshes() {\n    return [...this.meshSelectionSet];\n  }\n\n  has(mesh) {\n    return this.meshSelectionSet.has(mesh);\n  }\n\n  filter(predicate) {\n    const filteredSet = new Set();\n    this.meshSelectionSet.forEach(mesh => {\n      if (predicate(mesh)) filteredSet.add(mesh);\n    });\n    this.meshSelectionSet = filteredSet;\n    return this;\n  }\n\n  //   forEach(lambda) {\n  //     this.meshSelectionSet.forEach(lambda);\n  //     return this;\n  //   }\n\n  static ofMainView(mainView) {\n    return new MeshSelector(mainView);\n  }\n}\n\nconst placeHolderInstance = {};\n","import _uniqBy from \"lodash/uniqBy\";\nimport Util3d from \"../Util3d/Util3d\";\nimport KeyPoint from \"../NodeItem/KeyPoint\";\nimport { Quaternion, Observable, Vector3 } from \"@babylonjs/core\";\nimport { Maybe } from \"monet\";\nimport Vec3 from \"../Math/Vec3\";\nimport Vec2 from \"../Math/Vec2\";\nimport MeshSelector from \"../MainView/MeshSelector\";\n\nclass SelectionPlaceHolder {\n  constructor(mainView) {\n    return mainView\n      .getSceneMemory()\n      .map(({ scene }) => {\n        const sceneId = scene._uid;\n        if (sceneId in placeHolderInstance) {\n          return placeHolderInstance[sceneId];\n        }\n        this.scene = scene;\n        this.mesh = null;\n        this.arrayOfMeshes = [];\n        this.angleByMeshName = {};\n        this.mainView = mainView;\n        this.theta = 0;\n        placeHolderInstance[sceneId] = this;\n        return this;\n      })\n      .orSome(this);\n  }\n\n  push(arrayOfMeshes) {\n    if (arrayOfMeshes.length === 0) return this;\n    arrayOfMeshes = Array.isArray(arrayOfMeshes)\n      ? arrayOfMeshes\n      : [arrayOfMeshes];\n    this.arrayOfMeshes = _uniqBy(\n      this.arrayOfMeshes.concat(arrayOfMeshes),\n      mesh => mesh.name\n    );\n    this.angleByMeshName = this.arrayOfMeshes.reduce((map, m) => {\n      map[m.name] = getAngleFromMesh(m);\n      return map;\n    }, {});\n    const placeHolderPosition = Util3d.pointAverage(\n      this.arrayOfMeshes.map(mesh =>\n        Util3d.getGlobalCoordinates(mesh, mesh.position).toBabylon()\n      )\n    );\n    this.createPlaceHolderIn(placeHolderPosition);\n    return this;\n  }\n\n  clear() {\n    this.arrayOfMeshes = [];\n    this.mesh && this.mesh.dispose();\n    return this;\n  }\n\n  createPlaceHolderIn(p) {\n    if (this.mesh === null || this.mesh.isDisposed()) {\n      this.mesh = KeyPoint.ofDict(this.scene, {\n        name: NAME,\n        type: SelectionPlaceHolder,\n        position: [0, 0, 0],\n        quaternion: Quaternion.Identity(),\n        color: [0.5, 0.5, 0.5],\n        keyValueMap: {},\n        isVisible: true\n      }).mesh;\n      this.mesh.material = this.getSelPlaceHolderShader();\n    }\n    const that = this;\n    this.mesh.getMouseContextActions = () => [\n      {\n        title: \"Delete\",\n        onClick: () => {\n          that.mainView.addGizmo2Mesh();\n          that.clear();\n          MeshSelector.ofMainView(this.mainView).clear();\n          that.mainView.highlightMeshesInScene();\n          that.mainView.highlightNodesInTree();\n        }\n      }\n    ];\n    this.mesh.onClick = () => {};\n    this.mesh.isSelectionPlaceHolder = true;\n    this.mesh.parent = this.mainView.getRootNode().item.mesh;\n    this.mesh.position = p.add(new Vector3(0, 0, HEIGHT));\n    this.mesh.observers = new Observable();\n    this.mesh.observers.add(this.getPlaceHolderObs());\n    return this.mesh;\n  }\n\n  getSelPlaceHolderShader() {\n    return Util3d.getShaderMaterial({\n      name: \"placeHolderShader\",\n      vertex: VERTEX,\n      frag: FRAG\n    })(this.scene);\n  }\n\n  getPlaceHolderObs() {\n    const that = this;\n    return ({\n      updatedPointMesh: placeHolder,\n      is2updateServer,\n      displacement\n    }) => {\n      const filteredMeshes = that.arrayOfMeshes.filter(\n        mesh => !mesh.isDisposed()\n      );\n      const theta = getAngleFromMesh(placeHolder);\n      const dTheta = theta - that.theta;\n      that.theta = theta;\n\n      filteredMeshes.forEach(mesh => {\n        handleMotion(theta, mesh, displacement, placeHolder, dTheta, that);\n        if (is2updateServer) {\n          that.mainView.updateNodeInServer(mesh.name);\n        }\n        // notify babylonjs observers\n        Maybe.fromNull(mesh.observers).forEach(obs =>\n          obs.notifyObservers({\n            updatedPointMesh: mesh,\n            is2updateServer,\n            displacement\n          })\n        );\n        // notify graph observers\n        Maybe.fromNull(mesh.graphVertex).forEach(({ vertexObs }) => {\n          vertexObs({\n            updatedPointMesh: mesh,\n            is2updateServer,\n            displacement\n          });\n        });\n      });\n      if (filteredMeshes.length === 0) {\n        that.clear();\n      }\n    };\n  }\n\n  static ofMainView(mainView) {\n    return new SelectionPlaceHolder(mainView);\n  }\n}\n\nconst VERTEX = `precision highp float;\n\n// Attributes\nattribute vec3 position;\nattribute vec3 normal;\n\n// Uniforms\nuniform mat4 worldViewProjection;\n\n// Varying\nvarying vec3 vPosition;\nvarying vec3 vNormal;\n\nvoid main(void) {\n    gl_Position = worldViewProjection * vec4(position, 1.0);\n    vPosition = position;\n    vNormal = normal;\n}`;\n\nconst FRAG = `\nprecision highp float;\n\n// Varying\nvarying vec3 vPosition;\nvarying vec3 vNormal;\n\n// Uniforms\nuniform mat4 world;\nuniform float time;\n\nvoid main(void) {\n    // World values\n    vec3 p = vec3(world * vec4(vPosition, 1.0));\n    vec3 n = normalize(vec3(world * vec4(vNormal, 0.0)));\n    vec3 nColor = n * 0.5 + 0.5;\n    float spatialFreq = 20.;\n    float timeFreq = 10.;\n    float power = sin(spatialFreq * p.y - timeFreq * time);\n    power *= power;\n    vec3 color = power *  nColor + (1. - power) * vec3(1,1,1);\n    gl_FragColor = vec4(color, 1.);\n}`;\n\nconst getAngleFromMesh = mesh =>\n  Maybe.fromNull(mesh.rotationQuaternion)\n    .map(q => 2 * Math.atan2(q.z, q.w))\n    .orSome(0);\n\nconst placeHolderInstance = {};\nconst NAME = \"placeholder\";\nconst HEIGHT = 1.5;\n\nfunction handleMotion(theta, mesh, displacement, placeHolder, dTheta, that) {\n  if (Math.abs(dTheta) < 1e-3) {\n    handleTranslation(mesh, displacement);\n  } else {\n    handleRotation(placeHolder, mesh, dTheta, that, theta);\n  }\n}\n\nfunction handleRotation(placeHolder, mesh, dTheta, that, theta) {\n  const baseCoord = Vec3.ofBabylon(placeHolder.position);\n  const v = Vec3.ofBabylon(mesh.position).sub(baseCoord).toVec2();\n  const eITheta = Vec2.of(Math.cos(dTheta), Math.sin(dTheta));\n  const rV = eITheta.prod(v);\n  const finalV = Vec3.of([rV.x, rV.y, 0]).toBabylon();\n  mesh.position = new Vector3(\n    placeHolder.position.x,\n    placeHolder.position.y,\n    mesh.position.z\n  ).add(finalV);\n  const finalTheta = that.angleByMeshName[mesh.name] + theta;\n  // divide by 2 because of quaternion multiplication.\n  mesh.rotationQuaternion = new Quaternion(\n    0,\n    0,\n    Math.sin(finalTheta / 2),\n    Math.cos(finalTheta / 2)\n  );\n}\n\nfunction handleTranslation(mesh, displacement) {\n  const localDisplacement = Util3d.getLocalCoordFromWorld(\n    mesh,\n    Vec3.ofBabylon(displacement),\n    false\n  );\n  const newPos = Vec3.ofBabylon(mesh.position).add(localDisplacement);\n  // translating\n  mesh.position = newPos.toBabylon();\n}\n\nexport default SelectionPlaceHolder;\n","import Util3d from \"../Util3d/Util3d\";\nimport Vec3 from \"../Math/Vec3\";\nimport { Maybe } from \"monet\";\nimport MouseKeysAction from \"./MouseKeysAction\";\nimport React from \"react\";\nimport { Vector3 } from \"@babylonjs/core\";\nimport { UndoManager } from \"mov-fe-lib-core\";\nimport Clipboard from \"../Utils/Clipboard\";\nimport { selectOneAction } from \"../Utils/Utils\";\nimport SelectionPlaceHolder from \"../Util3d/SelectionPlaceHolder\";\nimport MeshSelector from \"../MainView/MeshSelector\";\nimport Vec2 from \"../Math/Vec2\";\nimport ReactDOM from \"react-dom\";\nimport TreeObject from \"../TreeObject/TreeObject\";\nimport GlobalRef from \"../NodeItem/GlobalRef\";\nimport GraphItem from \"../NodeItem/GraphItem\";\nimport Map from \"../NodeItem/Map\";\nimport Path from \"../NodeItem/Path\";\n\nclass DragObjectsAction extends MouseKeysAction {\n  constructor() {\n    super();\n    this.key = \"dragObject\";\n    this.name = \"Grab Objects [1]\";\n    this.icon = props => <i className=\"far fa-hand-paper\" {...props}></i>;\n    this.maybeSelectedMesh = Maybe.none();\n    this.clickPointInWorld = Vec3.ZERO;\n    this.movePointInWorld = Vec3.ZERO;\n    this.startDivPos = Vec2.ZERO;\n    this.corners = [];\n  }\n\n  action = parentView => {\n    super.action(parentView);\n    parentView.setSelectedAction(this);\n  };\n\n  onPointerDown = (evt, parentView) => {\n    if (!(evt.buttons === 1 || evt.buttons === 2) || evt.ctrlKey) return;\n    parentView.getSceneMemory().forEach(({ scene, ground }) => {\n      this.maybeSelectedMesh = Util3d.pickMesh(scene, ground);\n      this.maybeSelectedMesh.forEach(currentMesh =>\n        this.dragDownMesh(currentMesh, parentView, evt)\n      );\n      this.maybeSelectedMesh.orLazy(() => {\n        this.dragDownWithoutMesh(parentView, evt);\n      });\n    });\n  };\n\n  onPointerMove = (evt, parentView) => {\n    if (!(evt.buttons === 1) || evt.ctrlKey) return;\n    parentView.getSceneMemory().forEach(({ scene, ground }) => {\n      // check that a mesh was selected\n      this.maybeSelectedMesh.forEach(selectedMesh => {\n        Util3d.getGroundPosition(scene, ground).forEach(groundPos => {\n          this.dragMoveMesh(parentView, groundPos);\n        });\n      });\n      this.maybeSelectedMesh.orLazy(() => {\n        this.dragMoveWithoutMesh(evt);\n      });\n    });\n  };\n\n  onPointerUp = (evt, parentView) => {\n    parentView.getSceneMemory().forEach(({ camera, scene, ground, canvas }) => {\n      this.maybeSelectedMesh.forEach(selectedMesh => {\n        this.dragUpMesh(selectedMesh, parentView, scene, ground);\n      });\n      this.maybeSelectedMesh.orLazy(() => {\n        this.dragUpWithoutMesh(parentView, scene);\n      });\n      // reset action\n      camera.attachControl(canvas, true);\n      this.maybeSelectedMesh = Maybe.none();\n      this.destroySelectionDiv();\n      this.corners = [];\n    });\n  };\n\n  onKeyUp = (evt, parentView) => {\n    const predicateActionList = [\n      {\n        predicate: e => [\"Backspace\", \"Delete\"].includes(e.code),\n        action: this.getDeleteAction(parentView)\n      },\n      {\n        predicate: e => e.ctrlKey && e.code === \"KeyC\",\n        action: this.getCopyAction(parentView)\n      },\n      {\n        predicate: e => e.ctrlKey && e.code === \"KeyV\",\n        action: this.getPasteAction(parentView)\n      }\n    ];\n    selectOneAction(predicateActionList)(evt);\n  };\n\n  //========================================================================================\n  /*                                                                                      *\n   *                                         UTILS                                        *\n   *                                                                                      */\n  //========================================================================================\n\n  dragDownMesh(currentMesh, parentView, evt) {\n    if (currentMesh.isStatic) return;\n    parentView.getSceneMemory().forEach(({ camera, canvas, scene, ground }) => {\n      camera.detachControl(canvas);\n      this.addSelectedMesh(evt, currentMesh, parentView);\n      this.handleMeshRightClick(evt, parentView, currentMesh);\n      Util3d.getGroundPosition(scene, ground).forEach(groundPos => {\n        this.updateMouseVars(groundPos);\n        // mesh onClick\n        currentMesh.onClick\n          ? currentMesh.onClick()\n          : parentView.closeContextDial();\n\n        if (currentMesh.isSelectionPlaceHolder) {\n          parentView.addGizmo2Mesh(\n            currentMesh,\n            () => {\n              this.notifyObservers(currentMesh, false, Vec3.ZERO, parentView);\n            },\n            () => {\n              this.notifyObservers(currentMesh, true, Vec3.ZERO, parentView);\n            }\n          );\n        } else {\n          this.selectMeshUpdateUI(parentView);\n        }\n      });\n    });\n  }\n\n  selectMeshUpdateUI(parentView) {\n    const meshSelector = MeshSelector.ofMainView(parentView);\n    const selectionPlaceHolder = SelectionPlaceHolder.ofMainView(parentView);\n    const selectedMeshes = meshSelector.meshes();\n    parentView.highlightMeshesInScene(selectedMeshes);\n    parentView.highlightNodesInTree(selectedMeshes.map(({ name }) => name));\n    if (selectedMeshes.length > 1) {\n      parentView.addGizmo2Name();\n      selectionPlaceHolder.clear();\n      selectionPlaceHolder.push(selectedMeshes);\n      this.setProperties(parentView, selectedMeshes[0].name);\n    } else {\n      selectionPlaceHolder.clear();\n      parentView.addGizmo2Name();\n      selectedMeshes.forEach(mesh => {\n        parentView.addGizmo2Name(mesh.name);\n        this.setProperties(parentView, mesh.name);\n      });\n    }\n  }\n\n  dragDownWithoutMesh(parentView, evt) {\n    parentView\n      .getMouseCoordsFromRoot()\n      .forEach(mousePosRoot =>\n        this.handleRightClickWithoutMesh(evt, parentView, mousePosRoot)\n      );\n    parentView.getSceneMemory().forEach(({ camera, canvas, scene }) => {\n      if (evt.shiftKey) {\n        camera.detachControl(canvas);\n        this.createSelectionDiv(evt);\n        this.corners.push(Vec2.of(scene.pointerX, scene.pointerY));\n      }\n    });\n  }\n\n  dragMoveMesh(parentView, groundPos) {\n    const meshSelector = MeshSelector.ofMainView(parentView);\n    const meshes = meshSelector.meshes();\n    const selector = SelectionPlaceHolder.ofMainView(parentView);\n    const newMousePosInWorld = Vec3.ofBabylon(groundPos);\n    const v = newMousePosInWorld.sub(this.movePointInWorld);\n    meshes.forEach(mesh => {\n      let vLocal = Util3d.getLocalCoordFromWorld(mesh, v, false);\n      vLocal = new Vector3(vLocal.x, vLocal.y, 0);\n      mesh.position = mesh.position.add(vLocal);\n      this.notifyObservers(mesh, false, v, parentView);\n    });\n    if (meshes.length > 1) {\n      let vLocal = Util3d.getLocalCoordFromWorld(selector.mesh, v, false);\n      vLocal = new Vector3(vLocal.x, vLocal.y, 0);\n      selector.mesh.position = selector.mesh.position.add(vLocal);\n    }\n    this.movePointInWorld = newMousePosInWorld;\n  }\n\n  dragMoveWithoutMesh(evt) {\n    this.updateSelectionDiv(evt);\n  }\n\n  dragUpMesh(selectedMesh, parentView, scene, ground) {\n    const meshSelector = MeshSelector.ofMainView(parentView);\n    const meshes = meshSelector.meshes();\n    const selectPlaceHolder = SelectionPlaceHolder.ofMainView(parentView);\n    Util3d.getGroundPosition(scene, ground).forEach(groundPos => {\n      const groundPosInWorld = Vec3.ofBabylon(groundPos);\n      const bigDisplacement = groundPosInWorld.sub(this.clickPointInWorld);\n      const isBigDisplacement = bigDisplacement.length() > 1e-3;\n      meshes.forEach(mesh => {\n        // TODO: find better way without edge if\n        const isBigDisplaceOrIsEdgeMesh =\n          isBigDisplacement || !!mesh.edgeIndexes;\n        this.notifyObservers(\n          mesh,\n          isBigDisplaceOrIsEdgeMesh,\n          Vec3.ZERO,\n          parentView\n        );\n        if (isBigDisplacement) parentView.updateNodeInServer(mesh.name);\n      });\n      this.setProperties(parentView, selectedMesh.name);\n      if (isBigDisplacement) {\n        parentView\n          .getUndoManager()\n          .addIt(this.getUndoAbleAction(meshes, bigDisplacement, parentView));\n      }\n      if (selectedMesh.isSelectionPlaceHolder) {\n        meshSelector.clear();\n        meshSelector.addArray(selectPlaceHolder.arrayOfMeshes);\n      }\n      this.mergePathsIfAny(selectedMesh, parentView, scene, ground);\n    });\n  }\n\n  dragUpWithoutMesh(parentView, scene) {\n    this.selectObjectsInside(scene, parentView);\n  }\n\n  handleMeshRightClick = (evt, parentView, mesh) => {\n    if (!(evt.buttons === 2)) return;\n    if (!mesh || !mesh.getMouseContextActions) return;\n    parentView.setMouseContextActions(\n      evt,\n      mesh.getMouseContextActions(parentView)\n    );\n  };\n\n  /**\n   * @param evt: event\n   * @param parentView: MainView\n   * @param mousePosFromRoot: Vector3\n   */\n  handleRightClickWithoutMesh = (evt, parentView, mousePosFromRoot) => {\n    if (!(evt.buttons === 2)) return;\n    parentView.setMouseContextActions(evt, [\n      {\n        title: \"Paste\",\n        onClick: this.getPasteOnClick(mousePosFromRoot, parentView)\n      }\n    ]);\n  };\n\n  updateMouseVars(groundPos) {\n    const groundPosInGlobal = Vec3.ofBabylon(groundPos);\n    this.movePointInWorld = groundPosInGlobal;\n    this.clickPointInWorld = groundPosInGlobal;\n  }\n\n  addSelectedMesh(evt, currentMesh, parentView) {\n    const meshSelector = MeshSelector.ofMainView(parentView);\n    // is an edge mesh\n    if (!!currentMesh.edgeIndexes) {\n      meshSelector.clear();\n      meshSelector.add(currentMesh);\n      return;\n    }\n    // not an edge mesh\n    meshSelector.filter(mesh => !mesh.edgeIndexes);\n    if (evt.shiftKey) {\n      meshSelector.add(currentMesh);\n    } else {\n      if (meshSelector.has(currentMesh)) return;\n      meshSelector.clear();\n      meshSelector.add(currentMesh);\n    }\n  }\n\n  getPasteOnClick = (mousePosFromRoot, parentView) => () => {\n    const pasteAction = Clipboard.paste();\n    if (pasteAction && typeof pasteAction === \"function\") {\n      pasteAction(mousePosFromRoot, parentView);\n    }\n  };\n\n  getDeleteAction(parentView) {\n    return () => {\n      const meshSelector = MeshSelector.ofMainView(parentView);\n      const meshes = meshSelector.meshes();\n      const isOne = meshes.length === 1;\n      meshes.forEach(mesh => {\n        const maybeNode = parentView.getNodeFromTree(mesh.name);\n        maybeNode.forEach(node => parentView.onDeleteNode(node, isOne, isOne));\n        maybeNode.orElseRun(() => {\n          if (!isOne) return;\n          mesh.onDel && mesh.onDel();\n        });\n      });\n      parentView.highlightNodesInTree();\n      parentView.highlightMeshesInScene();\n      parentView.addGizmo2Mesh();\n      meshSelector.clear();\n      SelectionPlaceHolder.ofMainView(parentView).clear();\n      parentView.renderMenus();\n    };\n  }\n\n  getCopyAction(parentView) {\n    const meshSelector = MeshSelector.ofMainView(parentView);\n    const meshes = meshSelector.meshes();\n    const selectPlaceHolderMesh = SelectionPlaceHolder.ofMainView(parentView)\n      .mesh;\n    return () => {\n      if (meshes.length <= 1) {\n        this.copyOne(meshes);\n      } else {\n        this.copyMany(meshes, selectPlaceHolderMesh);\n      }\n    };\n  }\n\n  copyOne(meshes) {\n    Clipboard.copy((mousePosFromRoot, someMainView) => {\n      const uuid = Clipboard.getUID();\n      const itemCopyFunctions = meshes\n        .filter(mesh => !!mesh.nodeItem)\n        .map(mesh => mesh.nodeItem)\n        .map(item => item.getCopyFunction(true, name => name + \"_copy\" + uuid));\n      if (itemCopyFunctions.length === 0) return;\n      const doAction = () => {\n        const maybeCopiedItem = itemCopyFunctions[0](\n          mousePosFromRoot,\n          someMainView\n        );\n        maybeCopiedItem.forEach(item => {\n          const copiedMesh = item.mesh;\n          someMainView.addGizmo2Name(copiedMesh.name);\n          someMainView.highlightMeshesInScene([copiedMesh]);\n          someMainView.highlightNodesInTree([copiedMesh.name]);\n          MeshSelector.ofMainView(someMainView).clear().add(copiedMesh);\n          someMainView.setProperties(item.toForm());\n          someMainView.renderMenus();\n        });\n        return maybeCopiedItem;\n      };\n      const maybeCopiedItem = doAction();\n      someMainView.getUndoManager().addIt(\n        UndoManager.actionBuilder()\n          .doAction(doAction)\n          .undoAction(() => {\n            maybeCopiedItem.forEach(({ mesh: copiedMesh }) => {\n              someMainView.deleteNodeFromTreeUsingName(copiedMesh.name);\n              someMainView.highlightMeshesInScene();\n              someMainView.highlightNodesInTree();\n              someMainView.renderMenus();\n            });\n          })\n          .build()\n      );\n    });\n  }\n\n  copyMany(meshes, selectPlaceHolderMesh) {\n    Clipboard.copy((mousePosFromRoot, someMainView) => {\n      const nodeItems = meshes\n        .filter(mesh => !!mesh.nodeItem)\n        .map(mesh => mesh.nodeItem);\n      const uuids = nodeItems.map(() => Clipboard.getUID());\n      const itemCopyFunctions = nodeItems.map((item, i) =>\n        item.getCopyFunction(false, name => name + \"_copy\" + uuids[i])\n      );\n      const doAction = () => {\n        const maybeCopiedItems = itemCopyFunctions.map(\n          (itemCopyFunction, i) => {\n            const displacement = Util3d.toGlobalCoord(someMainView)(\n              nodeItems[i].mesh.absolutePosition\n            ).subtract(selectPlaceHolderMesh.position);\n            return itemCopyFunction(\n              displacement.add(mousePosFromRoot),\n              someMainView\n            );\n          }\n        );\n        const copiedItems = maybeCopiedItems\n          .filter(maybe => maybe.isSome())\n          .map(maybe => maybe.some());\n        const copiedMeshes = copiedItems.map(({ mesh }) => mesh);\n        const copiedNames = copiedItems.map(({ name }) => name);\n        someMainView.addGizmo2Name();\n        someMainView.highlightMeshesInScene(copiedMeshes);\n        someMainView.highlightNodesInTree(copiedNames);\n        MeshSelector.ofMainView(someMainView).clear().addArray(copiedMeshes);\n        SelectionPlaceHolder.ofMainView(someMainView)\n          .clear()\n          .push(copiedMeshes);\n        someMainView.renderMenus();\n        someMainView.forceUpdate();\n        return copiedItems;\n      };\n      const copiedItems = doAction();\n      someMainView.getUndoManager().addIt(\n        UndoManager.actionBuilder()\n          .doAction(doAction)\n          .undoAction(() => {\n            copiedItems.forEach(({ mesh }) => {\n              someMainView.deleteNodeFromTreeUsingName(mesh.name, true, false);\n            });\n            someMainView.highlightMeshesInScene();\n            someMainView.highlightNodesInTree();\n            MeshSelector.ofMainView(someMainView).clear();\n            SelectionPlaceHolder.ofMainView(someMainView).clear();\n            someMainView.renderMenus();\n            someMainView.forceUpdate();\n          })\n          .build()\n      );\n    });\n  }\n\n  getPasteAction(parentView) {\n    return () => {\n      parentView\n        .getMouseCoordsFromRoot()\n        .forEach(mousePosRoot =>\n          this.getPasteOnClick(mousePosRoot, parentView)()\n        );\n    };\n  }\n\n  /**\n   *\n   * @param {*} mesh: Mesh\n   * @param {*} is2updateServer: Boolean\n   * @param {*} displacement: Vec3 in world coordinates\n   */\n  notifyObservers(mesh, is2updateServer, displacement, parentView) {\n    // notify  babylonjs observers\n    Maybe.fromNull(mesh.observers).forEach(obs => {\n      obs.notifyObservers({\n        updatedPointMesh: mesh,\n        is2updateServer: is2updateServer,\n        displacement: displacement.toBabylon()\n      });\n    });\n    // notify graph observers\n    Maybe.fromNull(mesh.graphVertex).forEach(({ vertexObs }) => {\n      vertexObs({\n        updatedPointMesh: mesh,\n        is2updateServer: is2updateServer,\n        displacement: displacement.toBabylon()\n      });\n    });\n    if (parentView.getNodeFromTree(mesh.name).isSome()) {\n      this.notifyChildrenObserversRecursively(\n        mesh?._children || [],\n        is2updateServer,\n        displacement,\n        parentView\n      );\n    }\n  }\n\n  notifyChildrenObserversRecursively = (\n    nodeTree,\n    is2updateServer,\n    displacement,\n    parentView\n  ) => {\n    nodeTree.forEach(m => {\n      if (\n        (!!m.observers || !!m.graphVertex) &&\n        parentView.getNodeFromTree(m.name).isSome()\n      ) {\n        this.notifyObservers(m, is2updateServer, displacement, parentView);\n      }\n      if (m._children && m._children.length)\n        this.notifyChildrenObserversRecursively(\n          m._children,\n          is2updateServer,\n          displacement,\n          parentView\n        );\n    });\n  };\n\n  setProperties = (parentView, name) => parentView.setPropertiesWithName(name);\n\n  /**\n   *\n   * @param {*} selectedMeshes: Array<Mesh>\n   * @param {*} displacement: Vec3 in world coordinates\n   * @param {*} parentView: MainView\n   */\n  getUndoAbleAction(selectedMeshes, displacement, parentView) {\n    const meshesStruct = [...selectedMeshes].map(m => ({\n      mesh: m,\n      parent: m.parent,\n      keypointIndex: m.index || -1\n    }));\n    const sendMesh = (mesh, finalDisplacement, is2UpdateInServer = true) => {\n      const localDisplacement = Util3d.getLocalCoordFromWorld(\n        mesh,\n        finalDisplacement,\n        false\n      );\n      const newPos = Vec3.ofBabylon(mesh.position).add(localDisplacement);\n      mesh.position = newPos.toBabylon();\n      this.notifyObservers(\n        mesh,\n        is2UpdateInServer,\n        finalDisplacement,\n        parentView\n      );\n    };\n    const moveMesh = (dir = 1, is2UpdateInServer = true) => ({\n      mesh,\n      parent,\n      keypointIndex\n    }) => {\n      const finalDisplacement = displacement.scale(dir);\n      let maybeNodeItem = Maybe.None();\n      if (keypointIndex >= 0) {\n        maybeNodeItem = parentView.getNodeFromTree(parent.name);\n        maybeNodeItem.forEach(({ item }) => {\n          const nodeMesh = item.keyPoints[keypointIndex];\n          sendMesh(nodeMesh, finalDisplacement, is2UpdateInServer);\n          if (is2UpdateInServer) parentView.updateNodeInServer(item.name);\n        });\n        maybeNodeItem.orElseRun(() => {});\n      } else {\n        maybeNodeItem = parentView.getNodeFromTree(mesh.name);\n        maybeNodeItem.forEach(({ item }) => {\n          const nodeMesh = item.mesh;\n          sendMesh(nodeMesh, finalDisplacement, is2UpdateInServer);\n          if (is2UpdateInServer) parentView.updateNodeInServer(nodeMesh.name);\n        });\n      }\n      maybeNodeItem.orElseRun(() => {\n        sendMesh(mesh, finalDisplacement, is2UpdateInServer);\n        if (is2UpdateInServer) parentView.updateNodeInServer(mesh.name);\n      });\n    };\n    return UndoManager.actionBuilder()\n      .doAction(() => {\n        meshesStruct.forEach(moveMesh());\n      })\n      .undoAction(({ is2UpdateInServer = true }) => {\n        meshesStruct.forEach(moveMesh(-1, is2UpdateInServer));\n      })\n      .build();\n  }\n\n  createSelectionDiv(e) {\n    this.startDivPos = this.findMouseInDom(e);\n    const { x, y } = this.startDivPos;\n    const outerDiv = document.createElement(\"div\");\n    outerDiv.id = ID;\n    document.body.appendChild(outerDiv);\n    ReactDOM.render(\n      <SelectDiv left={x} top={y}></SelectDiv>,\n      document.getElementById(ID)\n    );\n  }\n\n  updateSelectionDiv(e) {\n    const newMouse = this.findMouseInDom(e);\n    const oldMouse = this.startDivPos;\n    const { x: minX, y: minY } = newMouse.op(oldMouse, Math.min);\n    const { x: maxX, y: maxY } = newMouse.op(oldMouse, Math.max);\n    const outerDiv = document.getElementById(ID);\n    if (!outerDiv) return;\n    ReactDOM.render(\n      <SelectDiv\n        left={minX}\n        top={minY}\n        width={maxX - minX}\n        height={maxY - minY}\n        style={{ zIndex: 999 }}\n      ></SelectDiv>,\n      outerDiv\n    );\n  }\n\n  destroySelectionDiv() {\n    const outerDiv = document.getElementById(ID);\n    if (!outerDiv) return;\n    outerDiv.parentNode.removeChild(outerDiv);\n  }\n\n  findMouseInDom(e) {\n    const x = e.clientX; //x position within the element.\n    const y = e.clientY; //y position within the element.\n    return new Vec2(x, y);\n  }\n\n  selectObjectsInside(scene, parentView) {\n    if (this.corners.length === 0) return;\n    this.corners.push(Vec2.of(scene.pointerX, scene.pointerY));\n    const [oldMouse, newMouse] = this.corners;\n    const min = newMouse.op(oldMouse, Math.min);\n    const max = newMouse.op(oldMouse, Math.max);\n    const cornersDiv = [min, Vec2.of(max.x, min.y), max, Vec2.of(min.x, max.y)];\n    const rayCastCorners = cornersDiv.map(p => this.pickPoints(p, parentView));\n    if (rayCastCorners.some(x => x === null || x === undefined)) return;\n    const treeObj = new TreeObject(parentView.getObjectTree());\n    const insideBox = treeObj.flatten(\n      this.isItemInsideBox(rayCastCorners, parentView)\n    );\n    let insideBoxDragAbleMeshes = insideBox.map(({ item }) => item.mesh);\n    const meshSelector = MeshSelector.ofMainView(parentView);\n    meshSelector.clear();\n    if (insideBoxDragAbleMeshes.length !== 0) {\n      meshSelector.addArray(insideBoxDragAbleMeshes, false);\n    }\n    this.selectMeshUpdateUI(parentView);\n  }\n\n  /**\n   *\n   * @param {*} p: Vec2 point in canvas\n   * @param {*} parentView: MainView\n   */\n  pickPoints(p, parentView) {\n    return parentView\n      .getSceneMemory()\n      .flatMap(memory => {\n        const { scene, ground } = memory;\n        const pickInfo = scene.pick(p.x, p.y, mesh => mesh === ground);\n        if (pickInfo.hit) {\n          const floorPoint = Util3d.toGlobalCoord(parentView)(\n            pickInfo.pickedPoint\n          );\n          return Maybe.some(Vec2.of(floorPoint.x, floorPoint.y));\n        }\n        return Maybe.none();\n      })\n      .orNull();\n  }\n\n  /**\n   *\n   * @param {*} polygon: Array<Vec2>\n   * @param {*} parentView\n   */\n  isItemInsideBox(polygon, parentView) {\n    return ({ item }) => {\n      const type = item.getType();\n      if (\n        type === GlobalRef.TYPE ||\n        type === Map.TYPE ||\n        type === GraphItem.TYPE ||\n        item?.mesh?.isSelectionPlaceHolder\n      )\n        return false;\n      const { mesh } = item;\n      return this.isMeshInsideBox(polygon, parentView)(mesh);\n    };\n  }\n\n  /**\n   *\n   * @param {*} polygon: Array<Vec2>\n   * @param {*} parentView\n   */\n  isMeshInsideBox(polygon, parentView) {\n    return mesh => {\n      const p = Util3d.toGlobalCoord(parentView)(mesh.absolutePosition);\n      const planeP = new Vec2(p.x, p.y);\n      return this.isPointInsideBox(polygon)(planeP);\n    };\n  }\n\n  /**\n   *\n   * @param {*} polygon: Array<Vec2>\n   * @param {*} epsilon: Number\n   */\n  isPointInsideBox(polygon, epsilon = 1e-3) {\n    return p => {\n      let theta = 0;\n      const n = polygon.length;\n      for (let i = 0; i < n; i++) {\n        const vi = polygon[i].sub(p);\n        const vii = polygon[(i + 1) % n].sub(p);\n        theta += Math.acos(vi.dot(vii) / (vi.length() * vii.length()));\n      }\n      return Math.abs(theta - 2 * Math.PI) < epsilon;\n    };\n  }\n\n  /**\n   *\n   * Merge paths if boundary keypoints are dragged together and have same orientation\n   *\n   * @param {*} selectedMesh\n   * @param {*} parentView\n   * @param {*} scene\n   * @param {*} ground\n   * @returns\n   */\n  mergePathsIfAny(selectedMesh, parentView, scene, ground) {\n    if (!Path.isKeyPointMesh(selectedMesh, parentView)) return;\n    const pickInfo = scene.pick(\n      scene.pointerX,\n      scene.pointerY,\n      mesh => mesh !== ground && mesh.isEnabled()\n    );\n    if (pickInfo.hit) {\n      const ray = pickInfo.ray;\n      var hits = scene.multiPickWithRay(ray);\n      if (hits) {\n        const keyPointHits = hits\n          .map(({ pickedMesh }) => pickedMesh)\n          .filter(hitMesh => Path.isKeyPointMesh(hitMesh, parentView));\n        // Are hits a keypoint of path\n        if (keyPointHits.length >= 2) {\n          const [first, second] = keyPointHits;\n          const left = first.index > second.index ? first : second;\n          const right = first.index <= second.index ? first : second;\n          // do they belong to the same path\n          if (left.parent.name !== right.parent.name) {\n            if (Path.areKeyPointsCompatible(left, right, parentView)) {\n              parentView\n                .getNodeFromTree(left.parent.name)\n                .forEach(({ item: firstPath }) => {\n                  parentView\n                    .getNodeFromTree(right.parent.name)\n                    .forEach(({ item: secondPath }) => {\n                      const oldPaths = [firstPath, secondPath].map(path => {\n                        return {\n                          parent: path.mesh.parent,\n                          dict: path.toDict(),\n                          children: [...path.mesh._children]\n                        };\n                      });\n                      const mergeName = firstPath.name + \"_\" + secondPath.name;\n                      parentView.getUndoManager().doIt(\n                        UndoManager.actionBuilder()\n                          .doAction(() => {\n                            Path.mergePaths(\n                              firstPath.name,\n                              secondPath.name,\n                              mergeName,\n                              parentView\n                            );\n                          })\n                          .undoAction(({ is2UpdateInServer = true }) => {\n                            Path.unMergePaths(\n                              oldPaths,\n                              mergeName,\n                              parentView,\n                              is2UpdateInServer\n                            );\n                          })\n                          .build()\n                      );\n                    });\n                });\n            }\n          }\n        }\n      }\n    }\n  }\n}\n\n//========================================================================================\n/*                                                                                      *\n *                                     SELECTION DIV                                    *\n *                                                                                      */\n//========================================================================================\n\nconst SelectDiv = ({ left, top, width, height, style }) => {\n  return (\n    <div\n      style={{\n        position: \"absolute\",\n        top: top,\n        left: left,\n        width: width,\n        height: height,\n        borderRadius: 10,\n        border: \"solid\",\n        borderColor: \"#c7c7c7\",\n        ...style\n      }}\n    ></div>\n  );\n};\nSelectDiv.defaultProps = {\n  left: 0,\n  top: 0,\n  width: 0,\n  height: 0\n};\nconst ID = \"SELECTION_TOOL_ID\";\n//========================================================================================\n/*                                                                                      *\n *                                        EXPORT                                        *\n *                                                                                      */\n//========================================================================================\n\nexport default DragObjectsAction;\n","import Util3d from \"../Util3d/Util3d\";\nimport KeyPoint from \"../NodeItem/KeyPoint\";\nimport Vec3 from \"../Math/Vec3\";\nimport { Maybe } from \"monet\";\nimport MouseKeysAction from \"./MouseKeysAction\";\nimport React from \"react\";\nimport { Color3, Axis, Vector3 } from \"@babylonjs/core\";\nimport { UndoManager } from \"mov-fe-lib-core\";\n\nclass AddKeyPointAction extends MouseKeysAction {\n  constructor() {\n    super();\n    this.key = \"addKeyPoint\";\n    this.name = \"Add Key Point [4]\";\n    this.maybeMousePos = Maybe.none();\n    this.tempMesh = null;\n    this.icon = props => <i className=\"fas fa-map-marker\" {...props}></i>;\n  }\n\n  createKeyPoint(\n    position,\n    name,\n    scene,\n    parentView,\n    is2addInServer = true,\n    color = Color3.Gray()\n  ) {\n    const rootMesh = parentView.getRootNode().item.mesh;\n\n    const keyPoint = KeyPoint.ofDict(scene, {\n      name: name,\n      color: [color.r, color.g, color.b]\n    });\n    const mesh = keyPoint.mesh;\n    mesh.parent = rootMesh;\n\n    const localPosition = Util3d.getLocalCoordFromWorld(\n      { parent: rootMesh },\n      Vec3.ofBabylon(position)\n    ).toBabylon();\n\n    mesh.setPositionWithLocalVector(\n      localPosition.add(Axis.Z.scale(KeyPoint.DEFAULT_SIZE))\n    );\n\n    if (is2addInServer) {\n      parentView.addNodeItem2Tree(keyPoint, rootMesh.name, is2addInServer);\n    }\n    return mesh;\n  }\n\n  action = parentView => {\n    super.action(parentView);\n    parentView.setSelectedAction(this);\n  };\n\n  onPointerDown = (evt, parentView) => {\n    if (evt.button !== 0) {\n      return;\n    }\n    parentView.getSceneMemory().forEach(memory => {\n      const { scene, ground, camera } = memory;\n      this.maybeMousePos = Util3d.getGroundPosition(scene, ground);\n      this.maybeMousePos.forEach(mousePos => {\n        camera.detachControl(memory.canvas);\n      });\n    });\n  };\n\n  onPointerMove = (evt, parentView) => {\n    parentView.getSceneMemory().forEach(memory => {\n      const scene = memory.scene;\n      const ground = memory.ground;\n      const maybeCurrent = Util3d.getGroundPosition(scene, ground);\n      maybeCurrent.forEach(current => {\n        this.maybeMousePos.forEach(oldMousePos => {\n          if (this.tempMesh) this.tempMesh.dispose();\n          this.tempMesh = this.createKeyPoint(\n            current,\n            TEMP_KEY_POINT_NAME,\n            scene,\n            parentView,\n            false\n          );\n        });\n      });\n    });\n  };\n\n  onPointerUp = (evt, parentView) => {\n    parentView.getSceneMemory().forEach(({ scene, camera, ground, canvas }) => {\n      const maybeCurrent = Util3d.getGroundPosition(scene, ground);\n      maybeCurrent.forEach(current => {\n        this.maybeMousePos.forEach(oldMousePos => {\n          if (this.tempMesh) this.tempMesh.dispose();\n          const name = `KeyPoint${Math.floor(Math.random() * 1e3)}`;\n          const keyPoint = this.createKeyPoint(\n            current,\n            name,\n            scene,\n            parentView,\n            true,\n            new Color3(Math.random(), Math.random(), Math.random())\n          );\n          parentView.setPropertiesWithName(name);\n          parentView\n            .getUndoManager()\n            .addIt(this.getUndoAbleAction(keyPoint, scene, parentView));\n        });\n      });\n      this.maybeMousePos = Maybe.none();\n      camera.attachControl(canvas, true);\n    });\n  };\n\n  getUndoAbleAction(mesh, scene, parentView) {\n    return UndoManager.actionBuilder()\n      .doAction(() => {\n        const keyPoint = this.createKeyPoint(\n          Vector3.Zero(),\n          mesh.name,\n          scene,\n          parentView,\n          true,\n          mesh.material.diffuseColor\n        );\n        keyPoint.position = mesh.position;\n        parentView.updateNodeInServer(mesh.name);\n      })\n      .undoAction(({ is2UpdateInServer = true }) => {\n        parentView.deleteNodeFromTreeUsingName(mesh.name, is2UpdateInServer);\n      })\n      .build();\n  }\n}\n\nconst TEMP_KEY_POINT_NAME = \"temp_key_point\";\nexport default AddKeyPointAction;\n","import NodeItem from \"./NodeItem\";\nimport Util3d from \"../Util3d/Util3d\";\nimport Vec3 from \"../Math/Vec3\";\nimport { Maybe } from \"monet\";\nimport Constants from \"../Utils/Constants\";\nimport {\n  Vector3,\n  Axis,\n  Color3,\n  Observable,\n  StandardMaterial,\n  Quaternion\n} from \"@babylonjs/core\";\nimport isEqual from \"lodash.isequal\";\n\nclass BoxRegion extends NodeItem {\n  constructor(mesh, corners, keyPoints, keyValueMap = {}) {\n    super(mesh, keyValueMap);\n    this.corners = corners; // in local coordinates, in relation to center of mass\n    this.keyPoints = keyPoints;\n  }\n\n  toDict() {\n    const dict = super.toDict();\n    dict.corners = this.corners;\n    return dict;\n  }\n\n  toForm() {\n    const schema = super.toForm();\n    schema.jsonSchema.properties[\"dimensions\"] = {\n      type: \"object\",\n      title: \"Dimensions\",\n      properties: {\n        lower: {\n          type: \"object\",\n          title: \"Lower Corner\",\n          properties: {\n            x: {\n              type: \"number\",\n              title: \"x\"\n            },\n            y: {\n              type: \"number\",\n              title: \"y\"\n            }\n          }\n        },\n        size: {\n          type: \"object\",\n          title: \"Size\",\n          properties: {\n            scaleX: {\n              type: \"number\",\n              title: \"scale-X\"\n            },\n            scaleY: {\n              type: \"number\",\n              title: \"scale-Y\"\n            }\n          }\n        }\n      }\n    };\n    schema.uiSchema[\"dimensions\"] = { \"ui:widget\": \"collapse\" };\n    // global ref coordinates\n    const worldCorners = this.keyPoints\n      .map(x => Util3d.getGlobalCoordinates(x, x.position))\n      .map(x => x.toArray());\n    schema.data[\"dimensions\"] = {\n      lower: {\n        x: worldCorners[0][0],\n        y: worldCorners[0][1]\n      },\n      size: {\n        // TODO: warning, doesn't take into account possible scaling\n        scaleX: this.corners[1][0] - this.corners[0][0],\n        scaleY: this.corners[1][1] - this.corners[0][1]\n      }\n    };\n    return schema;\n  }\n\n  ofForm(form) {\n    const oldForm = this.toForm();\n    const oldDimensions = oldForm.data.dimensions;\n    if (isEqual(oldDimensions, form.dimensions)) {\n      super.ofForm(form);\n    } else {\n      this.ofFormDimensions(form);\n    }\n  }\n\n  ofDict(scene, dict = null, mainView = null) {\n    return BoxRegion.ofDict(scene, dict, mainView);\n  }\n\n  getType = () => BoxRegion.TYPE;\n\n  static TYPE = \"BoxRegion\";\n\n  ofFormDimensions(form) {\n    const newLowerPositionInWorldCoordinates = Vector3.FromArray(\n      [form.dimensions.lower.x, form.dimensions.lower.y, 0].map(\n        Number.parseFloat\n      )\n    );\n    const newLocalDimensions = [\n      form.dimensions.size.scaleX,\n      form.dimensions.size.scaleY\n    ].map(Number.parseFloat);\n    let localLowerPosition = Util3d.getLocalCoordFromGlobal(\n      this.keyPoints[0],\n      newLowerPositionInWorldCoordinates\n    ).toArray();\n    const notify = (i, update = false) =>\n      this.keyPoints[i].observers.notifyObservers({\n        updatedPointMesh: this.keyPoints[i],\n        is2updateServer: update\n      });\n\n    this.keyPoints[0].position = new Vector3(\n      localLowerPosition[0],\n      localLowerPosition[1],\n      this.keyPoints[0].position.z\n    );\n    notify(0);\n    localLowerPosition = Util3d.getLocalCoordFromGlobal(\n      this.keyPoints[0],\n      newLowerPositionInWorldCoordinates\n    ).toArray();\n    this.keyPoints[1].position = new Vector3(\n      localLowerPosition[0] + newLocalDimensions[0],\n      localLowerPosition[1] + newLocalDimensions[1],\n      this.keyPoints[1].position.z\n    );\n    notify(1);\n  }\n\n  static ofDict(scene, dict = null, mainView = null) {\n    if (!dict) throw new Error(\"null dictionary describing Box region\");\n    const name = Maybe.fromNull(dict.name).orSome(\n      `BoxRegion${Math.floor(Math.random() * 1e3)}`\n    );\n    const mesh = createBoxRegionMesh(dict, name, scene);\n\n    const material = new StandardMaterial(`BoxRegionMaterial${name}`, scene);\n    const color = new Color3(dict.color[0], dict.color[1], dict.color[2]);\n    material.diffuseColor = color;\n    material.emissiveColor = color;\n    material.backFaceCulling = false;\n    mesh.material = material;\n\n    mesh.visibility = dict.color[3] || VISIBILITY;\n\n    Maybe.fromNull(dict.quaternion).forEach(quaternion => {\n      const babylonQuaternion = new Quaternion(\n        quaternion[1],\n        quaternion[2],\n        quaternion[3],\n        quaternion[0]\n      );\n      mesh.rotationQuaternion = babylonQuaternion.normalize();\n    });\n\n    const keyPoints = createPlaceHolderKeyPoints(\n      scene,\n      dict.corners.map(x => Vec3.of(x).toBabylon()),\n      mesh,\n      mainView\n    );\n    return new BoxRegion(mesh, dict.corners, keyPoints, dict.keyValueMap);\n  }\n}\n\nconst RADIUS = Constants.RADIUS;\nconst FACES = [\n  [0, 1, 2],\n  [2, 3, 0],\n  [4, 5, 6],\n  [6, 7, 4],\n  [0, 1, 5],\n  [5, 4, 0],\n  [3, 2, 6],\n  [6, 7, 3],\n  [1, 2, 6],\n  [6, 5, 1],\n  [0, 3, 7],\n  [7, 4, 0]\n];\n\n/**\n * @param boxRegion: {position: 3-array, corners: array of 3-arrays }\n */\nfunction createBoxRegionMesh(boxRegion, name, scene) {\n  // centered corners vec\n  const corners = boxRegion.corners.map(x => Vec3.of(x).toBabylon());\n  const d = corners[1].subtract(corners[0]);\n  const middlePoint = Vec3.of(boxRegion.position).toBabylon();\n  const shape = [\n    corners[0],\n    corners[0].add(Axis.X.scale(d.x)),\n    corners[0].add(new Vector3(d.x, d.y, 0)),\n    corners[0].add(Axis.Y.scale(d.y))\n  ];\n  const h = new Vector3(0, 0, d.z);\n  const boxRegionMesh = {\n    positions: [\n      shape[0],\n      shape[1],\n      shape[2],\n      shape[3],\n      shape[0].add(h),\n      shape[1].add(h),\n      shape[2].add(h),\n      shape[3].add(h)\n    ],\n    faces: FACES\n  };\n  const mesh = Util3d.meshFromPositionAndFaces(\n    name,\n    scene,\n    boxRegionMesh.positions,\n    boxRegionMesh.faces\n  );\n  mesh.position = middlePoint;\n  mesh.rotationQuaternion = Quaternion.Identity();\n  return mesh;\n}\n\nfunction createNewMeshFromOldUsingNewBox(newBox, scene, mesh, item) {\n  const average = Util3d.pointAverageVec3(newBox.corners.map(x => Vec3.of(x)));\n  newBox.position = average.toArray();\n  newBox.corners = newBox.corners.map(x => Vec3.of(x).sub(average).toArray());\n\n  // average in parent coord\n  const rotMat3 = Util3d.getRotationMatrix(mesh);\n  const scaleVec3 = Vec3.ofBabylon(mesh.scaling);\n  const averageInParentCoord = rotMat3\n    .prodVec(average.mul(scaleVec3))\n    .toBabylon();\n\n  const newMesh = createBoxRegionMesh(newBox, mesh.name, scene);\n  newMesh.parent = mesh.parent;\n  newMesh.rotationQuaternion = mesh.rotationQuaternion;\n  newMesh.position = averageInParentCoord.add(mesh.position);\n\n  newMesh.material = mesh.material;\n  newMesh.visibility = mesh.visibility;\n  newMesh.getMouseContextActions = mesh.getMouseContextActions;\n  newMesh.nodeItem = mesh.nodeItem;\n  newMesh.observers = mesh.observers;\n  if (!!mesh.graphVertex) {\n    newMesh.graphVertex = mesh.graphVertex;\n    newMesh.graphVertex.vertex.mesh = newMesh;\n  }\n  item.mesh = newMesh;\n  item.corners = newBox.corners;\n\n  const childrenCopy = [...mesh._children];\n  childrenCopy.forEach(c => {\n    c.parent = newMesh;\n  });\n  item.keyPoints.forEach((k, j) => {\n    const saveZ = k.position.z;\n    k.position = Vec3.of(newBox.corners[j]).toBabylon();\n    k.position.z = saveZ;\n  });\n  // dispose old mesh\n  mesh.dispose();\n}\n\nconst getKeyPointObserverFunction = (mainView, scene) => {\n  return ({ updatedPointMesh, is2updateServer }) => {\n    mainView\n      .getNodeFromTree(updatedPointMesh.parent.name)\n      .forEach(boxRegionTreeNode => {\n        const index = updatedPointMesh.index;\n        const item = boxRegionTreeNode.item;\n        const mesh = item.mesh;\n        const name = mesh.name;\n        let newBox = {\n          position: Vec3.ofBabylon(mesh.position).toArray(),\n          corners: item.corners\n        };\n        newBox.corners[index] = [\n          updatedPointMesh.position.x,\n          updatedPointMesh.position.y,\n          newBox.corners[index][2]\n        ];\n        createNewMeshFromOldUsingNewBox(newBox, scene, mesh, item);\n        mainView.addGizmo2Name();\n        if (is2updateServer) {\n          mainView.updateNodeInServer(name);\n          mainView.getNodeFromTree(name).forEach(node => {\n            mainView.setProperties(node.item.toForm());\n          });\n        }\n        // signal box region observers\n        Maybe.fromNull(item.mesh.observers).forEach(obs => {\n          obs.notifyObservers({\n            updatedPointMesh: item.mesh,\n            is2updateServer: is2updateServer,\n            displacement: Vector3.Zero()\n          });\n        });\n        Maybe.fromNull(item.mesh.graphVertex).forEach(({ vertexObs }) => {\n          vertexObs({\n            updatedPointMesh: item.mesh,\n            is2updateServer: is2updateServer,\n            displacement: Vector3.Zero()\n          });\n        });\n      });\n  };\n};\n\nconst createPlaceHolderKeyPoints = (\n  scene,\n  corners,\n  boxRegionMesh,\n  mainView\n) => {\n  const keyPoints = [];\n  const maxHeight = corners.reduce(\n    (max, x) => Math.max(max, x.z),\n    Number.MIN_VALUE\n  );\n  corners.forEach((corner, i) => {\n    const p = corner;\n\n    const keyPoint = Util3d.createSphere(\n      scene,\n      new Color3(0.25, 0.25, 0.25),\n      RADIUS,\n      `${boxRegionMesh.name}keyPoint${i}`,\n      true\n    );\n\n    keyPoint.parent = boxRegionMesh;\n    keyPoint.position = p;\n    keyPoint.position.z = maxHeight;\n    keyPoint.index = i;\n    keyPoint.observers = new Observable();\n    keyPoint.observers.add(getKeyPointObserverFunction(mainView, scene));\n    keyPoints.push(keyPoint);\n  });\n  return keyPoints;\n};\n\nconst VISIBILITY = 0.25;\nexport default BoxRegion;\n","import { Maybe } from \"monet\";\nimport MouseKeysAction from \"./MouseKeysAction\";\nimport BoxRegion from \"../NodeItem/BoxRegion\";\nimport Vec3 from \"../Math/Vec3\";\nimport Util3d from \"../Util3d/Util3d\";\nimport React from \"react\";\nimport { Color3 } from \"@babylonjs/core\";\nimport { UndoManager } from \"mov-fe-lib-core\";\n\nclass BoxRegionAction extends MouseKeysAction {\n  constructor() {\n    super();\n    this.key = \"drawBoxRegion\";\n    this.name = \"Draw Box Region [3]\";\n    this.maybeMousePos = Maybe.none();\n    this.tempMesh = null;\n    this.icon = props => <i className=\"fas fa-square\" {...props} />;\n  }\n\n  action = parentView => {\n    super.action(parentView);\n    parentView.setSelectedAction(this);\n  };\n\n  onPointerDown = (evt, parentView) => {\n    if (!(evt.buttons === 1)) return;\n    parentView.getSceneMemory().forEach(memory => {\n      const scene = memory.scene;\n      const ground = memory.ground;\n      const camera = memory.camera;\n      const maybeMousePos = Util3d.getGroundPosition(scene, ground);\n      this.maybeMousePos = maybeMousePos;\n      maybeMousePos.forEach(mousePos => {\n        camera.detachControl(memory.canvas);\n      });\n    });\n  };\n\n  onPointerMove = (evt, parentView) => {\n    parentView.getSceneMemory().forEach(memory => {\n      const scene = memory.scene;\n      const ground = memory.ground;\n      const maybeCurrent = Util3d.getGroundPosition(scene, ground);\n      maybeCurrent.forEach(current => {\n        this.maybeMousePos.forEach(oldMousePos => {\n          if (this.tempMesh) this.tempMesh.dispose();\n          this.tempMesh = this.createBoxRegion(\n            [oldMousePos, current],\n            TEMP_BOX_REGION_NAME,\n            scene,\n            parentView,\n            false\n          );\n        });\n      });\n    });\n  };\n\n  onPointerUp = (evt, parentView) => {\n    parentView.getSceneMemory().forEach(memory => {\n      const scene = memory.scene;\n      const camera = memory.camera;\n      const ground = memory.ground;\n      const maybeCurrent = Util3d.getGroundPosition(scene, ground);\n      maybeCurrent.forEach(current => {\n        this.maybeMousePos.forEach(oldMousePos => {\n          if (current.subtract(oldMousePos).length() < 1e-2) return;\n          this.tempMesh.dispose();\n          const name = `BoxRegion${Math.floor(Math.random() * 1e3)}`;\n          const boxMesh = this.createBoxRegion(\n            [oldMousePos, current],\n            name,\n            scene,\n            parentView,\n            true\n          );\n          parentView.setPropertiesWithName(name);\n          parentView\n            .getUndoManager()\n            .addIt(\n              this.getUndoAbleAction(\n                [oldMousePos, current],\n                boxMesh,\n                scene,\n                parentView\n              )\n            );\n        });\n      });\n      this.maybeMousePos = Maybe.none();\n      camera.attachControl(memory.canvas, true);\n    });\n  };\n\n  getUndoAbleAction(points, mesh, scene, parentView) {\n    return UndoManager.actionBuilder()\n      .doAction(() => {\n        this.createBoxRegion(points, mesh.name, scene, parentView, true);\n      })\n      .undoAction(({ is2UpdateInServer = true }) => {\n        parentView.deleteNodeFromTreeUsingName(mesh.name, is2UpdateInServer);\n      })\n      .build();\n  }\n\n  createBoxRegion = (\n    region,\n    name,\n    scene,\n    parentView,\n    is2addInServer = true,\n    color = Color3.Red(),\n    height = 1\n  ) => {\n    const rootMesh = parentView.getRootNode().item.mesh;\n\n    const localRegion = region.map(r =>\n      Util3d.getLocalCoordFromWorld({ parent: rootMesh }, Vec3.ofBabylon(r))\n    );\n\n    localRegion[1] = localRegion[1].add(Vec3.of([0, 0, height]));\n    const middlePoint = localRegion[0].add(localRegion[1]).scale(0.5);\n    const centeredRegion = localRegion.map(r => r.sub(middlePoint));\n\n    const boxRegionItem = BoxRegion.ofDict(\n      scene,\n      {\n        name: name,\n        position: middlePoint.toArray(),\n        color: [color.r, color.g, color.b],\n        corners: centeredRegion.map(x => x.toArray())\n      },\n      parentView\n    );\n    boxRegionItem.mesh.parent = rootMesh;\n    if (is2addInServer) {\n      parentView.addNodeItem2Tree(boxRegionItem, rootMesh.name, is2addInServer);\n    }\n    return boxRegionItem.mesh;\n  };\n}\n\nconst TEMP_BOX_REGION_NAME = \"temp_box_region\";\nexport default BoxRegionAction;\n","import Util3d from \"../Util3d/Util3d\";\nimport Vec3 from \"../Math/Vec3\";\nimport Path from \"../NodeItem/Path\";\nimport MouseKeysAction from \"./MouseKeysAction\";\nimport React from \"react\";\nimport { Color3 } from \"@babylonjs/core\";\nimport { UndoManager } from \"mov-fe-lib-core\";\nimport { selectOneAction } from \"../Utils/Utils\";\nimport Constants from \"../Utils/Constants\";\n\nclass DrawPathAction extends MouseKeysAction {\n  constructor() {\n    super();\n    this.key = \"drawPath\";\n    this.name = \"Draw Path [2]\";\n    this.icon = props => <i className=\"fas fa-bezier-curve\" {...props}></i>;\n    this.mouseCurve = [];\n    this.spherePlaceHolder = { dispose: () => {}, isDisposed: () => true };\n  }\n\n  action = parentView => {\n    super.action(parentView);\n    parentView.setSelectedAction(this);\n  };\n\n  onChange = parentView => {\n    if (this.mouseCurve.length > 1) {\n      parentView.getSceneMemory().forEach(({ scene }) => {\n        parentView\n          .getUndoManager()\n          .doIt(\n            this.getUndoAbleEnterAction(this.mouseCurve, scene, parentView)\n          );\n      });\n    }\n  };\n\n  onPointerDown = (evt, parentView) => {\n    if (!(evt.buttons === 1)) return;\n    if (!this.spherePlaceHolder.isDisposed()) {\n      this.createPointInCurve(parentView);\n      return;\n    }\n    parentView.getSceneMemory().forEach(memory => {\n      const { scene, ground, camera, canvas } = memory;\n      const maybeMousePos = Util3d.getGroundPosition(scene, ground);\n      maybeMousePos.forEach(mousePos => {\n        camera.detachControl(canvas);\n        this.mouseCurve.push(mousePos);\n        parentView\n          .getUndoManager()\n          .doIt(\n            this.getUndoAbleClickAction(\n              this.mouseCurve,\n              scene,\n              parentView,\n              memory\n            )\n          );\n      });\n    });\n  };\n\n  getUndoAbleClickAction = (\n    keyPoints,\n    scene,\n    parentView,\n    { camera, canvas }\n  ) => {\n    const kps = keyPoints.map(x => Vec3.ofBabylon(x));\n    return UndoManager.actionBuilder()\n      .doAction(() => {\n        const finalKps = kps.length === 1 ? [kps[0], kps[0]] : [...kps];\n        parentView.deleteNodeFromTreeUsingName(TEMP_PATH_NAME, false, false);\n        this.createCurve(finalKps, TEMP_PATH_NAME, scene, parentView, false);\n        if (kps.length <= 2) {\n          parentView.setContextActions(\n            this.getDrawPathContextAction(camera, canvas, scene)\n          );\n        }\n        this.mouseCurve = [...kps];\n      })\n      .undoAction(({ is2UpdateInServer = true }) => {\n        parentView.deleteNodeFromTreeUsingName(\n          TEMP_PATH_NAME,\n          is2UpdateInServer\n        );\n        const reducedKps = kps.slice(0, kps.length - 1);\n        const finalKps =\n          reducedKps.length === 1 ? [reducedKps[0], reducedKps[0]] : reducedKps;\n        if (is2UpdateInServer) {\n          reducedKps.length > 0 &&\n            this.createCurve(\n              finalKps,\n              TEMP_PATH_NAME,\n              scene,\n              parentView,\n              false\n            );\n          this.mouseCurve = reducedKps;\n        } else {\n          this.mouseCurve = [];\n        }\n      })\n      .build();\n  };\n\n  onPointerMove = (evt, parentView) => {\n    this.addKeyPointPlaceHolder(parentView);\n  };\n\n  onPointerUp = (evt, parentView) => {\n    // empty\n  };\n\n  onKeyUp = (evt, parentView) => {\n    parentView.getSceneMemory().forEach(memory => {\n      const { scene, camera, canvas } = memory;\n      const contextActions = this.getDrawPathContextAction(\n        camera,\n        canvas,\n        scene\n      );\n      const actions = [\n        {\n          predicate: e => e.code === \"Enter\" || e.code === \"NumpadEnter\",\n          action: () => contextActions[1].action(parentView)\n        },\n        {\n          predicate: e => e.code === \"Delete\" || e.code === \"Backspace\",\n          action: () => contextActions[0].action(parentView)\n        },\n        {\n          predicate: e => e.code === \"Escape\",\n          action: () => {\n            contextActions[0].action(parentView);\n          }\n        }\n      ];\n      selectOneAction(actions)(evt);\n    });\n  };\n\n  /**\n   *\n   * @param {*} curve: Array<Vector3>\n   * @param {*} name: String\n   * @param {*} scene: Scene\n   * @param {*} parentView: MainView\n   * @param {*} is2addInServer: Boolean\n   * @param {*} color: Color3\n   */\n  createCurve = (\n    curve,\n    name,\n    scene,\n    parentView,\n    is2addInServer = true,\n    color = Color3.Gray()\n  ) => {\n    const rootMesh = parentView.getRootNode().item.mesh;\n    const localCurve = Util3d.toGlobalCoord(parentView)(curve);\n    const middlePoint = Util3d.pointAverage(localCurve);\n    const centeredCurve = localCurve.map(w => w.subtract(middlePoint));\n\n    const pathItem = Path.ofDict(\n      scene,\n      {\n        name: name,\n        position: Vec3.ofBabylon(middlePoint).toArray(),\n        color: [color.r, color.g, color.b],\n        localPath: centeredCurve.map(z => Vec3.ofBabylon(z).toArray())\n      },\n      parentView\n    );\n    pathItem.mesh.parent = rootMesh;\n    parentView.addNodeItem2Tree(\n      pathItem,\n      rootMesh.name,\n      is2addInServer,\n      true,\n      is2addInServer\n    );\n    return pathItem;\n  };\n\n  getDrawPathContextAction = (camera, canvas, scene) => {\n    const ans = [];\n    ans.push({\n      icon: props => <i className=\"fas fa-trash\" {...props}></i>,\n      action: parentView => {\n        camera.attachControl(canvas, true);\n        parentView.deleteNodeFromTreeUsingName(TEMP_PATH_NAME, false);\n        this.mouseCurve = [];\n        parentView.closeContextDial();\n      },\n      name: \"Clear Path [ESC | DEL | Backspace]\"\n    });\n    if (this.mouseCurve.length > 1) {\n      ans.push({\n        icon: props => <i className=\"fas fa-check\" {...props}></i>,\n        action: parentView => {\n          camera.attachControl(canvas, true);\n          parentView\n            .getUndoManager()\n            .doIt(\n              this.getUndoAbleEnterAction(this.mouseCurve, scene, parentView)\n            );\n        },\n        name: \"Create Path [Enter]\"\n      });\n    }\n    return ans;\n  };\n\n  getUndoAbleEnterAction(keyPoints, scene, parentView) {\n    const kps = [...keyPoints];\n    const name = `Path${Math.floor(Math.random() * 1e3)}`;\n    return UndoManager.actionBuilder()\n      .doAction(() => {\n        parentView.deleteNodeFromTreeUsingName(TEMP_PATH_NAME, false);\n        const pathItem = this.createCurve(kps, name, scene, parentView, true);\n        this.mouseCurve = [];\n        parentView.setPropertiesWithName(name);\n        parentView.closeContextDial();\n        if (pathItem && pathItem.keyPoints) {\n          const keyPointMeshes = pathItem.keyPoints;\n          Path.addEdgesInKeyPoints(keyPointMeshes, scene, parentView);\n        }\n      })\n      .undoAction(({ is2UpdateInServer = true }) => {\n        this.deleteEdgeInKeyPoints(name, parentView, is2UpdateInServer);\n        parentView.deleteNodeFromTreeUsingName(name, is2UpdateInServer);\n        if (is2UpdateInServer) {\n          this.createCurve(kps, TEMP_PATH_NAME, scene, parentView, false);\n          this.mouseCurve = kps;\n        } else {\n          this.mouseCurve = [];\n          parentView.deleteNodeFromTreeUsingName(TEMP_PATH_NAME, false);\n        }\n      })\n      .build();\n  }\n\n  deleteEdgeInKeyPoints(pathName, parentView, is2UpdateInServer = true) {\n    parentView.getGraph().forEach(({ item: graph }) => {\n      parentView.getNodeFromTree(pathName).forEach(({ item: pathItem }) => {\n        const keyPointMeshes = pathItem.keyPoints;\n        const edgeMeshes = [\n          keyPointMeshes[0],\n          keyPointMeshes[keyPointMeshes.length - 1]\n        ];\n        graph.delEdge(...edgeMeshes);\n        if (is2UpdateInServer) parentView.updateNodeInServer(graph.name);\n      });\n    });\n  }\n\n  addKeyPointPlaceHolder(parentView) {\n    this.spherePlaceHolder.dispose();\n    parentView.getSceneMemory().forEach(({ scene, ground }) => {\n      Util3d.pickMesh(scene, ground).forEach(mesh => {\n        if (mesh.name === TEMP_PATH_NAME) return;\n        parentView.getNodeFromTree(mesh.name).forEach(({ item: nodeItem }) => {\n          if (nodeItem.getType() === Path.TYPE) {\n            Util3d.getGroundPosition(scene, ground).forEach(groundPos => {\n              const rootMesh = parentView.getRootNode().item.mesh;\n              this.spherePlaceHolder = Util3d.createSphere(\n                scene,\n                Color3.Gray(),\n                Constants.RADIUS,\n                \"sphereInsertPlaceHolder\",\n                false\n              );\n              this.spherePlaceHolder.parent = rootMesh;\n              this.spherePlaceHolder.position = Util3d.toGlobalCoord(\n                parentView\n              )(groundPos);\n              this.spherePlaceHolder.visibility = 0.5;\n            });\n          }\n        });\n      });\n    });\n  }\n\n  createPointInCurve(parentView) {\n    parentView.getSceneMemory().forEach(({ scene, ground }) => {\n      // dispose mesh before pick mesh\n      this.spherePlaceHolder.dispose();\n      // it can be shown that the picked mesh is the curve we want to edit\n      Util3d.pickMesh(scene, ground).forEach(({ name }) => {\n        parentView.getNodeFromTree(name).forEach(({ item: pathItem }) => {\n          Util3d.getGroundPosition(scene, ground).forEach(groundPos => {\n            const oldPoints = [...pathItem.localPath].map(p =>\n              Vec3.of(p).toBabylon()\n            );\n            const oldPosition = pathItem.mesh.position;\n            parentView.getUndoManager().doIt(\n              UndoManager.actionBuilder()\n                .doAction(() => {\n                  this.insertPointInCurve(\n                    scene,\n                    parentView,\n                    pathItem,\n                    groundPos\n                  );\n                  parentView.updateNodeInServer(pathItem.name);\n                })\n                .undoAction(({ is2UpdateInServer = true }) => {\n                  Path.createNewMeshFromOldUsingNewPoints(\n                    oldPoints,\n                    scene,\n                    pathItem,\n                    parentView,\n                    Path.onAddNewPointKeyPointUpdate\n                  );\n                  pathItem.mesh.position = oldPosition;\n                  if (is2UpdateInServer)\n                    parentView.updateNodeInServer(pathItem.name);\n                })\n                .build()\n            );\n          });\n        });\n      });\n    });\n  }\n\n  insertPointInCurve(scene, parentView, pathItem, groundPosInWorld) {\n    const localGround = Util3d.getLocalCoordFromWorld(\n      { parent: pathItem.mesh },\n      Vec3.ofBabylon(groundPosInWorld)\n    );\n    const localPath = pathItem.localPath.map(p => Vec3.of(p));\n    const sortedDistances = localPath\n      .map((p, i) => ({\n        distance: localGround.sub(p).length(),\n        index: i\n      }))\n      .sort((a, b) => a.distance - b.distance);\n    // all paths have 2 points at least\n    const minIndex = Math.min(\n      sortedDistances[0].index,\n      sortedDistances[1].index\n    );\n    const localPathB = localPath.map(p => p.toBabylon());\n    const newPoints = [\n      ...localPathB.slice(0, minIndex + 1),\n      localGround.toBabylon(),\n      ...localPathB.slice(minIndex + 1)\n    ];\n    Path.createNewMeshFromOldUsingNewPoints(\n      newPoints,\n      scene,\n      pathItem,\n      parentView,\n      Path.onAddNewPointKeyPointUpdate\n    );\n  }\n}\n\nconst TEMP_PATH_NAME = \"temp_curve\";\nexport default DrawPathAction;\n","import NodeItem from \"./NodeItem\";\nimport Vec3 from \"../Math/Vec3\";\nimport Util3d from \"../Util3d/Util3d\";\nimport { Maybe } from \"monet\";\nimport React from \"react\";\nimport { Utils } from \"mov-fe-lib-core\";\nimport Constants from \"../Utils/Constants\";\nimport {\n  Vector3,\n  Observable,\n  Color3,\n  StandardMaterial,\n  Quaternion\n} from \"@babylonjs/core\";\nimport { UndoManager } from \"mov-fe-lib-core\";\n\nconst RADIUS = Constants.RADIUS;\n\nconst { mod: positiveMod } = Utils;\n\nclass PolygonRegion extends NodeItem {\n  /**\n   * @param {*} mesh\n   * @param {*} localPolygon: is an array of 3-arrays of numbers of the local coordinates in relation to mesh.position and quaternion\n   * @param {*} keyPoints: are the keyPoints meshes array\n   */\n  constructor(\n    mesh,\n    localPolygon,\n    height,\n    keyPoints,\n    keyValueMap = {},\n    navigationAllowed = true\n  ) {\n    super(mesh, keyValueMap);\n    this.localPolygon = localPolygon;\n    this.height = height;\n    this.keyPoints = keyPoints;\n    this.navigationAllowed = navigationAllowed;\n  }\n\n  toDict() {\n    const dict = super.toDict();\n    dict.localPolygon = this.localPolygon;\n    dict.height = this.height;\n    dict.navigationAllowed = this.navigationAllowed;\n    return dict;\n  }\n\n  ofDict(scene, dict = null, mainView = null) {\n    return PolygonRegion.ofDict(scene, dict, mainView);\n  }\n\n  toForm() {\n    const schema = super.toForm();\n    const props = { ...schema.jsonSchema.properties };\n    const newJsonSchema = {\n      type: \"object\",\n      properties: {\n        oldName: props.oldName,\n        name: props.name,\n        type: props.type,\n        navigationAllowed: {\n          type: \"boolean\",\n          title: \"Navigation allowed\"\n        },\n        position: props.position,\n        rotation: props.rotation,\n        color: props.color,\n        annotations: props.annotations\n      }\n    };\n    schema.jsonSchema = newJsonSchema;\n    schema.data[\"navigationAllowed\"] = this.navigationAllowed;\n    return schema;\n  }\n\n  ofForm(form) {\n    super.ofForm(form);\n    this.navigationAllowed = Boolean(form.navigationAllowed);\n  }\n\n  getType = () => PolygonRegion.TYPE;\n\n  static TYPE = \"PolygonRegion\";\n\n  static ofDict(scene, dict = null, mainView = null) {\n    if (!dict || !mainView)\n      throw new Error(\"null dictionary describing polygon or null mainView\");\n\n    const polygon = dict.localPolygon.map(z => Vec3.of(z).toBabylon());\n    const middlePoint = Vec3.of(dict.position).toBabylon();\n\n    const mesh = createExtrudedPolygonMesh(\n      scene,\n      polygon,\n      dict.height,\n      dict.name\n    );\n    mesh.position = middlePoint;\n    mesh.rotationQuaternion = Quaternion.Identity();\n\n    const material = new StandardMaterial(`PolygonMaterial${dict.name}`, scene);\n    const color = new Color3(dict.color[0], dict.color[1], dict.color[2]);\n    material.diffuseColor = color;\n    material.emissiveColor = color;\n    mesh.material = material;\n    mesh.visibility = dict.color[3] || VISIBILITY;\n    Maybe.fromNull(dict.quaternion).forEach(quaternion => {\n      const babylonQuaternion = new Quaternion(\n        quaternion[1],\n        quaternion[2],\n        quaternion[3],\n        quaternion[0]\n      );\n      mesh.rotationQuaternion = babylonQuaternion.normalize();\n    });\n\n    const keypoints = createPlaceHolderKeyPoints(\n      scene,\n      polygon,\n      mesh,\n      mainView\n    );\n\n    return new PolygonRegion(\n      mesh,\n      polygon.map(point => [point.x, point.y, point.z]),\n      dict.height,\n      keypoints,\n      dict.keyValueMap,\n      dict.navigationAllowed\n    );\n  }\n\n  /**\n   * Create new mesh from old, has side effects\n   *\n   * @param {*} newPoints: Vector3\n   * @param {*} scene: Scene\n   * @param {*} item: PathItem\n   * @param {*} mainView: MainView\n   * @param {*} keyPointUpdateFunction: (scene, mainView, mesh, item) => Array<Mesh>\n   */\n  static createNewMeshFromOldUsingNewPoints(\n    newPoints,\n    scene,\n    item,\n    mainView,\n    keyPointUpdateFunction = defaultKeyPointUpdate\n  ) {\n    const { mesh: oldMesh } = item;\n    const average = Util3d.pointAverage(newPoints);\n    newPoints = newPoints.map(x => x.subtract(average));\n\n    // average in parent coord\n    const rotMat3 = Util3d.getRotationMatrix(oldMesh);\n    const scaleVec3 = Vec3.ofBabylon(oldMesh.scaling);\n    const averageInParentCoord = rotMat3\n      .prodVec(Vec3.ofBabylon(average).mul(scaleVec3))\n      .toBabylon();\n\n    // update mesh\n    const newMesh = createExtrudedPolygonMesh(\n      scene,\n      newPoints,\n      item.height,\n      oldMesh.name\n    );\n\n    newMesh.parent = oldMesh.parent;\n    newMesh.rotationQuaternion = oldMesh.rotationQuaternion;\n    newMesh.position = averageInParentCoord.add(oldMesh.position);\n\n    newMesh.material = oldMesh.material;\n    newMesh.visibility = oldMesh.visibility;\n    newMesh.onClick = oldMesh.onClick;\n    newMesh.getMouseContextActions = oldMesh.getMouseContextActions;\n    newMesh.nodeItem = oldMesh.nodeItem;\n    newMesh.observers = oldMesh.observers;\n    if (!!oldMesh.graphVertex) {\n      newMesh.graphVertex = oldMesh.graphVertex;\n      newMesh.graphVertex.vertex.mesh = newMesh;\n    }\n\n    item.localPolygon = newPoints.map(x => Vec3.ofBabylon(x).toArray());\n    item.mesh = newMesh;\n    item.keyPoints = keyPointUpdateFunction(scene, mainView, oldMesh, item);\n    // update children\n    const childrenCopy = [...oldMesh._children];\n    childrenCopy\n      .filter(c => mainView.getNodeFromTree(c.name).isJust())\n      .forEach(c => {\n        c.parent = item.mesh;\n      });\n    oldMesh.dispose();\n    return newPoints;\n  }\n\n  static deleteKeyPointWithUndo(scene, keyPointMesh, mainView) {\n    const index = keyPointMesh.index;\n    const name = keyPointMesh.parent.name;\n    mainView.getNodeFromTree(name).forEach(({ item }) => {\n      const { mesh } = item;\n      const copyPosition = { ...mesh.position };\n      let newPoints = item.localPolygon.map(x => Vec3.of(x).toBabylon());\n      if (newPoints.length === 3) return;\n      mainView\n        .getUndoManager()\n        .doIt(\n          PolygonRegion.getUndoDeleteKeyPoint(\n            name,\n            index,\n            copyPosition,\n            newPoints,\n            scene,\n            item,\n            mainView\n          )\n        );\n    });\n  }\n\n  static getUndoDeleteKeyPoint(\n    name,\n    index,\n    copyPosition,\n    newPoints,\n    scene,\n    item,\n    mainView\n  ) {\n    return UndoManager.actionBuilder()\n      .doAction(() => {\n        const copyPoints = [...newPoints];\n        copyPoints.splice(index, 1);\n        PolygonRegion.createNewMeshFromOldUsingNewPoints(\n          copyPoints,\n          scene,\n          item,\n          mainView,\n          PolygonRegion.onAddNewPointKeyPointUpdate\n        );\n        mainView.updateNodeInServer(name);\n      })\n      .undoAction(({ is2UpdateInServer = true }) => {\n        const copyPoints = [...newPoints];\n        item.mesh.position = copyPosition;\n        PolygonRegion.createNewMeshFromOldUsingNewPoints(\n          copyPoints,\n          scene,\n          item,\n          mainView,\n          PolygonRegion.onAddNewPointKeyPointUpdate\n        );\n        if (is2UpdateInServer) mainView.updateNodeInServer(name);\n      })\n      .build();\n  }\n\n  static onAddNewPointKeyPointUpdate(scene, mainView, oldMesh, item) {\n    // used when new keypoint is added\n    return createPlaceHolderKeyPoints(\n      scene,\n      item.localPolygon.map(x => Vec3.of(x).toBabylon()),\n      item.mesh,\n      mainView\n    );\n  }\n\n  /**\n   *\n   * @param {*} scene\n   * @param {*} keyPointMesh\n   * @param {*} curveMesh\n   * @param {*} mainView\n   * @param {*} orientation: it belongs to the set {-1,1}, represents orientation\n   */\n  static addKeyPointInBetween = (\n    scene,\n    keyPointMesh,\n    mainView,\n    orientation\n  ) => {\n    const index = keyPointMesh.index;\n    const name = keyPointMesh.parent.name;\n    mainView.getNodeFromTree(name).forEach(({ item }) => {\n      const copyPosition = { ...item.mesh.position };\n      const points = item.localPolygon.map(x => Vec3.of(x).toBabylon());\n      mainView\n        .getUndoManager()\n        .doIt(\n          PolygonRegion.getUndoAddKeyPointInBetween(\n            name,\n            index,\n            orientation,\n            item,\n            points,\n            copyPosition,\n            scene,\n            mainView\n          )\n        );\n    });\n  };\n\n  static getUndoAddKeyPointInBetween(\n    name,\n    index,\n    orientation,\n    item,\n    points,\n    copyPosition,\n    scene,\n    mainView\n  ) {\n    return UndoManager.actionBuilder()\n      .doAction(() => {\n        const numberOfPoints = points.length;\n        const nextIndex = positiveMod(index + orientation, numberOfPoints);\n        let newPoints = [];\n        const specialIndex = index + Math.max(0, orientation);\n        for (let i = 0; i < specialIndex; i++) {\n          newPoints.push(points[i]);\n        }\n        newPoints.push(points[nextIndex].add(points[index]).scale(0.5));\n        for (let i = specialIndex; i < numberOfPoints; i++) {\n          newPoints.push(points[i]);\n        }\n        PolygonRegion.createNewMeshFromOldUsingNewPoints(\n          newPoints,\n          scene,\n          item,\n          mainView,\n          PolygonRegion.onAddNewPointKeyPointUpdate\n        );\n        mainView.updateNodeInServer(name);\n      })\n      .undoAction(({ is2UpdateInServer = true }) => {\n        const copyPoints = [...points];\n        item.mesh.position = copyPosition;\n        PolygonRegion.createNewMeshFromOldUsingNewPoints(\n          copyPoints,\n          scene,\n          item,\n          mainView,\n          PolygonRegion.onAddNewPointKeyPointUpdate\n        );\n        if (is2UpdateInServer) mainView.updateNodeInServer(name);\n      })\n      .build();\n  }\n}\n\n/**\n *\n * @param {*} polygon: boundary as babylonjs vec3\n */\nconst stitchingBoundaries = polygon => {\n  const n = polygon.length;\n  const orientation = Util3d.computeOrientation(polygon);\n  const ans = [];\n  for (let i = 0; i < n; i++) {\n    const modi = (i + 1) % n;\n    ans.push([i, n + modi, modi]);\n    ans.push([i, n + i, n + modi]);\n  }\n  return orientation > 0 ? ans : ans.map(reverseOrientation);\n};\n\nconst reverseOrientation = triangleIndex => {\n  const ans = [];\n  ans.push(triangleIndex[1]);\n  ans.push(triangleIndex[0]);\n  ans.push(triangleIndex[2]);\n  return ans;\n};\n\n/**\n *\n * @param {*} scene\n * @param {*} polygon array of babylon js vector3\n * @param {*} height\n * @param {*} name\n */\nconst createExtrudedPolygonMesh = (scene, polygon, height, name) => {\n  const h = new Vector3(0, 0, height);\n  const polygonRegionMesh = {\n    positions: [],\n    faces: []\n  };\n  polygonRegionMesh.positions = [...polygon];\n  for (let i = 0; i < polygon.length; i++) {\n    polygonRegionMesh.positions.push(polygon[i].add(h));\n  }\n  const n = polygon.length;\n  const lowerTriangulation = Util3d.triangulatePolygon(polygon);\n  const upperTriangulation = Util3d.triangulatePolygon(\n    polygonRegionMesh.positions.slice(n)\n  )\n    .map(x => x.map(z => z + n))\n    .map(reverseOrientation);\n  const stitchTriangulation = stitchingBoundaries(polygon);\n  polygonRegionMesh.faces = lowerTriangulation\n    .concat(upperTriangulation)\n    .concat(stitchTriangulation);\n  const mesh = Util3d.meshFromPositionAndFaces(\n    name,\n    scene,\n    polygonRegionMesh.positions,\n    polygonRegionMesh.faces\n  );\n  return mesh;\n};\n\nfunction defaultKeyPointUpdate(scene, mainView, oldMesh, item) {\n  // used when keypoint is updated or deleted\n  const childrenCopy = [...oldMesh._children];\n  childrenCopy.forEach(c => {\n    c.parent = item.mesh;\n    console.log(\"Moving parents of child\", c.name);\n  });\n\n  return item.keyPoints.map((k, i) => {\n    k.observers = new Observable();\n    k.observers.add(getKeyPointObserverFunction(scene, mainView));\n    k.index = i;\n    k.name = `${oldMesh.name}keyPoint${i}`;\n    k.position = Vec3.of(item.localPolygon[i]).toBabylon();\n    return k;\n  });\n}\n\nconst getKeyPointObserverFunction = (scene, mainView) => {\n  return ({ updatedPointMesh, is2updateServer }) => {\n    if (!updatedPointMesh.parent) return;\n    mainView\n      .getNodeFromTree(updatedPointMesh.parent.name)\n      .forEach(polygonTreeNode => {\n        const index = updatedPointMesh.index;\n        const item = polygonTreeNode.item;\n        const mesh = item.mesh;\n        const name = mesh.name;\n        let newPoints = item.localPolygon.map(x => Vec3.of(x).toBabylon());\n        newPoints[index] = updatedPointMesh.position;\n        PolygonRegion.createNewMeshFromOldUsingNewPoints(\n          newPoints,\n          scene,\n          item,\n          mainView\n        );\n        if (is2updateServer) {\n          mainView.updateNodeInServer(name);\n        }\n        // signal observers\n        Maybe.fromNull(item.mesh.observers).forEach(obs => {\n          //side effect update absolute position\n          item.mesh.getAbsolutePosition();\n          obs.notifyObservers({\n            updatedPointMesh: item.mesh,\n            is2updateServer: is2updateServer,\n            displacement: Vector3.Zero()\n          });\n        });\n        Maybe.fromNull(item.mesh.graphVertex).forEach(({ vertexObs }) => {\n          item.mesh.getAbsolutePosition();\n          vertexObs({\n            updatedPointMesh: item.mesh,\n            is2updateServer: is2updateServer,\n            displacement: Vector3.Zero()\n          });\n        });\n      });\n  };\n};\n\nconst getKeyPointActions = (scene, keyPointMesh, mainView) => {\n  const actions = [];\n  mainView.getNodeFromTree(keyPointMesh.parent.name).forEach(pathTreeNode => {\n    const item = pathTreeNode.item;\n    const polygon = item.localPolygon;\n    if (polygon.length > 3) {\n      actions.push({\n        icon: props => <i className=\"fas fa-trash\" {...props}></i>,\n        action: parentView => {\n          PolygonRegion.deleteKeyPointWithUndo(scene, keyPointMesh, parentView);\n          parentView.closeContextDial();\n        },\n        name: \"Delete node [DEL]\"\n      });\n    }\n    actions.push({\n      icon: props => <i className=\"fas fa-less-than\" {...props}></i>,\n      action: parentView => {\n        PolygonRegion.addKeyPointInBetween(scene, keyPointMesh, parentView, -1);\n        parentView.closeContextDial();\n      },\n      name: \"Add previous\"\n    });\n    actions.push({\n      icon: props => <i className=\"fas fa-greater-than\" {...props}></i>,\n      action: parentView => {\n        PolygonRegion.addKeyPointInBetween(scene, keyPointMesh, parentView, 1);\n        parentView.closeContextDial();\n      },\n      name: \"Add next\"\n    });\n  });\n\n  return actions;\n};\n\nconst createPlaceHolderKeyPoints = (scene, polygon, polygonMesh, mainView) => {\n  const keyPoints = [];\n  polygon.forEach((p, i) => {\n    const color = new Color3(0.25, 0.25, 0.25);\n    const keyPoint = Util3d.createSphere(\n      scene,\n      color,\n      RADIUS,\n      `${polygonMesh.name}keyPointPolygon${i}`,\n      true\n    );\n    keyPoint.parent = polygonMesh;\n    keyPoint.position = p;\n    keyPoint.index = i;\n    keyPoint.observers = new Observable();\n    keyPoints.push(keyPoint);\n    keyPoint.observers.add(getKeyPointObserverFunction(scene, mainView));\n  });\n\n  keyPoints.forEach(kp => {\n    kp.onClick = () => {\n      mainView.setContextActions(getKeyPointActions(scene, kp, mainView));\n    };\n    kp.onDel = () => PolygonRegion.deleteKeyPointWithUndo(scene, kp, mainView);\n  });\n\n  return keyPoints;\n};\n\nconst VISIBILITY = 0.5;\nexport default PolygonRegion;\n","import MouseKeysAction from \"./MouseKeysAction\";\nimport Vec3 from \"../Math/Vec3\";\nimport Util3d from \"../Util3d/Util3d\";\nimport React from \"react\";\nimport PolygonRegion from \"../NodeItem/PolygonRegion\";\nimport { Color3 } from \"@babylonjs/core\";\nimport { UndoManager } from \"mov-fe-lib-core\";\nimport { selectOneAction } from \"../Utils/Utils\";\n\n// Similar 2 Draw Action Path\nclass PolygonRegionAction extends MouseKeysAction {\n  constructor() {\n    super();\n    this.key = \"drawPolygonRegion\";\n    this.name = \"Draw Polygon Region [5]\";\n    this.mouseCurve = [];\n    this.icon = props => <i className=\"fas fa-draw-polygon\" {...props}></i>;\n  }\n\n  action = parentView => {\n    super.action(parentView);\n    parentView.setSelectedAction(this);\n  };\n\n  onChange = parentView => {\n    if (this.mouseCurve.length > 2) {\n      parentView.getSceneMemory().forEach(({ scene }) => {\n        parentView\n          .getUndoManager()\n          .doIt(\n            this.getUndoAbleEnterAction(this.mouseCurve, scene, parentView)\n          );\n      });\n    }\n  };\n\n  onPointerDown = (evt, parentView) => {\n    if (!(evt.buttons === 1)) return;\n    parentView.getSceneMemory().forEach(memory => {\n      const scene = memory.scene;\n      const ground = memory.ground;\n      const camera = memory.camera;\n      const maybeMousePos = Util3d.getGroundPosition(scene, ground);\n      maybeMousePos.forEach(mousePos => {\n        camera.detachControl(memory.canvas);\n        this.mouseCurve.push(mousePos);\n        parentView\n          .getUndoManager()\n          .doIt(\n            this.getUndoAbleClickAction(\n              this.mouseCurve,\n              scene,\n              parentView,\n              memory\n            )\n          );\n      });\n    });\n  };\n\n  getUndoAbleClickAction(keyPoints, scene, parentView, { camera, canvas }) {\n    const kps = [...keyPoints];\n    return UndoManager.actionBuilder()\n      .doAction(() => {\n        const finalKps = kps.length === 1 ? [kps[0], kps[0]] : kps;\n        parentView.deleteNodeFromTreeUsingName(\n          TEMP_POLYGON_REGION_NAME,\n          false,\n          false\n        );\n        this.createPolygonRegion(\n          finalKps,\n          TEMP_POLYGON_REGION_NAME,\n          scene,\n          parentView,\n          false\n        );\n        parentView.setContextActions(\n          this.getDrawPolygonContextAction(camera, canvas, scene)\n        );\n        this.mouseCurve = kps;\n      })\n      .undoAction(({ is2UpdateInServer = true }) => {\n        parentView.deleteNodeFromTreeUsingName(\n          TEMP_POLYGON_REGION_NAME,\n          is2UpdateInServer\n        );\n        const reducedKps = kps.slice(0, kps.length - 1);\n        const finalKps =\n          reducedKps.length === 1 ? [reducedKps[0], reducedKps[0]] : reducedKps;\n        if (is2UpdateInServer)\n          reducedKps.length > 0 &&\n            this.createPolygonRegion(\n              finalKps,\n              TEMP_POLYGON_REGION_NAME,\n              scene,\n              parentView,\n              false\n            );\n        this.mouseCurve = reducedKps;\n      })\n      .build();\n  }\n\n  getDrawPolygonContextAction = (camera, canvas, scene) => {\n    const ans = [];\n    ans.push({\n      icon: props => <i className=\"fas fa-trash\" {...props}></i>,\n      action: parentView => {\n        camera.attachControl(canvas, true);\n        parentView.deleteNodeFromTreeUsingName(TEMP_POLYGON_REGION_NAME, false);\n        this.mouseCurve = [];\n        parentView.closeContextDial();\n      },\n      name: \"Clear Polygon [ESC | DEL | Backspace]\"\n    });\n    if (this.mouseCurve.length > 2) {\n      ans.push({\n        icon: props => <i className=\"fas fa-check\" {...props}></i>,\n        action: parentView => {\n          camera.attachControl(canvas, true);\n          parentView\n            .getUndoManager()\n            .doIt(\n              this.getUndoAbleEnterAction(this.mouseCurve, scene, parentView)\n            );\n        },\n        name: \"Create Polygon [Enter]\"\n      });\n    }\n    return ans;\n  };\n\n  getUndoAbleEnterAction(keyPoints, scene, parentView) {\n    const kps = [...keyPoints];\n    const name = `PolygonRegion${Math.floor(Math.random() * 1e3)}`;\n    return UndoManager.actionBuilder()\n      .doAction(() => {\n        parentView.deleteNodeFromTreeUsingName(TEMP_POLYGON_REGION_NAME, false);\n        this.createPolygonRegion(kps, name, scene, parentView, true);\n        this.mouseCurve = [];\n        parentView.setPropertiesWithName(name);\n        parentView.closeContextDial();\n      })\n      .undoAction(({ is2UpdateInServer = true }) => {\n        parentView.deleteNodeFromTreeUsingName(name, is2UpdateInServer);\n        if (is2UpdateInServer) {\n          this.createPolygonRegion(\n            kps,\n            TEMP_POLYGON_REGION_NAME,\n            scene,\n            parentView,\n            false\n          );\n          this.mouseCurve = kps;\n        }\n      })\n      .build();\n  }\n\n  onPointerMove = (evt, parentView) => {\n    // empty\n  };\n\n  onPointerUp = (evt, parentView) => {\n    // empty\n  };\n\n  onKeyUp = (evt, parentView) => {\n    // Warning: code duplication with PathAction\n    const defaultAction = () => super.onKeyUp(evt, parentView);\n    parentView.getSceneMemory().forEach(memory => {\n      const { scene, camera, canvas } = memory;\n      const contextActions = this.getDrawPolygonContextAction(\n        camera,\n        canvas,\n        scene\n      );\n      selectOneAction(\n        [\n          {\n            predicate: e => e.code === \"Enter\" || e.code === \"NumpadEnter\",\n            action: () => contextActions[1].action(parentView)\n          },\n          {\n            predicate: e => e.code === \"Delete\" || e.code === \"Backspace\",\n            action: () => contextActions[0].action(parentView)\n          },\n          {\n            predicate: e => e.code === \"Escape\",\n            action: () => {\n              contextActions[0].action(parentView);\n            }\n          }\n        ],\n        defaultAction\n      )(evt);\n    });\n  };\n\n  createPolygonRegion = (\n    region,\n    name,\n    scene,\n    parentView,\n    is2addInServer = true,\n    color = Color3.Yellow(),\n    height = 1\n  ) => {\n    const rootMesh = parentView.getRootNode().item.mesh;\n\n    const localRegion = region.map(r =>\n      Util3d.getLocalCoordFromWorld({ parent: rootMesh }, Vec3.ofBabylon(r))\n    );\n\n    const middlePoint = Util3d.pointAverageVec3(localRegion);\n    const centeredRegion = localRegion.map(r => r.sub(middlePoint));\n\n    const polygonRegionItem = PolygonRegion.ofDict(\n      scene,\n      {\n        name: name,\n        position: middlePoint.toArray(),\n        color: [color.r, color.g, color.b],\n        localPolygon: centeredRegion.map(x => x.toArray()),\n        height: height\n      },\n      parentView\n    );\n\n    polygonRegionItem.mesh.parent = rootMesh;\n\n    parentView.addNodeItem2Tree(\n      polygonRegionItem,\n      rootMesh.name,\n      is2addInServer,\n      true,\n      is2addInServer\n    );\n  };\n}\n\nconst TEMP_POLYGON_REGION_NAME = \"temp_polygon_region\";\nexport default PolygonRegionAction;\n","import { Maybe } from \"monet\";\nimport MouseKeysAction from \"./MouseKeysAction\";\nimport React from \"react\";\n\nclass OrbitAction extends MouseKeysAction {\n  constructor() {\n    super();\n    this.key = \"orbit\";\n    this.name = \"Orbit [ESC]\";\n    this.maybeSelectedMesh = Maybe.none();\n    this.icon = props => <i className=\"fas fa-globe\" {...props}></i>;\n  }\n\n  action = parentView => {\n    super.action(parentView);\n    parentView.setSelectedAction(this);\n  };\n\n  onPointerDown = (evt, parentView) => {};\n\n  onPointerMove = (evt, parentView) => {};\n\n  onPointerUp = (evt, parentView) => {};\n}\n\nexport default OrbitAction;\n","import MouseKeysAction from \"./MouseKeysAction\";\nimport React from \"react\";\nimport Util3d from \"../Util3d/Util3d\";\nimport { Color3 } from \"@babylonjs/core\";\nimport GraphItem from \"../NodeItem/GraphItem\";\nimport Constants from \"../Utils/Constants\";\nimport { UndoManager } from \"mov-fe-lib-core\";\nimport { selectOneAction } from \"../Utils/Utils\";\nimport Path from \"../NodeItem/Path\";\nimport { Maybe } from \"monet\";\nimport GlobalRef from \"../NodeItem/GlobalRef\";\n\nclass DrawGraphAction extends MouseKeysAction {\n  constructor() {\n    super();\n    this.key = \"drawGraph\";\n    this.name = \"Draw Graph [6]\";\n    this.icon = props => <i className=\"fas fa-project-diagram\" {...props}></i>;\n\n    this.previewMeshes = [];\n    this.firstMousePos = undefined;\n    this.firstClickedMesh = undefined;\n  }\n\n  //========================================================================================\n  /*                                                                                      *\n   *                            Mouse Key Action Implementation                           *\n   *                                                                                      */\n  //========================================================================================\n\n  action = parentView => {\n    super.action(parentView);\n    parentView.setSelectedAction(this);\n    // Make LogicGraph visible when action is selected\n    parentView.getGraph().forEach(node => {\n      if (!node.isVisible) {\n        node.item.mesh.setEnabled(true);\n      }\n    });\n  };\n\n  onPointerDown = (evt, parentView) => {\n    if (!(evt.buttons === 1)) return;\n    this.mousePosConsumer(parentView)((mousePos, memory) => {\n      const { scene, ground } = memory;\n      const maybeMesh = Util3d.pickMesh(scene, ground).filter(\n        this.isConnectableMesh(parentView)\n      );\n      maybeMesh.forEach(possibleMesh => {\n        parentView.highlightMeshesInScene([possibleMesh], Color3.Green());\n        this.onPointerDownLine(mousePos, possibleMesh, memory, parentView);\n      });\n      maybeMesh.orElseRun(() => {\n        // no mesh found\n        parentView.highlightMeshesInScene();\n        this.resetPreview();\n      });\n    });\n  };\n\n  onPointerMove = (evt, parentView) => {\n    this.mousePosConsumer(parentView)((mousePos, memory) => {\n      const { scene, ground } = memory;\n      Util3d.pickMesh(scene, ground)\n        .filter(this.isConnectableMesh(parentView))\n        .cata(\n          () => parentView.highlightMeshesInScene(),\n          pickedMesh =>\n            parentView.highlightMeshesInScene([pickedMesh], Color3.Green())\n        );\n      if (!this.firstMousePos) return;\n      this.onPointerMoveLine(mousePos, memory, parentView);\n    });\n  };\n\n  onPointerUp = (evt, parentView) => {};\n\n  onKeyUp = (evt, parentView) => {\n    const escapeAction = () => this.resetPreview();\n    const predicateActionList = [\n      {\n        predicate: e => [\"Backspace\", \"Delete\", \"Escape\"].includes(e.code),\n        action: escapeAction\n      }\n    ];\n    selectOneAction(predicateActionList)(evt);\n  };\n\n  onChange() {\n    this.resetPreview();\n  }\n\n  //========================================================================================\n  /*                                                                                      *\n   *                                  Auxiliary functions                                  *\n   *                                                                                      */\n  //========================================================================================\n\n  resetPreview = () => {\n    if (!!this.firstMousePos) {\n      this.deletePreviewMeshes();\n      this.firstMousePos = undefined;\n      this.firstClickedMesh = undefined;\n    }\n  };\n\n  deletePreviewMeshes = () => {\n    this.previewMeshes.forEach(mesh => mesh.dispose());\n    this.previewMeshes = [];\n  };\n\n  mousePosConsumer = parentView => lambda => {\n    parentView.getSceneMemory().forEach(memory => {\n      const { scene, ground } = memory;\n      const maybeCurrent = Util3d.getGroundPosition(scene, ground);\n      maybeCurrent.forEach(mousePos => lambda(mousePos, memory));\n    });\n  };\n\n  /**\n   * returns a predicate(mesh => boolean) that tells if a mesh is connectable by an edge\n   * @param {*} parentView\n   */\n  isConnectableMesh = parentView => mesh => {\n    return parentView\n      .getNodeFromTree(mesh.name)\n      .cata(\n        () => {\n          // mesh is not a nodeItem, check if mesh parent is a path and is beginning or end of path\n          const parentName = mesh?.parent?.name || \"\";\n          return parentView\n            .getNodeFromTree(parentName)\n            .filter(({ item }) => item.getType() === Path.TYPE)\n            .filter(({ item }) => {\n              const index = mesh.index;\n              return index === 0 || index === item.keyPoints.length - 1;\n            });\n        },\n        ({ item }) => {\n          // mesh is a nodeItem, check if not path\n          return Maybe.some(mesh).filter(\n            _ =>\n              item.getType() !== Path.TYPE && item.getType() !== GlobalRef.TYPE\n          );\n        }\n      )\n      .orSome(false);\n  };\n\n  belongsToPath = parentView => mesh => {\n    const parentName = mesh?.parent?.name || \"\";\n    return parentView\n      .getNodeFromTree(parentName)\n      .filter(({ item }) => item.getType() === Path.TYPE)\n      .map(({ item }) => item.name);\n  };\n\n  belongs2SamePath = parentView => (meshI, meshJ) => {\n    const belongsToPath = this.belongsToPath(parentView);\n    return belongsToPath(meshI)\n      .flatMap(nameI => belongsToPath(meshJ).map(nameJ => nameI === nameJ))\n      .orSome(false);\n  };\n\n  //========================================================================================\n  /*                                                                                      *\n   *                                       Line Edge                                      *\n   *                                                                                      */\n  //========================================================================================\n\n  onPointerDownLine = (mousePos, clickedMesh, memory, parentView) => {\n    const { scene } = memory;\n    if (!this.firstMousePos) {\n      this.firstMousePos = mousePos;\n      this.firstClickedMesh = clickedMesh;\n    } else {\n      //firstMousePos exists\n      if (\n        this.belongs2SamePath(parentView)(clickedMesh, this.firstClickedMesh) ||\n        GraphItem.isInvalidEdge(this.firstClickedMesh, clickedMesh)\n      ) {\n        this.resetPreview();\n      } else {\n        parentView\n          .getUndoManager()\n          .doIt(\n            this.getUndoAbleLineEdge(\n              [this.firstClickedMesh, clickedMesh],\n              scene,\n              parentView,\n              clickedMesh\n            )\n          );\n      }\n    }\n  };\n\n  getUndoAbleLineEdge = (edgeMeshes, scene, parentView) => {\n    return UndoManager.actionBuilder()\n      .doAction(() => {\n        this.createEdge(edgeMeshes, scene, parentView);\n        this.resetPreview();\n      })\n      .undoAction(({ is2UpdateInServer = true }) => {\n        this.deleteEdge(edgeMeshes, parentView, is2UpdateInServer);\n      })\n      .build();\n  };\n\n  onPointerMoveLine = (mousePos, memory, parentView) => {\n    // preview line\n    const visibility = 0.25;\n    const { scene } = memory;\n    const rootMesh = parentView.getRootNode().item.mesh;\n    const edgeEmbedding = toGlobalCoord(parentView)([\n      this.firstMousePos,\n      mousePos\n    ]);\n    this.deletePreviewMeshes();\n    this.previewMeshes = [\n      GraphItem.getEdgeMesh(\n        scene,\n        edgeEmbedding,\n        \"previewEdge\",\n        Color3.Blue(),\n        Constants.RADIUS / 4\n      )\n    ];\n    this.previewMeshes.forEach(mesh => {\n      mesh.visibility = visibility;\n      mesh.parent = rootMesh;\n      mesh.isPickable = false;\n    });\n  };\n\n  //========================================================================================\n  /*                                                                                      *\n   *                                    Draw functions                                    *\n   *                                                                                      */\n  //========================================================================================\n\n  createEdge = (edgeMeshes, scene, parentView) => {\n    GraphItem.createGraphItemIfNone(scene, parentView);\n    parentView.getGraph().forEach(graphNode => {\n      const { item: graphItem } = graphNode;\n      graphItem.addEdge(...edgeMeshes);\n      parentView.updateNodeInServer(graphItem.name);\n    });\n  };\n\n  deleteEdge = (edgeMeshes, parentView, is2UpdateInServer) => {\n    parentView.getGraph().forEach(graphNode => {\n      const { item: graphItem } = graphNode;\n      graphItem.delEdge(...edgeMeshes);\n      if (is2UpdateInServer) parentView.updateNodeInServer(graphItem.name);\n    });\n  };\n}\n\nconst toGlobalCoord = Util3d.toGlobalCoord;\nexport default DrawGraphAction;\n","import Util3d from \"../Util3d/Util3d\";\nimport MouseKeysAction from \"./MouseKeysAction\";\nimport React from \"react\";\nimport { MeshBuilder } from \"@babylonjs/core\";\nimport { AdvancedDynamicTexture, TextBlock } from \"@babylonjs/gui/2D\";\nimport Vec2 from \"../Math/Vec2\";\n\nclass MeasureAction extends MouseKeysAction {\n  constructor() {\n    super();\n    this.key = \"drawWall\";\n    this.name = \"Measure [7]\";\n    this.icon = props => <i className=\"fas fa-ruler\" {...props}></i>;\n    this.ruler = []; // can only have two elements, start point and end point\n    this.rulerMesh = null;\n    this.advancedTexture = null;\n    this.text = null;\n  }\n\n  action = parentView => {\n    super.action(parentView);\n    parentView.setSelectedAction(this);\n  };\n\n  onChange = parentView => {\n    this.resetMeasure(parentView);\n  };\n\n  onPointerDown = (evt, parentView) => {\n    if (evt.button !== 0) {\n      return;\n    }\n    parentView.getSceneMemory().forEach(({ scene, ground, camera, canvas }) => {\n      Util3d.getGroundPosition(scene, ground).forEach(current => {\n        const currentMousePos = Util3d.toGlobalCoord(parentView)(current);\n        this.ruler.push(currentMousePos);\n        if (this.ruler.length > 2) {\n          this.resetMeasure(parentView);\n        } else if (this.ruler.length === 2) {\n          // remove temp mesh\n          this.rulerMesh && this.rulerMesh.dispose();\n          this.rulerMesh = this.createRulerMesh(this.ruler, scene, parentView);\n          this.addTextGUI(\n            scene,\n            this.calculateDistance(this.ruler[0], currentMousePos),\n            evt\n          );\n          camera.attachControl(canvas, true);\n        } else {\n          camera.detachControl(canvas);\n        }\n      });\n    });\n  };\n\n  onPointerMove = (evt, parentView) => {\n    parentView.getSceneMemory().forEach(({ scene, ground }) => {\n      Util3d.getGroundPosition(scene, ground).forEach(current => {\n        const currentMousePos = Util3d.toGlobalCoord(parentView)(current);\n        // If the user pressed the mouse wheel or is rotating the view, it will delete the ruler\n        if (\n          this.ruler.length >= 2 &&\n          (evt.buttons === 4 || evt.pressure === 0.5)\n        ) {\n          this.resetMeasure(parentView);\n        }\n        // Fixed one point so display the ruler real time\n        if (this.ruler.length === 1) {\n          // Remove previous element from Mesh to not overlap\n          this.rulerMesh && this.rulerMesh.dispose();\n          this.rulerMesh = this.createRulerMesh(\n            [this.ruler[0], currentMousePos],\n            scene,\n            parentView\n          );\n          this.addTextGUI(\n            scene,\n            this.calculateDistance(this.ruler[0], currentMousePos),\n            evt\n          );\n        }\n      });\n    });\n  };\n\n  onPointerUp = (evt, parentView) => {};\n\n  onWheel = (evt, parentView) => {\n    if (Math.abs(evt.deltaY) > 0) {\n      this.resetMeasure(parentView);\n    }\n  };\n\n  // Calculate 2D distance from starting of ruler to the end of ruler\n  calculateDistance = (start, end) => {\n    const startVec = Vec2.ofBabylon(start);\n    const endVec = Vec2.ofBabylon(end);\n    return startVec.sub(endVec).length().toFixed(3);\n  };\n\n  addTextGUI = function (scene, value, evt) {\n    // TODO: maybe should use mouse coordinates  advanced texture from mainView\n    if (!this.advancedTexture) {\n      this.advancedTexture = AdvancedDynamicTexture.CreateFullscreenUI(\n        \"UI Ruler\",\n        true,\n        scene\n      );\n    }\n    this.text && this.advancedTexture.removeControl(this.text);\n    this.text = new TextBlock();\n    this.text.text = `${value}m`;\n    this.text.fontSize = 17;\n    this.text.left = scene.pointerX - evt.target.width / 2 + 20;\n    this.text.top = scene.pointerY - evt.target.height / 2 + 20;\n    this.text.color = \"white\";\n    this.advancedTexture.addControl(this.text);\n  };\n\n  resetMeasure(parentView) {\n    this.rulerMesh && this.rulerMesh.dispose();\n    this.text && this.text.dispose();\n    this.ruler = [];\n    parentView &&\n      parentView.getSceneMemory().forEach(({ camera, canvas }) => {\n        camera.attachControl(canvas, true);\n      });\n  }\n\n  createRulerMesh(points, scene, parentView) {\n    const rulerMesh = MeshBuilder.CreateLines(\n      \"ruler\",\n      {\n        points: points,\n        updatable: true\n      },\n      scene\n    );\n    const rootMesh = parentView.getRootNode().item.mesh;\n    rulerMesh.parent = rootMesh;\n    return rulerMesh;\n  }\n}\n\nexport default MeasureAction;\n","import MouseKeysAction from \"./MouseKeysAction\";\nimport React from \"react\";\nimport Util3d from \"../Util3d/Util3d\";\nimport { Maybe } from \"monet\";\nimport Constants from \"../Utils/Constants\";\nimport Vec3 from \"../Math/Vec3\";\n// import JsonToReact from \"../../_shared/JsonToReact/JsonToReact\";\nimport NavigationPreviewItem from \"../NodeItem/NavigationPreviewItem\";\nimport { UndoManager } from \"mov-fe-lib-core\";\n\nclass NavigationPreviewAction extends MouseKeysAction {\n  /**\n   *\n   * @param {*} uIInOut: (title, reactFactory) => {}\n   */\n  constructor(uIInOut) {\n    super();\n    this.key = \"navigationPreviewAction\";\n    this.name = \"Add navigation preview [8]\";\n    this.icon = props => <i className=\"fas fa-road\" {...props}></i>;\n    this.uIInOut = uIInOut;\n    this.maybeFirstClickPos = Maybe.none();\n    this.previewPoseMesh = undefined;\n    this.poses = [];\n    this.poseMeshes = [];\n    this.schema = {\n      jsonSchema: {\n        type: \"object\",\n        properties: {\n          type: {\n            type: \"string\",\n            title: \"Type\"\n          },\n          config: {\n            type: \"string\",\n            title: \"Robot Configuration\"\n          }\n        }\n      },\n      uiSchema: {\n        type: {\n          \"ui:disabled\": true\n        },\n        config: {\n          \"ui:widget\": \"selectScopeModal\",\n          \"ui:options\": {\n            scopeList: \"Configuration\",\n            name: \"Robot Config\",\n            filter: e => true\n          }\n        }\n      },\n      data: {\n        type: NavigationPreviewItem.TYPE,\n        config: \"\"\n      }\n    };\n  }\n\n  action = parentView => {\n    setTimeout(() => {\n      this.uIInOut(\"Navigation preview params\", () => (\n        <div style={{ marginTop: \"7px\" }}>\n          {/* <JsonToReact\n            schema={this.schema.jsonSchema}\n            uiSchema={this.schema.uiSchema}\n            formData={this.schema.data}\n            onSubmit={({ formData }) => {\n              this.schema.data.config = formData.config;\n            }}\n            disable={false}\n          /> */}\n        </div>\n      ));\n    });\n    parentView.setSelectedAction(this);\n  };\n\n  onChange(parentView) {\n    parentView.renderMenus();\n    this.resetData();\n  }\n\n  onPointerDown = (evt, parentView) => {\n    if (evt.button !== 0) {\n      return;\n    }\n    parentView.getSceneMemory().forEach(({ scene, ground, camera, canvas }) => {\n      const maybeMousePos = Util3d.getGroundPosition(scene, ground);\n      maybeMousePos.forEach(mousePos => {\n        camera.detachControl(canvas);\n        if (this.poses.length >= 2) {\n          this.resetData();\n        }\n        this.maybeFirstClickPos = Maybe.some(\n          Util3d.toGlobalCoord(parentView)(mousePos)\n        );\n      });\n    });\n  };\n\n  onPointerMove = (evt, parentView) => {\n    this.maybeFirstClickPos.forEach(firstClickPos => {\n      parentView.getSceneMemory().forEach(({ scene, ground }) => {\n        const maybeMousePos = Util3d.getGroundPosition(scene, ground);\n        maybeMousePos.forEach(mousePos => {\n          const secondClickPos = Util3d.toGlobalCoord(parentView)(mousePos);\n          this.previewPoseMesh && this.previewPoseMesh.dispose();\n          this.previewPoseMesh = this.createPreviewPose(\n            scene,\n            parentView,\n            firstClickPos,\n            secondClickPos\n          );\n        });\n      });\n    });\n  };\n\n  onPointerUp = (evt, parentView) => {\n    parentView.getSceneMemory().forEach(({ scene, ground, camera, canvas }) => {\n      this.maybeFirstClickPos.forEach(firstClickPos => {\n        const maybeMousePos = Util3d.getGroundPosition(scene, ground);\n        maybeMousePos.forEach(mousePos => {\n          const secondClickPos = Util3d.toGlobalCoord(parentView)(mousePos);\n          const poseMesh = this.createPreviewPose(\n            scene,\n            parentView,\n            firstClickPos,\n            secondClickPos,\n            true\n          );\n          poseMesh.material = this.poseMeshes.push(poseMesh);\n          const first = Vec3.ofBabylon(firstClickPos);\n          const v = Vec3.ofBabylon(secondClickPos).sub(first);\n          const theta = Math.atan2(v.y, v.x);\n          this.poses.push({\n            position: first.toArray(),\n            orientation: [Math.cos(theta / 2), 0, 0, Math.sin(theta / 2)]\n          });\n          if (this.poses.length === 2) {\n            this.createNavPreviewNode(scene, parentView);\n            this.resetData();\n          }\n        });\n      });\n      camera.attachControl(canvas, true);\n      this.previewPoseMesh && this.previewPoseMesh.dispose();\n      this.maybeFirstClickPos = Maybe.none();\n    });\n  };\n\n  resetData() {\n    this.maybeFirstClickPos = Maybe.none();\n    this.previewPoseMesh && this.previewPoseMesh.dispose();\n    this.poses = [];\n    this.poseMeshes.forEach(mesh => mesh.dispose());\n    this.poseMeshes = [];\n  }\n\n  createPreviewPose(scene, parentView, start, end, normalize = false) {\n    const maxLength = 1.3;\n    const v = end.subtract(start);\n    const length = v.length();\n    const finalLength = normalize\n      ? maxLength / length\n      : Math.min(maxLength / length, length);\n    const finalEnd = start.add(v.scale(finalLength));\n\n    const arrowMesh = Util3d.getArrow(\n      scene,\n      \"previewPose\",\n      start,\n      finalEnd,\n      Constants.RADIUS / 6\n    );\n    const rootMesh = parentView.getRootNode().item.mesh;\n    arrowMesh.parent = rootMesh;\n    return arrowMesh;\n  }\n\n  createNavPreviewNode(scene, parentView) {\n    const navName = `Navigation${Math.floor(Math.random() * 1e2)}`;\n    const poses = [...this.poses];\n    const config = this.schema.data.config;\n    parentView.getUndoManager().doIt(\n      UndoManager.actionBuilder()\n        .doAction(() => {\n          const root = parentView.getRootNode().item.mesh;\n          const navPreviewNode = NavigationPreviewItem.ofDict(\n            scene,\n            {\n              name: navName,\n              poses: poses,\n              robotConfig: config\n            },\n            parentView\n          );\n          navPreviewNode.mesh.parent = root;\n          parentView.addNodeItem2Tree(navPreviewNode, root.name);\n        })\n        .undoAction(() => {\n          parentView.deleteNodeFromTreeUsingName(navName);\n        })\n        .build()\n    );\n  }\n}\n\nexport default NavigationPreviewAction;\n","import DragObjectsAction from \"../Actions/DragObjectsAction\";\nimport AddKeyPointAction from \"../Actions/AddKeyPointAction\";\nimport BoxRegionAction from \"../Actions/BoxRegionAction\";\nimport DrawPathAction from \"../Actions/DrawPathAction\";\nimport PolygonRegionAction from \"../Actions/PolygonRegionAction\";\nimport OrbitAction from \"../Actions/OrbitAction\";\nimport DrawGraphAction from \"../Actions/DrawGraphAction\";\nimport MeasureAction from \"../Actions/MeasureAction\";\nimport NavigationPreviewAction from \"../Actions/NavigationPreviewAction\";\n\n/**\n * Order Matters\n */\nexport const ACTIONS = viewOnly =>\n  viewOnly\n    ? {\n        measure: new MeasureAction(),\n        orbit: new OrbitAction()\n      }\n    : {\n        robotPreview: new NavigationPreviewAction((title, reactFactory) => {}),\n        measure: new MeasureAction(),\n        drawGraph: new DrawGraphAction(),\n        drawRegion: new PolygonRegionAction(),\n        addKeyPoint: new AddKeyPointAction(),\n        drawBoxRegion: new BoxRegionAction(),\n        drawPath: new DrawPathAction(),\n        dragObjects: new DragObjectsAction(),\n        orbit: new OrbitAction()\n      };\n","export default class MapLoader {\n  constructor(yamlSrc) {\n    this.yamlSrc = yamlSrc;\n    this.cachedMap = null;\n  }\n\n  async load() {\n    if (this.cachedMap) return this.cachedMap;\n    const response = await fetch(MapLoader.getMapUrl(this.yamlSrc));\n    const map = await this.parseYaml(await response.text());\n    const ans = {\n      textureSrc: map.image,\n      resolution: map.resolution,\n      origin: map.origin,\n      imageSize: map.size\n    };\n    this.cachedMap = ans;\n    return ans;\n  }\n\n  async parseYaml(yamlTxt) {\n    const ans = {};\n    const actionDict = {\n      image: (k, v) => (ans[k] = MapLoader.getMapUrl(v)),\n      resolution: (k, v) => (ans[k] = Number.parseFloat(v)),\n      origin: (k, v) => (ans[k] = JSON.parse(v))\n    };\n    console.log(\"Yaml text\", yamlTxt);\n    yamlTxt\n      .split(\"\\n\")\n      .map(s => s.split(\": \"))\n      .filter(split => split.length >= 2)\n      .filter(split => split[0] in actionDict)\n      .forEach(split => actionDict[split[0]](split[0], split[1]));\n    ans[\"size\"] = await this.getImageSize(ans[\"image\"]);\n    return ans;\n  }\n\n  getImageSize(src) {\n    return new Promise((resolve, reject) => {\n      const img = new Image();\n      img.src = src;\n      img.onload = () => resolve([img.naturalWidth, img.naturalHeight]);\n    });\n  }\n  static getMapUrl = src => `/static/maps/${src}`;\n}\n","export default \"data:image/png;base64,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\"","/**\n * Inspired by https://en.wikipedia.org/wiki/Algorithms_for_calculating_variance\n * Hope it works, didn't found good lib in js for this.\n */\n\nexport default class Statistics {\n  constructor() {\n    this._count = 0;\n    this._mean = 0;\n    this._M2 = 0;\n  }\n\n  update(x) {\n    this._count += 1;\n    const delta = x - this._mean;\n    this._mean += delta / this._count;\n    const delta2 = x - this._mean;\n    this._M2 += delta * delta2;\n    return this;\n  }\n\n  get count() {\n    return this._count;\n  }\n\n  get mean() {\n    if (this._count < 2) {\n      return Number.NaN;\n    }\n    return this._mean;\n  }\n\n  get variance() {\n    if (this._count < 2) {\n      return Number.NaN;\n    }\n    return this._M2 / this._count;\n  }\n\n  get sampleVar() {\n    if (this._count < 2) {\n      return Number.NaN;\n    }\n    return this._M2 / (this._count - 1);\n  }\n\n  isOutlier(x, sigmas = 3) {\n    const zScore = (x - this.mean) / Math.sqrt(this.variance);\n    return Number.isNaN(zScore) || Math.abs(zScore) > sigmas;\n  }\n}\n","import Vec3 from \"../Math/Vec3\";\nimport Util3d from \"../Util3d/Util3d\";\nimport AssetNodeItem from \"./AssetNodeItem\";\nimport errorIcon from \"../../../../resources/alert-error.png\";\nimport {\n  Axis,\n  Space,\n  Vector3,\n  Quaternion,\n  Color3,\n  MeshBuilder,\n  Mesh,\n  StandardMaterial,\n  Texture\n} from \"@babylonjs/core\";\nimport _get from \"lodash/get\";\nimport Statistics from \"../Utils/Statistics\";\n\nclass Robot extends AssetNodeItem {\n  static ROBOT_MESH_NAME = \"Tugbot.stl\";\n\n  constructor(meshTree, assetName, keyValueMap = {}, scene, parentView) {\n    super(meshTree.mesh, assetName, keyValueMap);\n    this.robot = parentView.getRobotManager().getRobot(meshTree.id);\n    this.scene = scene;\n    this.isOnline = true;\n    this.numberOfIte = 0;\n    this.is2UsePos = true;\n    this.meshTree = meshTree;\n    this.parentView = parentView;\n    this.timeSinceLastUpdate = 0;\n    this.isSubscribedToLogs = true;\n    this.speedStats = new Statistics();\n    this.alert = null;\n    this.loggerSubscription = null;\n    this.requestAnimationFrameId = null;\n    this.speed = Vector3.Zero();\n    this.qSpeed = Quaternion.Zero();\n    this.newPos = Vector3.Zero();\n    this.newOri = Quaternion.Identity();\n    // Build alert mesh\n    this.alertMesh = this.buildAlertMesh(meshTree, scene);\n    // Get robot ip to start logger\n    const robotIP = this.robot.getIP(this.onGetIP(this));\n    if (robotIP) this.startLogger();\n    // Add click action to alertMesh\n    Util3d.addClickActionToMesh(\n      this.alertMesh,\n      scene,\n      this.onMeshAlertClick(this)\n    );\n  }\n\n  buildAlertMesh(meshTree, scene) {\n    if (this.alertMesh) return this.alertMesh;\n    const alertMesh = MeshBuilder.CreateDisc(`AlertDisc${meshTree.name}`, {\n      radius: 0.2,\n      sideOrientation: Mesh.DOUBLESIDE\n    });\n    const material = new StandardMaterial(`AlertMat${meshTree.name}`, scene);\n    material.emissiveColor = new Color3.White();\n    material.ambientTexture = new Texture(errorIcon, scene);\n    material.freeze();\n    alertMesh.material = material;\n    alertMesh.isStatic = true;\n    alertMesh.position.y = -1.5;\n    alertMesh.parent = meshTree.mesh;\n    alertMesh.setEnabled(false);\n    alertMesh.billboardMode = Mesh.BILLBOARDMODE_ALL;\n    return alertMesh;\n  }\n\n  /**\n   * On alert mesh click handler\n   *\n   * @param {*} robot: Robot class instance (this)\n   * @returns {Function} Function to be triggered whenever there's a click on the alert mesh\n   */\n  onMeshAlertClick(robot) {\n    return () => {\n      robot.parentView.showRobotAlertModal(robot.alert);\n    };\n  }\n\n  toDict() {\n    let dict = super.toDict();\n    dict.isSubscribedToLogs = this.isSubscribedToLogs;\n    return dict;\n  }\n\n  toForm() {\n    const schema = super.toForm();\n    const props = { ...schema.jsonSchema.properties };\n    const newJsonSchema = {\n      type: \"object\",\n      properties: {\n        oldName: props.oldName,\n        name: props.name,\n        type: props.type,\n        // isSubscribedToLogs: {\n        //   type: \"boolean\",\n        //   title: \"Subscribe to alerts\"\n        // },\n        position: props.position,\n        rotation: props.rotation,\n        color: props.color,\n        annotations: props.annotations\n      }\n    };\n    schema.jsonSchema = newJsonSchema;\n    schema.data[\"isSubscribedToLogs\"] = this.isSubscribedToLogs;\n    return schema;\n  }\n\n  ofForm(form) {\n    super.ofForm(form);\n    this.isSubscribedToLogs = Boolean(form.isSubscribedToLogs);\n    // Start/Stop logger based on isSubscribedToLogs property\n    if (form.isSubscribedToLogs && this.robot.ip) this.startLogger();\n    else this.stopLogger(true);\n  }\n\n  dispose() {\n    super.dispose();\n    this.robot.unsubscribe({\n      property: \"Parameter\",\n      propValue: \"tf\"\n    });\n    window.cancelAnimationFrame(this.requestAnimationFrameId);\n  }\n\n  updateRobot = (robot, oldTimeInMillis, robotAnimator) => {\n    const time = new Date().getTime();\n    const dt = 1e-3 * (time - oldTimeInMillis);\n    robotAnimator(robot, dt);\n    this.requestAnimationFrameId = requestAnimationFrame(() =>\n      this.updateRobot(robot, time, robotAnimator)\n    );\n  };\n\n  animate = robotAnimator => {\n    this.requestAnimationFrameId = requestAnimationFrame(() =>\n      this.updateRobot(this, new Date().getTime(), robotAnimator)\n    );\n  };\n\n  getType = () => Robot.TYPE;\n\n  toOffline() {\n    if (this.mesh.isDisposed()) return;\n    this.mesh.visibility = 0.1;\n    this.speed = Vector3.Zero();\n    this.qSpeed = Quaternion.Zero();\n    this.isOnline = false;\n    this.numberOfIte = 0;\n    this.speedStats = new Statistics();\n    this.stopLogger();\n  }\n\n  toOnline() {\n    if (this.mesh.isDisposed()) return;\n    this.mesh.visibility = 1;\n    this.isOnline = true;\n    this.startLogger();\n  }\n\n  /**\n   * Start robot logger\n   */\n  startLogger() {\n    if (!this.loggerSubscription) {\n      this.loggerSubscription = this.robot.subscribeToLogs(\n        this.updateAlertState(this)\n      );\n    }\n  }\n\n  /**\n   * Stop robot logger\n   *\n   * @param {Boolean} is2RemoveAlertMesh: If true: remove alert mesh\n   */\n  stopLogger(is2RemoveAlertMesh) {\n    if (this.loggerSubscription) {\n      this.robot.unsubscribeToLogs(this.loggerSubscription);\n      this.loggerSubscription = null;\n    }\n    // Remove robot alert mesh\n    if (is2RemoveAlertMesh) this.alertMesh.setEnabled(false);\n  }\n\n  /**\n   * Update robot alert state\n   *\n   * @param {*} robot: Robot class instance (this)\n   * @returns {Function} Function to be triggered whenever there's a new log for this robot\n   */\n  updateAlertState(robot) {\n    return logs => {\n      robot.timeSinceLastUpdate = 0;\n      if (\n        logs.length > 0 &&\n        (logs[0].level === \"ERROR\" || logs[0].level === \"CRITICAL\")\n      ) {\n        robot.alert = logs[0];\n        robot.alertMesh.setEnabled(true);\n      }\n      // If last log is not error/critical then clean alert (set it to null)\n      else {\n        robot.alertMesh.setEnabled(false);\n      }\n    };\n  }\n\n  /**\n   * Start logger after receiving robot IP\n   *\n   * @param {*} robot: Robot class instance (this)\n   * @returns {Function} Function to be triggered when receive robot ip\n   */\n  onGetIP(robot) {\n    return ip => {\n      // If robot IP were not found doesn't start logger\n      if (!ip) return;\n      robot.startLogger();\n    };\n  }\n\n  //========================================================================================\n  /*                                                                                      *\n   *                                   Static Functions                                   *\n   *                                                                                      */\n  //========================================================================================\n\n  static TYPE = \"Robot\";\n\n  static TIME_2_BE_OFFLINE_IN_SEC = 10;\n\n  static createBaseObject = ({\n    robotName,\n    robotMeshName = Robot.ROBOT_MESH_NAME,\n    id = Robot.randomId(),\n    nodeDict = {\n      position: [0, 0, 0],\n      quaternion: [1, 0, 0, 0]\n    }\n  }) => {\n    return {\n      id: id,\n      name: robotName,\n      type: Robot.TYPE,\n      meshName: robotMeshName,\n      robotTree: {\n        name: robotName,\n        child: [],\n        position: {\n          x: nodeDict.position[0],\n          y: nodeDict.position[1],\n          z: nodeDict.position[2]\n        },\n        orientation: {\n          w: nodeDict.quaternion[0],\n          x: nodeDict.quaternion[1],\n          y: nodeDict.quaternion[2],\n          z: nodeDict.quaternion[3]\n        }\n      }\n    };\n  };\n\n  static getDefaultAnimator = parentView => (robot, dt) => {\n    const mesh = robot.mesh;\n    const speed = 3;\n    const vel = Util3d.getRotationMatrix(mesh)\n      .prodVec(new Vec3([speed, 0, 0]))\n      .toBabylon();\n    mesh.position = mesh.position.add(vel.scale(dt));\n    mesh.rotate(Axis.Z, (-Math.PI / 2) * dt, Space.LOCAL);\n  };\n\n  static updateRobotMeshTree(newRobotTf, robot) {\n    const lastPosition = robot.mesh.position;\n    const lastOrientation = robot.mesh.rotationQuaternion;\n    const newPosition = new Vector3(\n      newRobotTf.position.x,\n      newRobotTf.position.y,\n      newRobotTf.position.z\n    );\n    const newOrientation = new Quaternion(\n      newRobotTf.orientation.x,\n      newRobotTf.orientation.y,\n      newRobotTf.orientation.z,\n      newRobotTf.orientation.w\n    ).normalize();\n\n    robot.numberOfIte++;\n    const isZero = robot.timeSinceLastUpdate === 0;\n    const dtInv = isZero ? 1.0 : Math.min(1.0 / robot.timeSinceLastUpdate, 1.0);\n\n    const speed = newPosition.subtract(lastPosition).scale(dtInv);\n    const qSpeed = newOrientation.subtract(lastOrientation).scale(dtInv);\n    const vel = speed.length();\n\n    if (robot.numberOfIte < SAMPLES) {\n      robot.speedStats.update(vel);\n    }\n    if (robot.speedStats.isOutlier(vel)) {\n      robot.is2UsePos = true;\n    } else {\n      robot.speedStats.update(vel);\n      robot.speed = speed;\n      robot.qSpeed = qSpeed;\n      robot.is2UsePos = false;\n    }\n    robot.newPos = newPosition;\n    robot.newOri = newOrientation;\n    robot.timeSinceLastUpdate = 0;\n  }\n\n  static getSocketAnimator = (robot, parentView) => {\n    const updateTF = data => {\n      const tf = _get(\n        data,\n        `Robot.${robot.meshTree.id}.Parameter.tf.Value`,\n        undefined\n      );\n      if (tf) Robot.updateRobotMeshTree(tf, robot);\n    };\n    // Subscribe to tf parameter\n    robot.robot.subscribe({\n      property: \"Parameter\",\n      propValue: \"tf\",\n      onLoad: data => updateTF(data?.value),\n      onUpdate: data => updateTF(data?.key)\n    });\n\n    // Animate\n    return (robot2Animate, dt) => {\n      robot2Animate.timeSinceLastUpdate += dt;\n      dt = Math.min(dt, 1);\n      if (Vec3.ofBabylon(robot2Animate.speed).someNaNOrInfinite()) return;\n      if (Vec3.ofBabylon(robot2Animate.qSpeed).someNaNOrInfinite()) return;\n      if (robot2Animate.is2UsePos) {\n        robot2Animate.mesh.position = robot2Animate.newPos;\n        robot2Animate.mesh.rotationQuaternion = robot2Animate.newOri;\n      } else {\n        robot2Animate.mesh.position = robot2Animate.mesh.position.add(\n          robot2Animate.speed.scale(dt)\n        );\n        robot2Animate.mesh.rotationQuaternion = robot2Animate.mesh.rotationQuaternion\n          .add(robot.qSpeed.scale(dt))\n          .normalize();\n      }\n      Robot.setOnOffLine(robot2Animate);\n    };\n  };\n\n  static setOnOffLine(robot) {\n    if (robot.timeSinceLastUpdate > Robot.TIME_2_BE_OFFLINE_IN_SEC) {\n      if (robot.isOnline) robot.toOffline();\n    } else {\n      if (robot.timeSinceLastUpdate > Robot.TIME_2_BE_OFFLINE_IN_SEC / 4) {\n        robot.is2UsePos = true;\n      }\n      if (!robot.isOnline) robot.toOnline();\n    }\n  }\n\n  static createRobotMeshTreeRecursive(node, mesh, parent, scene) {\n    if (!mesh) {\n      mesh = Util3d.createSphere(\n        scene,\n        new Color3(0.0, 0.0, 0.0),\n        0.5,\n        node.name,\n        false\n      );\n    }\n    const meshTree = {\n      mesh: mesh,\n      children: []\n    };\n    const position = new Vector3(\n      node.position.x,\n      node.position.y,\n      node.position.z\n    );\n    const quaternion = new Quaternion(\n      node.orientation.x,\n      node.orientation.y,\n      node.orientation.z,\n      node.orientation.w\n    );\n    mesh.position = position;\n    mesh.rotationQuaternion = quaternion;\n    if (parent) {\n      mesh.parent = parent;\n    }\n    meshTree[\"children\"] = node.child.map(child => {\n      return this.createRobotMeshTreeRecursive(\n        child,\n        Util3d.referentialBuilder(scene)\n          .boxParams({ isVisible: false, size: 0.1 })\n          .build(),\n        mesh,\n        scene\n      );\n    });\n    return meshTree;\n  }\n\n  static createRobotMeshTree(robotTree, robotMesh, scene) {\n    return Robot.createRobotMeshTreeRecursive(\n      robotTree,\n      robotMesh,\n      null,\n      scene\n    );\n  }\n\n  static builder() {\n    return new RobotBuilder();\n  }\n}\n\nclass RobotBuilder {\n  constructor() {\n    this._name = null;\n    this._meshTree = null;\n    this._parentMesh = null;\n    this._parentView = null;\n    this._scene = null;\n    this._isPickable = true;\n    this._id = null;\n    this._keyValueMap = {};\n    this._assetName = null;\n  }\n\n  name(name) {\n    this._name = name;\n    return this;\n  }\n\n  meshTree(meshTree) {\n    this._meshTree = meshTree;\n    return this;\n  }\n\n  parentMesh(parentMesh) {\n    this._parentMesh = parentMesh;\n    return this;\n  }\n\n  parentView(parentView) {\n    this._parentView = parentView;\n    return this;\n  }\n\n  scene(scene) {\n    this._scene = scene;\n    return this;\n  }\n\n  isPickable(isPickable) {\n    this._isPickable = isPickable;\n    return this;\n  }\n\n  id(id) {\n    this._id = id;\n    return this;\n  }\n\n  keyValueMap(keyValueMap) {\n    this._keyValueMap = keyValueMap;\n    return this;\n  }\n\n  assetName(assetName) {\n    this._assetName = assetName;\n    return this;\n  }\n\n  build() {\n    const variables = Object.keys(this)\n      .filter(x => x !== \"_parentMesh\")\n      .map(x => this[x]);\n\n    variables.forEach(x => {\n      if (x === null)\n        throw new Error(\n          `There are missing variables to build a robot, e.g ${x}`\n        );\n    });\n\n    this._meshTree.id = this._id;\n    this._meshTree.name = this._name;\n    this._meshTree.mesh.name = this._name;\n    this._meshTree.mesh.isPickable = this._isPickable;\n    this._meshTree.mesh.parent = this._parentMesh;\n\n    const baseAxis = Util3d.referentialBuilder(this._scene)\n      .isPickable(false)\n      .boxParams({ isVisible: false, size: 0.1 })\n      .name(`${this._name}Axis`)\n      .build();\n    baseAxis.parent = this._meshTree.mesh;\n\n    return new Robot(\n      this._meshTree,\n      this._assetName,\n      this._keyValueMap,\n      this._scene,\n      this._parentView\n    );\n  }\n}\n//========================================================================================\n/*                                                                                      *\n *                                       CONSTANTS                                      *\n *                                                                                      */\n//========================================================================================\n\nconst SAMPLES = 30;\n\n//========================================================================================\n/*                                                                                      *\n *                                        EXPORT                                        *\n *                                                                                      */\n//========================================================================================\n\nexport default Robot;\n","import { Maybe } from \"monet\";\nimport { ASSETS_TYPES, AssetsTypesFactory } from \"../Utils/AssetsTypesFactory\";\nimport { MasterDB } from \"mov-fe-lib-core\";\nimport MapLoader from \"./MapLoader\";\nimport Robot from \"../NodeItem/Robot\";\n\n/**\n *  Graphic Assets Manager, retrieves and manages the assets that are in DB.\n */\nclass AssetsManager {\n  constructor() {\n    if (instance) return instance;\n    instance = this;\n    this.assets = {};\n    this.assetsActionMap = {};\n    this.robots = {};\n    this.observersBySceneId = {};\n    this.afterLoad = [];\n    this.finishInitialSubscribers = 0;\n    this.isLoading = true;\n  }\n\n  //========================================================================================\n  /*                                                                                      *\n   *                                  Getters and Setters                                 *\n   *                                                                                      */\n  //========================================================================================\n\n  getAssets = () => this.assets;\n\n  getAssetsActionMap = () => this.assetsActionMap;\n\n  load = async () => {\n    await this.retrieveAssetsFromDb();\n    return this;\n  };\n\n  addAfterLoad(afterLoad) {\n    this.afterLoad.push(afterLoad);\n    return this;\n  }\n\n  addObserver(scene, observer) {\n    const sceneId = scene._uid;\n    if (!(sceneId in this.observersBySceneId)) {\n      this.observersBySceneId[sceneId] = [];\n    }\n    this.observersBySceneId[sceneId].push(observer);\n    return this;\n  }\n\n  signalObservers = () => {\n    Object.keys(this.observersBySceneId).forEach(k => {\n      this.observersBySceneId[k].forEach(obs => obs(this));\n    });\n  };\n\n  addAsset(assetKey, asset) {\n    try {\n      this.assets[assetKey] = asset;\n      this.assetsActionMap[assetKey] = AssetsTypesFactory[asset.type](asset);\n      if (!this.isLoading) this.signalObservers();\n    } catch (e) {\n      console.log(\"Caught exception while adding asset\", e);\n      throw Error(`Caught exception while adding asset ${e}`);\n    }\n  }\n\n  delAsset(assetKey) {\n    if (assetKey in this.assets) delete this.assets[assetKey];\n    if (assetKey in this.assetsActionMap) delete this.assetsActionMap[assetKey];\n    this.signalObservers();\n  }\n\n  clearObserver(scene) {\n    const sceneId = scene._uid;\n    if (sceneId in this.observersBySceneId) {\n      console.log(\"Clear asset observer\", sceneId);\n      delete this.observersBySceneId[sceneId];\n    }\n  }\n\n  //========================================================================================\n  /*                                                                                      *\n   *                                      Subscribers                                     *\n   *                                                                                      */\n  //========================================================================================\n\n  subs = [\n    resolve =>\n      MasterDB.subscribe(\n        {\n          Scope: \"Robot\",\n          Name: \"*\",\n          RobotName: \"*\"\n        },\n        this.getRobotUpdate(),\n        (data) => this.getRobotNameSub(\n          data.value,\n          () => {\n            this.addRobots();\n            this.finishSub(\"RobotName\", resolve);\n          }\n        )\n      ),\n    resolve => \n      MasterDB.subscribe(\n        {\n          Scope: \"Robot\",\n          Name: \"*\",\n          Parameter: \"mesh\"\n        },\n        this.getRobotUpdate(),\n        (data) => this.getRobotMeshSub(\n          data.value,\n          () => {\n            this.addRobots();\n            this.finishSub(\"RobotMesh\", resolve);\n          }\n        )\n      ),\n    resolve =>\n      MasterDB.subscribe(\n        {\n          Scope: \"Package\",\n          File: \"*\",\n          Name: \"maps\",\n          FileLabel: \"*\"\n        },\n        this.getMapUpdater(({ key }) => key),\n        this.getMapSubscriber(\n          ({ value }) => value,\n          () => this.finishSub(\"Maps\", resolve)\n        )\n      ),\n    resolve =>\n      MasterDB.subscribe(\n        { Scope: \"Package\", File: \"*\", Name: \"meshes\", FileLabel: \"*\" },\n        this.getMeshUpdater(),\n        this.getMeshSubscriber(\n          ({ value }) => value,\n          () => this.finishSub(\"Meshes\", resolve)\n        )\n      )\n  ];\n\n  retrieveAssetsFromDb() {\n    return new Promise((re, rej) => {\n      this.subs.forEach(f => f(re));\n    });\n  }\n\n  //========================================================================================\n  /*                                                                                      *\n   *                                         Utils                                        *\n   *                                                                                      */\n  //========================================================================================\n\n  finishSub = (place, resolve) => {\n    console.log(\"FINISH SUB \", place, this.finishInitialSubscribers);\n    if (++this.finishInitialSubscribers > this.subs.length - 1) {\n      this.afterLoad.forEach(f => f(this));\n      this.afterLoad = [];\n      this.isLoading = false;\n      resolve(true);\n    }\n  };\n\n  //========================================================================================\n  /*                                                                                      *\n   *                                        Robots                                        *\n   *                                                                                      */\n  //========================================================================================\n\n  deleteRobot = id => {\n    if(!this.robots.hasOwnProperty(id)) return;\n    this.delAsset(this.robots[id].name);\n    if (id in this.robots) delete this.robots[id];\n  };\n\n  setRobot(id, name = null, meshName = null) {\n    if (!(id in this.robots)) {\n      this.robots[id] = {\n        id: id,\n        name: null,\n        meshName: null,\n      };\n    }\n    ofNull(name).forEach(name => (this.robots[id].name = name));\n    ofNull(meshName).forEach(meshName => (this.robots[id].meshName = meshName));\n  }\n\n  addRobots(robots = this.robots) {\n    Object.keys(robots).forEach((id) => {\n      if (Object.values(this.robots[id]).every(x => x !== null)) {\n        const localRobot = this.robots[id];\n        this.addAsset(\n          localRobot.name, \n          Robot.createBaseObject({robotName: localRobot.name, robotMeshName: localRobot.meshName, id })\n        );\n      }\n    })\n  }\n\n  getRobotNameSub(data, after = () => {}) {\n    ofNull(data)\n      .flatMap(maybeGet(\"Robot\"))\n      .forEach(r =>\n        Object.keys(r).forEach(id => this.setRobot(id, r[id].RobotName))\n      );\n    after();\n  }\n\n  getRobotMeshSub(data, after = () => {}) {\n    ofNull(data)\n      .flatMap(maybeGet(\"Robot\"))\n      .forEach(r =>\n        Object.keys(r).forEach(id => this.setRobot(id, r[id].RobotName, r[id].Parameter.mesh.Value))\n      );\n    Object.keys(this.robots).forEach((id) => {\n      this.robots[id].meshName = this.robots[id].meshName \n        ? this.robots[id].meshName \n        : Robot.ROBOT_MESH_NAME;\n    });\n    after();\n  }\n\n  getRobotUpdate() {\n    const actionMap = {\n      del: data => {\n        const pattern = data.patterns[0];\n        // del event from RobotName pattern\n        if(pattern.hasOwnProperty('RobotName')) {\n          ofNull(data.key)\n            .flatMap(maybeGet(\"Robot\"))\n            .forEach(r => Object.keys(r).forEach(this.deleteRobot));\n        }\n        // del event from RobotMesh pattern\n        else if(pattern.hasOwnProperty('Parameter')) {\n          ofNull(data.key)\n            .flatMap(maybeGet(\"Robot\"))\n            .forEach(r => Object.keys(r).forEach(robotId => {\n              this.robots[robotId].meshName = Robot.ROBOT_MESH_NAME;\n            }));\n        }\n      },\n      set: data => {\n        const pattern = data.patterns[0];\n        const robots = { ...data.key.Robot }\n        // set event from RobotName pattern\n        if(pattern.hasOwnProperty('RobotName'))\n          this.getRobotNameSub(data.key, () => this.addRobots(robots))\n        // set event from RobotMesh pattern\n        else if(pattern.hasOwnProperty('Parameter'))\n          this.getRobotMeshSub(data.key, () => this.addRobots(robots))\n      }\n    };\n    return data => {\n      console.log(\"Robot NAME UPDATE\", data);\n      actionMap[data.event](data);\n    };\n  }\n\n  //========================================================================================\n  /*                                                                                      *\n   *                                         Maps                                         *\n   *                                                                                      */\n  //========================================================================================\n\n  getMapSubscriber = (dataGetter, after = () => {}) => {\n    return data =>\n      this.getMapFileData(dataGetter, data).forEach(fileName => {\n        Object.keys(fileName)\n          .filter(f => f.includes(\".yaml\"))\n          .forEach(this.addMap);\n        after();\n      });\n  };\n\n  getMapUpdater = dataGetter => {\n    const actionMap = {\n      del: data => {\n        this.getMapFileData(dataGetter, data).forEach(f => {\n          let filename = Object.keys(f)[0];\n          filename = filename.split(\".\")[0];\n          this.delAsset(filename);\n        });\n      },\n      set: this.getMapSubscriber(dataGetter),\n      subscribe: this.getMapSubscriber(dataGetter)\n    };\n    return data => {\n      console.log(\"MAP UPDATE\", data);\n      actionMap[data.event](data);\n    };\n  };\n\n  addMap = yamlSrc => {\n    const map = {\n      name: yamlSrc.split(\".\")[0],\n      loader: new MapLoader(yamlSrc),\n      type: ASSETS_TYPES.Map\n    };\n    this.addAsset(map.name, map);\n  };\n\n  getMapFileData = (dataGetter, data) =>\n    ofNull(dataGetter(data))\n      .flatMap(maybeGet(\"Package\"))\n      .flatMap(maybeGet(\"maps\"))\n      .flatMap(maybeGet(\"File\"));\n\n  //========================================================================================\n  /*                                                                                      *\n   *                                         Mesh                                         *\n   *                                                                                      */\n  //========================================================================================\n\n  getMeshSubscriber = (dataGetter, after = () => {}) => data => {\n    this.getMeshFileData(dataGetter, data).forEach(d =>\n      Object.keys(d).forEach(id => {\n        const mesh = { id: id, name: d[id].FileLabel, type: ASSETS_TYPES.Mesh };\n        this.addAsset(mesh.name, mesh);\n      })\n    );\n    after();\n  };\n\n  getMeshUpdater = () => {\n    const actionMap = {\n      del: data => {\n        this.getMeshFileData(d => d.key, data).forEach(f => {\n          let filename = Object.keys(f)[0];\n          this.delAsset(filename);\n        });\n      },\n      set: this.getMeshSubscriber(d => d.key),\n      subscribe: this.getMeshSubscriber(d => d.key)\n    };\n    return data => actionMap[data.event](data);\n  };\n\n  getMeshFileData = (dataGetter, data) =>\n    ofNull(dataGetter(data))\n      .flatMap(maybeGet(\"Package\"))\n      .flatMap(maybeGet(\"meshes\"))\n      .flatMap(maybeGet(\"File\"));\n\n  //========================================================================================\n  /*                                                                                      *\n   *                                        static                                        *\n   *                                                                                      */\n  //========================================================================================\n\n  static getInstance() {\n    return new AssetsManager();\n  }\n}\n\n// private variable\nlet instance = null;\n\n// auxiliary functions\nconst ofNull = Maybe.fromNull;\nconst get = prop => obj => obj[prop];\nconst dot = f => g => x => f(g(x));\nconst maybeGet = prop => dot(ofNull)(get(prop));\n\nexport default AssetsManager;\n","import Util3d from \"../Util3d/Util3d\";\nimport Vec3 from \"../Math/Vec3\";\nimport Action from \"./Action\";\nimport Map from \"../NodeItem/Map\";\nimport { Maybe } from \"monet\";\nimport React from \"react\";\nimport GlobalRef, { ROS_ORIGIN } from \"../NodeItem/GlobalRef\";\nimport { Axis, Space, Vector3, Quaternion } from \"@babylonjs/core\";\nimport DefaultScene from \"../Utils/DefaultScene\";\nimport { ACTIONS } from \"../MainView/MainViewActions\";\nimport { UndoManager } from \"mov-fe-lib-core\";\nimport AssetsManager from \"../AssetsManager/AssetsManager\";\n\nclass AddMapAction extends Action {\n  constructor(name, mapLoader) {\n    super();\n    this.name = name;\n    this.key = `addMap${name}`;\n    this.mapLoader = mapLoader;\n    this.icon = props => <i {...props} className=\"fas fa-map\"></i>;\n    this.firstTimeLoad = true;\n  }\n\n  addMap(parentView) {\n    parentView.getSceneMemory().forEach(async memory => {\n      const { scene, camera } = memory;\n      const {\n        textureSrc,\n        resolution,\n        origin,\n        imageSize\n      } = await this.mapLoader.load();\n\n      const width = resolution * imageSize[0];\n      const height = resolution * imageSize[1];\n      const mesh = Util3d.groundBuilder(scene)\n        .name(Maybe.fromNull(this.memory[\"name\"]).orSome(this.name))\n        .width(width)\n        .height(height)\n        .textureSrc(textureSrc)\n        .build();\n\n      const [xOrigin, yOrigin, yawOrigin] = origin;\n      const originPos = Vec3.of([-width / 2, -height / 2, 0]).sub(\n        Vec3.of([xOrigin, yOrigin, 0])\n      );\n\n      const rootNode = parentView.getRootNode();\n      const parent = rootNode.item.mesh.parent;\n      parent.position = GlobalRef.inverseCoordinates(originPos.toBabylon());\n      parent.rotationQuaternion = new Quaternion(\n        ROS_ORIGIN.quaternion[1],\n        ROS_ORIGIN.quaternion[2],\n        ROS_ORIGIN.quaternion[3],\n        ROS_ORIGIN.quaternion[0]\n      );\n\n      parent.rotate(Axis.Z, -yawOrigin, Space.LOCAL);\n      camera.setTarget(\n        new Vector3(parent.position.x, parent.position.y, parent.position.z)\n      );\n\n      const map = new Map(\n        mesh,\n        [width, height],\n        this.textureSrc,\n        Maybe.fromNull(this.memory[\"assetName\"]).orSome(this.name)\n      );\n\n      const isVisible = Maybe.fromNull(this.memory[\"isVisible\"]).orSome(true);\n      const is2sendServer = Maybe.fromNull(this.memory[\"isImport\"])\n        .map(x => !x)\n        .orSome(true);\n\n      mesh.setEnabled(isVisible);\n      parentView.addNodeItem2Tree(map, null, is2sendServer, isVisible);\n      memory.ground.dispose();\n      memory.ground = DefaultScene.createMeshGround(scene, width, height);\n      this.memory[\"isImport\"] = false;\n    });\n  }\n\n  action(parentView) {\n    super.action(parentView);\n    const maybeNode = parentView.getNodeFromTree(this.name);\n    maybeNode.orElseRun(() => {\n      const isImport = this.memory[\"isImport\"];\n      // you shouldn't be able to undo when importing a scene. isImport prevents removing the map when you undo.\n      // firstTimeLoad condition to prevent adding a map when fast map switch, TODO: doesn't work\n      if (isImport) {\n        this.addMap(parentView);\n        this.firstTimeLoad = false;\n      } else {\n        parentView.getUndoManager().doIt(this.getUndoAction(parentView));\n      }\n    });\n    parentView.setSelectedAction(ACTIONS().orbit);\n  }\n\n  getUndoAction(parentView) {\n    if (parentView.getObjectTree().length < 2) {\n      return UndoManager.actionBuilder()\n        .doAction(() => {\n          this.addMap(parentView);\n        })\n        .undoAction(({ is2UpdateInServer = true }) => {\n          const name = parentView.getObjectTree()[1].title;\n          parentView.deleteNodeFromTreeUsingName(name, is2UpdateInServer);\n        })\n        .build();\n    } else {\n      const oldMapName = parentView.getObjectTree()[1].title;\n      const newMapName = this.name;\n      return UndoManager.actionBuilder()\n        .doAction(() => {\n          this.switchMaps(oldMapName, newMapName, parentView);\n        })\n        .undoAction(({ is2UpdateInServer = true }) => {\n          parentView.deleteNodeFromTreeUsingName(newMapName, is2UpdateInServer);\n          Maybe.fromNull(\n            AssetsManager.getInstance().getAssetsActionMap()[oldMapName]\n          ).forEach(a => a.action(parentView));\n        })\n        .build();\n    }\n  }\n\n  switchMaps(oldMapName, newMapName, parentView) {}\n\n  getType = () => AddMapAction.TYPE;\n\n  deleteAsset = () => {};\n\n  download = async () => {};\n\n  static TYPE = \"AddMapAction\";\n}\n\nexport default AddMapAction;\n","import NodeItem from \"./NodeItem\";\nimport { Mesh, StandardMaterial, Color3, VertexData } from \"@babylonjs/core\";\nimport { Maybe } from \"monet\";\nimport { MasterDB, Utils } from \"mov-fe-lib-core\";\n\nconst { ofNull } = Utils;\n\nclass PointCloud extends NodeItem {\n  /**\n   *\n   * @param {*} mesh\n   * @param {*} robot: {name: string, id: string} representing a robot\n   */\n  constructor(mesh, robot) {\n    super(mesh);\n    this.robot = robot;\n    this.pointCloudSubscribe();\n  }\n\n  pointCloudSubscribe() {\n    MasterDB.subscribe(\n      {\n        Scope: \"Robot\",\n        Name: this.robot.id,\n        Parameter: \"front_lidar\"\n      },\n      data => {\n        Maybe.fromNull(data)\n          .flatMap(d => ofNull(d.key))\n          .flatMap(k => ofNull(k.Robot[this.robot.id]))\n          .flatMap(r => ofNull(r.Parameter))\n          .flatMap(p => ofNull(p.front_lidar))\n          .flatMap(f => ofNull(f.Value))\n          .flatMap(v => ofNull(v.points))\n          .forEach(points => this.updatePointCloud(points));\n      },\n      data => {\n        Maybe.fromNull(data.value)\n          .flatMap(v => ofNull(v.Robot))\n          .flatMap(r => ofNull(r[this.robot.id]))\n          .flatMap(r => ofNull(r.Parameter))\n          .flatMap(p => ofNull(p.front_lidar))\n          .flatMap(f => ofNull(f.Value))\n          .flatMap(v => ofNull(v.points))\n          .forEach(points => this.updatePointCloud(points));\n      }\n    );\n  }\n\n  /**\n   *\n   * @param {*} points: Array<3-Array>\n   */\n  updatePointCloud(points) {\n    const vertexData = new VertexData();\n    //Assign positions\n    vertexData.positions = points.flatMap(x => x);\n    const colors = new Array(4 * points.length);\n    vertexData.colors = colors.fill(1.0);\n    //Apply vertexData to custom mesh\n    vertexData.applyToMesh(this.mesh, true);\n  }\n\n  dispose() {\n    super.dispose();\n    MasterDB.unsubscribe({\n      Scope: \"Robot\",\n      Name: this.robot.id,\n      Parameter: \"front_lidar\"\n    });\n  }\n\n  getType = () => PointCloud.TYPE;\n\n  static TYPE = \"PointCloud\";\n\n  static ofDict(scene, dict = null, mainView = null) {\n    if (!dict || !mainView)\n      throw new Error(\n        \"null dictionary describing point cloud or null mainView\"\n      );\n\n    const pointCloudMesh = new Mesh(`cloudPoint${dict.name}`, scene);\n    const mat = new StandardMaterial(`cloudPoint${dict.name}Material`, scene);\n    mat.emissiveColor = new Color3(1, 1, 1);\n    mat.disableLighting = true;\n    mat.pointsCloud = true;\n    mat.pointSize = 2;\n    pointCloudMesh.material = mat;\n\n    return new PointCloud(pointCloudMesh, dict);\n  }\n}\n\nexport default PointCloud;\n","import { Maybe } from \"monet\";\n/**\n * Mesh cache for each scene.\n *\n * Each mesh is associated with a scene therefore we must have a cache per scene.\n *\n */\nclass MeshCache {\n  constructor() {\n    if (instance) return instance;\n    instance = this;\n    this.meshCacheBySceneId = {};\n    this.count = 0;\n  }\n\n  static getInstance() {\n    return new MeshCache();\n  }\n\n  hasKey(key, scene) {\n    const sceneId = scene._uid;\n    return Maybe.fromNull(this.meshCacheBySceneId[sceneId])\n      .flatMap(meshCache => ofNull(meshCache[key]))\n      .cata(\n        () => false,\n        () => true\n      );\n  }\n\n  put(key, scene, mesh) {\n    const sceneId = scene._uid;\n    if (!(sceneId in this.meshCacheBySceneId)) {\n      this.meshCacheBySceneId[sceneId] = {};\n    }\n    this.meshCacheBySceneId[sceneId][key] = mesh;\n    mesh.setEnabled(false);\n    return this;\n  }\n\n  get(key, scene) {\n    const sceneId = scene._uid;\n    return Maybe.fromNull(this.meshCacheBySceneId[sceneId])\n      .flatMap(meshCache => ofNull(meshCache[key]))\n      .map(mesh => {\n        console.log(\n          \"#Mesh: Found Mesh in cache, retrieving copy number\",\n          this.count\n        );\n        const cloneMesh = mesh.clone(`${key}${this.count++}`);\n        console.log(\"#Mesh:\", cloneMesh);\n        cloneMesh.setEnabled(true);\n        return cloneMesh;\n      })\n      .orNull();\n  }\n\n  del(scene) {\n    const sceneId = scene._uid;\n    if (sceneId in this.meshCacheBySceneId) {\n      delete this.meshCacheBySceneId[sceneId];\n    }\n  }\n}\n\nconst ofNull = x => Maybe.fromNull(x);\n// private instance\nlet instance = null;\nexport default MeshCache;\n","import MeshCache from \"./MeshCache\";\nimport {\n  AssetsManager,\n  Quaternion,\n  Vector3,\n  VertexBuffer\n} from \"@babylonjs/core\";\nimport { ASSETS_TYPES } from \"../Utils/AssetsTypesFactory\";\nimport \"@babylonjs/loaders\";\n\nclass MeshLoader {\n  constructor(scene) {\n    this.scene = scene;\n  }\n\n  static of(scene) {\n    return new MeshLoader(scene);\n  }\n\n  load = (meshName, mapFunction = MeshLoader.transformMesh) =>\n    new Promise((re, rej) => {\n      const meshCache = MeshCache.getInstance();\n      if (meshCache.hasKey(meshName, this.scene)) {\n        console.log(`Found Mesh ${meshName} in cache for scene ${this.scene}`);\n        re(meshCache.get(meshName, this.scene));\n      } else {\n        console.log(\"Loading mesh....\");\n        const assetsManager = new AssetsManager(this.scene);\n        const meshTask = assetsManager.addMeshTask(\"\", \"\", MESH_URL, meshName);\n        meshTask.onSuccess = task => {\n          console.log(\"Load Success\", meshName);\n          const mesh = task.loadedMeshes[0];\n          mesh.name = meshName;\n          mesh.rotationQuaternion = Quaternion.Identity();\n          mesh.position = Vector3.Zero();\n          meshCache.put(meshName, this.scene, mesh);\n        };\n        meshTask.onError = (task, message, exception) => {\n          console.log(\"Load error =>\", message);\n          rej({\n            message,\n            exception,\n            assetName: meshName,\n            assetType: ASSETS_TYPES.Mesh\n          });\n        };\n        assetsManager.onFinish = task => {\n          console.log(\"Load finish \");\n          const meshParam = meshCache.get(meshName, this.scene);\n          if (meshParam !== null) re(mapFunction(meshParam));\n        };\n        assetsManager.load();\n      }\n    });\n\n  static getMeshUrl = src => `${MESH_URL}${src}`;\n  /**\n   * Side effect function\n   */\n  static transformMesh(mesh) {\n    const theta = Math.PI / 2;\n    const positions = mesh.getVerticesData(VertexBuffer.PositionKind);\n    const normals = mesh.getVerticesData(VertexBuffer.NormalKind);\n    const newPos = new Float32Array(positions.length);\n    const newNormals = new Float32Array(positions.length);\n    const cos = Math.cos(theta);\n    const sin = Math.sin(theta);\n    const numberOfVertices = positions.length / 3;\n    for (let i = 0; i < numberOfVertices; i++) {\n      newPos[i * 3] = positions[i * 3];\n      newPos[i * 3 + 1] =\n        positions[i * 3 + 1] * cos - positions[i * 3 + 2] * sin;\n      newPos[i * 3 + 2] =\n        positions[i * 3 + 1] * sin - positions[i * 3 + 2] * cos;\n      newNormals[i * 3] = normals[i * 3];\n      newNormals[i * 3 + 1] =\n        normals[i * 3 + 1] * cos - normals[i * 3 + 2] * sin;\n      newNormals[i * 3 + 2] =\n        normals[i * 3 + 1] * sin - normals[i * 3 + 2] * cos;\n    }\n    mesh.setVerticesData(VertexBuffer.PositionKind, newPos, true);\n    mesh.setVerticesData(VertexBuffer.NormalKind, newNormals, true);\n    return mesh;\n  }\n}\n\nconst MESH_URL = `/static/meshes/`;\nexport default MeshLoader;\n","import Robot from \"../NodeItem/Robot\";\nimport Action from \"./Action\";\nimport { Maybe } from \"monet\";\nimport React from \"react\";\nimport PointCloud from \"../NodeItem/PointCloud\";\nimport { ACTIONS } from \"../MainView/MainViewActions\";\nimport MeshLoader from \"../Utils/MeshLoader\";\nimport { UndoManager } from \"mov-fe-lib-core\";\n\nclass RobotAction extends Action {\n  constructor(\n    robot,\n    robotAnimatorFactory = (robot, parentView) =>\n      Robot.getDefaultAnimator(parentView)\n  ) {\n    super();\n    this.key = `robotAction${robot.name}`;\n    this.name = robot.name;\n    this.robot = robot;\n    this.robotAnimatorFactory = robotAnimatorFactory;\n    this.icon = props => <i className=\"fas fa-robot\" {...props}></i>;\n  }\n\n  action = (parentView, errorCallback = () => {}) => {\n    super.action(parentView);\n    // If robot doesn't exists: Add robot\n    parentView\n      .getNodeFromTree(this.robot.name)\n      .orElseRun(() => this.addRobot(parentView, errorCallback));\n    // If robot already exist in node tree : Update robot if mesh is different\n    parentView.getNodeFromTree(this.robot.name).forEach(({ item }) => {\n      if (!item.mesh.id.includes(this.robot.meshName)) {\n        parentView.deleteNodeFromTreeUsingName(this.name, true, true);\n        this.addRobot(parentView, errorCallback);\n      }\n    });\n    parentView.setSelectedAction(ACTIONS().dragObjects);\n  };\n\n  addRobot(parentView, errorCallback = () => {}) {\n    parentView.getSceneMemory().forEach(memory => {\n      const { scene } = memory;\n      const actionMemoryClone = { ...this.memory };\n      const isImport = actionMemoryClone[\"isImport\"];\n      if (isImport)\n        this.loadRobot(scene, parentView, actionMemoryClone, errorCallback);\n      else {\n        parentView\n          .getUndoManager()\n          .doIt(this.getUndoAbleAction(parentView, scene, actionMemoryClone));\n      }\n    });\n    this.memory[\"isImport\"] = false;\n  }\n\n  getUndoAbleAction(parentView, scene, actionMemoryClone) {\n    return UndoManager.actionBuilder()\n      .doAction(() => {\n        this.loadRobot(scene, parentView, actionMemoryClone);\n      })\n      .undoAction(({ is2UpdateInServer = true }) => {\n        parentView.deleteNodeFromTreeUsingName(this.name, is2UpdateInServer);\n      })\n      .build();\n  }\n\n  loadRobot(scene, parentView, actionMemoryClone, errorCallback = () => {}) {\n    MeshLoader.of(scene)\n      .load(this.robot.meshName)\n      .then(mesh =>\n        this.createRobotFromMesh(mesh, scene, parentView, actionMemoryClone)\n      )\n      .catch(err => errorCallback(err));\n  }\n\n  createRobotFromMesh(mesh, scene, parentView, memory) {\n    const parentMesh = this.getParentMesh(parentView);\n    const isImport = Maybe.fromNull(memory.isImport).orSome(false);\n    const isVisible = Maybe.fromNull(memory.isVisible).orSome(true);\n    mesh.setEnabled(isVisible);\n\n    const robot = this.getRobot(scene, mesh, parentMesh, parentView);\n    robot.animate(this.robotAnimatorFactory(robot, parentView));\n    parentView.addNodeItem2Tree(robot, parentMesh.name, !isImport, isVisible);\n\n    const cloudPoint = this.getCloudPoint(scene, parentView, robot);\n    parentView.addNodeItem2Tree(cloudPoint, robot.name, false, isVisible);\n  }\n\n  getRobot = (scene, mesh, parentMesh, parentView) => {\n    const meshTree = Robot.createRobotMeshTree(\n      this.robot.robotTree,\n      mesh,\n      scene\n    );\n    const dict = Maybe.fromNull(this.memory[\"nodeItemDict\"]);\n    return Robot.builder()\n      .id(this.robot.id)\n      .name(Maybe.fromNull(this.memory[\"name\"]).orSome(this.robot.name))\n      .assetName(\n        Maybe.fromNull(this.memory[\"assetName\"]).orSome(this.robot.name)\n      )\n      .meshTree(meshTree)\n      .parentMesh(parentMesh)\n      .parentView(parentView)\n      .scene(scene)\n      .keyValueMap(dict.map(x => x.keyValueMap).orSome({}))\n      .build();\n  };\n\n  getCloudPoint = (scene, parentView, robot) => {\n    const cloudPoint = PointCloud.ofDict(\n      scene,\n      { name: this.robot.name, id: this.robot.id },\n      parentView\n    );\n    cloudPoint.mesh.parent = robot.mesh;\n    return cloudPoint;\n  };\n\n  getParentMesh = parentView => {\n    return Maybe.fromNull(this.memory[\"parentObj\"])\n      .map(parentObj => parentObj.parent)\n      .flatMap(parentName => parentView.getNodeFromTree(parentName))\n      .map(treeNode => treeNode.item.mesh)\n      .orSome(parentView.getRootNode().item.mesh);\n  };\n\n  getType = () => RobotAction.TYPE;\n\n  static TYPE = \"RobotAction\";\n}\n\nexport default RobotAction;\n","import AssetNodeItem from \"./AssetNodeItem\";\n\nclass Mesh extends AssetNodeItem {\n  constructor(mesh, assetName, keyValueMap = {}) {\n    super(mesh, assetName, keyValueMap);\n  }\n\n  toDict() {\n    let dict = super.toDict();\n    return dict;\n  }\n\n  getMouseContextActions(mainView) {\n    return super\n      .getMouseContextActions(mainView)\n      .filter(x => x.title === \"Delete\");\n  }\n\n  getType = () => Mesh.TYPE;\n  static TYPE = \"Mesh\";\n}\n\nexport default Mesh;\n","import Action from \"./Action\";\nimport React from \"react\";\nimport { ACTIONS } from \"../MainView/MainViewActions\";\nimport MeshLoader from \"../Utils/MeshLoader\";\nimport { Maybe } from \"monet\";\nimport Mesh from \"../NodeItem/Mesh\";\nimport { Vector3, Quaternion, Color3, StandardMaterial } from \"@babylonjs/core\";\nimport { UndoManager } from \"mov-fe-lib-core\";\n\n//\nclass AddMeshAction extends Action {\n  constructor(mesh) {\n    super();\n    this.key = mesh.id;\n    this.name = mesh.name;\n    this.icon = props => <i {...props} className=\"fas fa-draw-polygon\"></i>;\n  }\n\n  action(parentView) {\n    super.action(parentView);\n    console.log(`Mesh ${this.key} : ${this.name}`, this.memory);\n    this.addMesh(parentView);\n    parentView.setSelectedAction(ACTIONS().dragObjects);\n  }\n\n  addMesh = parentView => {\n    parentView.getSceneMemory().forEach(memory => {\n      const { scene } = memory;\n      const actionMemoryClone = { ...this.memory };\n      const isImport = this.getIsImport(actionMemoryClone);\n      const finalName = this.getFinalNameFromMemory(\n        actionMemoryClone,\n        isImport\n      );\n      if (isImport) {\n        this.loadMesh(\n          parentView,\n          scene,\n          actionMemoryClone,\n          isImport,\n          finalName\n        );\n      } else {\n        parentView\n          .getUndoManager()\n          .doIt(\n            this.getUndoAbleAction(\n              parentView,\n              scene,\n              actionMemoryClone,\n              isImport,\n              finalName\n            )\n          );\n      }\n    });\n    this.memory[\"isImport\"] = false;\n  };\n\n  getIsImport(memory) {\n    return ofNull(memory[\"isImport\"]).orSome(false);\n  }\n\n  getFinalNameFromMemory(memory, isImport) {\n    return ofNull(memory[\"nodeItemDict\"])\n      .flatMap(d => (isImport ? some(d.name) : none()))\n      .orSome(`${this.name}${Math.floor(Math.random() * 100)}`);\n  }\n\n  getUndoAbleAction(parentView, scene, actionMemory, isImport, finalName) {\n    return UndoManager.actionBuilder()\n      .doAction(() => {\n        this.loadMesh(parentView, scene, actionMemory, isImport, finalName);\n      })\n      .undoAction(({ is2UpdateInServer = true }) => {\n        parentView.deleteNodeFromTreeUsingName(finalName, is2UpdateInServer);\n      })\n      .build();\n  }\n\n  loadMesh(parentView, scene, actionMemory, isImport, finalName) {\n    MeshLoader.of(scene)\n      .load(this.key)\n      .then(this.transformMesh(parentView, scene, actionMemory, isImport))\n      .then(this.addMesh2Scene(parentView, actionMemory, isImport, finalName));\n  }\n\n  transformMesh = (parentView, scene, actionMemory, isImport) => mesh => {\n    const parentMesh = this.getParentMesh(parentView);\n    mesh.parent = parentMesh;\n    mesh.createNormals();\n    const maybeDict = ofNull(actionMemory[\"nodeItemDict\"]);\n    mesh.position = maybeDict\n      .flatMap(d => (isImport ? some(d.position) : none()))\n      .map(Vector3.FromArray)\n      .orSome(Vector3.Zero());\n    mesh.rotationQuaternion = maybeDict\n      .flatMap(d => (isImport ? some(d.quaternion) : none()))\n      .map(\n        quaternion =>\n          new Quaternion(\n            quaternion[1],\n            quaternion[2],\n            quaternion[3],\n            quaternion[0]\n          )\n      )\n      .orSome(Quaternion.Identity());\n    const material = new StandardMaterial(`Mesh${mesh.name}`, scene);\n    const color = maybeDict\n      .flatMap(d => (isImport ? some(d.color) : none()))\n      .map(Color3.FromArray)\n      .orSome(Color3.Gray());\n    material.diffuseColor = color;\n    material.emissiveColor = color;\n    mesh.material = material;\n    return mesh;\n  };\n\n  addMesh2Scene = (parentView, actionMemory, isImport, finalName) => mesh => {\n    const parentMesh = this.getParentMesh(parentView);\n    mesh.name = finalName;\n    const meshItem = new Mesh(\n      mesh,\n      this.name,\n      ofNull(actionMemory[\"nodeItemDict\"])\n        .flatMap(x => (isImport ? some(x.keyValueMap) : none()))\n        .orSome({})\n    );\n\n    parentView.addNodeItem2Tree(meshItem, parentMesh.name, !isImport);\n    parentView.renderMenus();\n  };\n\n  getParentMesh = parentView => {\n    return ofNull(this.memory[\"parentObj\"])\n      .map(parentObj => parentObj.parent)\n      .flatMap(parentName => parentView.getNodeFromTree(parentName))\n      .map(treeNode => treeNode.item.mesh)\n      .orSome(parentView.getRootNode().item.mesh);\n  };\n\n  getType = () => AddMeshAction.TYPE;\n  static TYPE = \"AddMeshAction\";\n\n  deleteAsset = () => {};\n\n  download = async () => {};\n}\n\nconst ofNull = Maybe.fromNull;\nconst none = Maybe.none;\nconst some = Maybe.some;\nexport default AddMeshAction;\n","import AddMapAction from \"../Actions/AddMapAction\";\nimport RobotAction from \"../Actions/RobotAction\";\nimport Robot from \"../NodeItem/Robot\";\nimport AddMeshAction from \"../Actions/AddMeshAction\";\n\nexport const ASSETS_TYPES = {\n  Map: \"Map\",\n  Robot: \"Robot\",\n  Mesh: \"Mesh\"\n};\n\nexport const AssetsTypesFactory = {\n  Map: map => new AddMapAction(map.name, map.loader),\n  Robot: robot => new RobotAction(robot, Robot.getSocketAnimator),\n  Mesh: mesh => new AddMeshAction(mesh)\n};\n","import NodeItem from \"./NodeItem\";\nimport Vec3 from \"../Math/Vec3\";\nimport { Maybe } from \"monet\";\nimport Util3d from \"../Util3d/Util3d\";\nimport Constants from \"../Utils/Constants\";\nimport { Vector3, Color3, Observable, StandardMaterial } from \"@babylonjs/core\";\n/**\n * Will be deprecated\n */\nclass Wall extends NodeItem {\n  constructor(mesh, localWall, size, keyPoints = {}, keyValueMap = {}) {\n    super(mesh, keyValueMap);\n    this.localWall = localWall;\n    this.size = size;\n    this.keyPoints = keyPoints;\n  }\n\n  toDict() {\n    const dict = super.toDict();\n    dict.localWall = this.localWall;\n    dict.size = this.size;\n    return dict;\n  }\n\n  ofDict(scene, dict = null, mainView = null) {\n    return Wall.ofDict(scene, dict, mainView);\n  }\n\n  getType = () => Wall.TYPE;\n\n  static TYPE = \"Wall\";\n\n  static ofDict(scene, dict = null, mainView = null) {\n    if (!dict) throw new Error(\"null dictionary describing wall\");\n    const name = Maybe.fromNull(dict.name).orSome(\n      `Wall${Math.floor(Math.random() * 1e3)}`\n    );\n    const mesh = createWallMesh(dict, name, scene);\n\n    const material = new StandardMaterial(`WallMaterial${name}`, scene);\n    const color = new Color3(dict.color[0], dict.color[1], dict.color[2]);\n    material.diffuseColor = color;\n    material.emissiveColor = color;\n    mesh.material = material;\n    // babylonjs highlight shader flickers when floor intersect\n    mesh.position.z += 1e-3;\n\n    const keypoints = createPlaceHolderKeyPoints(\n      scene,\n      dict.localWall.map(x => Vec3.of(x).toBabylon()),\n      mesh,\n      mainView\n    );\n    return new Wall(\n      mesh,\n      dict.localWall,\n      dict.size,\n      keypoints,\n      dict.keyValueMap\n    );\n  }\n}\n\nconst RADIUS = Constants.RADIUS;\nconst FACES = [\n  [0, 1, 2],\n  [2, 3, 0],\n  [4, 6, 5],\n  [6, 4, 7],\n  [0, 5, 1],\n  [5, 0, 4],\n  [3, 2, 6],\n  [6, 7, 3],\n  [1, 6, 2],\n  [6, 1, 5],\n  [0, 3, 7],\n  [7, 4, 0]\n];\n\nfunction createWallMesh(dict, name, scene) {\n  const centeredWall = dict.localWall.map(x => Vec3.of(x).toBabylon());\n  const middlePoint = Vec3.of(dict.position).toBabylon();\n  const tangent = centeredWall[1].subtract(centeredWall[0]).normalize();\n  const normal = new Vector3(-tangent.y, tangent.x, 0);\n  const shape = [\n    centeredWall[0].add(normal.scale(dict.size.width)),\n    centeredWall[0].subtract(normal.scale(dict.size.width)),\n    centeredWall[1].subtract(normal.scale(dict.size.width)),\n    centeredWall[1].add(normal.scale(dict.size.width))\n  ];\n  const h = new Vector3(0, 0, dict.size.height);\n  const wallMesh = {\n    positions: [\n      shape[0],\n      shape[1],\n      shape[2],\n      shape[3],\n      shape[0].add(h),\n      shape[1].add(h),\n      shape[2].add(h),\n      shape[3].add(h)\n    ],\n    faces: FACES\n  };\n  const mesh = Util3d.meshFromPositionAndFaces(\n    name,\n    scene,\n    wallMesh.positions,\n    wallMesh.faces\n  );\n  mesh.position = middlePoint;\n  return mesh;\n}\n\nfunction createNewMeshFromOldUsingNewPoints(newWall, scene, mesh, item) {\n  const average = Util3d.pointAverageVec3(\n    newWall.localWall.map(x => Vec3.of(x))\n  );\n  newWall.position = average.toArray();\n  newWall.localWall = newWall.localWall.map(x =>\n    Vec3.of(x).sub(average).toArray()\n  );\n\n  const newMesh = createWallMesh(newWall, mesh.name, scene);\n  newMesh.position = mesh.position;\n  newMesh.rotationQuaternion = mesh.rotationQuaternion;\n  newMesh.locallyTranslate(average.toBabylon());\n  newMesh.material = mesh.material;\n  newMesh.visibility = mesh.visibility;\n  newMesh.parent = mesh.parent;\n  newMesh.getMouseContextActions = mesh.getMouseContextActions;\n  newMesh.nodeItem = mesh.nodeItem;\n\n  item.mesh = newMesh;\n  item.localWall = newWall.localWall;\n\n  const childrenCopy = [...mesh._children];\n  childrenCopy.forEach(c => {\n    mesh.removeChild(c);\n    c.parent = newMesh;\n  });\n  item.keyPoints.forEach((k, j) => {\n    k.position = Vec3.of(newWall.localWall[j]).toBabylon();\n  });\n  // dispose old mesh\n  mesh.dispose();\n}\n\nconst getKeyPointObserverFunction = (mainView, scene) => {\n  return ({ updatedPointMesh, is2updateServer }) => {\n    mainView.getNodeFromTree(updatedPointMesh.parent.name).forEach(wallNode => {\n      const index = updatedPointMesh.index;\n      const item = wallNode.item;\n      const mesh = item.mesh;\n      let newWall = {\n        position: Vec3.ofBabylon(mesh.position).toArray(),\n        localWall: item.localWall,\n        size: item.size\n      };\n      newWall.localWall[index] = Vec3.ofBabylon(\n        updatedPointMesh.position\n      ).toArray();\n\n      createNewMeshFromOldUsingNewPoints(newWall, scene, mesh, item);\n\n      if (is2updateServer) {\n        mainView.updateNodeInServer(mesh.name);\n      }\n    });\n  };\n};\n\nconst createPlaceHolderKeyPoints = (scene, wall, wallMesh, mainView) => {\n  const keyPoints = [];\n  wall.forEach((p, i) => {\n    const keyPoint = Util3d.createSphere(\n      scene,\n      new Color3(0.25, 0.25, 0.25),\n      RADIUS,\n      `${wallMesh.name}keyPointWall${i}`,\n      true\n    );\n    keyPoint.parent = wallMesh;\n    keyPoint.position = p;\n    keyPoint.index = i;\n    keyPoint.observers = new Observable();\n    keyPoint.observers.add(getKeyPointObserverFunction(mainView, scene));\n    keyPoints.push(keyPoint);\n  });\n  return keyPoints;\n};\n\nexport default Wall;\n","import GlobalRef from \"../NodeItem/GlobalRef\";\nimport Box from \"../NodeItem/Box\";\nimport KeyPoint from \"../NodeItem/KeyPoint\";\nimport Path from \"../NodeItem/Path\";\nimport Wall from \"../NodeItem/Wall\";\nimport BoxRegion from \"../NodeItem/BoxRegion\";\nimport PolygonRegion from \"../NodeItem/PolygonRegion\";\nimport GraphItem from \"../NodeItem/GraphItem\";\nimport NavigationPreviewItem from \"../NodeItem/NavigationPreviewItem\";\n\nconst NODE_ITEM_FACTORY_MAP = {\n  GlobalRef: GlobalRef,\n  Box: Box,\n  KeyPoint: KeyPoint,\n  Path: Path,\n  Wall: Wall,\n  BoxRegion: BoxRegion,\n  PolygonRegion: PolygonRegion,\n  GraphItem: GraphItem,\n  NavigationPreviewItem: NavigationPreviewItem\n};\n\nexport default NODE_ITEM_FACTORY_MAP;\n","import GlobalRef from \"../NodeItem/GlobalRef\";\nimport { Maybe } from \"monet\";\nimport { ASSETS_TYPES, AssetsTypesFactory } from \"../Utils/AssetsTypesFactory\";\nimport NODE_ITEM_FACTORY_MAP from \"./NodeItemFactoryMap\";\nimport Robot from \"../NodeItem/Robot\";\n\nclass MainViewRetriever {\n  static updateErrorList = () => {};\n\n  static importScene(\n    mainView,\n    serverScene = [],\n    parent = null,\n    is2addInServer = false,\n    updateErrorList = () => {}\n  ) {\n    console.log(\"Importing scene...\", mainView, serverScene);\n    MainViewRetriever.updateErrorList = updateErrorList;\n    const errors = [];\n    if (serverScene.length > 0) {\n      importSceneRecursive(\n        mainView,\n        serverScene,\n        parent,\n        errors,\n        is2addInServer\n      );\n    } else {\n      importDefaultScene(mainView);\n    }\n    console.log(\"End Importing scene\");\n    return errors;\n  }\n\n  static importNodeItem(mainView, nodeDict, parent, is2addInServer = false) {\n    const nodeItemClass = NODE_ITEM_FACTORY_MAP[nodeDict.type]; //retrieve default export\n    if (nodeItemClass) {\n      mainView.getSceneMemory().forEach(({ scene }) => {\n        const nodeItem = nodeItemClass.ofDict(scene, nodeDict, mainView);\n        // pseudo lazy migration of isVisible prop\n        const isVisible =\n          nodeDict.isVisible === undefined ? true : nodeDict.isVisible;\n        nodeItem.mesh.setEnabled(isVisible);\n        mainView.getNodeFromTree(parent).forEach(treeNode => {\n          nodeItem.mesh.parent = treeNode.item.mesh;\n        });\n        mainView.addNodeItem2Tree(\n          nodeItem,\n          parent,\n          is2addInServer,\n          isVisible,\n          false\n        );\n      });\n    }\n  }\n}\n\nfunction isAsset(nodeDict) {\n  return nodeDict.type in ASSETS_TYPES;\n}\n\nfunction importAsset(mainView, nodeDict, parent, errors) {\n  const assetType = nodeDict.type;\n  const assetName = Maybe.fromNull(nodeDict.assetName).orSome(nodeDict.name);\n  const assetActionMap = mainView.getAssetsActionMap();\n  // legacy\n  let retrievedAction = Maybe.fromNull(assetActionMap[assetName]).orLazy(\n    () => assetActionMap[assetName.split(\".\")[0]]\n  );\n  if (!retrievedAction && assetType === ASSETS_TYPES.Robot) {\n    const defaultRobot = Robot.createBaseObject({\n      robotName: assetName,\n      nodeDict\n    });\n    retrievedAction = AssetsTypesFactory.Robot(defaultRobot);\n  }\n  if (!retrievedAction) {\n    errors.push({\n      cause: `Asset of type ${assetType} with name ${assetName}, was not found`,\n      solution: `please upload ${assetType} ${assetName}`\n    });\n    return;\n  }\n  retrievedAction.memory[\"parentObj\"] = { parent: parent };\n  retrievedAction.memory[\"nodeItemDict\"] = nodeDict;\n  retrievedAction.memory[\"assetName\"] = assetName;\n  retrievedAction.memory[\"name\"] = nodeDict.name;\n  retrievedAction.memory[\"isImport\"] = true;\n  retrievedAction.memory[\"isVisible\"] =\n    nodeDict.isVisible === undefined ? true : nodeDict.isVisible;\n  // Execute action\n  retrievedAction.action(mainView, err => {\n    if (err?.exception?.name === \"RequestFileError\") {\n      errors.push({\n        cause: `Asset of type ${err.assetType} with name ${err.assetName}, was not found`,\n        solution: `please upload ${err.assetType} ${err.assetName}`\n      });\n      MainViewRetriever.updateErrorList(errors);\n    }\n  });\n}\n\nfunction importSceneRecursive(\n  mainView,\n  arrayTree,\n  parent = null,\n  errors = [],\n  is2addInServer = false\n) {\n  if (!arrayTree) return;\n  const sortArrayTree = arrayTree.sort((a, b) => {\n    // global ref is first\n    if (a.item.type === NODE_ITEM_FACTORY_MAP.GlobalRef.TYPE) return -1;\n    if (b.item.type === NODE_ITEM_FACTORY_MAP.GlobalRef.TYPE) return 1;\n    // graphItem is last\n    if (a.item.type === NODE_ITEM_FACTORY_MAP.GraphItem.TYPE) return 1;\n    if (b.item.type === NODE_ITEM_FACTORY_MAP.GraphItem.TYPE) return -1;\n    return a.name < b.name ? -1 : a.name > b.name ? 1 : 0;\n  });\n  sortArrayTree.forEach(node => {\n    if (isAsset(node.item)) {\n      importAsset(mainView, node.item, parent, errors);\n    } else {\n      MainViewRetriever.importNodeItem(\n        mainView,\n        node.item,\n        parent,\n        is2addInServer\n      );\n    }\n    if (node.children.length > 0) {\n      importSceneRecursive(\n        mainView,\n        node.children,\n        node.name,\n        errors,\n        is2addInServer\n      );\n    }\n  });\n}\n\nfunction importDefaultScene(mainView) {\n  mainView.getSceneMemory().forEach(({ scene }) => {\n    const send2server = true;\n    mainView.addNodeItem2Tree(GlobalRef.ofDict(scene), null, send2server);\n  });\n}\n\nexport default MainViewRetriever;\n","import { MasterDB } from \"mov-fe-lib-core\";\nimport Constants from \"./Constants\";\n\nclass SceneServerUtils {\n  static retrieveScene = (\n    sceneName,\n    successCallback = DEFAULT_SUCCESS,\n    failCallback = DEFAULT_FAILURE(\"retrieving scene\")\n  ) => {\n    MasterDB.cloudFunction(\n      Constants.CLOUD_FUNCTION_NAME,\n      \"retrieveScene\",\n      sceneName,\n      data => successFailIf(data, successCallback, failCallback)\n    );\n  };\n}\n\nconst DEFAULT_FAILURE = failureLocation => data => {};\n\nconst DEFAULT_SUCCESS = data => {};\n\nconst successFailIf = (data, successCallback, failCallback) => {\n  if (data.success) {\n    successCallback(data);\n  } else {\n    failCallback(data);\n  }\n};\nexport default SceneServerUtils;\n","import { Vector3 } from \"@babylonjs/core\";\nimport Vec3 from \"../Math/Vec3\";\nimport Util3d from \"../Util3d/Util3d\";\nimport { Animator } from \"./Animator\";\n\nexport default class DefaultMouseEvents {\n  static onPointerDown = mainView => evt => {\n    mainView.mousePosClick = mainView\n      .getMouseCoordsFromRoot()\n      .orSome(Vector3.Zero());\n    mainView.mousePosMove = mainView.mousePosClick;\n    mainView.sceneMemory.forEach(({ camera, canvas }) => {\n      if (evt.buttons === 2 || evt.buttons === 4 || evt.ctrlKey) {\n        camera.detachControl(canvas);\n      }\n    });\n  };\n\n  static onPointerUp = mainView => () => {\n    mainView.sceneMemory.forEach(({ camera, canvas }) => {\n      camera.attachControl(canvas, true);\n    });\n  };\n\n  static onPointerMove = mainView => evt => {\n    mainView.sceneMemory.forEach(({ mouseLocationText, camera }) => {\n      mainView.getMouseCoordsFromRoot().forEach(currentLocal => {\n        setMouseLocationTxt(mouseLocationText, currentLocal);\n        const panCamera = () => {\n          const v = currentLocal.subtract(mainView.mousePosMove);\n          const vBabylon = getWorldVector(mainView, v);\n          animateCamera(camera, vBabylon.scale(-1));\n          mainView.mousePosMove = currentLocal;\n        };\n        const mouseButtonActions = [\n          { predicate: evt.ctrlKey && evt.buttons === 1, action: panCamera },\n          { predicate: evt.buttons === 4, action: panCamera }\n        ];\n        const filterActions = mouseButtonActions.filter(\n          ({ predicate }) => predicate\n        );\n        if (filterActions.length > 0) filterActions[0].action();\n      });\n    });\n  };\n}\n\nfunction animateCamera(camera, v) {\n  Animator.builder()\n    .initialState({\n      camera: camera,\n      time: 0,\n      T: new Date().getTime()\n    })\n    .nextState(s => {\n      const { camera, time } = s;\n      const dt = 0.1; //(new Date().getTime() - T) / 1000;\n      const vdt = v.scale(dt);\n      camera.position = camera.position.add(vdt);\n      camera.setTarget(camera.target.add(vdt));\n      return {\n        camera: camera,\n        time: time + dt,\n        T: new Date().getTime()\n      };\n    })\n    .while(s => s.time <= 1)\n    .build()\n    .play();\n}\n\nfunction setMouseLocationTxt(mouseLocationText, currentLocal) {\n  mouseLocationText.text = `x: ${currentLocal.x.toFixed(\n    2\n  )}, y: ${currentLocal.y.toFixed(2)}`;\n}\n\nfunction getWorldVector(mainView, vector3) {\n  const worldFrameMesh = mainView.getRootNode().item.mesh.parent;\n  // compute world coordinates from GlobalRef (similar to Util3d.getBabylonCoordinates)\n  const matrix = Util3d.getRotationMatrix(worldFrameMesh);\n  const scale = Vec3.ofBabylon(worldFrameMesh.scaling);\n  const vBabylon = matrix\n    .prodVec(scale.mul(Vec3.ofBabylon(vector3)))\n    .toBabylon();\n  return vBabylon;\n}\n","import React, { Component } from \"react\";\nimport BaseViewer from \"./BaseViewer/BaseViewer\";\nimport PropTypes from \"prop-types\";\nimport { HighlightLayer, Vector3 } from \"@babylonjs/core\";\nimport { Maybe } from \"monet\";\nimport MainViewRetriever from \"./MainView/MainViewRetriever\";\nimport DefaultScene from \"./Utils/DefaultScene\";\nimport GlobalRef from \"./NodeItem/GlobalRef\";\nimport SceneServerUtils from \"./Utils/SceneServerUtils\";\nimport TreeServerUtils from \"./Utils/TreeServerUtils\";\nimport AssetsManager from \"./AssetsManager/AssetsManager\";\nimport TreeObject from \"./TreeObject/TreeObject\";\nimport GraphItem from \"./NodeItem/GraphItem\";\nimport DefaultMouseEvents from \"./Utils/DefaultMouseEvents\";\nimport Util3d from \"./Util3d/Util3d\";\nimport Vec3 from \"./Math/Vec3\";\nimport ReactResizeDetector from \"react-resize-detector\";\nimport { UndoManager, RobotManager } from \"mov-fe-lib-core\";\nimport ConfirmAlertModal from \"../Modal/ConfirmAlertModal\";\nimport RobotLogModal from \"../Modal/RobotLogModal\";\nimport MeshCache from \"./Utils/MeshCache\";\nimport Robot from \"./NodeItem/Robot\";\n\n//========================================================================================\n/*                                                                                      *\n *                                      SceneViewer                                     *\n *                                                                                      */\n//========================================================================================\n\nclass SceneViewer extends Component {\n  constructor(props) {\n    super(props);\n    this.state = { errorList: [] };\n    this.sceneName = props.sceneName.Value;\n    this.sceneMemory = Maybe.none();\n    this.objectTree = [];\n    this.undoManager = new UndoManager();\n    // camera properties\n    this.isPanned = false;\n    this.isRotated = false;\n    this.targetPos = undefined;\n    this.cameraSpeed = Vector3.Zero();\n    this.time = new Date().getTime() * 1e-3;\n    this.robotManager = new RobotManager();\n    this.robotAlertModal = React.createRef();\n  }\n\n  //========================================================================================\n  /*                                                                                      *\n   *                                   Getters & Setters                                  *\n   *                                                                                      */\n  //========================================================================================\n\n  getRobotManager = () => this.robotManager;\n\n  getSceneMemory = () => this.sceneMemory;\n\n  getAssetsActionMap = () => AssetsManager.getInstance().getAssetsActionMap();\n\n  getRootNode = (tree = [...this.objectTree]) => {\n    return tree.filter(x => x.title === GlobalRef.NAME)[0];\n  };\n\n  getObjectTree = () => this.objectTree;\n\n  setSelectedAction = () => {\n    /* empty */\n  };\n\n  getGraph() {\n    return new TreeObject(this.objectTree).getNode(\n      x => GraphItem.TYPE === x.item.getType()\n    );\n  }\n\n  getRobots() {\n    return this.getRootNode()\n      .children.filter(x => x.item.getType() === Robot.TYPE)\n      .map(el => el.item);\n  }\n\n  getUndoManager = () => this.undoManager;\n\n  //========================================================================================\n  /*                                                                                      *\n   *                                    Utils functions                                   *\n   *                                                                                      */\n  //========================================================================================\n\n  getNodeFromTree = (name, objectTree = [...this.objectTree]) => {\n    return TreeServerUtils.ofScene(\n      this.sceneName,\n      this.undoManager\n    ).getNodeFromTree(name, objectTree);\n  };\n\n  deleteNodeFromTreeUsingName = () => {\n    throw new Error(\"Delete Node in viewer Exception\");\n  };\n\n  updateNodeInServer = (name, oldName = null) => {\n    TreeServerUtils.ofScene(\n      this.sceneName,\n      this.undoManager\n    ).updateNodeInServer(name, [...this.objectTree], oldName);\n  };\n\n  addNodeItem2Tree = (\n    nodeItem,\n    parentName = GlobalRef.NAME,\n    is2addInServer = true,\n    isVisible = true\n  ) => {\n    const newObjectTree = TreeServerUtils.ofScene(\n      this.sceneName,\n      this.undoManager\n    ).addNodeItem2Tree(\n      [...this.objectTree],\n      nodeItem,\n      parentName,\n      is2addInServer,\n      isVisible\n    );\n    this.objectTree = newObjectTree;\n  };\n\n  setCameraToTarget = () => {\n    this.sceneMemory.forEach(({ camera }) => {\n      const focusObject = this.isPanned ? \"\" : this.props.focusObject.Value;\n      this.getNodeFromTree(focusObject).forEach(x => {\n        console.log(\"Set Camera, Found Object\", x.item.mesh);\n        const dt = new Date().getTime() * 1e-3 - this.time;\n        this.time = new Date().getTime() * 1e-3;\n        const pos = x.item.mesh._absolutePosition.clone();\n        this.cameraSpeed = !this.targetPos\n          ? Vector3.Zero()\n          : pos.subtract(this.targetPos);\n        this.targetPos = pos;\n        camera.setTarget(pos);\n        camera.position = camera.position.add(this.cameraSpeed.scale(dt));\n        camera.beta = this.isRotated ? camera.beta : 0;\n        // move target object for debug\n        // const p = x.item.mesh.position;\n        // x.item.mesh.position = p.add(new Vector3(p.x, p.y, 0).scale(1e-2));\n      });\n    });\n  };\n\n  addCanvasEventListeners(canvas) {\n    const events = [\n      {\n        name: \"pointerdown\",\n        function: evt => this.onPointerDown(evt)\n      },\n      { name: \"pointerup\", function: evt => this.onPointerUp(evt) },\n      {\n        name: \"pointermove\",\n        function: evt => this.onPointerMove(evt)\n      }\n    ];\n    events.forEach(event =>\n      canvas.addEventListener(event.name, event.function, false)\n    );\n  }\n\n  onPointerDown = evt => {\n    this.isRotated = true;\n    DefaultMouseEvents.onPointerDown(this)(evt);\n  };\n\n  onPointerUp = evt => {\n    DefaultMouseEvents.onPointerUp(this)(evt);\n  };\n\n  onPointerMove = evt => {\n    if (evt.buttons === 4) this.isPanned = true;\n    DefaultMouseEvents.onPointerMove(this)(evt);\n  };\n\n  getMouseCoordsFromRoot() {\n    // TODO: code repetition in mainView\n    return this.sceneMemory.flatMap(({ scene, ground }) => {\n      const maybeCurrent = Util3d.getGroundPosition(scene, ground);\n      return maybeCurrent.flatMap(current =>\n        Maybe.fromNull(this.getRootNode()).map(rootNode =>\n          Util3d.getLocalCoordFromWorld(\n            rootNode.item.mesh,\n            Vec3.ofBabylon(current)\n          ).toBabylon()\n        )\n      );\n    });\n  }\n\n  onResize = (w, h) => {\n    if (w === 0 && h === 0) return;\n    this.getSceneMemory().forEach(({ mouseLocationText }) => {\n      mouseLocationText.left = -w / 2 + w / 17;\n      mouseLocationText.top = -h / 2 + h / 30;\n    });\n  };\n\n  //========================================================================================\n  /*                                                                                      *\n   *                                    Scene functions                                   *\n   *                                                                                      */\n  //========================================================================================\n\n  retrieveSceneFromServer = (afterLoading = () => {}) => {\n    SceneServerUtils.retrieveScene(this.sceneName, data => {\n      const errorList = MainViewRetriever.importScene(this, data.result);\n      this.resizeGround();\n      this.setState({ errorList });\n      afterLoading();\n    });\n  };\n\n  loadAssets = async () => {\n    const assetManager = AssetsManager.getInstance();\n    if (Object.values(assetManager.getAssets()).length === 0) {\n      await assetManager.load();\n    }\n  };\n\n  loadScene = async () => {\n    await this.loadAssets();\n    this.retrieveSceneFromServer(this.renderScene);\n  };\n\n  renderScene = () => {\n    this.getSceneMemory().forEach(({ engine, scene }) =>\n      engine.runRenderLoop(() => {\n        this.time = new Date().getTime() * 1e-3;\n        scene.render();\n        this.setCameraToTarget();\n      })\n    );\n  };\n\n  onSceneReady = scene => {\n    const engine = scene.getEngine();\n    const canvas = engine.getRenderingCanvas();\n    this.addCanvasEventListeners(canvas);\n    const mouseLocationText = DefaultScene.createMouseLocationText(scene);\n    this.sceneMemory = Maybe.some({\n      engine: engine,\n      canvas: canvas,\n      scene: scene,\n      camera: DefaultScene.createCamera(scene, canvas),\n      light: DefaultScene.createLight(scene),\n      ground: DefaultScene.createMeshGround(scene),\n      gizmoManager: DefaultScene.createGizmo(scene),\n      highlightLayer: {\n        layer: new HighlightLayer(\"hl1\", scene),\n        lastHlMeshes: []\n      },\n      mouseLocationText: mouseLocationText\n    });\n    return scene;\n  };\n\n  resizeGround(defaultSize = 30) {\n    this.getSceneMemory().forEach(memory => {\n      memory.ground.dispose();\n      const scene = memory.scene;\n      const { max, min } = scene.getWorldExtends();\n      let diff = max.subtract(min);\n      let is2Small = false;\n      if (diff.length() < defaultSize) {\n        diff = new Vector3(defaultSize, 0, defaultSize);\n        is2Small = true;\n      }\n      memory.ground = DefaultScene.createMeshGround(scene, diff.x, diff.z);\n      memory.ground.position = new Vector3(\n        min.x + (is2Small ? 0 : diff.x / 2),\n        memory.ground.position.y,\n        min.z + (is2Small ? 0 : diff.z / 2)\n      );\n    });\n  }\n\n  showRobotAlertModal = alert => {\n    this.robotAlertModal.current.open(alert);\n  };\n\n  showAlert = (message, type) => {\n    alert(`type:${type} ` + message);\n  };\n\n  //========================================================================================\n  /*                                                                                      *\n   *                                   Render functions                                   *\n   *                                                                                      */\n  //========================================================================================\n\n  renderMenus = () => {\n    // to implement interface of MainView\n  };\n\n  componentDidUpdate = prevProps => {\n    const predicateAction = [\n      {\n        propVar: x => x.sceneName.Value,\n        action: () => (this.sceneName = this.props.sceneName.Value)\n      },\n      {\n        propVar: x => x.focusObject.Value,\n        action: () => {\n          this.isPanned = false;\n          this.isRotated = false;\n          this.setCameraToTarget();\n        }\n      }\n    ];\n    predicateAction.forEach(({ propVar, action }) => {\n      if (propVar(this.props) !== propVar(prevProps)) {\n        action();\n      }\n    });\n  };\n\n  componentDidMount = () => {\n    console.log(\"SceneViewer Did Mount!! \");\n    this.loadScene();\n  };\n\n  componentWillUnmount() {\n    this.sceneMemory.forEach(({ scene }) => {\n      // Unsubscribe robots from robot logger\n      this.getRobots().forEach(nodeItem => {\n        nodeItem.dispose();\n        if (nodeItem.loggerSubscription)\n          nodeItem.robot.unsubscribeToLogs(nodeItem.loggerSubscription);\n      });\n      // Clear observers and clean scene objects\n      AssetsManager.getInstance().clearObserver(scene);\n      MeshCache.getInstance().del(scene);\n      delete this.objectTree;\n      delete this.sceneMemory;\n      delete this.undoManager;\n    });\n  }\n\n  render() {\n    const { errorList } = this.state;\n    const resetErrorList = () => this.setState({ errorList: [] });\n    return (\n      <div style={{ display: \"flex\", flexGrow: 1, maxHeight: \"100%\" }}>\n        <BaseViewer\n          onSceneReady={this.onSceneReady}\n          is2render={false}\n          sceneFactory={DefaultScene.createScene}\n        />\n        <ConfirmAlertModal\n          onSubmit={resetErrorList}\n          onCancel={resetErrorList}\n          open={errorList?.length > 0}\n          title={\"Scene Viewer\"}\n          message={\"An error occurred while loading the scene\"}\n          submitText={\"OK\"}\n          submitColor={\"primary\"}\n          cancelText={\"Cancel\"}\n          cancelColor={\"secondary\"}\n        >\n          {getErrorSolutionList(errorList)}\n        </ConfirmAlertModal>\n        <RobotLogModal ref={this.robotAlertModal} title=\"Alert\" />\n        <ReactResizeDetector\n          handleWidth\n          handleHeight\n          onResize={this.onResize}\n        />\n      </div>\n    );\n  }\n\n  //========================================================================================\n  /*                                                                                      *\n   *                                   Static functions                                   *\n   *                                                                                      */\n  //========================================================================================\n\n  static getComponentFactory(sceneName) {\n    return masterProps => {\n      const augmentProps = {\n        sceneName,\n        ...masterProps\n      };\n      return <SceneViewer {...augmentProps} />;\n    };\n  }\n\n  static EXTENSION = \".3d\";\n}\n\nSceneViewer.propTypes = {\n  sceneName: PropTypes.shape({ Value: PropTypes.string }),\n  focusObject: PropTypes.shape({ Value: PropTypes.string })\n};\n\nSceneViewer.defaultProps = {\n  sceneName: { Value: \"Pedro\" },\n  focusObject: { Value: \"\" }\n};\n\nfunction getErrorSolutionList(errorList) {\n  return !errorList ? (\n    []\n  ) : (\n    <ul>\n      {errorList.map(({ cause, solution }, i) => {\n        return <li key={\"error\" + i}>{`${cause}, ${solution}`}</li>;\n      })}\n    </ul>\n  );\n}\n\nexport default SceneViewer;\n","import React from \"react\";\nimport { makeStyles } from \"@material-ui/core/styles\";\nimport InputLabel from \"@material-ui/core/InputLabel\";\nimport MenuItem from \"@material-ui/core/MenuItem\";\nimport FormControl from \"@material-ui/core/FormControl\";\nimport MaterialSelect from \"@material-ui/core/Select\";\nimport PropTypes from \"prop-types\";\n\nconst useStyles = makeStyles(theme => ({\n  formControl: {\n    margin: theme.spacing(1),\n    minWidth: 120\n  }\n}));\n\nconst Select = props => {\n  const classes = useStyles();\n\n  let noneOption = <div></div>;\n  if (props.noneOption) {\n    noneOption = (\n      <MenuItem value=\"\">\n        <em>None</em>\n      </MenuItem>\n    );\n  }\n\n  return (\n    <FormControl\n      variant={props.variant}\n      className={classes.formControl}\n      style={props.style}\n      hiddenLabel={props.label === undefined ? true : false}\n    >\n      <InputLabel id=\"movai-react-select\">{props.label}</InputLabel>\n      <MaterialSelect\n        labelId=\"movai-react-select\"\n        id={props.id}\n        value={props.value}\n        onChange={props.onChange}\n        inputProps={props.inputProps}\n      >\n        {noneOption}\n        {props.options.map((element, index) => {\n          return (\n            <MenuItem key={index} value={element}>\n              {element}\n            </MenuItem>\n          );\n        })}\n      </MaterialSelect>\n    </FormControl>\n  );\n};\n\nSelect.propTypes = {\n  value: PropTypes.string,\n  options: PropTypes.array,\n  noneOption: PropTypes.bool,\n  label: PropTypes.string,\n  variant: PropTypes.string,\n  style: PropTypes.object,\n  onChange: PropTypes.func,\n  id: PropTypes.string,\n  inputProps: PropTypes.object\n};\nSelect.defaultProps = {\n  value: \"option2\",\n  options: [\"option1\", \"option2\", \"option3\"],\n  variant: \"filled\",\n  noneOption: true,\n  onChange: evt => console.log(evt.target.value),\n  id: \"movai-react-select\"\n};\n\nexport default Select;\n","// import * as React from \"react\";\n// import SvgIcon from \"@material-ui/core/SvgIcon\";\n\n// export default function createSvgIcon({\n//   path = \"\",\n//   style = {},\n//   fill = \"#fff\",\n//   width = \"100%\",\n//   className = \"\",\n//   height = \"100%\",\n//   viewBox = \"0 0 32 32\"\n// }) {\n//   return (\n//     <svg\n//       width={width}\n//       style={style}\n//       height={height}\n//       viewBox={viewBox}\n//       className={className}\n//       xmlns=\"http://www.w3.org/2000/svg\"\n//       xmlnsXlink=\"http://www.w3.org/1999/xlink\"\n//     >\n//       <path d={path} fill={fill} />\n//     </svg>\n//   );\n// }\n\n// export default function createSvgIcon(path, displayName) {\n//   const Component = React.memo(\n//     React.forwardRef((props, ref) => (\n//       <SvgIcon data-mui-test={`${displayName}Icon`} ref={ref} {...props}>\n//         {path}\n//       </SvgIcon>\n//       <SvgIcon>\n//         {path}\n//       </SvgIcon>\n//     ))\n//   );\n\n//   if (process.env.NODE_ENV !== \"production\") {\n//     Component.displayName = `${displayName}Icon`;\n//   }\n\n//   Component.muiName = SvgIcon.muiName;\n\n//   return Component;\n// }\n\nimport React from \"react\";\n\nconst CreateSVGIcon = ({\n  path = \"\",\n  style = {},\n  fill = \"#fff\",\n  width = \"100%\",\n  height = \"100%\",\n  className = \"\",\n  viewBox = \"0 0 24 24\"\n}) => (\n  <svg\n    width={width}\n    style={style}\n    height={height}\n    viewBox={viewBox}\n    xmlns=\"http://www.w3.org/2000/svg\"\n    className={`svg-icon ${className || \"\"}`}\n    xmlnsXlink=\"http://www.w3.org/1999/xlink\"\n  >\n    <path fill={fill} d={path} />\n  </svg>\n);\n\nexport default CreateSVGIcon;\n","import React from \"react\";\nimport CreateSVGIcon from \"./CreateSVGIcon\";\n\nexport const svgIcons = {\n  Close: (\n    <CreateSVGIcon\n      width={24}\n      path=\"M19 6.41L17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z\"\n    />\n  ),\n  ErrorOutline: (\n    <CreateSVGIcon\n      width={24}\n      path=\"M11 15h2v2h-2zm0-8h2v6h-2zm.99-5C6.47 2 2 6.48 2 12s4.47 10 9.99 10C17.52 22 22 17.52 22 12S17.52 2 11.99 2zM12 20c-4.42 0-8-3.58-8-8s3.58-8 8-8 8 3.58 8 8-3.58 8-8 8z\"\n    ></CreateSVGIcon>\n  ),\n  InfoOutlined: (\n    <CreateSVGIcon\n      width={24}\n      path=\"M11,9H13V7H11M12,20C7.59,20 4,16.41 4,12C4,7.59 7.59,4 12,4C16.41,4 20,7.59 20, 12C20,16.41 16.41,20 12,20M12,2A10,10 0 0,0 2,12A10,10 0 0,0 12,22A10,10 0 0,0 22,12A10, 10 0 0,0 12,2M11,17H13V11H11V17Z\"\n    ></CreateSVGIcon>\n  ),\n  ReportProblemOutlined: (\n    <CreateSVGIcon\n      width={24}\n      path=\"M12 5.99L19.53 19H4.47L12 5.99M12 2L1 21h22L12 2zm1 14h-2v2h2v-2zm0-6h-2v4h2v-4z\"\n    ></CreateSVGIcon>\n  ),\n  SuccessOutlined: (\n    <CreateSVGIcon\n      width={24}\n      path=\"M20,12A8,8 0 0,1 12,20A8,8 0 0,1 4,12A8,8 0 0,1 12,4C12.76,4 13.5,4.11 14.2, 4.31L15.77,2.74C14.61,2.26 13.34,2 12,2A10,10 0 0,0 2,12A10,10 0 0,0 12,22A10,10 0 0, 0 22,12M7.91,10.08L6.5,11.5L11,16L21,6L19.59,4.58L11,13.17L7.91,10.08Z\"\n    ></CreateSVGIcon>\n  )\n};\n","import * as React from \"react\";\nimport PropTypes from \"prop-types\";\nimport clsx from \"clsx\";\nimport { withStyles } from \"@material-ui/core/styles\";\nimport IconButton from \"@material-ui/core/IconButton\";\nimport { capitalize } from \"@material-ui/core/utils\";\nimport { svgIcons } from \"./svg-icons/svgIcons\";\n\nexport const styles = () => {\n  return {\n    /* Styles applied to the root element. */\n    root: {\n      // borderRadius: theme.shape.borderRadius,\n      backgroundColor: \"transparent\",\n      display: \"flex\",\n      padding: \"6px 16px\"\n    },\n    /* Styles applied to the root element if `variant=\"filled\"` and `color=\"success\"`. */\n    filledSuccess: {\n      color: \"#fff\",\n      // fontWeight: theme.typography.fontWeightMedium,\n      backgroundColor: \"#4caf50\"\n    },\n    /* Styles applied to the root element if `variant=\"filled\"` and `color=\"info\"`. */\n    filledInfo: {\n      color: \"#fff\",\n      // fontWeight: theme.typography.fontWeightMedium,\n      backgroundColor: \"#2196f3\"\n    },\n    /* Styles applied to the root element if `variant=\"filled\"` and `color=\"warning\"`. */\n    filledWarning: {\n      color: \"#fff\",\n      // fontWeight: theme.typography.fontWeightMedium,\n      backgroundColor: \"#ff9800\"\n    },\n    /* Styles applied to the root element if `variant=\"filled\"` and `color=\"error\"`. */\n    filledError: {\n      color: \"#fff\",\n      // fontWeight: theme.typography.fontWeightMedium,\n      backgroundColor: \"#f44336\"\n    },\n    /* Styles applied to the icon wrapper element. */\n    icon: {\n      marginRight: 12,\n      padding: \"7px 0\",\n      display: \"flex\",\n      fontSize: 22,\n      opacity: 0.9\n    },\n    /* Styles applied to the message wrapper element. */\n    message: {\n      padding: \"8px 0\",\n      display: \"flex\",\n      flexDirection: \"column\",\n      justifyContent: \"center\"\n    },\n    /* Styles applied to the action wrapper element if `action` is provided. */\n    action: {\n      display: \"flex\",\n      alignItems: \"center\",\n      marginLeft: \"auto\",\n      paddingLeft: 16,\n      marginRight: -8\n    }\n  };\n};\n\nconst defaultIconMapping = {\n  success: svgIcons.SuccessOutlined,\n  warning: svgIcons.ReportProblemOutlined,\n  error: svgIcons.ErrorOutline,\n  info: svgIcons.InfoOutlined\n};\n\nconst Alert = props => {\n  const {\n    action,\n    children,\n    classes,\n    className,\n    closeText = \"Close\",\n    color,\n    icon,\n    iconMapping = defaultIconMapping,\n    onClose,\n    role = \"alert\",\n    severity = \"success\",\n    variant = \"standard\",\n    theme,\n    ...other\n  } = props;\n\n  return (\n    <div\n      className={clsx(\n        classes.root,\n        classes[`${variant}${capitalize(color || severity)}`],\n        className\n      )}\n      {...other}\n    >\n      {icon !== false ? (\n        <div className={classes.icon}>\n          {icon || iconMapping[severity] || defaultIconMapping[severity]}\n        </div>\n      ) : null}\n      <div className={classes.message}>{children}</div>\n      {action != null ? <div className={classes.action}>{action}</div> : null}\n      {action == null && onClose ? (\n        <div className={classes.action}>\n          <IconButton\n            size=\"small\"\n            aria-label={closeText}\n            title={closeText}\n            color=\"inherit\"\n            onClick={onClose}\n          >\n            {svgIcons.Close}\n          </IconButton>\n        </div>\n      ) : null}\n    </div>\n  );\n};\n\nAlert.propTypes = {\n  // ----------------------------- Warning --------------------------------\n  // | These PropTypes are generated from the TypeScript type definitions |\n  // |     To update them edit the d.ts file and run \"yarn proptypes\"     |\n  // ----------------------------------------------------------------------\n  /**\n   * The action to display. It renders after the message, at the end of the alert.\n   */\n  action: PropTypes.node,\n  /**\n   * The content of the component.\n   */\n  children: PropTypes.node,\n  /**\n   * Override or extend the styles applied to the component.\n   * See [CSS API](#css) below for more details.\n   */\n  classes: PropTypes.object,\n  /**\n   * @ignore\n   */\n  className: PropTypes.string,\n  /**\n   * Override the default label for the *close popup* icon button.\n   *\n   * For localization purposes, you can use the provided [translations](/guides/localization/).\n   */\n  closeText: PropTypes.string,\n  /**\n   * The main color for the alert. Unless provided, the value is taken from the `severity` prop.\n   */\n  color: PropTypes.oneOf([\"error\", \"info\", \"success\", \"warning\"]),\n  /**\n   * Override the icon displayed before the children.\n   * Unless provided, the icon is mapped to the value of the `severity` prop.\n   */\n  icon: PropTypes.node,\n  /**\n   * The component maps the `severity` prop to a range of different icons,\n   * for instance success to `<SuccessOutlined>`.\n   * If you wish to change this mapping, you can provide your own.\n   * Alternatively, you can use the `icon` prop to override the icon displayed.\n   */\n  iconMapping: PropTypes.shape({\n    error: PropTypes.node,\n    info: PropTypes.node,\n    success: PropTypes.node,\n    warning: PropTypes.node\n  }),\n  /**\n   * Callback fired when the component requests to be closed.\n   * When provided and no `action` prop is set, a close icon button is displayed that triggers the callback when clicked.\n   *\n   * @param {object} event The event source of the callback.\n   */\n  onClose: PropTypes.func,\n  /**\n   * The ARIA role attribute of the element.\n   */\n  role: PropTypes.string,\n  /**\n   * The severity of the alert. This defines the color and icon used.\n   */\n  severity: PropTypes.oneOf([\"error\", \"info\", \"success\", \"warning\"]),\n  /**\n   * The variant to use.\n   */\n  variant: PropTypes.oneOf([\"filled\", \"outlined\", \"standard\"])\n};\n\nexport default withStyles(styles, { name: \"MuiAlert\" })(Alert);\n","// Inspired from https://github.com/GA-MO/react-confirm-alert\n\nimport React, { Component } from \"react\";\nimport PropTypes from \"prop-types\";\nimport { render, unmountComponentAtNode } from \"react-dom\";\n// import { Alert } from \"@material-ui/lab\";\nimport Alert from \"./Alert/Alert\";\n\nimport \"./Snackbar.css\";\n\nimport { svgIcons } from \"./Alert/svg-icons/svgIcons\";\n\nclass ReactConfirmAlert extends Component {\n  static propTypes = {\n    message: PropTypes.string,\n    customUI: PropTypes.func,\n    closeOnClickOutside: PropTypes.bool,\n    closeOnEscape: PropTypes.bool,\n    willUnmount: PropTypes.func,\n    onClickOutside: PropTypes.func,\n    onKeypressEscape: PropTypes.func,\n    // new props\n    severity: PropTypes.string,\n    closeText: PropTypes.string,\n    autoHideDuration: PropTypes.number,\n    closable: PropTypes.bool\n  };\n\n  autoClose = null;\n\n  static defaultProps = {\n    closeOnClickOutside: true,\n    closeOnEscape: true,\n    willUnmount: () => null,\n    onClickOutside: () => null,\n    onKeypressEscape: () => null,\n    // new props\n    severity: \"info\", // error, warning, info or success\n    closeText: \"Close\",\n    autoHideDuration: 6000,\n    closable: true\n  };\n\n  handleClickButton = button => {\n    if (button.onClick) button.onClick();\n    this.close();\n  };\n\n  handleClickOverlay = e => {\n    const { closeOnClickOutside, onClickOutside } = this.props;\n    const isClickOutside = e.target === this.overlay;\n\n    if (closeOnClickOutside && isClickOutside) {\n      onClickOutside();\n      this.close();\n    }\n  };\n\n  close = () => {\n    removeBodyClass();\n    removeElementReconfirm();\n  };\n\n  keyboardClose = event => {\n    const { closeOnEscape, onKeypressEscape } = this.props;\n    const isKeyCodeEscape = event.keyCode === 27;\n\n    if (closeOnEscape && isKeyCodeEscape) {\n      onKeypressEscape(event);\n      this.close();\n    }\n  };\n\n  componentDidMount = () => {\n    document.addEventListener(\"keydown\", this.keyboardClose, false);\n    this.autoClose = setTimeout(() => {\n      if (\n        document.getElementById(\"react-confirm-alert\") ||\n        document.getElementById(\"react-confirm-alert-body-element\")\n      ) {\n        this.close();\n      }\n    }, this.props.autoHideDuration);\n  };\n\n  componentWillUnmount = () => {\n    document.removeEventListener(\"keydown\", this.keyboardClose, false);\n    clearTimeout(this.autoClose);\n    this.props.willUnmount();\n  };\n\n  renderCustomUI = () => {\n    const { title, message, customUI } = this.props;\n    const dataCustomUI = {\n      title,\n      message,\n      onClose: this.close\n    };\n\n    return customUI(dataCustomUI);\n  };\n\n  render() {\n    const {\n      message,\n      customUI,\n      severity,\n      closeText,\n      closable,\n      theme\n    } = this.props;\n\n    return (\n      <div\n        className=\"react-confirm-alert-overlay\"\n        ref={dom => (this.overlay = dom)}\n        onClick={this.handleClickOverlay}\n      >\n        <div className=\"react-confirm-alert\">\n          {customUI ? (\n            this.renderCustomUI()\n          ) : (\n            <div className=\"react-confirm-alert-body\">\n              <Alert\n                theme={theme}\n                elevation={6}\n                variant=\"filled\"\n                severity={severity}\n                closeText={closeText}\n                action={\n                  closable ? (\n                    <div\n                      className=\"icon-container\"\n                      onClick={() => this.close()}\n                    >\n                      {svgIcons.Close}\n                    </div>\n                  ) : (\n                    undefined\n                  )\n                }\n              >\n                {message}\n              </Alert>\n            </div>\n          )}\n        </div>\n      </div>\n    );\n  }\n}\n\nfunction createElementReconfirm(properties, theme) {\n  let divTarget = document.getElementById(\"react-confirm-alert\");\n  if (divTarget) {\n    // Rerender - the mounted ReactConfirmAlert\n    render(<ReactConfirmAlert {...properties} theme={theme} />, divTarget);\n  } else {\n    // Mount the ReactConfirmAlert component\n    document.body.children[0].classList.add(\"react-confirm-alert-blur\");\n    divTarget = document.createElement(\"div\");\n    divTarget.id = \"react-confirm-alert\";\n    document.body.appendChild(divTarget);\n    render(<ReactConfirmAlert {...properties} theme={theme} />, divTarget);\n  }\n}\n\nfunction removeElementReconfirm() {\n  const target = document.getElementById(\"react-confirm-alert\");\n  unmountComponentAtNode(target);\n  target.parentNode.removeChild(target);\n}\n\nfunction addBodyClass() {\n  document.body.classList.add(\"react-confirm-alert-body-element\");\n}\n\nfunction removeBodyClass() {\n  document.body.classList.remove(\"react-confirm-alert-body-element\");\n}\n\nexport function snackbar(properties, theme) {\n  addBodyClass();\n  createElementReconfirm(properties, theme);\n}\n\nexport default ReactConfirmAlert;\n","import { createMuiTheme } from \"@material-ui/core/styles\";\nimport \"fontsource-roboto\";\nimport \"fontsource-open-sans\";\n\nconst CONSTANTS = {\n  dark: {\n    borderBottom: \"1px solid #212121\",\n    textColor: \"white\",\n    background: {\n      primary: \"#424242\",\n      secondary: \"#212121\"\n    }\n  },\n  light: {\n    borderBottom: \"1px solid #ccc\",\n    textColor: \"rgba(0, 0, 0, 0.87)\",\n    background: {\n      primary: \"#e2e2e2\",\n      secondary: \"#b2b2b2\"\n    }\n  }\n};\n\nconst themeFactory = particular => ({\n  ...particular,\n  typography: {\n    fontFamily: \"Open Sans\",\n    h1: {\n      fontFamily: \"Open Sans\"\n    },\n    h2: {\n      fontFamily: \"Open Sans\"\n    },\n    h3: {\n      fontFamily: \"Open Sans\"\n    },\n    h4: {\n      fontFamily: \"Open Sans\"\n    },\n    h5: {\n      fontFamily: \"Open Sans\"\n    },\n    h6: {\n      fontFamily: \"Open Sans\"\n    },\n    body1: {\n      fontFamily: \"Roboto\"\n    }\n  },\n  cursorDefault: {\n    cursor: \"default\"\n  },\n  cursorPointer: {\n    cursor: \"pointer\"\n  }\n});\n\nconst Themes = {\n  dark: createMuiTheme(\n    themeFactory({\n      label: \"dark\",\n      textColor: CONSTANTS.dark.textColor,\n      backgroundColor:\n        \"linear-gradient(114.01deg, #212121 0%, #050505 100.43%)\",\n      bottomNavigation: { background: \"#212121\" },\n      globalStats: {\n        borderColor: \"#474747\",\n        subTextColor: \"#CDCDCD\",\n        upperTextColor: \"#E6E6E6\"\n      },\n      palette: {\n        type: \"dark\", // Switching the dark mode on, is a single property value change.\n        primary: {\n          main: \"#36b5e6\"\n        },\n        secondary: {\n          main: \"#CF6679\"\n        },\n        green: {\n          main: \"#03DAC5\"\n        },\n        background: {\n          primary: CONSTANTS.dark.background.primary,\n          secondary: CONSTANTS.dark.background.secondary\n        },\n        accent: {\n          background: \"#f5f5f9\",\n          color: \"rgba(0, 0, 0, 0.87)\",\n          border: \"#dadde9\"\n        }\n      },\n      icon: { color: \"#c6c6c6\", hoverColor: \"white\" },\n      table: { stripColor: \"#505050\" },\n      verticalBar: {\n        iconColor: \"#9e9e9e\"\n      },\n      overrides: {\n        MuiTableCell: {\n          body: {\n            color: CONSTANTS.dark.textColor\n          }\n        },\n        MuiAppBar: {\n          colorDefault: {\n            color: CONSTANTS.dark.textColor,\n            borderColor: \"black\",\n            backgroundColor: CONSTANTS.dark.background.secondary\n          },\n          colorInherit: {\n            color: CONSTANTS.dark.textColor,\n            backgroundColor: \"#353535\"\n          }\n        },\n        MuiButton: {\n          outlined: {\n            margin: \"8px\"\n          },\n          text: {\n            margin: \"8px\"\n          },\n          contained: {\n            margin: \"8px\"\n          },\n          containedPrimary: {\n            color: \"inherit\",\n            margin: \"8px\"\n          },\n          containedSecondary: {\n            color: \"inherit\",\n            margin: \"8px\"\n          }\n        },\n        MuiButtonGroup: {\n          root: {\n            margin: \"0\"\n          },\n          groupedContainedPrimary: {\n            margin: \"0\"\n          },\n          groupedOutlined: {\n            margin: \"0\"\n          },\n          groupedText: {\n            margin: \"0\"\n          }\n        },\n        MuiIconButton: {\n          root: {\n            color: \"#36b5e6\"\n          }\n        },\n        MuiListItem: {\n          button: {\n            \"&:hover\": {\n              backgroundColor: \"rgba(54,181,230, 0.15)\"\n            }\n          }\n        },\n        MuiFormControlLabel: {\n          label: {\n            color: \"rgba(255,255,255,0.8)\"\n          }\n        },\n        MuiInputBase: {\n          input: {\n            font: \"Roboto\"\n          }\n        },\n        MuiFilledInput: {\n          root: {\n            border: \"4px\"\n          },\n          underline: {\n            \"&::before\": {\n              borderRadius: \"4px\"\n            }\n          }\n        }\n      }\n    })\n  ),\n  light: createMuiTheme(\n    themeFactory({\n      font: {\n        Roboto: {\n          fontFamily: \"Roboto\"\n        },\n        OpenSans: {\n          fontFamily: \"Open Sans\"\n        }\n      },\n      label: \"light\",\n      textColor: CONSTANTS.light.textColor,\n      backgroundColor:\n        \"linear-gradient(122.19deg, #FFFFFF 2.58%, #FFFFFF 76.23%)\", // it was white before\n      bottomNavigation: { background: \"#c3c3c3\" },\n      icon: { color: \"#757575\", hoverColor: \"black\" },\n      table: { stripColor: \"whitesmoke\" },\n      globalStats: {\n        borderColor: \"#E6E6E6\",\n        subTextColor: \"#717171\",\n        upperTextColor: \"#474747\"\n      },\n      palette: {\n        primary: {\n          main: \"#007197\"\n        },\n        secondary: {\n          main: \"#BE2424\"\n        },\n        green: {\n          main: \"#03DAC5\"\n        },\n        background: {\n          primary: CONSTANTS.light.background.primary,\n          secondary: CONSTANTS.light.background.secondary\n        },\n        accent: {\n          background: \"whitesmoke\",\n          color: CONSTANTS.light.textColor,\n          border: \"darkgray\"\n        }\n      },\n      verticalBar: {\n        iconColor: \"#616161\"\n      },\n      overrides: {\n        MuiTableCell: {\n          body: {\n            color: CONSTANTS.light.textColor\n          }\n        },\n        MuiAppBar: {\n          colorDefault: {\n            color: CONSTANTS.light.textColor,\n            borderColor: CONSTANTS.light.borderBottom,\n            backgroundColor: CONSTANTS.light.background.secondary\n          },\n          colorInherit: {\n            color: CONSTANTS.light.textColor,\n            backgroundColor: \"#d2d2d2\"\n          }\n        },\n        MuiButton: {\n          outlined: {\n            margin: \"8px\"\n          },\n          text: {\n            margin: \"8px\"\n          },\n          contained: {\n            margin: \"8px\"\n          },\n          containedPrimary: {\n            color: \"white\",\n            margin: \"8px\"\n          },\n          containedSecondary: {\n            color: \"white\",\n            margin: \"8px\"\n          }\n        },\n        MuiButtonGroup: {\n          root: {\n            margin: \"0\"\n          },\n          groupedContainedPrimary: {\n            margin: \"0\"\n          },\n          groupedOutlined: {\n            margin: \"0\"\n          },\n          groupedText: {\n            margin: \"0\"\n          }\n        },\n        MuiIconButton: {\n          root: {\n            color: \"#007197\"\n          }\n        },\n        MuiListItem: {\n          button: {\n            \"&:hover\": {\n              backgroundColor: \"rgba(0,113,151, 0.15)\"\n            }\n          }\n        },\n        MuiFormControlLabel: {\n          label: {\n            color: \"rgba(0,0,0,0.8)\"\n          }\n        },\n        MuiInputBase: {\n          input: {\n            font: \"Roboto\"\n          }\n        },\n        MuiFilledInput: {\n          root: {\n            border: \"4px\"\n          },\n          underline: {\n            \"&::before\": {\n              borderRadius: \"4px\"\n            }\n          }\n        },\n        MuiPaper: {\n          root: {\n            color: \"#272727\",\n            backgroundColor: CONSTANTS.light.background.primary\n          }\n        },\n        MuiTableRow: {\n          head: {\n            \"& th\": {\n              backgroundColor: CONSTANTS.light.background.primary,\n              borderBottom: CONSTANTS.light.borderBottom\n            }\n          },\n          root: {\n            \"& td\": {\n              borderBottom: CONSTANTS.light.borderBottom\n            }\n          }\n        }\n      }\n    })\n  )\n};\n\nThemes.getTheme = () => {\n  const theme = window.localStorage.getItem(\"movai.theme\"); // dark or light\n  return theme ? theme : \"dark\";\n};\n\nThemes.setTheme = value => {\n  window.localStorage.setItem(\"movai.theme\", value);\n};\n\nexport default Themes;\n","import { createGlobalStyle } from \"styled-components\";\nimport { Style as S } from \"mov-fe-lib-core\";\n\nconst Style = createGlobalStyle`${S}`;\nexport default Style;\n","import React, { Component } from \"react\";\nimport { withStyles } from \"@material-ui/core/styles\";\nimport Menu from \"@material-ui/core/Menu\";\nimport { Typography, Tooltip } from \"@material-ui/core\";\nimport { fade } from \"@material-ui/core/styles/colorManipulator\";\nimport IconButton from \"@material-ui/core/IconButton\";\nimport PropTypes from \"prop-types\";\n\nconst styles = theme => ({\n  button: {\n    margin: theme.spacing(1),\n    color: theme.palette.primary.main,\n    borderColor: theme.palette.primary.main\n  },\n  iconActive: {\n    color: theme.palette.primary.main,\n    borderColor: theme.palette.primary.main,\n    backgroundColor: fade(theme.palette.primary.main, 0.1)\n  },\n  buttonApplyFilters: {\n    background: theme.palette.primary.main,\n    fontFamily: \"Roboto\",\n    fontStyle: \"normal\",\n    fontWeight: \"bold\",\n    fontSize: \"14px\",\n    color: \"#FAFAFA\",\n    margin: \"0px 20px 10px 20px\",\n    \"&:hover\": { background: theme.palette.primary.dark }\n  },\n  icon: {\n    // fontSize: \"18px\",\n    // height: \"21px\",\n    // width: \"15px\",\n    //color: theme.palette.primary.main,\n    \"&:hover\": { cursor: \"pointer\" }\n  },\n  height: { height: \"100%\" },\n  checkbox: { marginLeft: \"10px\" },\n  limitText: {\n    width: \"50px\",\n    margin: theme.spacing(0, 3, 0, 3)\n  }\n});\n\nconst StyledMenu = withStyles(theme => ({\n  paper: {\n    // border: \"1px solid #F0F0F0\",\n    borderRadius: \"8px\",\n    width: \"242px\",\n    height: \"411px\",\n    boxShadow: \"2px 2px 4px rgba(0, 0, 0, 0.25)\"\n  }\n}))(props => (\n  <Menu\n    elevation={0}\n    getContentAnchorEl={null}\n    anchorOrigin={{\n      vertical: \"bottom\",\n      horizontal: \"center\"\n    }}\n    transformOrigin={{\n      vertical: \"top\",\n      horizontal: \"center\"\n    }}\n    autoFocus={false}\n    {...props}\n  />\n));\n\nclass FilterIcon extends Component {\n  state = { anchorEl: null, otherFilters: [] };\n\n  handleClick = event => {\n    this.setState({ anchorEl: event.currentTarget });\n  };\n\n  handleClose = () => {\n    this.setState({\n      anchorEl: null,\n      otherFilters: []\n    });\n  };\n\n  render() {\n    const { classes, t, disabled, tooltip, title } = this.props;\n    return (\n      <React.Fragment>\n        <Tooltip title={tooltip || title}>\n          <IconButton\n            size=\"small\"\n            onClick={this.handleClick}\n            disabled={disabled}\n            className={this.props.isActive ? classes.iconActive : classes.icon}\n          >\n            {this.props.icon}\n          </IconButton>\n        </Tooltip>\n        <StyledMenu\n          id=\"customized-menu\"\n          anchorEl={this.state.anchorEl}\n          open={Boolean(this.state.anchorEl)}\n          onClose={this.handleClose}\n          className={classes.height}\n        >\n          <div\n            style={{\n              display: \"flex\",\n              flexDirection: \"column\",\n              height: \"-webkit-fill-available\"\n            }}\n          >\n            <Typography\n              component=\"div\"\n              style={{\n                padding: \"10px 10px 0px 20px\",\n                display: \"flex\",\n                flexDirection: \"row\"\n              }}\n            >\n              <Typography\n                component=\"div\"\n                style={{\n                  fontSize: \"24px\",\n                  fontFamily: \"Open Sans\",\n                  fontWeight: 500\n                }}\n              >\n                {this.props.title}\n              </Typography>\n              <Typography\n                component=\"div\"\n                style={{\n                  flexGrow: 1\n                }}\n              ></Typography>\n              <Typography\n                component=\"div\"\n                onClick={this.handleClose}\n                className={classes.icon}\n              >\n                <i className=\"fas fa-times\"></i>\n              </Typography>\n            </Typography>\n            <div\n              style={{\n                flexGrow: 1,\n                display: \"flex\",\n                flexDirection: \"column\",\n                margin: \"10px 0px 0px 10px\"\n              }}\n            >\n              {this.props.children}\n            </div>\n          </div>\n        </StyledMenu>\n      </React.Fragment>\n    );\n  }\n}\n\nFilterIcon.propTypes = {\n  isActive: PropTypes.bool,\n  disabled: PropTypes.bool,\n  tooltip: PropTypes.string,\n  title: PropTypes.string\n};\n\nFilterIcon.defaultProps = {\n  isActive: false,\n  disabled: false,\n  tooltip: \"\",\n  title: \"Filters\"\n};\n\nexport default withStyles(styles, { withTheme: true })(FilterIcon);\n","import React, { memo } from \"react\";\nimport InputAdornment from \"@material-ui/core/InputAdornment\";\nimport IconButton from \"@material-ui/core/IconButton\";\nimport SearchIcon from \"@material-ui/icons/Search\";\nimport { makeStyles } from \"@material-ui/core/styles\";\nimport {\n  AppBar,\n  FormControlLabel,\n  Switch,\n  TextField,\n  Toolbar\n} from \"@material-ui/core\";\nimport ResetSearch from \"@material-ui/icons/Close\";\nimport FiltersIcon from \"./FiltersIcon/FiltersIcon\";\nimport LabelIcon from \"@material-ui/icons/Label\";\nimport Chip from \"@material-ui/core/Chip\";\nimport AddIcon from \"@material-ui/icons/Add\";\nimport TodayIcon from \"@material-ui/icons/Today\";\nimport { Typography } from \"@material-ui/core\";\nimport Input from \"@material-ui/core/Input\";\nimport MenuItem from \"@material-ui/core/MenuItem\";\nimport FormControl from \"@material-ui/core/FormControl\";\nimport ListItemText from \"@material-ui/core/ListItemText\";\nimport Select from \"@material-ui/core/Select\";\nimport SettingsIcon from \"@material-ui/icons/Settings\";\nimport Checkbox from \"@material-ui/core/Checkbox\";\nimport {\n  KeyboardDateTimePicker,\n  MuiPickersUtilsProvider\n} from \"@material-ui/pickers\";\nimport DateFnsUtils from \"@date-io/date-fns\";\nimport PropTypes from \"prop-types\";\nimport _isEqual from \"lodash/isEqual\";\nimport _get from \"lodash/get\";\n\nconst useStyles = makeStyles(theme => ({\n  input: {\n    flex: 1,\n    paddingLeft: \"10px\",\n    fontSize: \"medium\"\n  },\n  searchText: {\n    minWidth: 150,\n    paddingLeft: theme.spacing(3)\n  },\n  addTagText: {\n    width: \"100%\"\n  },\n  limitText: {\n    width: \"50px\",\n    margin: theme.spacing(0, 3, 0, 3)\n  },\n  toggleContainer: {\n    margin: theme.spacing(2)\n  },\n  tagsContainer: {\n    display: \"flex\",\n    flexDirection: \"column\",\n    padding: theme.spacing(0.5),\n    margin: theme.spacing(0, 3, 0, 3)\n  },\n  tagsList: {\n    marginTop: theme.spacing(3)\n  },\n  chip: {\n    margin: theme.spacing(0.5)\n  },\n  formControl: {\n    margin: theme.spacing(1),\n    minWidth: 120,\n    maxWidth: 300\n  },\n  filtersButton: {\n    display: \"flex\",\n    flexDirection: \"row\"\n  },\n  columnsFilter: {\n    display: \"flex\",\n    flexDirection: \"column\",\n    marginTop: 6\n  },\n  iconButton: {\n    color: \"#0B6A8A\",\n    \"&:hover\": {\n      color: \"#22c7ff\"\n    }\n  }\n}));\n\nconst LogsFilterBar = props => {\n  const classes = useStyles();\n  const [tagText, setTagText] = React.useState(\"\");\n\n  const handleRobotChange = event => {\n    const arrayEvent = event?.target?.value;\n    const selectedId = arrayEvent[arrayEvent.length - 1];\n    props.updateRobotSelection(selectedId);\n  };\n  const getRobotSelector = () => {\n    return (\n      <div className={classes.toggleContainer}>\n        <svg\n          width=\"20\"\n          height=\"18\"\n          viewBox=\"0 0 30 27\"\n          fill=\"none\"\n          xmlns=\"http://www.w3.org/2000/svg\"\n          style={{ paddingTop: \"5px\", paddingRight: \"5px\" }}\n        >\n          <path\n            fillRule=\"evenodd\"\n            clipRule=\"evenodd\"\n            d=\"M16.7753 1.35706L15.9587 2.61119L16.3648 2.87846L18.4001 4.18898L17.1052 6.20016H25.437C26.5487 6.20016 27.45 7.10137 27.45 8.21307V12.8244H28.0955C28.6514 12.8244 29.102 13.275 29.102 13.8308V16.0643C29.102 16.6201 28.6514 17.0707 28.0955 17.0707H27.45V21.2901C27.45 22.4018 26.5487 23.303 25.437 23.303H4.12161C3.00991 23.303 2.1087 22.4017 2.1087 21.29V17.0707H1.42467C0.868819 17.0707 0.418213 16.6201 0.418213 16.0643V13.8308C0.418213 13.275 0.868819 12.8244 1.42467 12.8244H2.1087V8.21307C2.1087 7.10137 3.00991 6.20016 4.12161 6.20016H13.5141L14.8252 4.16395L13.2875 3.15192L13.2966 3.13812L13.2875 3.1322L15.1377 0.290771L16.7753 1.35706ZM24.4306 9.21953H5.12807V20.2836H24.4306V9.21953ZM7.18098 12.1324C6.68518 12.1324 6.28325 12.5343 6.28325 13.0301C6.28325 13.5259 6.68518 13.9278 7.18098 13.9278H9.04635C9.54216 13.9278 9.94409 13.5259 9.94409 13.0301C9.94409 12.5343 9.54216 12.1324 9.04635 12.1324H7.18098ZM20.6901 12.1324C20.1943 12.1324 19.7924 12.5343 19.7924 13.0301C19.7924 13.5259 20.1943 13.9278 20.6901 13.9278H22.5555C23.0513 13.9278 23.4532 13.5259 23.4532 13.0301C23.4532 12.5343 23.0513 12.1324 22.5555 12.1324H20.6901ZM9.17669 17.6512H11.3239V19.253H9.17669V17.6512ZM14.3432 17.6513H12.196V19.253H14.3432V17.6513ZM15.2154 17.6513H17.3626V19.253H15.2154V17.6513ZM20.382 17.6513H18.2348V19.253H20.382V17.6513ZM10.9568 23.69H18.6019V25.7029C18.6019 26.2587 18.1513 26.7093 17.5954 26.7093H11.9632C11.4074 26.7093 10.9568 26.2587 10.9568 25.7029V23.69Z\"\n            fill=\"#9E9E9E\"\n          />\n        </svg>\n        <FormControl className={classes.formControl}>\n          <Select\n            labelId=\"select-label\"\n            id=\"select\"\n            multiple\n            value={props.selectedRobots}\n            onChange={handleRobotChange}\n            renderValue={selected => {\n              const selectedNames = selected\n                .filter(({ isSelected }) => isSelected)\n                .map(({ name }) => name);\n              return selectedNames.length > 2\n                ? [selectedNames[0], selectedNames[1]].join(\" , \") + \"...\"\n                : selectedNames.join(\" , \");\n            }}\n            input={<Input />}\n            MenuProps={MenuProps}\n          >\n            {/* <MenuItem key={`robotList-Default`} value={robotDefault}>\n              Default\n            </MenuItem> */}\n            {props.selectedRobots.map((robot, robotIndex) => {\n              return (\n                <MenuItem key={`robotList-${robotIndex}`} value={robot.id}>\n                  <Checkbox checked={robot.isSelected} />\n                  <ListItemText primary={robot.name} />\n                </MenuItem>\n              );\n            })}\n          </Select>\n        </FormControl>\n      </div>\n    );\n  };\n\n  const getSearchInput = () => {\n    return (\n      <TextField\n        className={classes.searchText}\n        label=\"\"\n        placeholder=\"Search (regex)\"\n        value={props.messageRegex}\n        onChange={evt => props.handleMessageRegex(evt.target.value)}\n        InputProps={{\n          startAdornment: (\n            <InputAdornment style={{ paddingRight: 8 }}>\n              <SearchIcon fontSize=\"small\" />\n            </InputAdornment>\n          ),\n          endAdornment: (\n            <InputAdornment position=\"end\">\n              <IconButton\n                disabled={!props.messageRegex}\n                onClick={() => props.handleMessageRegex(\"\")}\n              >\n                <ResetSearch color=\"inherit\" fontSize=\"small\" />\n              </IconButton>\n            </InputAdornment>\n          )\n        }}\n        size=\"small\"\n      />\n    );\n  };\n\n  const getLevels = () => {\n    return (\n      <div className={classes.toggleContainer}>\n        <FormControl className={classes.formControl}>\n          <Select\n            labelId=\"demo-mutiple-checkbox-label\"\n            id=\"demo-mutiple-checkbox\"\n            style={{ minWidth: \"290px\" }}\n            multiple\n            value={props.levels}\n            onChange={props.handleLevels}\n            input={<Input />}\n            renderValue={selected => {\n              // selected comes from state, for example [\"ERROR\", \"INFO\"]\n              // but want to show the lables, for example [\"Alerts\", \"State of Robot\"]\n              const labels = props.levelsList\n                .filter(level => selected.includes(level.value))\n                .map(elem => elem.label);\n              return labels.join(\", \");\n            }}\n            MenuProps={MenuProps}\n          >\n            {props.levelsList.map(level => (\n              <MenuItem key={level.value} value={level.value}>\n                <Checkbox checked={props.levels.indexOf(level.value) > -1} />\n                <ListItemText primary={level.label} />\n              </MenuItem>\n            ))}\n          </Select>\n        </FormControl>\n      </div>\n    );\n  };\n\n  const getTags = isAdvancedMode => {\n    return (\n      <FiltersIcon\n        icon={<LabelIcon></LabelIcon>}\n        title=\"Tags\"\n        disabled={!isAdvancedMode}\n        isActive={props.tags.length > 0}\n      >\n        <div className={classes.tagsContainer}>\n          <TextField\n            className={classes.addTagText}\n            value={tagText}\n            onChange={evt => setTagText(evt.target.value)}\n            onKeyUp={event => {\n              // User pressed Enter\n              if (event.keyCode === 13) {\n                props.handleAddTag(tagText);\n                setTagText(\"\");\n              }\n            }}\n            label=\"Add Tag\"\n            InputProps={{\n              endAdornment: (\n                <InputAdornment>\n                  <IconButton\n                    onClick={() => {\n                      props.handleAddTag(tagText);\n                      setTagText(\"\");\n                    }}\n                  >\n                    <AddIcon />\n                  </IconButton>\n                </InputAdornment>\n              )\n            }}\n            size=\"small\"\n          />\n          <div className={classes.tagsList}>\n            {props.tags.map(data => {\n              return (\n                <li key={data.key}>\n                  <Chip\n                    label={data.label}\n                    onDelete={() => props.handleDeleteTag(data)}\n                    className={classes.chip}\n                    size=\"small\"\n                  />\n                </li>\n              );\n            })}\n          </div>\n        </div>\n      </FiltersIcon>\n    );\n  };\n\n  const getTimeFilters = () => {\n    return (\n      <FiltersIcon\n        icon={<TodayIcon></TodayIcon>}\n        title={props.t(\"Date Range\")}\n        isActive={\n          props.selectedFromDate !== null || props.selectedToDate !== null\n        }\n      >\n        {/* From -> To Date */}\n        <MuiPickersUtilsProvider utils={DateFnsUtils}>\n          <KeyboardDateTimePicker\n            key=\"time-picker\"\n            size=\"small\"\n            variant=\"inline\"\n            ampm={false}\n            label={props.t(\"From date\")}\n            value={props.selectedFromDate}\n            onChange={newDate =>\n              props.handleDateChange(newDate, \"selectedFromDate\")\n            }\n            onError={console.log}\n            format=\"yyyy/MM/dd HH:mm\"\n          />\n          <KeyboardDateTimePicker\n            key=\"time-picker2\"\n            size=\"small\"\n            variant=\"inline\"\n            ampm={false}\n            label={props.t(\"To date\")}\n            value={props.selectedToDate}\n            onChange={newDate =>\n              props.handleDateChange(newDate, \"selectedToDate\")\n            }\n            onError={console.log}\n            format=\"yyyy/MM/dd HH:mm\"\n          />\n        </MuiPickersUtilsProvider>\n      </FiltersIcon>\n    );\n  };\n\n  const getSettings = () => {\n    return (\n      <FiltersIcon\n        icon={<SettingsIcon></SettingsIcon>}\n        title={props.t(\"Configuration\")}\n      >\n        {/* Advanced/Simple Mode */}\n        <FormControlLabel\n          control={\n            <Switch\n              checked={props.advancedMode}\n              onChange={props.handleAdvancedMode}\n            />\n          }\n          label={props.advancedMode ? \"Advanced\" : \"Simple\"}\n        />\n        <div className={classes.filtersButton}>\n          {/* Limit Input */}\n          <Typography\n            component=\"div\"\n            style={{\n              fontSize: \"1rem\",\n              fontFamily: \"Open Sans\",\n              fontWeight: 500\n            }}\n          >\n            {`${props.t(\"Limit p/Robot\")}:`}\n          </Typography>\n          <TextField\n            value={props.limit}\n            onChange={props.handleLimit}\n            className={classes.limitText}\n            id=\"outlined-number\"\n            // label=\"limit\"\n            placeholder={props.t(\"limit\")}\n            type=\"number\"\n            InputLabelProps={{\n              shrink: true\n            }}\n            // variant=\"outlined\"\n            size=\"small\"\n          />\n        </div>\n        <div className={classes.columnsFilter}>\n          {/* Limit Input */}\n          <Typography\n            component=\"div\"\n            style={{\n              fontSize: \"1rem\",\n              fontFamily: \"Open Sans\",\n              fontWeight: 500\n            }}\n          >\n            {`${props.t(\"Columns\")}:`}\n          </Typography>\n          <FormControl className={classes.formControl}>\n            <Select\n              labelId=\"demo-mutiple-checkbox-label\"\n              id=\"demo-mutiple-checkbox\"\n              multiple\n              value={props.columns}\n              onChange={props.handleColumns}\n              input={<Input />}\n              renderValue={selected =>\n                selected\n                  .map(elem => _get(props, `columnList[${elem}].label`, \"\"))\n                  .join(`, `)\n              }\n              MenuProps={MenuProps}\n            >\n              {Object.keys(props.columnList).map((column, index) => {\n                return (\n                  <MenuItem key={index} value={column}>\n                    <Checkbox checked={props.columns.indexOf(column) > -1} />\n                    <ListItemText primary={props.columnList[column].label} />\n                  </MenuItem>\n                );\n              })}\n            </Select>\n          </FormControl>\n        </div>\n      </FiltersIcon>\n    );\n  };\n\n  return (\n    <AppBar position=\"static\" color=\"inherit\">\n      <Toolbar variant=\"dense\">\n        {getRobotSelector()}\n        {/* Search Input */}\n        {getSearchInput()}\n        {/* Toggle: INFO, DEBUG, ERROR, CRITICAL */}\n        {getLevels()}\n        {/* Tags */}\n        {getTags(props.advancedMode)}\n        {/* Date time filter */}\n        {getTimeFilters()}\n        <div style={{ flexGrow: 1 }}></div>\n        {getSettings()}\n      </Toolbar>\n    </AppBar>\n  );\n};\n\nconst ITEM_HEIGHT = 48;\nconst ITEM_PADDING_TOP = 8;\nconst MenuProps = {\n  PaperProps: {\n    style: {\n      maxHeight: ITEM_HEIGHT * 4.5 + ITEM_PADDING_TOP,\n      width: 250\n    }\n  },\n  getContentAnchorEl: null\n};\n\nLogsFilterBar.propTypes = {\n  levels: PropTypes.array,\n  levelsList: PropTypes.array,\n  handleLevels: PropTypes.func,\n  limit: PropTypes.number,\n  handleLimit: PropTypes.func,\n  columns: PropTypes.array,\n  columnList: PropTypes.object,\n  handleColumns: PropTypes.func,\n  handleDeleteTag: PropTypes.func,\n  messageRegex: PropTypes.string,\n  handleMessageRegex: PropTypes.func,\n  selectedFromDate: PropTypes.string,\n  selectToDate: PropTypes.string,\n  handleDateChange: PropTypes.func,\n  selectedRobots: PropTypes.array,\n  updateRobotSelection: PropTypes.func,\n  advancedMode: PropTypes.bool,\n  handleAdvancedMode: PropTypes.func,\n  t: PropTypes.func\n};\n\nLogsFilterBar.defaultProps = {\n  levels: [],\n  levelsList: [],\n  handleLevels: () => {},\n  limit: 1,\n  handleLimit: () => {},\n  columns: [],\n  columnList: {},\n  handleColumns: () => {},\n  handleDeleteTag: () => {},\n  messageRegex: \"\",\n  handleMessageRegex: () => {},\n  selectedFromDate: \"\",\n  selectToDate: \"\",\n  handleDateChange: () => {},\n  selectedRobots: [],\n  updateRobotSelection: () => {},\n  advancedMode: false,\n  handleAdvancedMode: () => {},\n  t: string => string\n};\n\n//The function returns true when the compared props equal, preventing the component from re-rendering\nfunction arePropsEqual(prevProps, nextProps) {\n  return _isEqual(prevProps, nextProps);\n}\n\nexport default memo(LogsFilterBar, arePropsEqual);\n","import React from \"react\";\nimport _isEmpty from \"lodash/isEmpty\";\n\n// export const levels = [\n//   { value: \"INFO\", label: i18n.t(\"Robot Status\") },\n//   // { value: \"WARNING\", label: \"Warnings\" },\n//   // { value: \"DEBUG\", label: \"Debug\" },\n//   { value: \"ERROR\", label: i18n.t(\"Alerts\") }\n//   // { value: \"CRITICAL\", label: \"Critical\" }\n// ];\n\nexport const colorCoding = {\n  INFO: {\n    backgroundColor: \"rgba(33, 150, 243, 0.1)\"\n  },\n  WARNING: {\n    backgroundColor: \"rgba(255, 152, 0, 0.1)\"\n  },\n  DEBUG: {\n    backgroundColor: \"rgba(76, 175, 80, 0.1)\"\n  },\n  ERROR: {\n    backgroundColor: \"rgba(244, 67, 54, 0.1)\"\n  },\n  CRITICAL: {\n    backgroundColor: \"rgba(255, 19, 1, 0.1)\"\n  }\n};\n\n// export const fixedColumns = {\n//   Date: {\n//     label: i18n.t(\"Date\"),\n//     dataKey: \"time\",\n//     width: 100,\n//     render: time => getJustDateFromServer(time)\n//   },\n//   Time: {\n//     label: i18n.t(\"Time\"),\n//     dataKey: \"time\",\n//     render: time => getJustTimeFromServer(time),\n//     width: 100\n//   },\n//   Level: {\n//     label: i18n.t(\"Level\"),\n//     dataKey: \"level\",\n//     width: 100\n//   },\n//   Module: {\n//     label: i18n.t(\"Module\"),\n//     dataKey: \"module\",\n//     width: 100\n//   },\n//   Function: {\n//     label: \"Function\",\n//     dataKey: \"funcName\",\n//     width: 100\n//   },\n//   Callback: {\n//     label: i18n.t(\"Callback\"),\n//     dataKey: \"callback\",\n//     width: 100\n//   },\n//   Node: {\n//     label: i18n.t(\"Node\"),\n//     dataKey: \"node\",\n//     width: 100\n//   },\n//   Fleet: {\n//     label: i18n.t(\"Fleet\"),\n//     dataKey: \"fleet\",\n//     width: 100\n//   },\n//   Robot: {\n//     label: i18n.t(\"Robot\"),\n//     dataKey: \"robot\",\n//     width: 100\n//   },\n//   Message: {\n//     label: i18n.t(\"Message\"),\n//     dataKey: \"message\",\n//     width: 100\n//   }\n// };\n\n// Makes sure to find unique \"i\" of chip array\n// Input: [{key: 0, label: \"Chip1\"}, {key: 2, label: \"Chip3\"}], keyName= \"key\"\n// Output: 1\nexport function findsUniqueKey(array, keyName) {\n  const length = array.length;\n  // If empty, return 0\n  if (length === 0 || array === undefined) {\n    return 0;\n  }\n  for (let k = 0; k < length; k++) {\n    for (let j = 0; j < length; j++) {\n      if (k === array[j][keyName]) {\n        break;\n      }\n      if (j === length - 1) {\n        return k;\n      }\n    }\n  }\n\n  return length;\n}\n\n// Converts the levels in the state for the string for the request\n//  Input: [\"INFO\", \"DEBUG\"]\n//  Output: \"level=info,debug\"\nexport function getRequestLevels(levelsArray, levelsList) {\n  let res = \"\";\n  if (Array.isArray(levelsArray) && levelsArray.length === levelsList.length) {\n    return res;\n  }\n\n  try {\n    levelsArray.forEach(level => {\n      if (res === \"\") {\n        res = `${level.toLowerCase()}`;\n      } else {\n        res = `${res},${level.toLowerCase()}`;\n      }\n    });\n    return `level=${res}`;\n  } catch (error) {\n    return \"\";\n  }\n}\n// Converts the levels in the state for the string for the request\n//  Input: [{ key: 0, label: \"UI\" }, { key: 1, label: \"TASKS\" }]\n//  Output: \"&tags=UI,TASKS\"\nexport function getRequestTags(tagsArray) {\n  let res = \"\";\n\n  if (_isEmpty(tagsArray)) {\n    return res;\n  }\n\n  tagsArray.forEach(tag => {\n    if (res === \"\") {\n      res = `${tag.label}`;\n    } else {\n      res = `${res},${tag.label}`;\n    }\n  });\n\n  return `&tags=${res}`;\n}\n// Converts the levels in the state for the string for the request\n//  Input: \"r'started\\.$\"\n//  Output: \"&message=r'started\\.$\"\nexport function getRequestMessage(message) {\n  if (!message || message === \"\") {\n    return \"\";\n  }\n  // Parse message to URL and return\n  const parsedMessageToUrl = message.replace(/ /g, \"+\");\n  return `&message=${parsedMessageToUrl}`;\n}\n\n// Convert Date format to a human readable format\n// Input: 1586370146\n// Output: \"08/04/2020 19:22:26\"\nexport const getTimeFromServer = serverTime => {\n  const time = new Date(serverTime * 1000);\n  return `${time.toLocaleString(\"pt\")}`;\n};\n// Convert Date format to a human readable format\n// Input: 1586370146\n// Output: \"08/04/2020\"\nexport const getJustDateFromServer = serverTime => {\n  const time = new Date(serverTime * 1000);\n  return `${time.toLocaleDateString(\"pt\")}`;\n};\n// Convert Date format to a human readable format\n// Input: 1586370146\n// Output: \"19:22:26\"\nexport const getJustTimeFromServer = serverTime => {\n  const time = new Date(serverTime * 1000);\n  return `${time.toLocaleTimeString(\"pt\")}`;\n};\n\n// Convert array of object to array of strings for LogList\n// Input:\n// [\n//   {\n//     time: 1586370146,\n//     level: \"INFO\",\n//     message: \"UI Tag Log Test: 12\"\n//   },\n//   {\n//     time: 1586370147,\n//     level: \"INFO\",\n//     message: \"UI Tag Log Test: 13\"\n//   }\n// ];\n// Output\n// [\n//   \"[08/04/2020 19:22:26] [INFO] : UI Tag Log Test: 12\",\n//   \"[08/04/2020 19:21:31] [INFO] : UI Tag Log Test: 56\"\n// ];\n\nexport const formatLogsData = data => {\n  return data.map(\n    elem => elem.stdout\n    // `[${getTimeFromServer(elem.time)}] [${elem.level}] : ${elem.message}`\n  );\n};\n\nfunction binaryIndexOf(data, criteria) {\n  var minIndex = 0;\n  var maxIndex = data.length - 1;\n  var currentIndex;\n  var currentElement;\n  var result = null;\n\n  while (minIndex <= maxIndex) {\n    currentIndex = ((minIndex + maxIndex) / 2) | 0;\n    currentElement = data[currentIndex];\n    var comparison = criteria(currentElement);\n\n    if (comparison[0] === \"right\") {\n      minIndex = currentIndex + 1;\n    } else {\n      maxIndex = currentIndex - 1;\n    }\n\n    if (comparison[1]) {\n      result = currentIndex;\n    }\n  }\n\n  return result;\n}\n\nexport const filterByFromToDates = (logsData, fromDate, toDate) => {\n  // If there is a problem fetching the logs, show nothing\n  if (!logsData) {\n    return [];\n  }\n\n  let lowerIndex = 0;\n  let upperIndex = logsData.length;\n\n  // If nothing is selected, do nothing\n  if (!fromDate && !toDate) {\n    return logsData;\n  }\n\n  // List of time format. Array is sorted in descending order (Newer -> Older)\n  const dateList = logsData.map(log => log.time);\n  if (toDate) {\n    // First log that is <= toDate (first index that fits criteria)\n    lowerIndex = binaryIndexOf(dateList, function (value) {\n      return value >= toDate.getTime() / 1000\n        ? [\"right\", false]\n        : [\"left\", true];\n    });\n  }\n  if (fromDate) {\n    // First log that is >= fromDate (last index that still fits criteria)\n    upperIndex = binaryIndexOf(dateList, function (value) {\n      return value <= fromDate.getTime() / 1000\n        ? [\"left\", false]\n        : [\"right\", true];\n    });\n  }\n  return logsData.slice(lowerIndex, upperIndex + 1);\n};\n\n// This function is to get the same string as the one you get in\n// Robot:Status nodes_lchd and persistent_nodes_lchd\nexport const addNestedName = (nestedName, newName) => {\n  if (nestedName === \"\") {\n    return newName;\n  } else {\n    return `${nestedName}__${newName}`;\n  }\n};\n\n// Will update according with the list of running nodes all the nodes to running or stopped\nexport const updateRunningNodes = (treeList, runningNodesList) => {\n  return treeList.map(elem => {\n    // Only update the status of nodes, not containers\n    if (elem.status) {\n      if (runningNodesList.includes(elem.nestedName)) {\n        return { ...elem, status: \"running\" };\n      } else {\n        return { ...elem, status: \"stopped\" };\n      }\n    } else {\n      return elem;\n    }\n  });\n};\n\n// This will remove the deleted container from the treeList and its respective children\nexport const removeDeleteContainer = (treeList, id) => {\n  // Get the id of the Container to remove\n  const deleteIndex = treeList.findIndex(elem => elem.id === id);\n  treeList.splice(deleteIndex, 1);\n  // Remove children: find all children with parentId that is the id\n  for (let i = 0; i < treeList.length; i++) {\n    if (treeList[i].parentId === id) {\n      removeDeleteContainer(treeList, treeList[i].id);\n    }\n  }\n};\n\n// Detects if there are loops within nested containers\n// Returns true if it finds a loop, false otherwise\nexport const detectContainerLoop = (treeList, parentId, flowId) => {\n  // If first level there are no loops\n  if (parentId === 0) {\n    return false;\n  }\n  // index of container to add\n  let flowIndex = treeList.findIndex(elem => elem.id === parentId);\n  let currentFlow = treeList[flowIndex];\n  // Stop when reaches the root of the tree\n  while (currentFlow.parentId) {\n    // get the parentId of the current container\n    const parentId = currentFlow.parentId;\n    // get the index of that parent in the array\n    flowIndex = treeList.findIndex(elem => elem.id === parentId);\n    currentFlow = treeList[flowIndex];\n    if (currentFlow.flowId === flowId) {\n      console.error(\"Found Flow Loop :0\");\n      return true;\n    }\n  }\n  return false;\n};\n","import React from \"react\";\nimport PropTypes from \"prop-types\";\nimport clsx from \"clsx\";\nimport { makeStyles } from \"@material-ui/core/styles\";\nimport TableCell from \"@material-ui/core/TableCell\";\nimport { AutoSizer, Column, Table } from \"react-virtualized\";\nimport { colorCoding } from \"../utils/Utils\";\n\nconst useStyles = makeStyles(theme => {\n  return {\n    flexContainer: {\n      display: \"flex\",\n      alignItems: \"center\",\n      boxSizing: \"border-box\"\n    },\n    table: {\n      // temporary right-to-left patch, waiting for\n      // // https://github.com/bvaughn/react-virtualized/issues/454\n      \"& .ReactVirtualized__Table__headerRow\": {\n        flip: false,\n        paddingRight: theme.direction === \"rtl\" ? \"0 !important\" : undefined\n      }\n    },\n    tableRow: {\n      cursor: \"pointer\"\n    },\n    tableRowHover: {\n      \"&:hover\": {\n        backgroundColor: \"rgba(0, 5, 58, 0.3)\"\n      }\n    },\n    tableCell: {\n      flexGrow: 1,\n      whiteSpace: \"nowrap\",\n      overflow: \"hidden\",\n      textOverflow: \"ellipsis\",\n      display: \"inline-block\"\n    },\n    flexColumn: {\n      flex: 1,\n      alignItems: \"center\"\n    },\n    noClick: {\n      cursor: \"initial\"\n    },\n    ...colorCoding\n  };\n});\n\nconst MuiVirtualizedTable = props => {\n  const { columns, rowHeight, headerHeight, onRowClick, ...tableProps } = props;\n  const classes = useStyles();\n\n  const getRowClassName = ({ index }) => {\n    const { data } = props;\n    const rowData = data[index];\n    return clsx(\n      classes.tableRow,\n      classes.flexContainer,\n      index !== -1 && classes[rowData.level],\n      {\n        [classes.tableRowHover]: index !== -1 && onRowClick != null\n      }\n    );\n  };\n\n  const cellRenderer = render => ({ cellData, columnIndex }) => {\n    return (\n      <TableCell\n        component=\"div\"\n        className={`${classes.tableCell} ${classes.flexContainer}`}\n        variant=\"body\"\n        style={{ height: rowHeight }}\n        align={\n          (columnIndex != null && columns[columnIndex].numeric) || false\n            ? \"right\"\n            : \"left\"\n        }\n      >\n        {render ? render(cellData) : cellData}\n      </TableCell>\n    );\n  };\n\n  const headerRenderer = ({ label, columnIndex }) => {\n    return (\n      <TableCell\n        component=\"div\"\n        className={clsx(\n          classes.tableCell,\n          classes.flexContainer,\n          classes.noClick\n        )}\n        variant=\"head\"\n        style={{ height: headerHeight }}\n        align={columns[columnIndex].numeric || false ? \"right\" : \"left\"}\n      >\n        <span>{label}</span>\n      </TableCell>\n    );\n  };\n\n  return (\n    <AutoSizer>\n      {({ height, width }) => (\n        <Table\n          height={height}\n          width={width}\n          onRowClick={onRowClick}\n          rowHeight={rowHeight}\n          gridStyle={{\n            direction: \"inherit\"\n          }}\n          headerHeight={headerHeight}\n          className={classes.table}\n          {...tableProps}\n          rowClassName={getRowClassName}\n        >\n          {columns.map(({ dataKey, render, ...other }, index) => {\n            return (\n              <Column\n                key={dataKey}\n                headerRenderer={headerProps => {\n                  return headerRenderer({\n                    ...headerProps,\n                    columnIndex: index\n                  });\n                }}\n                flexGrow={dataKey === \"message\" ? 1 : undefined}\n                className={classes.flexContainer}\n                cellRenderer={cellRenderer(render)}\n                dataKey={dataKey}\n                {...other}\n              />\n            );\n          })}\n        </Table>\n      )}\n    </AutoSizer>\n  );\n};\n\n// const VirtualizedTable = withStyles(styles)(MuiVirtualizedTable);\n\nexport default function LogsTable(props) {\n  return (\n    <MuiVirtualizedTable\n      rowHeight={48}\n      headerHeight={48}\n      rowCount={props.logsData.length}\n      rowGetter={({ index }) => props.logsData[index]}\n      data={props.logsData}\n      columns={props.columns.map(elem => props.columnList[elem])}\n      onRowClick={props.onRowClick}\n    />\n  );\n}\n\nLogsTable.propTypes = {\n  columns: PropTypes.array,\n  columnList: PropTypes.object,\n  logsData: PropTypes.array,\n  height: PropTypes.number,\n  onRowClick: PropTypes.func\n};\n\nLogsTable.defaultProps = {\n  columns: [],\n  columnList: {},\n  logsData: [],\n  height: 10\n};\n","import React, { Component, createRef } from \"react\";\nimport LogsFilterBar from \"./LogsFilterBar/LogsFilterBar\";\nimport \"./Logs.css\";\nimport { MasterDB } from \"mov-fe-lib-core\";\nimport { withStyles } from \"@material-ui/core/styles\";\nimport RobotLogModal from \"../Modal/RobotLogModal\";\nimport {\n  getRequestLevels,\n  getRequestTags,\n  getRequestMessage,\n  filterByFromToDates,\n  findsUniqueKey,\n  getJustDateFromServer,\n  getJustTimeFromServer\n} from \"./utils/Utils\";\nimport LogsTable from \"./LogsTable/LogsTable\";\nimport _isEqual from \"lodash/isEqual\";\nimport PropTypes from \"prop-types\";\n\nconst UI_TAG = { key: 0, label: \"ui\" };\n\nconst styles = theme => ({\n  tableContainer: {\n    flexGrow: 1,\n    minHeight: 0,\n    overflow: \"hidden\"\n  }\n});\n\nclass Logs extends Component {\n  state = {\n    selectedRobots: [],\n    levels: [\"INFO\", \"ERROR\"],\n    limit: 50,\n    logsData: [],\n    messageRegex: \"\",\n    selectedFromDate: null,\n    selectedToDate: null,\n    columns: [\"Time\", \"Robot\", \"Message\"],\n    tags: this.props.advancedMode ? [] : [UI_TAG],\n    height: 0, //LogsTable height\n    levelsList: this.props.advancedMode\n      ? [\n          { value: \"INFO\", label: \"Info\" },\n          { value: \"WARNING\", label: \"Warnings\" },\n          { value: \"DEBUG\", label: \"Debug\" },\n          { value: \"ERROR\", label: \"Error\" },\n          { value: \"CRITICAL\", label: \"Critical\" }\n        ]\n      : [\n          { value: \"INFO\", label: \"Robot Status\" },\n          { value: \"ERROR\", label: \"Alerts\" }\n        ],\n    advancedMode: this.props.advancedMode\n  };\n  logsTimeout = undefined;\n  logModal = createRef();\n\n  simpleLevelsList = [\n    { value: \"INFO\", label: \"Robot Status\" },\n    { value: \"ERROR\", label: \"Alerts\" }\n  ];\n\n  advancedLevelsList = [\n    { value: \"INFO\", label: \"Info\" },\n    { value: \"WARNING\", label: \"Warnings\" },\n    { value: \"DEBUG\", label: \"Debug\" },\n    { value: \"ERROR\", label: \"Error\" },\n    { value: \"CRITICAL\", label: \"Critical\" }\n  ];\n\n  resizeHandler() {\n    const height = this.divElement.clientHeight;\n    this.setState({ height });\n  }\n\n  componentDidMount() {\n    this.updateSelectedRobots();\n  }\n\n  componentDidUpdate(prevProps, prevState) {\n    if (_isEqual(prevProps.robotsData, this.props.robotsData)) return;\n    this.updateSelectedRobots();\n  }\n\n  updateSelectedRobots = () => {\n    if (\n      this.props.robotsData.length &&\n      this.props.robotsData.filter(robot => robot.ip).length\n    )\n      this.setSelectedRobots(\n        this.props.robotsData.map(elem => ({ ...elem, isSelected: true }))\n      );\n  };\n\n  componentWillUnmount() {\n    if (this.logsTimeout) {\n      clearTimeout(this.logsTimeout);\n    }\n  }\n\n  // This function is responsible to check/unckeck the list of robots\n  updateRobotSelection = robotId => {\n    const selectedRobots = [...this.state.selectedRobots];\n    const updateRobot =\n      selectedRobots[selectedRobots.findIndex(elem => elem.id === robotId)];\n    updateRobot.isSelected = !updateRobot.isSelected;\n    this.setState({ selectedRobots });\n  };\n\n  setSelectedRobots = selectedRobots => {\n    clearTimeout(this.logsTimeout);\n    this.setState({ selectedRobots });\n    this.getLogs(selectedRobots);\n  };\n\n  getLogs = async robots => {\n    await Promise.all(\n      robots\n        .filter(robot => robot.robotState !== this.props.robotStates.off) // If robot is offline doesn't bother making the request\n        .filter(robot => robot.isSelected)\n        .map(robot => this.getRobotLogData(robot))\n    ).then(dataArrays => {\n      this.setState(prevState => {\n        const finalArray = dataArrays.reduce((all, dataArray) => {\n          dataArray && dataArray.forEach(data => all.push(data));\n          return all;\n        }, []);\n        this.logsTimeout = setTimeout(\n          this.getLogs,\n          3000,\n          prevState.selectedRobots\n        );\n        return { logsData: finalArray.sort((a, b) => b.time - a.time) };\n      });\n    });\n  };\n\n  getRobotLogData = robotSelected => {\n    return new Promise((re, rej) => {\n      // Failsafe timer to prevent the promise all from hanging\n      const timeoutHandle = setTimeout(() => {\n        console.error(\"MOV.AI: One of the promises reached timeout\");\n        re([]);\n      }, 2000);\n\n      if (robotSelected.ip) {\n        const dynamicURL = `http://${\n          robotSelected.ip\n        }/api/v1/logs/?${getRequestLevels(\n          this.state.levels,\n          this.state.levelsList\n        )}&limit=${this.state.limit}${getRequestTags(\n          this.state.tags\n        )}${getRequestMessage(this.state.messageRegex)}`;\n\n        MasterDB.get(dynamicURL, (res, e) => {\n          re(res?.data || []);\n          clearTimeout(timeoutHandle);\n        });\n      } else {\n        re([]);\n      }\n    }).catch(() => console.log(\"Failed getRobotLogData\"));\n  };\n\n  onRowClick = log => {\n    this.logModal.current.open(log.rowData);\n  };\n\n  render() {\n    return (\n      <div\n        style={{\n          width: \"100%\",\n          height: \"100%\",\n          display: \"flex\",\n          flexDirection: \"column\"\n        }}\n      >\n        <div\n          style={{\n            flexGrow: \"1\",\n            height: \"100%\",\n            display: \"flex\",\n            flexDirection: \"column\"\n          }}\n        >\n          <LogsFilterBar\n            selectedRobots={this.state.selectedRobots}\n            updateRobotSelection={this.updateRobotSelection}\n            levels={this.state.levels}\n            levelsList={this.state.levelsList}\n            handleLevels={event => {\n              this.setState({ levels: event.target.value });\n            }}\n            limit={this.state.limit}\n            handleLimit={evt => {\n              if (evt.target.value === \"\") {\n                this.setState({ limit: 0 });\n              } else {\n                this.setState({ limit: evt.target.value });\n              }\n            }}\n            columns={this.state.columns}\n            columnList={this.props.columnList}\n            handleColumns={event => {\n              // make sure columns are always with the same order\n              const columns = Object.keys(this.props.columnList).filter(elem =>\n                event.target.value.includes(elem)\n              );\n              this.setState({ columns });\n            }}\n            tags={this.state.tags}\n            handleAddTag={tagText => {\n              const { tags } = this.state;\n              // Don't add tag if it's empty or duplicate\n              if (\n                tagText !== \"\" &&\n                tags.findIndex(elem => elem.label === tagText) < 0\n              ) {\n                tags.push({\n                  key: findsUniqueKey(tags, \"key\"),\n                  label: tagText\n                });\n                this.setState({ tags });\n              }\n            }}\n            handleDeleteTag={tagToDelete => {\n              const { tags } = this.state;\n              const filteredTags = tags.filter(\n                tag => tag.key !== tagToDelete.key\n              );\n              this.setState({ tags: filteredTags });\n            }}\n            messageRegex={this.state.messageRegex}\n            handleMessageRegex={text => this.setState({ messageRegex: text })}\n            selectedFromDate={this.state.selectedFromDate}\n            selectedToDate={this.state.selectedToDate}\n            handleDateChange={(newDate, keyToChange) => {\n              this.setState({ [keyToChange]: newDate });\n            }}\n            advancedMode={this.state.advancedMode}\n            handleAdvancedMode={evt => {\n              // Toggle advanced mode: change the levels\n              const advancedMode = !this.state.advancedMode;\n              this.setState({\n                advancedMode: advancedMode,\n                levelsList: this.state.advancedMode\n                  ? this.simpleLevelsList\n                  : this.advancedLevelsList,\n                tags: advancedMode ? [] : [UI_TAG]\n              });\n            }}\n          ></LogsFilterBar>\n          <div\n            ref={divElement => {\n              this.divElement = divElement;\n            }}\n            className={this.props.classes.tableContainer}\n          >\n            <LogsTable\n              columns={this.state.columns}\n              columnList={this.props.columnList}\n              logsData={filterByFromToDates(\n                this.state.logsData,\n                this.state.selectedFromDate,\n                this.state.selectedToDate\n              )}\n              height={this.state.height}\n              levelsList={this.state.levelsList}\n              onRowClick={this.onRowClick}\n            ></LogsTable>\n          </div>\n        </div>\n        <RobotLogModal\n          ref={this.logModal}\n          props={[\"module\", \"service\"]}\n        ></RobotLogModal>\n      </div>\n    );\n  }\n}\n\nLogs.propTypes = {\n  robotsData: PropTypes.array,\n  robotStates: PropTypes.object,\n  columnList: PropTypes.object,\n  advancedMode: PropTypes.bool\n};\nLogs.defaultProps = {\n  robotsData: [\n    {\n      name: \"robot\",\n      id: \"032cf6207ff34ad0a68cc45034f61b41\",\n      timestamp: 1604334778.6494586,\n      robotState: \"okay\",\n      battery: 78,\n      ip: \"127.0.0.1\"\n    },\n    {\n      name: \"robot_test\",\n      id: \"4df900e30cb44adba33ae74bb2596d88\",\n      timestamp: 1603969723.997914,\n      robotState: \"off\",\n      battery: 22,\n      ip: \"127.0.0.1\"\n    }\n  ],\n  robotStates: {\n    error: \"error\",\n    temp: \"temp\",\n    okay: \"okay\",\n    off: \"off\"\n  },\n  columnList: {\n    Date: {\n      label: \"Date\",\n      dataKey: \"time\",\n      width: 100,\n      render: time => getJustDateFromServer(time)\n    },\n    Time: {\n      label: \"Time\",\n      dataKey: \"time\",\n      width: 100,\n      render: time => getJustTimeFromServer(time)\n    },\n    Level: {\n      label: \"Level\",\n      dataKey: \"level\",\n      width: 100\n    },\n    Module: {\n      label: \"Module\",\n      dataKey: \"module\",\n      width: 100\n    },\n    Robot: {\n      label: \"Robot\",\n      dataKey: \"robot\",\n      width: 100\n    },\n    Message: {\n      label: \"Message\",\n      dataKey: \"message\",\n      width: 100\n    }\n  },\n  advancedMode: false\n};\n\nexport default withStyles(styles, { withTheme: true })(Logs);\n","import React, { Component } from \"react\";\nimport Typography from \"@material-ui/core/Typography\";\nimport Button from \"@material-ui/core/Button\";\nimport Grid from \"@material-ui/core/Grid\";\nimport defaultLogo from \"./movai_red.svg\";\nimport Paper from \"@material-ui/core/Paper\";\nimport FormControl from \"@material-ui/core/FormControl\";\nimport FormHelperText from \"@material-ui/core/FormHelperText\";\nimport Input from \"@material-ui/core/Input\";\nimport InputLabel from \"@material-ui/core/InputLabel\";\nimport { withStyles } from \"@material-ui/core/styles\";\nimport { Authentication } from \"mov-fe-lib-core\";\nimport PropTypes from \"prop-types\";\n\nconst styles = theme => ({\n  root: {\n    padding: theme.spacing(4, 4),\n    borderRadius: 10\n  }\n});\n\nclass LoginForm extends Component {\n  state = {\n    username: \"\",\n    password: \"\",\n    remember: false,\n    error: false,\n    errorMessage: \"\",\n    capsLockOn: false\n  };\n\n  sendCreds = async () => {\n    try {\n      const apiResponse = await Authentication.login(\n        this.state.username,\n        this.state.password,\n        this.state.remember\n      );\n      // If successfully logged in\n      if (!apiResponse.error) {\n        this.props.setLoggedIn(true);\n      } else {\n        // Show the error in red\n        this.setState({\n          error: true,\n          errorMessage: apiResponse.error\n        });\n      }\n    } catch (e) {\n      this.setState({\n        error: true,\n        errorMessage: e\n      });\n    }\n  };\n\n  checkCapsLock = event => {\n    if (event.key === \"CapsLock\" && this.state.capsLockOn)\n      this.setState({ capsLockOn: false });\n    else {\n      const capsLock = event.getModifierState(\"CapsLock\");\n      this.setState({ capsLockOn: capsLock });\n    }\n  };\n\n  render() {\n    const { classes, logo } = this.props;\n\n    return (\n      <Grid\n        style={{ paddingTop: \"5%\" }}\n        container\n        direction=\"column\"\n        alignItems=\"center\"\n        justify=\"space-evenly\"\n      >\n        <Paper elevation={10} className={classes.root}>\n          <Grid item>\n            <img\n              src={logo ? logo : defaultLogo}\n              className=\"center\"\n              alt=\"logo\"\n              style={{\n                display: \"block\",\n                marginLeft: \"auto\",\n                marginRight: \"auto\",\n                width: \"50%\"\n              }}\n            />\n          </Grid>\n          <Grid>\n            <Typography align=\"center\" variant=\"subtitle1\" gutterBottom>\n              <FormControl\n                className={classes.formControl}\n                error={this.state.error}\n              >\n                <InputLabel htmlFor=\"component-username-error\">\n                  Username\n                </InputLabel>\n                <Input\n                  id=\"component-username-error\"\n                  value={this.state.username}\n                  aria-describedby=\"component-username-error-text\"\n                  onChange={event =>\n                    this.setState({ username: event.target.value })\n                  }\n                />\n              </FormControl>\n            </Typography>\n          </Grid>\n          <Grid>\n            <Typography align=\"center\" variant=\"subtitle1\" gutterBottom>\n              <FormControl\n                className={classes.formControl}\n                error={this.state.error}\n              >\n                <InputLabel htmlFor=\"component-password-error\">\n                  Password\n                </InputLabel>\n                <Input\n                  id=\"component-password-error\"\n                  type=\"password\"\n                  value={this.state.password}\n                  aria-describedby=\"component-password-error-text\"\n                  onChange={event =>\n                    this.setState({ password: event.target.value })\n                  }\n                  onKeyUp={event => {\n                    this.checkCapsLock(event);\n                    if (event.key === \"Enter\") {\n                      this.sendCreds();\n                    }\n                  }}\n                />\n                {this.state.error && (\n                  <FormHelperText id=\"component-error-text\">\n                    {this.state.errorMessage}\n                  </FormHelperText>\n                )}\n                {this.state.capsLockOn && (\n                  <FormHelperText id=\"component-warning-text\">\n                    Warning: Caps lock is ON!\n                  </FormHelperText>\n                )}\n              </FormControl>\n            </Typography>\n          </Grid>\n          <Grid>\n            <Typography align=\"center\" gutterBottom>\n              <Button onClick={() => this.sendCreds()}>Login</Button>\n            </Typography>\n          </Grid>\n        </Paper>\n      </Grid>\n    );\n  }\n}\n\nLoginForm.propTypes = {\n  logs: PropTypes.any, // expects a svg element\n  setLoggedIn: PropTypes.func\n};\n\nLoginForm.defaultProps = {\n  setLoggedIn: loggedIn => console.log(loggedIn)\n};\n\nexport default withStyles(styles, { withTheme: true })(LoginForm);\n","import React from \"react\";\nimport IconButton from \"@material-ui/core/IconButton\";\nimport Menu from \"@material-ui/core/Menu\";\nimport MenuItem from \"@material-ui/core/MenuItem\";\nimport SettingsIcon from \"@material-ui/icons/Settings\";\nimport PropTypes from \"prop-types\";\nimport Toggle from \"./Toggle\";\nimport { makeStyles } from \"@material-ui/core/styles\";\nimport Divider from \"@material-ui/core/Divider\";\nimport { Typography } from \"@material-ui/core\";\n\nconst useStyles = makeStyles(theme => {\n  return {\n    menuItemSpacing: {\n      fontSize: \"18px\",\n      minHeight: \"18px\",\n      padding: theme.spacing(1.25, 2),\n      ...theme.cursorDefault\n    },\n    profileMenuFooter: {\n      fontSize: \"14px\",\n      textAlign: \"end\"\n    }\n  };\n});\n\nconst ProfileMenu = props => {\n  const classes = useStyles();\n  const [anchorEl, setAnchorEl] = React.useState(null);\n\n  const handleClick = event => {\n    setAnchorEl(event.currentTarget);\n  };\n\n  const handleClose = () => {\n    setAnchorEl(null);\n  };\n\n  return (\n    <div>\n      <IconButton\n        aria-controls=\"simple-menu\"\n        aria-haspopup=\"true\"\n        onClick={handleClick}\n      >\n        <SettingsIcon />\n      </IconButton>\n      <Menu\n        id=\"simple-menu\"\n        anchorEl={anchorEl}\n        keepMounted\n        open={Boolean(anchorEl)}\n        onClose={handleClose}\n      >\n        <Typography component=\"div\" variant=\"body1\">\n          <div className={classes.menuItemSpacing}>\n            {props.welcomeLabel}, {props.userName}\n          </div>\n          <Divider variant=\"middle\" />\n          {props.extraItems?.map(item => (\n            <MenuItem\n              className={classes.menuItemSpacing}\n              onClick={() => item.func}\n            >\n              {item.label}\n            </MenuItem>\n          ))}\n          <div className={classes.menuItemSpacing}>\n            {props.darkThemeLabel}\n            <Toggle\n              onToggle={() => props.handleToggleTheme()}\n              toggle={props.isDarkTheme}\n            ></Toggle>\n          </div>\n          <MenuItem\n            className={(classes.menuItemSpacing, classes.cursorPointer)}\n            onClick={props.handleLogout}\n          >\n            {props.logoutLabel}\n          </MenuItem>\n          <Divider variant=\"middle\" />\n          <div\n            className={\n              classes.menuItemSpacing + \" \" + classes.profileMenuFooter\n            }\n          >\n            {props.version}\n          </div>\n        </Typography>\n      </Menu>\n    </div>\n  );\n};\nProfileMenu.propTypes = {\n  welcomeLabel: PropTypes.string,\n  userName: PropTypes.string,\n  darkThemeLabel: PropTypes.string,\n  logoutLabel: PropTypes.string,\n  version: PropTypes.string,\n  extraItems: PropTypes.array,\n  isDarkTheme: PropTypes.bool,\n  handleLogout: PropTypes.func,\n  handleToggleTheme: PropTypes.func\n};\n\nProfileMenu.defaultProps = {\n  welcomeLabel: \"Hello\",\n  userName: \"User\",\n  darkThemeLabel: \"Dark Theme\",\n  logoutLabel: \"Logout\",\n  version: \"\",\n  extraItems: [],\n  isDarkTheme: true,\n  handleLogout: () => console.log(\"logout\"),\n  handleToggleTheme: () => console.log(\"toggle\")\n};\n\nexport default ProfileMenu;\n","import React, { Component } from \"react\";\nimport {\n  List,\n  InputBase,\n  IconButton,\n  Typography,\n  Divider,\n  ListItem\n} from \"@material-ui/core\";\nimport PropTypes from \"prop-types\";\nimport SearchIcon from \"@material-ui/icons/Search\";\nimport ClearIcon from \"@material-ui/icons/Clear\";\n\nclass TreeSearch extends Component {\n  searchInput = null;\n  timer = null;\n  inputRef = React.createRef();\n\n  handleChange = evt => {\n    this.searchInput = evt.target.value;\n    if (this.timer) {\n      clearTimeout(this.timer);\n    }\n    this.timer = setTimeout(this.handleSearch, 250);\n  };\n\n  handleSearch = () => {\n    if (this.searchInput !== null) this.props.search(this.searchInput);\n  };\n\n  resetValue() {\n    const input = this.inputRef.current.children[0];\n    input.value = \"\";\n    input.focus();\n    this.searchInput = \"\";\n    this.handleSearch();\n    this.forceUpdate();\n  }\n\n  isEmpty() {\n    return this.searchInput === null || this.searchInput.trim() === \"\";\n  }\n\n  render() {\n    return (\n      <Typography\n        component=\"div\"\n        style={{\n          padding: \"2px 4px\",\n          display: \"flex\",\n          alignItems: \"center\",\n          width: \"100%\"\n        }}\n      >\n        <InputBase\n          ref={this.inputRef}\n          style={{\n            marginLeft: 10,\n            flex: 1\n          }}\n          placeholder=\"Search\"\n          onChange={this.handleChange}\n        />\n        <IconButton\n          style={{ padding: 10 }}\n          onClick={() => {\n            if (!this.isEmpty()) {\n              this.resetValue();\n            }\n          }}\n        >\n          {this.isEmpty() ? <SearchIcon /> : <ClearIcon />}\n        </IconButton>\n      </Typography>\n    );\n  }\n}\n\n/**\n *\n * @param {*} props: contains children which are Items\n */\nconst ListItemsTree = props => {\n  return (\n    <List\n      style={{ paddingLeft: \"0px\", paddingRight: \"0px\", ...props.style }}\n      dense={true}\n      component=\"div\"\n      onKeyUp={props.onKeyUp}\n    >\n      {props.children}\n    </List>\n  );\n};\n\nconst ListItemsTreeWithTitle = props => {\n  return (\n    <ListItemsTree>\n      <ListItem>\n        <Typography component={props.variant}>{props.title}</Typography>\n      </ListItem>\n      <Divider />\n      {props.children}\n    </ListItemsTree>\n  );\n};\n/* \n  TODO: think about how to generalize the search\n\n  Using either the _shared/Search method or using a predicate \n*/\nconst ListItemsTreeWithSearch = props => {\n  return (\n    <ListItemsTree\n      style={{ flexGrow: 1, paddingBottom: \"0px\", paddingTop: \"0px\" }}\n      onKeyUp={props.onKeyUp}\n    >\n      <ListItem>\n        <TreeSearch search={input => props.onSearch(input)} />\n      </ListItem>\n      <Divider />\n      <Typography style={props.style} component=\"div\">\n        {React.Children.map(props.children, x => {\n          return x;\n        })}\n      </Typography>\n    </ListItemsTree>\n  );\n};\n\nListItemsTreeWithSearch.propTypes = {\n  onSearch: PropTypes.func\n};\n\nListItemsTreeWithSearch.defaultProps = {\n  onSearch: input => console.log(input)\n};\n\nexport { ListItemsTree, ListItemsTreeWithSearch, ListItemsTreeWithTitle };\n","import React, { Component } from \"react\";\nimport PropTypes from \"prop-types\";\nimport Tree from \"react-virtualized-tree\";\nimport \"material-icons/css/material-icons.css\";\nimport \"react-virtualized/styles.css\";\nimport \"react-virtualized-tree/lib/main.css\";\nimport ExpandMoreIcon from \"@material-ui/icons/ExpandMore\";\nimport ChevronRightIcon from \"@material-ui/icons/ChevronRight\";\nimport Box from \"@material-ui/core/Box\";\nimport Grid from \"@material-ui/core/Grid\";\nimport { withStyles } from \"@material-ui/core/styles\";\nimport _get from \"lodash/get\";\nimport { ListItemsTreeWithSearch } from \"./TreeSearch\";\n\n//========================================================================================\n/*                                                                                      *\n *                                     TODO REFACTOR                                    *\n *                                                                                      */\n//========================================================================================\n\nconst styles = theme => ({\n  horizFlex: {\n    display: \"flex\",\n    flexDirection: \"row\",\n    alignItems: \"center\"\n  },\n  spaceBetween: {\n    display: \"flex\",\n    width: \"100%\",\n    justifyContent: \"space-between\"\n  },\n  preContainer: {\n    justifyContent: \"space-between\",\n    \"& button\": {\n      display: \"none\"\n    },\n    \"&:hover\": {\n      backgroundColor: \"rgba(54,181,230, 0.15)\",\n      \"& button\": {\n        display: \"inline-flex\"\n      }\n    }\n  },\n  ellipsis: {\n    whiteSpace: \"nowrap\",\n    overflow: \"hidden\",\n    textOverflow: \"ellipsis\",\n    flex: 2\n  },\n  iconSpace: {\n    flex: 1,\n    textAlign: \"right\",\n    minWidth: \"45px\",\n    \"& button\": {\n      position: \"relative\",\n      bottom: \"7px\",\n      padding: \"7px\"\n    }\n  }\n});\n\n// const {Deletable, Expandable, Favorite} = Renderers;\n\nconst testArray = [];\n\nfor (let index = 0; index < 100; index++) {\n  testArray.push({\n    id: index,\n    name: `1.0.${index}`\n  });\n}\n\nconst EXPANDED = \"EXPANDED\";\n\nclass BasicVirtualizedTree extends Component {\n  state = {\n    selectedGroup: EXPANDED,\n    groupsEnabled: true,\n    searchValue: \"\"\n  };\n\n  searchFilter = (nodes, searchValue) => {\n    const searchValueLower = searchValue.toLowerCase();\n    const filteredNodes = nodes\n      .filter(\n        node =>\n          (!node.name.includes(\"@SM\") &&\n            node.name.toLowerCase().includes(searchValueLower)) ||\n          node.children.findIndex(ch =>\n            ch.name.toLowerCase().includes(searchValueLower)\n          ) >= 0\n      )\n      .map(node => {\n        return {\n          ...node,\n          children: (node?.children || []).filter(\n            ch =>\n              ch.name &&\n              !ch.name.includes(\"@SM\") &&\n              (node.name.toLowerCase().includes(searchValueLower) ||\n                ch.name.toLowerCase().includes(searchValueLower))\n          )\n        };\n      });\n\n    // Add children id if missing\n    filteredNodes.forEach(node => {\n      node.children.forEach((child, i) => {\n        child.id = child.id ? child.id : i;\n        if (child.children) {\n          child.children.forEach((grandChild, j) => {\n            grandChild.id = grandChild.id ? grandChild.id : j;\n          });\n        }\n      });\n    });\n\n    return filteredNodes;\n  };\n\n  handleSelectedGroupChange = selectedGroup => {\n    this.setState({ selectedGroup });\n  };\n\n  // open: true -> expand\n  //       false -> collapse\n  handleExpansion = (evt, nodes, node, open) => {\n    // const treeData = _cloneDeep(nodes);\n    // _set(treeData, [node.id, \"state\"], {\n    //   expanded: open\n    // });\n    // evt.stopPropagation();\n    // this.props.handleChange(treeData);\n  };\n\n  render() {\n    const { classes } = this.props;\n    const iconStyle = <i className=\"fas fa-home\" />;\n    const nodes = this.props.data;\n    return (\n      <div>\n        <ListItemsTreeWithSearch\n          style={{\n            overflow: \"auto\"\n          }}\n          icon={iconStyle}\n          onSearch={input => {\n            this.setState({\n              searchValue: input\n            });\n          }}\n        >\n          <div style={{ height: this.props.height }}>\n            <Tree\n              nodes={this.searchFilter(nodes, this.state.searchValue)}\n              onChange={this.props.handleChange}\n            >\n              {({ style, node, ...rest }) => {\n                // Adjust tree indentation\n                style.paddingLeft = style.marginLeft / 1.5;\n                style.marginLeft = 0;\n                // Render tree element\n                return (\n                  <div\n                    style={style}\n                    onClick={() => this.props.onClickNode(node)}\n                    onDoubleClick={() => this.props.onDoubleClickNode(node)}\n                    p={2}\n                    className={\n                      !_get(node, `children`, false) ? classes.preContainer : \"\"\n                    }\n                  >\n                    <Box p={1} className={classes.inlineFlex}>\n                      <Grid alignContent={\"space-between\"} container>\n                        {_get(node, `children`, false) &&\n                          node.state?.expanded && (\n                            <ExpandMoreIcon\n                              onClick={evt =>\n                                this.handleExpansion(evt, nodes, node, false)\n                              }\n                            />\n                          )}\n                        {_get(node, `children`, false) &&\n                          !node.state?.expanded && (\n                            <ChevronRightIcon\n                              onClick={evt =>\n                                this.handleExpansion(evt, nodes, node, true)\n                              }\n                            />\n                          )}\n\n                        <div\n                          className={\n                            !_get(node, `children`, false)\n                              ? classes.spaceBetween\n                              : \"\"\n                          }\n                        >\n                          <div className={classes.ellipsis}>{node.name}</div>\n                        </div>\n                      </Grid>\n                    </Box>\n                  </div>\n                );\n              }}\n            </Tree>\n          </div>\n        </ListItemsTreeWithSearch>\n      </div>\n    );\n  }\n}\n\nBasicVirtualizedTree.propTypes = {\n  data: PropTypes.array,\n  onClickNode: PropTypes.func,\n  onDoubleClickNode: PropTypes.func,\n  handleChange: PropTypes.func,\n  height: PropTypes.oneOfType([PropTypes.string, PropTypes.number])\n};\n\nBasicVirtualizedTree.defaultProps = {\n  data: [],\n  onClickNode: () => {},\n  onDoubleClickNode: () => {},\n  handleChange: () => {},\n  height: 700\n};\n\nexport default withStyles(styles, { withTheme: true })(BasicVirtualizedTree);\n","import React from \"react\";\nimport PropTypes from \"prop-types\";\nimport _set from \"lodash/set\";\nimport _get from \"lodash/get\";\nimport _cloneDeep from \"lodash/cloneDeep\";\nimport {\n  FormControl,\n  Grid,\n  InputLabel,\n  MenuItem,\n  Select,\n  Typography\n} from \"@material-ui/core\";\nimport { Workspace } from \"mov-fe-lib-core\";\nimport BasicVirtualizedTree from \"../Tree/BasicVirtualizedTree\";\nimport AbstractModal from \"./AbstractModal\";\nimport Backdrop from \"@material-ui/core/Backdrop\";\nimport CircularProgress from \"@material-ui/core/CircularProgress\";\n\n//========================================================================================\n/*                                                                                      *\n *                                    TEMPORARY CODE                                    *\n *                                                                                      */\n//========================================================================================\n\nconst SelectScopeModal = props => {\n  const initialData = [\n    {\n      id: 0,\n      name: \"Annotations\",\n      scope: \"Annotation\",\n      children: []\n    },\n    {\n      id: 1,\n      name: \"Callback\",\n      scope: \"Callback\",\n      children: []\n    },\n    {\n      id: 2,\n      name: \"Configuration\",\n      scope: \"Configuration\",\n      children: []\n    },\n    {\n      id: 3,\n      name: \"Flow\",\n      scope: \"Flow\",\n      children: []\n    },\n    {\n      id: 4,\n      name: \"Nodes\",\n      scope: \"Node\",\n      children: []\n    },\n    {\n      id: 5,\n      name: \"Layouts\",\n      scope: \"Layout\",\n      children: []\n    },\n    {\n      id: 6,\n      name: \"Scenes\",\n      scope: \"GraphicScene\",\n      children: []\n    }\n  ];\n\n  const [data, setData] = React.useState(initialData);\n  const [selectedWorkspace, setSelectedWorkspace] = React.useState(\"global\");\n  const [selectedScopeItem, setSelectedScopeItem] = React.useState(\n    props.selected\n  );\n  const [workSpaceList, setWorkSpaceList] = React.useState({});\n  const [isLoading, setIsLoading] = React.useState(true);\n\n  const scopeFilteredData = initialData.filter(elem =>\n    props.scopeList.includes(elem.scope)\n  );\n\n  /* eslint-disable react-hooks/exhaustive-deps */\n  React.useEffect(() => {\n    //get list of workspace\n    Workspace.getAll()\n      .then(response => setWorkSpaceList(response))\n      .catch(error => console.log(error));\n\n    // get all information in the scopes (not filtered by message)\n    getAllData(selectedWorkspace);\n    //Unmount\n    return () => {};\n  }, [props.scopeList]);\n\n  // Filter Results based on props.filter\n  React.useEffect(() => {\n    if (isLoading || selectedWorkspace !== \"global\" || !props.filter) return;\n    const filteredData = _cloneDeep(data);\n    data.forEach((scope, index) => {\n      filteredData[index].children = scope.children.filter(props.filter);\n    });\n    // Set filtered data\n    setData(filteredData);\n  }, [props.filter, isLoading]);\n  /* eslint-enable react-hooks/exhaustive-deps */\n\n  const changeWorkspace = evt => {\n    // Update the selector\n    setSelectedWorkspace(evt.target.value);\n    // When you switch workspaces reset Data\n    getAllData(evt.target.value);\n    setIsLoading(true);\n  };\n\n  const getAllData = workspace => {\n    const dataToSet = _cloneDeep(scopeFilteredData);\n\n    dataToSet.forEach((element, index) => {\n      // Get all scope items\n      Workspace.getDocs({ workspace: workspace, scope: element.scope })\n        .then(response => {\n          let sortedScopeItems = response.scopes\n            .sort((a, b) => a.ref.localeCompare(b.ref))\n            .map((elem, i) => {\n              return {\n                id: i,\n                url: elem.url,\n                name: elem.ref,\n                children: [{ name: \"\" }]\n              };\n            });\n\n          dataToSet[index].children = sortedScopeItems;\n          setData(dataToSet);\n          setIsLoading(false);\n        })\n        .catch(error => console.error(error));\n    });\n  };\n\n  const requestScopeVersions = node => {\n    const dataToSet = _cloneDeep(data);\n    const mapObj = {\n      0: () => {\n        const indexToSet = dataToSet.findIndex(elem => elem.id === node.id);\n\n        // Toggle the expansion of the panel\n        const isExpanded = _get(\n          dataToSet,\n          [indexToSet, \"state\", \"expanded\"],\n          false\n        );\n        _set(dataToSet, [indexToSet, \"state\"], {\n          expanded: !isExpanded\n        });\n\n        setData(dataToSet);\n      },\n      1: () => {\n        // second level, ask for versions (versions of scope items)\n\n        // find index of selected node in first level\n        const indexToSet = dataToSet.findIndex(\n          elem => elem.id === node.parents[0]\n        );\n\n        Workspace.getDocs({\n          workspace: selectedWorkspace,\n          scope: dataToSet[indexToSet].scope,\n          id: node.name\n        })\n          .then(response => {\n            // Tailor data Data comes with \"ref\" key but we want \"name\"\n            const versionList = response.versions.map((elem, index) => {\n              return {\n                url: elem.url,\n                name: elem.tag,\n                id: index\n              };\n            });\n\n            // find index of selected node in the second level\n            const index2ndLevel = dataToSet[indexToSet].children.findIndex(\n              elem => elem.id === node.id\n            );\n\n            // Toggle the expansion of the panel\n            const isExpanded = _get(\n              dataToSet,\n              [indexToSet, \"children\", index2ndLevel, \"state\", \"expanded\"],\n              false\n            );\n            _set(dataToSet, [indexToSet, \"children\", index2ndLevel, \"state\"], {\n              expanded: !isExpanded\n            });\n\n            // Set version list into the Tree\n            _set(\n              dataToSet,\n              [indexToSet, \"children\", index2ndLevel, \"children\"],\n              versionList\n            );\n            setData(dataToSet);\n          })\n          .catch(error => console.error(error));\n      },\n      2: () => {\n        // Display the selected option\n        setSelectedScopeItem(`${node.url}`);\n      }\n    };\n    _get(mapObj, node.deepness, () => {})();\n  };\n\n  const confirmNodeSelection = node => {\n    // Display the selected option and confirm selection\n    if (selectedWorkspace !== \"global\" && node.deepness <= 1) return;\n    setSelectedScopeItem(node.url);\n    props.onSubmit(node.url);\n  };\n\n  const getModalTitle = scope => {\n    const vowels = [\"a\", \"e\", \"i\", \"o\", \"u\"];\n    const pronoun = vowels.includes(scope[0].toLowerCase()) ? \"an\" : \"a\";\n    return `Select ${pronoun} ${scope}`;\n  };\n\n  return (\n    <AbstractModal\n      onSubmit={() => props.onSubmit(selectedScopeItem)}\n      onCancel={props.onCancel}\n      open={props.open}\n      title={getModalTitle(props.scopeList[0])}\n      width=\"50%\"\n    >\n      <Grid container>\n        <Grid\n          item\n          xs={12}\n          style={{\n            textAlign: \"center\",\n            paddingBottom: \"6px\",\n            paddingTop: \"10px\"\n          }}\n        >\n          <FormControl style={{ width: \"50%\" }}>\n            <InputLabel>Workspace</InputLabel>\n            <Select\n              value={selectedWorkspace}\n              onChange={changeWorkspace}\n              disabled={!props.allowArchive}\n            >\n              {Object.keys(workSpaceList).map((key, index) => (\n                <MenuItem key={index} value={key}>\n                  {workSpaceList[key].label}\n                </MenuItem>\n              ))}\n            </Select>\n          </FormControl>\n        </Grid>\n        <Typography\n          component=\"div\"\n          style={{\n            overflowY: \"auto\",\n            overflowX: \"hidden\",\n            justifyContent: \"center\",\n            width: \"100%\"\n          }}\n        >\n          {isLoading ? (\n            <Backdrop\n              style={{\n                position: \"relative\",\n                height: \"50vh\",\n                width: \"inherit\",\n                color: \"#fff\",\n                zIndex: 99999\n              }}\n              open={isLoading}\n            >\n              <CircularProgress color=\"inherit\" />\n            </Backdrop>\n          ) : (\n            <BasicVirtualizedTree\n              onClickNode={node => requestScopeVersions(node)}\n              onDoubleClickNode={data => confirmNodeSelection(data)}\n              data={data}\n              handleChange={nodes => setData(nodes)}\n              showIcons={false}\n              height=\"400px\"\n            ></BasicVirtualizedTree>\n          )}\n        </Typography>\n        <Grid item xs={12} style={{ textAlign: \"center\" }}>\n          <Typography label=\"Message\" value={\"selected\"} margin=\"normal\">\n            {selectedScopeItem === \"\" ? \"Nothing selected\" : selectedScopeItem}\n          </Typography>\n        </Grid>\n      </Grid>\n    </AbstractModal>\n  );\n};\n\nSelectScopeModal.propTypes = {\n  allowArchive: PropTypes.bool,\n  onSubmit: PropTypes.func,\n  onCancel: PropTypes.func,\n  open: PropTypes.bool,\n  scopeList: PropTypes.array,\n  message: PropTypes.string,\n  selected: PropTypes.string,\n  filter: PropTypes.func\n};\n\nSelectScopeModal.defaultProps = {\n  allowArchive: true,\n  title: \"Insert Text here\",\n  message: \"Are you sure?\",\n  onSubmit: () => {},\n  onCancel: () => {},\n  open: false,\n  scopeList: [\"Callback\"],\n  selected: \"\"\n};\n\nexport default SelectScopeModal;\n","import React, { useEffect } from \"react\";\nimport { MasterDB } from \"mov-fe-lib-core\";\nimport Alert from \"@material-ui/lab/Alert\";\nimport CircularProgress from \"@material-ui/core/CircularProgress\";\nimport { makeStyles } from \"@material-ui/styles\";\nimport { Button } from \"@material-ui/core\";\n\nconst useStyles = makeStyles(theme => ({\n  alert: { position: \"absolute\", bottom: 0, width: \"100%\" }\n}));\n\nexport default function withOfflineValidation(Component) {\n  return function (props) {\n    const [isConnected, setConnected] = React.useState(true);\n    const [showSuccessAlert, setSuccessAlert] = React.useState(false);\n    const [validator, setValidator] = React.useState(null);\n    const [loading, setLoading] = React.useState(false);\n    const classes = useStyles();\n\n    /**\n     * Start offline validation\n     */\n    useEffect(() => {\n      const _validator = MasterDB.offlineValidation({ onOnline, onOffline });\n      setValidator(_validator);\n    }, []);\n\n    const onOnline = () => {\n      setConnected(true);\n      setSuccessAlert(true);\n      setTimeout(() => setSuccessAlert(false), 2000);\n    };\n\n    const onOffline = () => {\n      setConnected(false);\n    };\n\n    const retryConnection = () => {\n      setLoading(true);\n      validator.retryConnection().then(() => setLoading(false));\n    };\n\n    /**\n     * renders the Login form if the user is not logged in\n     */\n    return (\n      <React.Fragment>\n        <React.Fragment>\n          <Component {...props} />\n          {!isConnected && (\n            <Alert\n              className={classes.alert}\n              variant=\"filled\"\n              severity=\"error\"\n              action={\n                <Button color=\"inherit\" size=\"small\" onClick={retryConnection}>\n                  {loading ? (\n                    <CircularProgress\n                      size={20}\n                      color=\"inherit\"\n                    ></CircularProgress>\n                  ) : (\n                    \"RETRY\"\n                  )}\n                </Button>\n              }\n            >\n              Connection failed... You're now in offline mode, please wait to\n              reconnect.\n            </Alert>\n          )}\n          {isConnected && showSuccessAlert && (\n            <Alert\n              className={classes.alert}\n              variant=\"filled\"\n              severity=\"success\"\n            >\n              You're now online!\n            </Alert>\n          )}\n        </React.Fragment>\n      </React.Fragment>\n    );\n  };\n}\n","import React, { useState, useEffect, useRef } from \"react\";\nimport { Modal } from \"@material-ui/core\";\nimport { Authentication } from \"mov-fe-lib-core\";\nimport LoginForm from \"../LoginForm/LoginForm\";\nimport jwtDecode from \"jwt-decode\";\n\nexport default function withAuthentication(Component) {\n  return function (props) {\n    const RECHECK_VALID_DELAY = 2000; // milliseconds\n\n    const firstRender = useRef(true);\n\n    const [loggedIn, setLoggedIn] = useState(false);\n    const [checkLogin, setCheckLogin] = useState(0);\n\n    /**\n     * check if the user is authenticated\n     */\n    useEffect(() => {\n      async function checkLogin() {\n        return await Authentication.checkLogin();\n      }\n\n      setLoggedIn(checkLogin());\n    }, []);\n\n    /**\n     * Checks if the refresh token is still valid\n     * sets loggedIn accordingly.\n     * Setting checkLogin or loggedIn will trigger execution\n     */\n    useEffect(() => {\n      const now = Math.floor(Date.now() * 0.001);\n      const token = window.localStorage.getItem(\"movai.refreshToken\");\n\n      try {\n        // decode the token and get exp value\n        const exp = jwtDecode(token).exp || now;\n\n        // check if token expiration time is still valid\n        const expDelta = exp - now;\n        if (expDelta <= 0) {\n          throw new Error(\"Token expired\");\n        }\n\n        // check again in expire time + RECHECK_VALID_DELAY\n        setTimeout(\n          () => setCheckLogin(now),\n          expDelta * 1000 + RECHECK_VALID_DELAY\n        );\n\n        setLoggedIn(true);\n      } catch (error) {\n        // token expired or no token\n        setLoggedIn(false);\n      }\n    }, [checkLogin, loggedIn]);\n\n    /**\n     * handleLogOut - log out the user\n     */\n    const handleLogOut = () => {\n      Authentication.logout();\n    };\n\n    /**\n     * handleFirstRender - If the user is not logged in and it is the first render\n     * then show the login form without the application on the background.\n     * After the first login, the login form can be showned as a modal instead.\n     */\n    const handleFirstRender = () => {\n      firstRender.current = false;\n      return <LoginForm setLoggedIn={state => setLoggedIn(state)} />;\n    };\n\n    /**\n     * renders the Login form if the user is not logged in\n     */\n    return (\n      <React.Fragment>\n        {!loggedIn && firstRender.current ? (\n          handleFirstRender()\n        ) : (\n          <React.Fragment>\n            <Component\n              handleLogOut={handleLogOut}\n              loggedIn={loggedIn}\n              {...props}\n            />\n            <Modal open={!loggedIn}>\n              <LoginForm setLoggedIn={state => setLoggedIn(state)} />\n            </Modal>\n          </React.Fragment>\n        )}\n      </React.Fragment>\n    );\n  };\n}\n"],"sourceRoot":""}